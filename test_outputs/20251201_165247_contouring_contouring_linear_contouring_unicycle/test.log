2025-12-01 16:52:47,550 - INFO - integration_test - Contouring objective detected: automatically switching to contouring-aware dynamics model
2025-12-01 16:52:47,550 - WARNING - integration_test -   Vehicle dynamics 'contouring_unicycle' is not automatically converted. Ensure it supports contouring (has 'spline' state variable)
2025-12-01 16:52:47,550 - INFO - integration_test - Created vehicle dynamics model: ContouringSecondOrderUnicycleModel
2025-12-01 16:52:47,550 - INFO - integration_test - ✓ Validation passed: Contouring objective with dynamics model that has 'spline' state
2025-12-01 16:52:47,550 - INFO - integration_test - Creating objective module: contouring
2025-12-01 16:52:47,556 - INFO - integration_test - Objective module 'contouring' created: contouring_objective
2025-12-01 16:52:47,556 - INFO - integration_test - Creating 2 constraint module(s): ['contouring', 'linear']
2025-12-01 16:52:47,556 - DEBUG - integration_test - Creating constraint module: contouring
2025-12-01 16:52:47,561 - INFO - integration_test - Constraint module 'contouring' created: contouring_constraints
2025-12-01 16:52:47,561 - DEBUG - integration_test - Creating constraint module: linear
2025-12-01 16:52:47,567 - INFO - integration_test - Constraint module 'linear' created: linearized_constraints
2025-12-01 16:52:47,567 - INFO - integration_test - Created 2 constraint module(s)
2025-12-01 16:52:47,582 - INFO - integration_test - Setting solver on all modules...
2025-12-01 16:52:47,582 - DEBUG - integration_test -   Set solver on module: contouring_constraints
2025-12-01 16:52:47,582 - DEBUG - integration_test -   Set solver on module: linearized_constraints
2025-12-01 16:52:47,582 - DEBUG - integration_test -   Set solver on module: control_effort_objective
2025-12-01 16:52:47,582 - DEBUG - integration_test -   Set solver on module: control_jerk_objective
2025-12-01 16:52:47,582 - DEBUG - integration_test -   Set solver on module: path_reference_velocity_objective
2025-12-01 16:52:47,582 - DEBUG - integration_test -   Set solver on module: contouring_objective
2025-12-01 16:52:47,582 - WARNING - integration_test - Error shaping obstacles: 'max_obstacles'
2025-12-01 16:52:47,582 - WARNING - integration_test - Error in on_data_received: 'Planner' object has no attribute 'on_data_received'
2025-12-01 16:52:47,583 - INFO - integration_test - Initial vehicle state (before spline): [0. 0. 0. 1.]
2025-12-01 16:52:47,583 - INFO - integration_test - Vehicle starting position: (0.00, 0.00)
2025-12-01 16:52:47,583 - INFO - integration_test - Reference path start: (0.00, 0.00)
2025-12-01 16:52:47,583 - INFO - integration_test - Reference path starts at vehicle position (requirement satisfied)
2025-12-01 16:52:47,583 - INFO - integration_test - Contouring-aware dynamics detected: initializing spline variable
2025-12-01 16:52:47,583 - INFO - integration_test - Initialized spline to closest path point: s=0.0000 (vehicle at (0.00, 0.00), closest path point at (0.00, 0.00), distance=0.000m)
2025-12-01 16:52:47,583 - INFO - integration_test - Added spline variable: 0.0000
2025-12-01 16:52:47,583 - INFO - integration_test - Final initial state: [0. 0. 0. 1. 0.] (variables: ['x', 'y', 'psi', 'v', 'spline'])
2025-12-01 16:52:47,583 - INFO - integration_test - Step 0 (contouring until path end)
2025-12-01 16:52:47,584 - DEBUG - integration_test - Syncing planner state at step 0: vehicle_state=[0. 0. 0. 1. 0.]
2025-12-01 16:52:47,584 - DEBUG - integration_test - Step 0: Using propagated spline 0.0000 (close to path, dist=0.000m)
2025-12-01 16:52:47,584 - DEBUG - integration_test -   Set spline state to 0.0000
2025-12-01 16:52:47,586 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2025-12-01 16:52:47,600 - DEBUG - integration_test - Step 0: Checking path alignment: vehicle=(0.000, 0.000), path_start=(0.000, 0.000), dist=0.000m
2025-12-01 16:52:47,600 - INFO - integration_test - === Calling planner.solve_mpc() at step 0 ===
2025-12-01 16:52:47,603 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2025-12-01 16:52:47,604 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['contouring_constraints', 'linearized_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2025-12-01 16:52:47,604 - INFO - integration_test - Warmstart k=0: x0=0.0 , y0=0.0 , psi0=0.0 , v0=1.0 , spline0=0.0 , a0=0.0 , w0=0.0
2025-12-01 16:52:47,604 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2025-12-01 16:52:47,605 - INFO - integration_test - Dyn residual k=0: pred=[0.1, 0.0, 0.0, 1.0, 0.1], ws=[0.1, 0.0, 0.0, 1.0, 0.1], res=[0.0, 0.0, 0.0, 0.0, 0.0], res_norm=0.000e+00
2025-12-01 16:52:47,606 - INFO - integration_test - Dyn residual k=1: pred=[0.2, 0.0, 0.0, 1.0, 0.2], ws=[0.2, 0.0, 0.0, 1.0, 0.2127494608332952], res=[0.0, 0.0, 0.0, 0.0, -0.0127494608332952], res_norm=1.275e-02
2025-12-01 16:52:47,607 - INFO - integration_test - Dyn residual k=2: pred=[0.30000000000000004, 0.0, 0.0, 1.0, 0.31274946083329525], ws=[0.30000000000000004, 0.0, 0.0, 1.0, 0.3386985848683951], res=[0.0, 0.0, 0.0, 0.0, -0.025949124035099858], res_norm=2.595e-02
2025-12-01 16:52:47,622 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:47,636 - INFO - integration_test - Stage 0: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:47,653 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:47,666 - INFO - integration_test - Stage 1: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:47,684 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:47,698 - INFO - integration_test - Stage 2: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:47,715 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:47,729 - INFO - integration_test - Stage 3: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:47,746 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:47,760 - INFO - integration_test - Stage 4: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:47,778 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:47,792 - INFO - integration_test - Stage 5: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:47,810 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:47,823 - INFO - integration_test - Stage 6: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:47,838 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:47,851 - INFO - integration_test - Stage 7: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:47,866 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:47,879 - INFO - integration_test - Stage 8: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:47,896 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:47,909 - INFO - integration_test - Stage 9: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:47,928 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:47,940 - INFO - integration_test - Stage 10: constraints count=2 (linearized=0, contouring=2, other=0)
2025-12-01 16:52:48,635 - INFO - integration_test - Step 0: MPC solve successful
2025-12-01 16:52:48,664 - INFO - integration_test - Step 0: Computed 10 numeric contouring constraints for visualization (s=0.000)
2025-12-01 16:52:48,664 - DEBUG - integration_test - Step 0: Captured 10 contouring constraint halfspaces for visualization
2025-12-01 16:52:48,664 - DEBUG - integration_test - Captured 2 linearized constraint halfspaces at step 0
2025-12-01 16:52:48,664 - INFO - integration_test - === Applying control at step 0 ===
2025-12-01 16:52:48,664 - INFO - integration_test -   Control dict from planner: {'a': 2.000000019993503, 'w': 0.8000000098235426}
2025-12-01 16:52:48,664 - INFO - integration_test -   Expected input names: ['a', 'w']
2025-12-01 16:52:48,664 - INFO - integration_test -   Planner output success: True
2025-12-01 16:52:48,666 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2025-12-01 16:52:48,666 - INFO - integration_test - Step 0 completed in 1.083s
2025-12-01 16:52:48,698 - INFO - integration_test - Step 1 (contouring until path end)
2025-12-01 16:52:48,699 - DEBUG - integration_test - Syncing planner state at step 1: vehicle_state=[0.10987738 0.00453085 0.08       1.2        0.12      ]
2025-12-01 16:52:48,700 - DEBUG - integration_test - Step 1: Using propagated spline 0.1200 (close to path, dist=0.110m)
2025-12-01 16:52:48,700 - DEBUG - integration_test -   Set spline state to 0.1200
2025-12-01 16:52:48,701 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2025-12-01 16:52:48,702 - DEBUG - integration_test - Error updating modules: 'x'
2025-12-01 16:52:48,720 - DEBUG - integration_test - Step 1: Checking path alignment: vehicle=(0.110, 0.005), path_start=(0.000, 0.000), dist=0.110m
2025-12-01 16:52:48,721 - WARNING - integration_test - Could not update reference path at step 1: x and y must have the same length
2025-12-01 16:52:48,721 - INFO - integration_test - === Calling planner.solve_mpc() at step 1 ===
2025-12-01 16:52:48,725 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2025-12-01 16:52:48,728 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['contouring_constraints', 'linearized_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2025-12-01 16:52:48,728 - INFO - integration_test - Warmstart k=0: x0=0.10987737537798789 , y0=0.0045308451139730995 , psi0=0.08000000098235426 , v0=1.2000000019993502 , spline0=0.12000000019993502 , a0=0.0 , w0=0.0
2025-12-01 16:52:48,728 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2025-12-01 16:52:48,729 - INFO - integration_test - Dyn residual k=0: pred=[0.22949358032417722, 0.014120608523757055, 0.08000000098235426, 1.2000000019993502, 0.24000000039987004], ws=[0.22949358032417724, 0.014120608523757058, 0.08000000098235427, 1.2000000019993502, 0.2825662537002405], res=[-2.7755575615628914e-17, -3.469446951953614e-18, -1.3877787807814457e-17, 0.0, -0.04256625330037048], res_norm=4.257e-02
2025-12-01 16:52:48,730 - INFO - integration_test - Dyn residual k=1: pred=[0.34910978527036657, 0.023710371933541016, 0.08000000098235427, 1.2000000019993502, 0.40256625390017553], ws=[0.3491097852703666, 0.023710371933541016, 0.08000000098235427, 1.2000000019993502, 0.4628520712936688], res=[-5.551115123125783e-17, 0.0, 0.0, 0.0, -0.06028581739349326], res_norm=6.029e-02
2025-12-01 16:52:48,731 - INFO - integration_test - Dyn residual k=2: pred=[0.468725990216556, 0.033300135343324974, 0.08000000098235427, 1.2000000019993502, 0.5828520714936039], ws=[0.468725990216556, 0.033300135343324974, 0.08000000098235427, 1.2000000019993502, 0.6617370077588454], res=[0.0, 0.0, 0.0, 0.0, -0.07888493626524151], res_norm=7.888e-02
2025-12-01 16:52:48,754 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:48,769 - INFO - integration_test - Stage 0: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:48,788 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:48,806 - INFO - integration_test - Stage 1: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:48,830 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:48,849 - INFO - integration_test - Stage 2: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:48,870 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:48,887 - INFO - integration_test - Stage 3: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:48,909 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:48,927 - INFO - integration_test - Stage 4: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:48,949 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:48,967 - INFO - integration_test - Stage 5: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:48,988 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:49,007 - INFO - integration_test - Stage 6: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:49,033 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:49,051 - INFO - integration_test - Stage 7: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:49,076 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:49,097 - INFO - integration_test - Stage 8: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:49,124 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:49,145 - INFO - integration_test - Stage 9: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:49,173 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:49,189 - INFO - integration_test - Stage 10: constraints count=2 (linearized=0, contouring=2, other=0)
2025-12-01 16:52:49,503 - INFO - integration_test - Step 1: MPC solve successful
2025-12-01 16:52:49,517 - INFO - integration_test - Step 1: Computed 10 numeric contouring constraints for visualization (s=0.120)
2025-12-01 16:52:49,517 - DEBUG - integration_test - Step 1: Captured 10 contouring constraint halfspaces for visualization
2025-12-01 16:52:49,517 - INFO - integration_test - === Applying control at step 1 ===
2025-12-01 16:52:49,517 - INFO - integration_test -   Control dict from planner: {'a': 2.00000001766651, 'w': 0.7999999672852307}
2025-12-01 16:52:49,518 - INFO - integration_test -   Expected input names: ['a', 'w']
2025-12-01 16:52:49,518 - INFO - integration_test -   Planner output success: True
2025-12-01 16:52:49,519 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2025-12-01 16:52:49,520 - INFO - integration_test - Step 1 completed in 0.821s
2025-12-01 16:52:49,555 - INFO - integration_test - Step 2 (contouring until path end)
2025-12-01 16:52:49,555 - DEBUG - integration_test - Syncing planner state at step 2: vehicle_state=[0.23889213 0.02022162 0.16       1.4        0.26      ]
2025-12-01 16:52:49,556 - DEBUG - integration_test - Step 2: Using propagated spline 0.2600 (close to path, dist=0.240m)
2025-12-01 16:52:49,556 - DEBUG - integration_test -   Set spline state to 0.2600
2025-12-01 16:52:49,558 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2025-12-01 16:52:49,559 - DEBUG - integration_test - Error updating modules: 'x'
2025-12-01 16:52:49,583 - DEBUG - integration_test - Step 2: Checking path alignment: vehicle=(0.239, 0.020), path_start=(0.000, 0.000), dist=0.240m
2025-12-01 16:52:49,584 - WARNING - integration_test - Could not update reference path at step 2: x and y must have the same length
2025-12-01 16:52:49,584 - INFO - integration_test - === Calling planner.solve_mpc() at step 2 ===
2025-12-01 16:52:49,589 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2025-12-01 16:52:49,591 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['contouring_constraints', 'linearized_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2025-12-01 16:52:49,591 - INFO - integration_test - Warmstart k=0: x0=0.2388921281898357 , y0=0.02022162172569844 , psi0=0.1599999977108773 , v0=1.4000000037660012 , spline0=0.26000000057653516 , a0=0.0 , w0=0.0
2025-12-01 16:52:49,591 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2025-12-01 16:52:49,593 - INFO - integration_test - Dyn residual k=0: pred=[0.3771039482852713, 0.042526170395308316, 0.1599999977108773, 1.4000000037660012, 0.40000000095313526], ws=[0.3771039482852713, 0.042526170395308316, 0.15999999771087747, 1.4000000037660012, 0.4922268651505974], res=[0.0, 0.0, -1.6653345369377348e-16, 0.0, -0.09222686419746212], res_norm=9.223e-02
2025-12-01 16:52:49,595 - INFO - integration_test - Dyn residual k=1: pred=[0.5153157683807068, 0.06483071906491822, 0.15999999771087747, 1.4000000037660012, 0.6322268655271975], ws=[0.5153157683807068, 0.06483071906491822, 0.15999999771087747, 1.4000000037660012, 0.7474945961470119], res=[0.0, 0.0, 0.0, 0.0, -0.11526773061981432], res_norm=1.153e-01
2025-12-01 16:52:49,597 - INFO - integration_test - Dyn residual k=2: pred=[0.6535275884761423, 0.08713526773452812, 0.15999999771087747, 1.4000000037660012, 0.887494596523612], ws=[0.6535275884761423, 0.08713526773452812, 0.15999999771087747, 1.4000000037660012, 0.9682208639333026], res=[0.0, 0.0, 0.0, 0.0, -0.08072626740969069], res_norm=8.073e-02
2025-12-01 16:52:49,621 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:49,644 - INFO - integration_test - Stage 0: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:49,668 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:49,689 - INFO - integration_test - Stage 1: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:49,720 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:49,743 - INFO - integration_test - Stage 2: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:49,767 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:49,786 - INFO - integration_test - Stage 3: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:49,818 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:49,844 - INFO - integration_test - Stage 4: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:49,870 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:49,890 - INFO - integration_test - Stage 5: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:49,912 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:49,931 - INFO - integration_test - Stage 6: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:49,952 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:49,971 - INFO - integration_test - Stage 7: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:49,992 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:50,011 - INFO - integration_test - Stage 8: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:50,032 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:50,050 - INFO - integration_test - Stage 9: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:50,071 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:50,087 - INFO - integration_test - Stage 10: constraints count=2 (linearized=0, contouring=2, other=0)
2025-12-01 16:52:50,418 - INFO - integration_test - Step 2: MPC solve successful
2025-12-01 16:52:50,429 - INFO - integration_test - Step 2: Computed 10 numeric contouring constraints for visualization (s=0.260)
2025-12-01 16:52:50,429 - DEBUG - integration_test - Step 2: Captured 10 contouring constraint halfspaces for visualization
2025-12-01 16:52:50,429 - INFO - integration_test - === Applying control at step 2 ===
2025-12-01 16:52:50,429 - INFO - integration_test -   Control dict from planner: {'a': 2.000000018686752, 'w': 0.7999999732917615}
2025-12-01 16:52:50,429 - INFO - integration_test -   Expected input names: ['a', 'w']
2025-12-01 16:52:50,429 - INFO - integration_test -   Planner output success: True
2025-12-01 16:52:50,430 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2025-12-01 16:52:50,431 - INFO - integration_test - Step 2 completed in 0.876s
2025-12-01 16:52:50,462 - INFO - integration_test - Step 3 (contouring until path end)
2025-12-01 16:52:50,463 - DEBUG - integration_test - Syncing planner state at step 3: vehicle_state=[0.38583644 0.05014472 0.24       1.60000001 0.42      ]
2025-12-01 16:52:50,464 - DEBUG - integration_test - Step 3: Using propagated spline 0.4200 (close to path, dist=0.389m)
2025-12-01 16:52:50,464 - DEBUG - integration_test -   Set spline state to 0.4200
2025-12-01 16:52:50,465 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2025-12-01 16:52:50,465 - DEBUG - integration_test - Error updating modules: 'x'
2025-12-01 16:52:50,483 - DEBUG - integration_test - Step 3: Checking path alignment: vehicle=(0.386, 0.050), path_start=(0.000, 0.000), dist=0.389m
2025-12-01 16:52:50,484 - WARNING - integration_test - Could not update reference path at step 3: x and y must have the same length
2025-12-01 16:52:50,484 - INFO - integration_test - === Calling planner.solve_mpc() at step 3 ===
2025-12-01 16:52:50,487 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2025-12-01 16:52:50,489 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['contouring_constraints', 'linearized_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2025-12-01 16:52:50,489 - INFO - integration_test - Warmstart k=0: x0=0.38583643582103067 , y0=0.05014471588907085 , psi0=0.23999999504005345 , v0=1.6000000056346764 , spline0=0.4200000011400028 , a0=0.0 , w0=0.0
2025-12-01 16:52:50,489 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2025-12-01 16:52:50,490 - INFO - integration_test - Dyn residual k=0: pred=[0.5412505125333117, 0.08817713548050461, 0.23999999504005345, 1.6000000056346764, 0.5800000017034704], ws=[0.5412505125333117, 0.08817713548050461, 0.23999999504005354, 1.6000000056346764, 0.7289817605790139], res=[0.0, 0.0, -8.326672684688674e-17, 0.0, -0.14898175887554344], res_norm=1.490e-01
2025-12-01 16:52:50,492 - INFO - integration_test - Dyn residual k=1: pred=[0.6966645892455927, 0.12620955507193837, 0.23999999504005354, 1.6000000056346764, 0.8889817611424815], ws=[0.6966645892455927, 0.12620955507193837, 0.23999999504005354, 1.6000000056346764, 1.0077625417341802], res=[0.0, 0.0, 0.0, 0.0, -0.11878078059169872], res_norm=1.188e-01
2025-12-01 16:52:50,493 - INFO - integration_test - Dyn residual k=2: pred=[0.8520786659578737, 0.16424197466337215, 0.23999999504005354, 1.6000000056346764, 1.1677625422976479], ws=[0.8520786659578737, 0.16424197466337215, 0.23999999504005354, 1.6000000056346764, 1.31263381597094], res=[0.0, 0.0, 0.0, 0.0, -0.14487127367329222], res_norm=1.449e-01
2025-12-01 16:52:50,512 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:50,529 - INFO - integration_test - Stage 0: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:50,549 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:50,566 - INFO - integration_test - Stage 1: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:50,587 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:50,604 - INFO - integration_test - Stage 2: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:50,624 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:50,639 - INFO - integration_test - Stage 3: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:50,657 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:50,672 - INFO - integration_test - Stage 4: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:50,690 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:50,704 - INFO - integration_test - Stage 5: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:50,722 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:50,736 - INFO - integration_test - Stage 6: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:50,754 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:50,768 - INFO - integration_test - Stage 7: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:50,787 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:50,801 - INFO - integration_test - Stage 8: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:50,819 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:50,833 - INFO - integration_test - Stage 9: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:50,851 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:50,864 - INFO - integration_test - Stage 10: constraints count=2 (linearized=0, contouring=2, other=0)
2025-12-01 16:52:51,204 - INFO - integration_test - Step 3: MPC solve successful
2025-12-01 16:52:51,218 - INFO - integration_test - Step 3: Computed 10 numeric contouring constraints for visualization (s=0.420)
2025-12-01 16:52:51,218 - DEBUG - integration_test - Step 3: Captured 10 contouring constraint halfspaces for visualization
2025-12-01 16:52:51,218 - INFO - integration_test - === Applying control at step 3 ===
2025-12-01 16:52:51,218 - INFO - integration_test -   Control dict from planner: {'a': 1.999999953760346, 'w': 0.7999978718400763}
2025-12-01 16:52:51,218 - INFO - integration_test -   Expected input names: ['a', 'w']
2025-12-01 16:52:51,218 - INFO - integration_test -   Planner output success: True
2025-12-01 16:52:51,220 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2025-12-01 16:52:51,221 - INFO - integration_test - Step 3 completed in 0.758s
2025-12-01 16:52:51,261 - INFO - integration_test - Step 4 (contouring until path end)
2025-12-01 16:52:51,262 - DEBUG - integration_test - Syncing planner state at step 4: vehicle_state=[0.54913547 0.09724074 0.31999978 1.8        0.6       ]
2025-12-01 16:52:51,262 - DEBUG - integration_test - Step 4: Using propagated spline 0.6000 (close to path, dist=0.455m)
2025-12-01 16:52:51,262 - DEBUG - integration_test -   Set spline state to 0.6000
2025-12-01 16:52:51,265 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2025-12-01 16:52:51,265 - DEBUG - integration_test - Error updating modules: 'x'
2025-12-01 16:52:51,288 - DEBUG - integration_test - Step 4: Checking path alignment: vehicle=(0.549, 0.097), path_start=(0.000, 0.000), dist=0.558m
2025-12-01 16:52:51,288 - WARNING - integration_test - Could not update reference path at step 4: x and y must have the same length
2025-12-01 16:52:51,288 - INFO - integration_test - === Calling planner.solve_mpc() at step 4 ===
2025-12-01 16:52:51,294 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2025-12-01 16:52:51,296 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['contouring_constraints', 'linearized_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2025-12-01 16:52:51,296 - INFO - integration_test - Warmstart k=0: x0=0.5491354665962086 , y0=0.09724073787813511 , psi0=0.3199997822240611 , v0=1.800000001010711 , spline0=0.6000000012410739 , a0=0.0 , w0=0.0
2025-12-01 16:52:51,296 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2025-12-01 16:52:51,298 - INFO - integration_test - Dyn residual k=0: pred=[0.7199978542778892, 0.15386268161111435, 0.3199997822240611, 1.800000001010711, 0.780000001342145], ws=[0.7199978542778892, 0.15386268161111435, 0.3199997822240612, 1.800000001010711, 0.9928306763956032], res=[0.0, 0.0, -1.1102230246251565e-16, 0.0, -0.2128306750534582], res_norm=2.128e-01
2025-12-01 16:52:51,299 - INFO - integration_test - Dyn residual k=1: pred=[0.8908602419595698, 0.2104846253440936, 0.3199997822240612, 1.800000001010711, 1.1728306764966743], ws=[0.8908602419595698, 0.2104846253440936, 0.3199997822240612, 1.800000001010711, 1.3619893516852903], res=[0.0, 0.0, 0.0, 0.0, -0.18915867518861607], res_norm=1.892e-01
2025-12-01 16:52:51,300 - INFO - integration_test - Dyn residual k=2: pred=[1.0617226296412503, 0.2671065690770728, 0.3199997822240612, 1.800000001010711, 1.5419893517863614], ws=[1.0617226296412503, 0.26710656907707286, 0.3199997822240612, 1.800000001010711, 1.7641730777117626], res=[0.0, -5.551115123125783e-17, 0.0, 0.0, -0.22218372592540114], res_norm=2.222e-01
2025-12-01 16:52:51,322 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:51,345 - INFO - integration_test - Stage 0: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:51,370 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:51,390 - INFO - integration_test - Stage 1: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:51,413 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:51,430 - INFO - integration_test - Stage 2: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:51,456 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:51,481 - INFO - integration_test - Stage 3: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:51,502 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:51,518 - INFO - integration_test - Stage 4: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:51,537 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:51,552 - INFO - integration_test - Stage 5: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:51,571 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:51,586 - INFO - integration_test - Stage 6: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:51,603 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:51,619 - INFO - integration_test - Stage 7: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:51,639 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:51,653 - INFO - integration_test - Stage 8: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:51,671 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:51,686 - INFO - integration_test - Stage 9: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:51,704 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:51,717 - INFO - integration_test - Stage 10: constraints count=2 (linearized=0, contouring=2, other=0)
2025-12-01 16:52:52,005 - INFO - integration_test - Step 4: MPC solve successful
2025-12-01 16:52:52,016 - INFO - integration_test - Step 4: Computed 10 numeric contouring constraints for visualization (s=0.600)
2025-12-01 16:52:52,016 - DEBUG - integration_test - Step 4: Captured 10 contouring constraint halfspaces for visualization
2025-12-01 16:52:52,017 - INFO - integration_test - === Applying control at step 4 ===
2025-12-01 16:52:52,017 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000184427447, 'w': 0.7999999344479446}
2025-12-01 16:52:52,017 - INFO - integration_test -   Expected input names: ['a', 'w']
2025-12-01 16:52:52,017 - INFO - integration_test -   Planner output success: True
2025-12-01 16:52:52,018 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2025-12-01 16:52:52,018 - INFO - integration_test - Step 4 completed in 0.757s
2025-12-01 16:52:52,049 - INFO - integration_test - Step 5 (contouring until path end)
2025-12-01 16:52:52,049 - DEBUG - integration_test - Syncing planner state at step 5: vehicle_state=[0.72686151 0.16427971 0.39999978 2.         0.8       ]
2025-12-01 16:52:52,050 - DEBUG - integration_test - Step 5: Using propagated spline 0.8000 (close to path, dist=0.375m)
2025-12-01 16:52:52,050 - DEBUG - integration_test -   Set spline state to 0.8000
2025-12-01 16:52:52,051 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2025-12-01 16:52:52,052 - DEBUG - integration_test - Error updating modules: 'x'
2025-12-01 16:52:52,070 - DEBUG - integration_test - Step 5: Checking path alignment: vehicle=(0.727, 0.164), path_start=(0.000, 0.000), dist=0.745m
2025-12-01 16:52:52,071 - WARNING - integration_test - Could not update reference path at step 5: x and y must have the same length
2025-12-01 16:52:52,071 - INFO - integration_test - === Calling planner.solve_mpc() at step 5 ===
2025-12-01 16:52:52,074 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2025-12-01 16:52:52,076 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['contouring_constraints', 'linearized_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2025-12-01 16:52:52,076 - INFO - integration_test - Warmstart k=0: x0=0.7268615082825509 , y0=0.164279709763378 , psi0=0.3999997756688556 , v0=2.0000000028549856 , spline0=0.8000000015265725 , a0=0.0 , w0=0.0
2025-12-01 16:52:52,076 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2025-12-01 16:52:52,078 - INFO - integration_test - Dyn residual k=0: pred=[0.9110737248178173, 0.24216333701175108, 0.3999997756688556, 2.0000000028549856, 1.000000001812071], ws=[0.9110737248178173, 0.24216333701175108, 0.3999997756688556, 2.0000000028549856, 1.2100959685907717], res=[0.0, 0.0, 0.0, 0.0, -0.2100959667787008], res_norm=2.101e-01
2025-12-01 16:52:52,079 - INFO - integration_test - Dyn residual k=1: pred=[1.0952859413530838, 0.32004696426012413, 0.3999997756688556, 2.0000000028549856, 1.4100959688762704], ws=[1.0952859413530838, 0.32004696426012413, 0.3999997756688556, 2.0000000028549856, 1.6563639883698644], res=[0.0, 0.0, 0.0, 0.0, -0.246268019493594], res_norm=2.463e-01
2025-12-01 16:52:52,080 - INFO - integration_test - Dyn residual k=2: pred=[1.2794981578883502, 0.3979305915084972, 0.3999997756688556, 2.0000000028549856, 1.856363988655363], ws=[1.2794981578883502, 0.3979305915084972, 0.3999997756688556, 2.0000000028549856, 2.0825433322068494], res=[0.0, 0.0, 0.0, 0.0, -0.2261793435514865], res_norm=2.262e-01
2025-12-01 16:52:52,099 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:52,115 - INFO - integration_test - Stage 0: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:52,134 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:52,148 - INFO - integration_test - Stage 1: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:52,167 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:52,181 - INFO - integration_test - Stage 2: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:52,198 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:52,212 - INFO - integration_test - Stage 3: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:52,230 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:52,245 - INFO - integration_test - Stage 4: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:52,263 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:52,278 - INFO - integration_test - Stage 5: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:52,296 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:52,311 - INFO - integration_test - Stage 6: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:52,329 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:52,343 - INFO - integration_test - Stage 7: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:52,361 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:52,377 - INFO - integration_test - Stage 8: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:52,396 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:52,412 - INFO - integration_test - Stage 9: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:52,430 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:52,442 - INFO - integration_test - Stage 10: constraints count=2 (linearized=0, contouring=2, other=0)
2025-12-01 16:52:52,792 - INFO - integration_test - Step 5: MPC solve successful
2025-12-01 16:52:52,801 - INFO - integration_test - Step 5: Computed 10 numeric contouring constraints for visualization (s=0.800)
2025-12-01 16:52:52,801 - DEBUG - integration_test - Step 5: Captured 10 contouring constraint halfspaces for visualization
2025-12-01 16:52:52,801 - INFO - integration_test - === Applying control at step 5 ===
2025-12-01 16:52:52,801 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000038715795, 'w': 0.7999989130443688}
2025-12-01 16:52:52,801 - INFO - integration_test -   Expected input names: ['a', 'w']
2025-12-01 16:52:52,801 - INFO - integration_test -   Planner output success: True
2025-12-01 16:52:52,802 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2025-12-01 16:52:52,803 - INFO - integration_test - Step 5 completed in 0.754s
2025-12-01 16:52:52,828 - INFO - integration_test - Step 6 (contouring until path end)
2025-12-01 16:52:52,829 - DEBUG - integration_test - Syncing planner state at step 6: vehicle_state=[0.91675195 0.2538237  0.47999967 2.2        1.02      ]
2025-12-01 16:52:52,829 - DEBUG - integration_test - Step 6: Using propagated spline 1.0200 (close to path, dist=0.373m)
2025-12-01 16:52:52,829 - DEBUG - integration_test -   Set spline state to 1.0200
2025-12-01 16:52:52,831 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2025-12-01 16:52:52,831 - DEBUG - integration_test - Error updating modules: 'x'
2025-12-01 16:52:52,847 - DEBUG - integration_test - Step 6: Checking path alignment: vehicle=(0.917, 0.254), path_start=(0.000, 0.000), dist=0.951m
2025-12-01 16:52:52,848 - WARNING - integration_test - Could not update reference path at step 6: x and y must have the same length
2025-12-01 16:52:52,848 - INFO - integration_test - === Calling planner.solve_mpc() at step 6 ===
2025-12-01 16:52:52,851 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2025-12-01 16:52:52,852 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['contouring_constraints', 'linearized_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2025-12-01 16:52:52,852 - INFO - integration_test - Warmstart k=0: x0=0.9167519468797583 , y0=0.25382369649870967 , psi0=0.47999966697329244 , v0=2.2000000032421436 , spline0=1.0200000018507869 , a0=0.0 , w0=0.0
2025-12-01 16:52:52,852 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2025-12-01 16:52:52,853 - INFO - integration_test - Dyn residual k=0: pred=[1.1118908640114222, 0.3554150502810859, 0.47999966697329244, 2.2000000032421436, 1.2400000021750013], ws=[1.1118908640114222, 0.3554150502810859, 0.47999966697329244, 2.2000000032421436, 1.5284219554446388], res=[0.0, 0.0, 0.0, 0.0, -0.2884219532696375], res_norm=2.884e-01
2025-12-01 16:52:52,854 - INFO - integration_test - Dyn residual k=1: pred=[1.3070297811430862, 0.4570064040634621, 0.47999966697329244, 2.2000000032421436, 1.7484219557688532], ws=[1.3070297811430862, 0.4570064040634621, 0.47999966697329244, 2.2000000032421436, 2.0213814253958224], res=[0.0, 0.0, 0.0, 0.0, -0.27295946962696926], res_norm=2.730e-01
2025-12-01 16:52:52,855 - INFO - integration_test - Dyn residual k=2: pred=[1.5021686982747502, 0.5585977578458383, 0.47999966697329244, 2.2000000032421436, 2.2413814257200366], ws=[1.5021686982747502, 0.5585977578458383, 0.47999966697329244, 2.2000000032421436, 2.557601241419283], res=[0.0, 0.0, 0.0, 0.0, -0.3162198156992462], res_norm=3.162e-01
2025-12-01 16:52:52,871 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:52,886 - INFO - integration_test - Stage 0: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:52,903 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:52,918 - INFO - integration_test - Stage 1: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:52,935 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:52,949 - INFO - integration_test - Stage 2: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:52,968 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:52,982 - INFO - integration_test - Stage 3: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:52,999 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:53,013 - INFO - integration_test - Stage 4: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:53,031 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:53,046 - INFO - integration_test - Stage 5: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:53,064 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:53,079 - INFO - integration_test - Stage 6: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:53,097 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:53,112 - INFO - integration_test - Stage 7: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:53,130 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:53,145 - INFO - integration_test - Stage 8: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:53,164 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:53,178 - INFO - integration_test - Stage 9: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:53,195 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:53,208 - INFO - integration_test - Stage 10: constraints count=2 (linearized=0, contouring=2, other=0)
2025-12-01 16:52:53,503 - INFO - integration_test - Step 6: MPC solve successful
2025-12-01 16:52:53,512 - INFO - integration_test - Step 6: Computed 10 numeric contouring constraints for visualization (s=1.020)
2025-12-01 16:52:53,512 - DEBUG - integration_test - Step 6: Captured 10 contouring constraint halfspaces for visualization
2025-12-01 16:52:53,512 - INFO - integration_test - === Applying control at step 6 ===
2025-12-01 16:52:53,512 - INFO - integration_test -   Control dict from planner: {'a': 2.000000012860401, 'w': 0.7999993947948845}
2025-12-01 16:52:53,513 - INFO - integration_test -   Expected input names: ['a', 'w']
2025-12-01 16:52:53,513 - INFO - integration_test -   Planner output success: True
2025-12-01 16:52:53,514 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2025-12-01 16:52:53,514 - INFO - integration_test - Step 6 completed in 0.686s
2025-12-01 16:52:53,538 - INFO - integration_test - Step 7 (contouring until path end)
2025-12-01 16:52:53,538 - DEBUG - integration_test - Syncing planner state at step 7: vehicle_state=[1.11623095 0.36819126 0.55999961 2.4        1.26      ]
2025-12-01 16:52:53,538 - DEBUG - integration_test - Step 7: Using propagated spline 1.2600 (close to path, dist=0.475m)
2025-12-01 16:52:53,538 - DEBUG - integration_test -   Set spline state to 1.2600
2025-12-01 16:52:53,540 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2025-12-01 16:52:53,540 - DEBUG - integration_test - Error updating modules: 'x'
2025-12-01 16:52:53,555 - DEBUG - integration_test - Step 7: Checking path alignment: vehicle=(1.116, 0.368), path_start=(0.000, 0.000), dist=1.175m
2025-12-01 16:52:53,555 - WARNING - integration_test - Could not update reference path at step 7: x and y must have the same length
2025-12-01 16:52:53,555 - INFO - integration_test - === Calling planner.solve_mpc() at step 7 ===
2025-12-01 16:52:53,558 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2025-12-01 16:52:53,559 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['contouring_constraints', 'linearized_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2025-12-01 16:52:53,559 - INFO - integration_test - Warmstart k=0: x0=1.1162309480549364 , y0=0.3681912630056969 , psi0=0.5599996064527809 , v0=2.4000000045281835 , spline0=1.2600000023036053 , a0=0.0 , w0=0.0
2025-12-01 16:52:53,559 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2025-12-01 16:52:53,560 - INFO - integration_test - Dyn residual k=0: pred=[1.3195722252530375, 0.49567587072285546, 0.5599996064527809, 2.4000000045281835, 1.5000000027564238], ws=[1.3195722252530375, 0.49567587072285546, 0.5599996064527808, 2.4000000045281835, 1.8738630782016763], res=[0.0, 0.0, 1.1102230246251565e-16, 0.0, -0.37386307544525255], res_norm=3.739e-01
2025-12-01 16:52:53,561 - INFO - integration_test - Dyn residual k=1: pred=[1.5229135024511387, 0.623160478440014, 0.5599996064527808, 2.4000000045281835, 2.1138630786544947], ws=[1.5229135024511387, 0.623160478440014, 0.5599996064527808, 2.4000000045281835, 2.481385931396531], res=[0.0, 0.0, 0.0, 0.0, -0.3675228527420362], res_norm=3.675e-01
2025-12-01 16:52:53,562 - INFO - integration_test - Dyn residual k=2: pred=[1.7262547796492398, 0.7506450861571725, 0.5599996064527808, 2.4000000045281835, 2.7213859318493494], ws=[1.7262547796492398, 0.7506450861571725, 0.5599996064527808, 2.4000000045281835, 3.0823015461482974], res=[0.0, 0.0, 0.0, 0.0, -0.36091561429894803], res_norm=3.609e-01
2025-12-01 16:52:53,577 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:53,590 - INFO - integration_test - Stage 0: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:53,606 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:53,620 - INFO - integration_test - Stage 1: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:53,640 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:53,656 - INFO - integration_test - Stage 2: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:53,676 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:53,693 - INFO - integration_test - Stage 3: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:53,712 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:53,727 - INFO - integration_test - Stage 4: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:53,745 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:53,760 - INFO - integration_test - Stage 5: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:53,778 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:53,792 - INFO - integration_test - Stage 6: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:53,810 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:53,824 - INFO - integration_test - Stage 7: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:53,842 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:53,856 - INFO - integration_test - Stage 8: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:53,922 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:53,936 - INFO - integration_test - Stage 9: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:53,953 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:53,965 - INFO - integration_test - Stage 10: constraints count=2 (linearized=0, contouring=2, other=0)
2025-12-01 16:52:54,303 - INFO - integration_test - Step 7: MPC solve successful
2025-12-01 16:52:54,312 - INFO - integration_test - Step 7: Computed 10 numeric contouring constraints for visualization (s=1.260)
2025-12-01 16:52:54,312 - DEBUG - integration_test - Step 7: Captured 10 contouring constraint halfspaces for visualization
2025-12-01 16:52:54,312 - INFO - integration_test - === Applying control at step 7 ===
2025-12-01 16:52:54,312 - INFO - integration_test -   Control dict from planner: {'a': 2.000000019998499, 'w': 0.8000000097843729}
2025-12-01 16:52:54,312 - INFO - integration_test -   Expected input names: ['a', 'w']
2025-12-01 16:52:54,312 - INFO - integration_test -   Planner output success: True
2025-12-01 16:52:54,313 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2025-12-01 16:52:54,314 - INFO - integration_test - Step 7 completed in 0.776s
2025-12-01 16:52:54,335 - INFO - integration_test - Step 8 (contouring until path end)
2025-12-01 16:52:54,335 - DEBUG - integration_test - Syncing planner state at step 8: vehicle_state=[1.32243463 0.50942418 0.63999961 2.60000001 1.52      ]
2025-12-01 16:52:54,335 - DEBUG - integration_test - Step 8: Using propagated spline 1.5200 (close to path, dist=0.429m)
2025-12-01 16:52:54,335 - DEBUG - integration_test -   Set spline state to 1.5200
2025-12-01 16:52:54,337 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2025-12-01 16:52:54,337 - DEBUG - integration_test - Error updating modules: 'x'
2025-12-01 16:52:54,351 - DEBUG - integration_test - Step 8: Checking path alignment: vehicle=(1.322, 0.509), path_start=(0.000, 0.000), dist=1.417m
2025-12-01 16:52:54,352 - WARNING - integration_test - Could not update reference path at step 8: x and y must have the same length
2025-12-01 16:52:54,352 - INFO - integration_test - === Calling planner.solve_mpc() at step 8 ===
2025-12-01 16:52:54,355 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2025-12-01 16:52:54,356 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['contouring_constraints', 'linearized_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2025-12-01 16:52:54,356 - INFO - integration_test - Warmstart k=0: x0=1.3224346271212633 , y0=0.5094241782109952 , psi0=0.6399996074312182 , v0=2.6000000065280333 , spline0=1.5200000029564087 , a0=0.0 , w0=0.0
2025-12-01 16:52:54,356 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2025-12-01 16:52:54,357 - INFO - integration_test - Dyn residual k=0: pred=[1.5309795856492487, 0.6646949114868399, 0.6399996074312182, 2.6000000065280333, 1.780000003609212], ws=[1.5309795856492487, 0.6646949114868399, 0.6399996074312182, 2.6000000065280333, 2.1722695111727943], res=[0.0, 0.0, 0.0, 0.0, -0.39226950756358225], res_norm=3.923e-01
2025-12-01 16:52:54,358 - INFO - integration_test - Dyn residual k=1: pred=[1.7395245441772342, 0.8199656447626846, 0.6399996074312182, 2.6000000065280333, 2.4322695118255977], ws=[1.7395245441772342, 0.8199656447626846, 0.6399996074312182, 2.6000000065280333, 2.8208115058338903], res=[0.0, 0.0, 0.0, 0.0, -0.3885419940082926], res_norm=3.885e-01
2025-12-01 16:52:54,358 - INFO - integration_test - Dyn residual k=2: pred=[1.9480695027052197, 0.9752363780385294, 0.6399996074312182, 2.6000000065280333, 3.0808115064866937], ws=[1.9480695027052197, 0.9752363780385294, 0.6399996074312182, 2.6000000065280333, 3.4656377198679955], res=[0.0, 0.0, 0.0, 0.0, -0.38482621338130185], res_norm=3.848e-01
2025-12-01 16:52:54,374 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:54,388 - INFO - integration_test - Stage 0: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:54,405 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:54,419 - INFO - integration_test - Stage 1: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:54,435 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:54,448 - INFO - integration_test - Stage 2: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:54,465 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:54,479 - INFO - integration_test - Stage 3: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:54,496 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:54,509 - INFO - integration_test - Stage 4: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:54,526 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:54,539 - INFO - integration_test - Stage 5: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:54,556 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:54,570 - INFO - integration_test - Stage 6: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:54,587 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:54,601 - INFO - integration_test - Stage 7: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:54,617 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:54,630 - INFO - integration_test - Stage 8: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:54,647 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:54,661 - INFO - integration_test - Stage 9: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:54,678 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:54,689 - INFO - integration_test - Stage 10: constraints count=2 (linearized=0, contouring=2, other=0)
2025-12-01 16:52:55,023 - INFO - integration_test - Step 8: MPC solve successful
2025-12-01 16:52:55,032 - INFO - integration_test - Step 8: Computed 10 numeric contouring constraints for visualization (s=1.520)
2025-12-01 16:52:55,033 - DEBUG - integration_test - Step 8: Captured 10 contouring constraint halfspaces for visualization
2025-12-01 16:52:55,033 - INFO - integration_test - === Applying control at step 8 ===
2025-12-01 16:52:55,033 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000198300505, 'w': 0.7999999830568058}
2025-12-01 16:52:55,033 - INFO - integration_test -   Expected input names: ['a', 'w']
2025-12-01 16:52:55,033 - INFO - integration_test -   Planner output success: True
2025-12-01 16:52:55,034 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2025-12-01 16:52:55,034 - INFO - integration_test - Step 8 completed in 0.700s
2025-12-01 16:52:55,059 - INFO - integration_test - Step 9 (contouring until path end)
2025-12-01 16:52:55,060 - DEBUG - integration_test - Syncing planner state at step 9: vehicle_state=[1.53223953 0.67925659 0.71999961 2.80000001 1.8       ]
2025-12-01 16:52:55,060 - DEBUG - integration_test - Step 9: Using propagated spline 1.8000 (close to path, dist=0.464m)
2025-12-01 16:52:55,060 - DEBUG - integration_test -   Set spline state to 1.8000
2025-12-01 16:52:55,062 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2025-12-01 16:52:55,062 - DEBUG - integration_test - Error updating modules: 'x'
2025-12-01 16:52:55,077 - DEBUG - integration_test - Step 9: Checking path alignment: vehicle=(1.532, 0.679), path_start=(0.000, 0.000), dist=1.676m
2025-12-01 16:52:55,077 - WARNING - integration_test - Could not update reference path at step 9: x and y must have the same length
2025-12-01 16:52:55,077 - INFO - integration_test - === Calling planner.solve_mpc() at step 9 ===
2025-12-01 16:52:55,081 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2025-12-01 16:52:55,082 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['contouring_constraints', 'linearized_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2025-12-01 16:52:55,082 - INFO - integration_test - Warmstart k=0: x0=1.532239534100644 , y0=0.6792565942848913 , psi0=0.7199996057368988 , v0=2.8000000085110384 , spline0=1.8000000038075126 , a0=0.0 , w0=0.0
2025-12-01 16:52:55,082 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2025-12-01 16:52:55,083 - INFO - integration_test - Dyn residual k=0: pred=[1.742745211691836, 0.8638842200035017, 0.7199996057368988, 2.8000000085110384, 2.0800000046586162], ws=[1.742745211691836, 0.8638842200035017, 0.7199996057368989, 2.8000000085110384, 2.5726637907156626], res=[0.0, 0.0, -1.1102230246251565e-16, 0.0, -0.4926637860570464], res_norm=4.927e-01
2025-12-01 16:52:55,084 - INFO - integration_test - Dyn residual k=1: pred=[1.953250889283028, 1.048511845722112, 0.7199996057368989, 2.8000000085110384, 2.8526637915667665], ws=[1.953250889283028, 1.048511845722112, 0.7199996057368989, 2.8000000085110384, 3.3533832772460173], res=[0.0, 0.0, 0.0, 0.0, -0.5007194856792507], res_norm=5.007e-01
2025-12-01 16:52:55,085 - INFO - integration_test - Dyn residual k=2: pred=[2.16375656687422, 1.2331394714407224, 0.7199996057368989, 2.8000000085110384, 3.633383278097121], ws=[2.16375656687422, 1.2331394714407224, 0.7199996057368989, 2.8000000085110384, 4.144520098745712], res=[0.0, 0.0, 0.0, 0.0, -0.5111368206485909], res_norm=5.111e-01
2025-12-01 16:52:55,100 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:55,114 - INFO - integration_test - Stage 0: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:55,131 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:55,145 - INFO - integration_test - Stage 1: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:55,161 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:55,175 - INFO - integration_test - Stage 2: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:55,192 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:55,206 - INFO - integration_test - Stage 3: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:55,222 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:55,236 - INFO - integration_test - Stage 4: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:55,253 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:55,266 - INFO - integration_test - Stage 5: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:55,283 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:55,296 - INFO - integration_test - Stage 6: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:55,312 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:55,325 - INFO - integration_test - Stage 7: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:55,341 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:55,355 - INFO - integration_test - Stage 8: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:55,372 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:55,385 - INFO - integration_test - Stage 9: constraints count=4 (linearized=2, contouring=2, other=0)
2025-12-01 16:52:55,402 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2025-12-01 16:52:55,413 - INFO - integration_test - Stage 10: constraints count=2 (linearized=0, contouring=2, other=0)
2025-12-01 16:52:55,758 - INFO - integration_test - Step 9: MPC solve successful
2025-12-01 16:52:55,766 - INFO - integration_test - Step 9: Computed 10 numeric contouring constraints for visualization (s=1.800)
2025-12-01 16:52:55,767 - DEBUG - integration_test - Step 9: Captured 10 contouring constraint halfspaces for visualization
2025-12-01 16:52:55,767 - INFO - integration_test - === Applying control at step 9 ===
2025-12-01 16:52:55,767 - INFO - integration_test -   Control dict from planner: {'a': 2.000000019998955, 'w': 0.8000000097707457}
2025-12-01 16:52:55,767 - INFO - integration_test -   Expected input names: ['a', 'w']
2025-12-01 16:52:55,767 - INFO - integration_test -   Planner output success: True
2025-12-01 16:52:55,768 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2025-12-01 16:52:55,768 - INFO - integration_test - Step 9 completed in 0.709s
2025-12-01 16:52:55,791 - INFO - integration_test - Step 10 (contouring until path end)
2025-12-01 16:52:55,791 - DEBUG - integration_test - Syncing planner state at step 10: vehicle_state=[1.74229418 0.87908708 0.79999961 3.00000001 2.1       ]
2025-12-01 16:52:55,792 - DEBUG - integration_test - Step 10: Using propagated spline 2.1000 (close to path, dist=0.397m)
2025-12-01 16:52:55,792 - DEBUG - integration_test -   Set spline state to 2.1000
2025-12-01 16:52:55,794 - ERROR - integration_test - Test failed: cannot access local variable 'bounced' where it is not associated with a value
2025-12-01 16:52:55,796 - ERROR - integration_test - Traceback: Traceback (most recent call last):
  File "/home/stephen/PyMPC/test/integration/constraints/contouring/../../../../test/integration/integration_test_framework.py", line 1066, in run_test
    self.obstacle_manager.update_obstacle_states(
  File "/home/stephen/PyMPC/test/integration/constraints/contouring/../../../../planning/obstacle_manager.py", line 1150, in update_obstacle_states
    if self.obstacle_heading_change_times[i] <= 0 and not bounced:
                                                          ^^^^^^^
UnboundLocalError: cannot access local variable 'bounced' where it is not associated with a value

