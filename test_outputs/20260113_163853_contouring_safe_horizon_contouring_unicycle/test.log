2026-01-13 16:38:53,914 - INFO - integration_test - Contouring objective detected: automatically switching to contouring-aware dynamics model
2026-01-13 16:38:53,914 - INFO - integration_test -   Converted 'unicycle' -> 'contouring_unicycle'
2026-01-13 16:38:53,914 - INFO - integration_test - Created vehicle dynamics model: ContouringSecondOrderUnicycleModel
2026-01-13 16:38:53,914 - INFO - integration_test - ✓ Validation passed: Contouring objective with dynamics model that has 'spline' state
2026-01-13 16:38:53,914 - INFO - integration_test - Creating objective module: contouring
2026-01-13 16:38:53,919 - INFO - integration_test - Objective module 'contouring' created: contouring_objective
2026-01-13 16:38:53,919 - INFO - integration_test - Creating 2 constraint module(s): ['safe_horizon', 'contouring']
2026-01-13 16:38:53,919 - DEBUG - integration_test - Creating constraint module: safe_horizon
2026-01-13 16:38:53,939 - INFO - integration_test - Constraint module 'safe_horizon' created: safe_horizon_constraint
2026-01-13 16:38:53,939 - DEBUG - integration_test - Creating constraint module: contouring
2026-01-13 16:38:53,943 - INFO - integration_test - Constraint module 'contouring' created: contouring_constraints
2026-01-13 16:38:53,943 - INFO - integration_test - Created 2 constraint module(s)
2026-01-13 16:38:53,943 - INFO - integration_test - Safe Horizon diagnostics enabled for this test, output folder: test_outputs/20260113_163853_contouring_safe_horizon_contouring_unicycle
2026-01-13 16:38:53,957 - INFO - integration_test - Setting solver on all modules...
2026-01-13 16:38:53,957 - WARNING - integration_test -   Module safe_horizon_constraint has no solver attribute
2026-01-13 16:38:53,957 - DEBUG - integration_test -   Set solver on module: contouring_constraints
2026-01-13 16:38:53,957 - DEBUG - integration_test -   Set solver on module: control_effort_objective
2026-01-13 16:38:53,957 - DEBUG - integration_test -   Set solver on module: control_jerk_objective
2026-01-13 16:38:53,957 - DEBUG - integration_test -   Set solver on module: path_reference_velocity_objective
2026-01-13 16:38:53,957 - DEBUG - integration_test -   Set solver on module: contouring_objective
2026-01-13 16:38:53,959 - WARNING - integration_test - Error shaping obstacles: name 'get_dummy_obstacle' is not defined
2026-01-13 16:38:53,959 - WARNING - integration_test - Error in on_data_received: 'Planner' object has no attribute 'on_data_received'
2026-01-13 16:38:53,960 - INFO - integration_test - Initial vehicle state (before spline): [0. 0. 0. 1.]
2026-01-13 16:38:53,960 - INFO - integration_test - Vehicle starting position: (0.00, 0.00)
2026-01-13 16:38:53,960 - INFO - integration_test - Reference path start: (0.00, 0.00)
2026-01-13 16:38:53,960 - INFO - integration_test - Reference path starts at vehicle position (requirement satisfied)
2026-01-13 16:38:53,960 - INFO - integration_test - Contouring-aware dynamics detected: initializing spline variable
2026-01-13 16:38:53,960 - INFO - integration_test - Initialized spline to closest path point: s=0.0000 (vehicle at (0.00, 0.00), closest path point at (0.00, 0.00), distance=0.000m)
2026-01-13 16:38:53,960 - INFO - integration_test - Added spline variable: 0.0000
2026-01-13 16:38:53,961 - INFO - integration_test - Final initial state: [0. 0. 0. 1. 0.] (variables: ['x', 'y', 'psi', 'v', 'spline'])
2026-01-13 16:38:53,961 - INFO - integration_test - Step 0 (contouring until path end)
2026-01-13 16:38:53,961 - DEBUG - integration_test - Syncing planner state at step 0: vehicle_state=[0. 0. 0. 1. 0.]
2026-01-13 16:38:53,961 - DEBUG - integration_test - Step 0: Using propagated spline 0.0000 (close to path, dist=0.000m, drift=0.000m)
2026-01-13 16:38:53,961 - DEBUG - integration_test -   Set spline state to 0.0000
2026-01-13 16:38:53,962 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:38:53,978 - DEBUG - integration_test - Step 0: Checking path alignment: vehicle=(0.000, 0.000), path_start=(0.000, 0.000), dist=0.000m
2026-01-13 16:38:53,978 - INFO - integration_test - === Calling planner.solve_mpc() at step 0 ===
2026-01-13 16:38:53,982 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:38:53,993 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:38:53,993 - INFO - integration_test - Warmstart k=0: x0=0.0 , y0=0.0 , psi0=0.0 , v0=1.0 , spline0=0.0 , a0=0.0 , w0=0.0
2026-01-13 16:38:53,993 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:38:53,994 - INFO - integration_test - Dyn residual k=0: pred=[0.1, 0.0, 0.0, 1.0, 0.1], ws=[0.1, 0.0, 0.0, 1.0, 0.051515151515151514], res=[0.0, 0.0, 0.0, 0.0, 0.04848484848484849], res_norm=4.848e-02
2026-01-13 16:38:53,995 - INFO - integration_test - Dyn residual k=1: pred=[0.2, 0.0, 0.0, 1.0, 0.15151515151515152], ws=[0.2, 0.0, 0.0, 1.0, 0.10530806991582416], res=[0.0, 0.0, 0.0, 0.0, 0.04620708159932736], res_norm=4.621e-02
2026-01-13 16:38:53,997 - INFO - integration_test - Dyn residual k=2: pred=[0.30000000000000004, 0.0, 0.0, 1.0, 0.20530806991582418], ws=[0.30000000000000004, 0.0, 0.0, 1.0, 0.16177874499601194], res=[0.0, 0.0, 0.0, 0.0, 0.043529324919812235], res_norm=4.353e-02
2026-01-13 16:38:54,010 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:54,079 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:54,093 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:54,104 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:54,119 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:54,130 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:54,144 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:54,155 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:54,169 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:54,180 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:54,194 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:54,204 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:54,219 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:54,230 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:54,245 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:54,256 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:54,270 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:54,281 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:54,295 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:54,305 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:38:54,317 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:54,327 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:38:56,413 - INFO - integration_test - Step 0: MPC solve successful
2026-01-13 16:38:56,613 - INFO - integration_test - Step 0: Computed 6 numeric contouring constraints for visualization (s=0.000)
2026-01-13 16:38:56,613 - DEBUG - integration_test - Step 0: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:38:56,613 - DEBUG - integration_test - Linearized constraints module not found at step 0
2026-01-13 16:38:56,613 - INFO - integration_test - === Applying control at step 0 ===
2026-01-13 16:38:56,613 - INFO - integration_test -   Control dict from planner: {'a': 2.000000019711105, 'w': 0.8000000048543567}
2026-01-13 16:38:56,614 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:38:56,614 - INFO - integration_test -   Planner output success: True
2026-01-13 16:38:56,615 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:38:56,615 - INFO - integration_test - Step 0 completed in 2.654s
2026-01-13 16:38:56,628 - INFO - integration_test - Step 1 (contouring until path end)
2026-01-13 16:38:56,628 - DEBUG - integration_test - Syncing planner state at step 1: vehicle_state=[0.10987738 0.00453085 0.08       1.2        0.12      ]
2026-01-13 16:38:56,628 - DEBUG - integration_test - Step 1: Using propagated spline 0.1200 (close to path, dist=0.110m, drift=0.120m)
2026-01-13 16:38:56,629 - DEBUG - integration_test -   Set spline state to 0.1200
2026-01-13 16:38:56,629 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:38:56,692 - DEBUG - integration_test - Step 1: Checking path alignment: vehicle=(0.110, 0.005), path_start=(0.000, 0.000), dist=0.110m
2026-01-13 16:38:56,692 - INFO - integration_test - === Calling planner.solve_mpc() at step 1 ===
2026-01-13 16:38:56,744 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:38:56,753 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:38:56,753 - INFO - integration_test - Warmstart k=0: x0=0.10987737537810102 , y0=0.004530845085785483 , psi0=0.08000000048543568 , v0=1.2000000019711106 , spline0=0.051717171719162736 , a0=0.0 , w0=0.0
2026-01-13 16:38:56,753 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:38:56,754 - INFO - integration_test - Dyn residual k=0: pred=[0.2294935803262408, 0.01412060843590425, 0.08000000048543568, 1.2000000019711106, 0.17171717191627378], ws=[0.22949358032624076, 0.01412060843590425, 0.08000000048543576, 1.2000000019711106, 0.10627058848982827], res=[2.7755575615628914e-17, 0.0, -8.326672684688674e-17, 0.0, 0.0654465834264455], res_norm=6.545e-02
2026-01-13 16:38:56,755 - INFO - integration_test - Dyn residual k=1: pred=[0.3491097852743805, 0.023710371786023025, 0.08000000048543576, 1.2000000019711106, 0.22627058868693933], ws=[0.3491097852743805, 0.023710371786023025, 0.08000000048543576, 1.2000000019711106, 0.218854356110647], res=[0.0, 0.0, 0.0, 0.0, 0.007416232576292342], res_norm=7.416e-03
2026-01-13 16:38:56,755 - INFO - integration_test - Dyn residual k=2: pred=[0.46872599022252026, 0.0333001351361418, 0.08000000048543576, 1.2000000019711106, 0.33885435630775806], ws=[0.46872599022252026, 0.0333001351361418, 0.08000000048543576, 1.2000000019711106, 0.28229509891789173], res=[0.0, 0.0, 0.0, 0.0, 0.056559257389866335], res_norm=5.656e-02
2026-01-13 16:38:56,769 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:56,837 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:56,851 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:56,863 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:56,878 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:56,889 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:56,904 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:56,915 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:56,929 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:56,941 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:56,955 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:56,966 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:56,981 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:56,992 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:57,006 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:57,018 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:57,033 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:57,045 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:57,059 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:57,069 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:38:57,082 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:57,092 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:38:57,208 - INFO - integration_test - Step 1: MPC solve successful
2026-01-13 16:38:57,248 - INFO - integration_test - Step 1: Computed 6 numeric contouring constraints for visualization (s=0.120)
2026-01-13 16:38:57,249 - DEBUG - integration_test - Step 1: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:38:57,249 - INFO - integration_test - === Applying control at step 1 ===
2026-01-13 16:38:57,249 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000191731586, 'w': 0.7999999951065971}
2026-01-13 16:38:57,249 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:38:57,249 - INFO - integration_test -   Planner output success: True
2026-01-13 16:38:57,250 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:38:57,250 - INFO - integration_test - Step 1 completed in 0.622s
2026-01-13 16:38:57,262 - INFO - integration_test - Step 2 (contouring until path end)
2026-01-13 16:38:57,263 - DEBUG - integration_test - Syncing planner state at step 2: vehicle_state=[0.23889213 0.02022162 0.16       1.4        0.26      ]
2026-01-13 16:38:57,263 - DEBUG - integration_test - Step 2: Using propagated spline 0.2600 (close to path, dist=0.240m, drift=0.260m)
2026-01-13 16:38:57,263 - DEBUG - integration_test -   Set spline state to 0.2600
2026-01-13 16:38:57,264 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:38:57,328 - DEBUG - integration_test - Step 2: Checking path alignment: vehicle=(0.239, 0.020), path_start=(0.000, 0.000), dist=0.240m
2026-01-13 16:38:57,328 - INFO - integration_test - === Calling planner.solve_mpc() at step 2 ===
2026-01-13 16:38:57,381 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:38:57,390 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:38:57,390 - INFO - integration_test - Warmstart k=0: x0=0.23889212817763322 , y0=0.020221621817843927 , psi0=0.15999999999609538 , v0=1.4000000038884264 , spline0=0.15939393941169555 , a0=0.0 , w0=0.0
2026-01-13 16:38:57,390 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:38:57,391 - INFO - integration_test - Dyn residual k=0: pred=[0.37710394823418414, 0.042526170805248405, 0.15999999999609538, 1.4000000038884264, 0.2993939398005382], ws=[0.37710394823418414, 0.04252617080524841, 0.15999999999609527, 1.4000000038884264, 0.21989439507250172], res=[0.0, -6.938893903907228e-18, 1.1102230246251565e-16, 0.0, 0.07949954472803647], res_norm=7.950e-02
2026-01-13 16:38:57,392 - INFO - integration_test - Dyn residual k=1: pred=[0.515315768290735, 0.06483071979265288, 0.15999999999609527, 1.4000000038884264, 0.3598943954613444], ws=[0.5153157682907351, 0.06483071979265288, 0.15999999999609527, 1.4000000038884264, 0.2850309020833125], res=[-1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.07486349337803189], res_norm=7.486e-02
2026-01-13 16:38:57,393 - INFO - integration_test - Dyn residual k=2: pred=[0.653527588347286, 0.08713526878005735, 0.15999999999609527, 1.4000000038884264, 0.42503090247215514], ws=[0.6535275883472861, 0.08713526878005735, 0.15999999999609527, 1.4000000038884264, 0.41466969078774857], res=[-1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.010361211684406568], res_norm=1.036e-02
2026-01-13 16:38:57,406 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:57,474 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:57,489 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:57,500 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:57,514 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:57,525 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:57,540 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:57,551 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:57,565 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:57,577 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:57,591 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:57,603 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:57,617 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:57,629 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:57,643 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:57,654 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:57,668 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:57,679 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:57,694 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:57,704 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:38:57,716 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:57,726 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:38:57,845 - INFO - integration_test - Step 2: MPC solve successful
2026-01-13 16:38:57,886 - INFO - integration_test - Step 2: Computed 6 numeric contouring constraints for visualization (s=0.260)
2026-01-13 16:38:57,886 - DEBUG - integration_test - Step 2: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:38:57,886 - INFO - integration_test - === Applying control at step 2 ===
2026-01-13 16:38:57,886 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000107567417, 'w': 0.7999997398133827}
2026-01-13 16:38:57,886 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:38:57,886 - INFO - integration_test -   Planner output success: True
2026-01-13 16:38:57,887 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:38:57,887 - INFO - integration_test - Step 2 completed in 0.624s
2026-01-13 16:38:57,900 - INFO - integration_test - Step 3 (contouring until path end)
2026-01-13 16:38:57,900 - DEBUG - integration_test - Syncing planner state at step 3: vehicle_state=[0.38583644 0.05014471 0.23999997 1.6        0.42      ]
2026-01-13 16:38:57,901 - DEBUG - integration_test - Step 3: Using propagated spline 0.4200 (close to path, dist=0.389m, drift=0.420m)
2026-01-13 16:38:57,901 - DEBUG - integration_test -   Set spline state to 0.4200
2026-01-13 16:38:57,901 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:38:57,965 - DEBUG - integration_test - Step 3: Checking path alignment: vehicle=(0.386, 0.050), path_start=(0.000, 0.000), dist=0.389m
2026-01-13 16:38:57,965 - INFO - integration_test - === Calling planner.solve_mpc() at step 3 ===
2026-01-13 16:38:58,016 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:38:58,025 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:38:58,025 - INFO - integration_test - Warmstart k=0: x0=0.3858364360936191 , y0=0.050144714562168985 , psi0=0.23999997397743364 , v0=1.6000000049641006 , spline0=0.21898989903363084 , a0=0.0 , w0=0.0
2026-01-13 16:38:58,025 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:38:58,027 - INFO - integration_test - Dyn residual k=0: pred=[0.541250513541827, 0.08817713086423537, 0.23999997397743364, 1.6000000049641006, 0.3789898995300409], ws=[0.541250513541827, 0.08817713086423537, 0.23999997397743345, 1.6000000049641006, 0.34216400929074753], res=[0.0, 0.0, 1.942890293094024e-16, 0.0, 0.03682589023929339], res_norm=3.683e-02
2026-01-13 16:38:58,027 - INFO - integration_test - Dyn residual k=1: pred=[0.6966645909900347, 0.12620954716630173, 0.23999997397743345, 1.6000000049641006, 0.5021640097871576], ws=[0.6966645909900347, 0.12620954716630173, 0.23999997397743345, 1.6000000049641006, 0.4166868338745445], res=[0.0, 0.0, 0.0, 0.0, 0.08547717591261306], res_norm=8.548e-02
2026-01-13 16:38:58,028 - INFO - integration_test - Dyn residual k=2: pred=[0.8520786684382425, 0.16424196346836806, 0.23999997397743345, 1.6000000049641006, 0.5766868343709546], ws=[0.8520786684382425, 0.16424196346836809, 0.23999997397743345, 1.6000000049641006, 0.7399794732241254], res=[0.0, -2.7755575615628914e-17, 0.0, 0.0, -0.1632926388531708], res_norm=1.633e-01
2026-01-13 16:38:58,042 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:58,109 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:58,124 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:58,136 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:58,151 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:58,162 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:58,176 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:58,187 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:58,201 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:58,212 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:58,227 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:58,239 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:58,253 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:58,264 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:58,278 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:58,289 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:58,304 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:58,315 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:58,329 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:58,339 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:38:58,352 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:58,362 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:38:58,489 - INFO - integration_test - Step 3: MPC solve successful
2026-01-13 16:38:58,532 - INFO - integration_test - Step 3: Computed 6 numeric contouring constraints for visualization (s=0.420)
2026-01-13 16:38:58,532 - DEBUG - integration_test - Step 3: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:38:58,532 - INFO - integration_test - === Applying control at step 3 ===
2026-01-13 16:38:58,532 - INFO - integration_test -   Control dict from planner: {'a': 2.000000019403434, 'w': 0.7999999940026659}
2026-01-13 16:38:58,532 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:38:58,532 - INFO - integration_test -   Planner output success: True
2026-01-13 16:38:58,533 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:38:58,533 - INFO - integration_test - Step 3 completed in 0.633s
2026-01-13 16:38:58,545 - INFO - integration_test - Step 4 (contouring until path end)
2026-01-13 16:38:58,546 - DEBUG - integration_test - Syncing planner state at step 4: vehicle_state=[0.54913546 0.09724075 0.31999997 1.80000001 0.6       ]
2026-01-13 16:38:58,547 - DEBUG - integration_test - Step 4: Using propagated spline 0.6000 (close to path, dist=0.455m, drift=0.006m)
2026-01-13 16:38:58,547 - DEBUG - integration_test -   Set spline state to 0.6000
2026-01-13 16:38:58,548 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:38:58,611 - DEBUG - integration_test - Step 4: Checking path alignment: vehicle=(0.549, 0.097), path_start=(0.000, 0.000), dist=0.558m
2026-01-13 16:38:58,612 - INFO - integration_test - === Calling planner.solve_mpc() at step 4 ===
2026-01-13 16:38:58,664 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:38:58,673 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:38:58,673 - INFO - integration_test - Warmstart k=0: x0=0.5491354627844522 , y0=0.09724075078863867 , psi0=0.31999997337770025 , v0=1.800000006904444 , spline0=0.3393939395013823 , a0=0.0 , w0=0.0
2026-01-13 16:38:58,673 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:38:58,674 - INFO - integration_test - Dyn residual k=0: pred=[0.7199978402020931, 0.15386272736798118, 0.31999997337770025, 1.800000006904444, 0.5193939401918267], ws=[0.7199978402020932, 0.15386272736798118, 0.31999997337770036, 1.800000006904444, 0.47435686255705006], res=[-1.1102230246251565e-16, 0.0, -1.1102230246251565e-16, 0.0, 0.04503707763477666], res_norm=4.504e-02
2026-01-13 16:38:58,675 - INFO - integration_test - Dyn residual k=1: pred=[0.8908602176197341, 0.21048470394732371, 0.31999997337770036, 1.800000006904444, 0.6543568632474945], ws=[0.8908602176197341, 0.21048470394732371, 0.31999997337770036, 1.800000006904444, 0.801829065176892], res=[0.0, 0.0, 0.0, 0.0, -0.14747220192939747], res_norm=1.475e-01
2026-01-13 16:38:58,676 - INFO - integration_test - Dyn residual k=2: pred=[1.061722595037375, 0.26710668052666625, 0.31999997337770036, 1.800000006904444, 0.9818290658673364], ws=[1.061722595037375, 0.26710668052666625, 0.31999997337770036, 1.800000006904444, 0.8999392959316947], res=[0.0, 0.0, 0.0, 0.0, 0.08188976993564168], res_norm=8.189e-02
2026-01-13 16:38:58,689 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:58,757 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:58,772 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:58,783 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:58,797 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:58,808 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:58,822 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:58,834 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:58,848 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:58,859 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:58,874 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:58,885 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:58,899 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:58,910 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:58,925 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:58,937 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:58,951 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:58,963 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:58,977 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:58,987 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:38:59,000 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:59,011 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:38:59,155 - INFO - integration_test - Step 4: MPC solve successful
2026-01-13 16:38:59,199 - INFO - integration_test - Step 4: Computed 6 numeric contouring constraints for visualization (s=0.600)
2026-01-13 16:38:59,199 - DEBUG - integration_test - Step 4: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:38:59,199 - INFO - integration_test - === Applying control at step 4 ===
2026-01-13 16:38:59,199 - INFO - integration_test -   Control dict from planner: {'a': 2.000000019941048, 'w': 0.8000000085174808}
2026-01-13 16:38:59,199 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:38:59,199 - INFO - integration_test -   Planner output success: True
2026-01-13 16:38:59,200 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:38:59,200 - INFO - integration_test - Step 4 completed in 0.654s
2026-01-13 16:38:59,213 - INFO - integration_test - Step 5 (contouring until path end)
2026-01-13 16:38:59,213 - DEBUG - integration_test - Syncing planner state at step 5: vehicle_state=[0.72686149 0.16427976 0.39999997 2.00000001 0.8       ]
2026-01-13 16:38:59,214 - DEBUG - integration_test - Step 5: Using propagated spline 0.8000 (close to path, dist=0.375m, drift=0.194m)
2026-01-13 16:38:59,214 - DEBUG - integration_test -   Set spline state to 0.8000
2026-01-13 16:38:59,215 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:38:59,279 - DEBUG - integration_test - Step 5: Checking path alignment: vehicle=(0.727, 0.164), path_start=(0.000, 0.000), dist=0.745m
2026-01-13 16:38:59,279 - INFO - integration_test - === Calling planner.solve_mpc() at step 5 ===
2026-01-13 16:38:59,330 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:38:59,340 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:38:59,340 - INFO - integration_test - Warmstart k=0: x0=0.7268614919530665 , y0=0.1642797575236018 , psi0=0.39999997422944833 , v0=2.0000000088985486 , spline0=0.46868686890203337 , a0=0.0 , w0=0.0
2026-01-13 16:38:59,340 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:38:59,341 - INFO - integration_test - Dyn residual k=0: pred=[0.9110736935803592, 0.24216342158460769, 0.39999997422944833, 2.0000000088985486, 0.6686868697918882], ws=[0.9110736935803592, 0.24216342158460769, 0.39999997422944844, 2.0000000088985486, 0.610324512387308], res=[0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.05836235740458018], res_norm=5.836e-02
2026-01-13 16:38:59,342 - INFO - integration_test - Dyn residual k=1: pred=[1.0952858952076518, 0.32004708564561357, 0.39999997422944844, 2.0000000088985486, 0.8103245132771628], ws=[1.0952858952076518, 0.32004708564561357, 0.39999997422944844, 2.0000000088985486, 0.9554815260533094], res=[0.0, 0.0, 0.0, 0.0, -0.14515701277614657], res_norm=1.452e-01
2026-01-13 16:38:59,342 - INFO - integration_test - Dyn residual k=2: pred=[1.2794980968349445, 0.39793074970661946, 0.39999997422944844, 2.0000000088985486, 1.1554815269431642], ws=[1.2794980968349445, 0.39793074970661946, 0.39999997422944844, 2.0000000088985486, 1.0655810511101096], res=[0.0, 0.0, 0.0, 0.0, 0.0899004758330546], res_norm=8.990e-02
2026-01-13 16:38:59,356 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:59,423 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:59,438 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:59,450 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:59,464 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:59,476 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:59,490 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:59,501 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:59,515 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:59,527 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:59,542 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:59,554 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:59,568 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:59,579 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:59,593 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:59,604 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:59,619 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:59,631 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:38:59,646 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:59,656 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:38:59,668 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:38:59,678 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:38:59,822 - INFO - integration_test - Step 5: MPC solve successful
2026-01-13 16:38:59,948 - INFO - integration_test - Step 5: Computed 6 numeric contouring constraints for visualization (s=0.800)
2026-01-13 16:38:59,949 - DEBUG - integration_test - Step 5: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:38:59,949 - INFO - integration_test - === Applying control at step 5 ===
2026-01-13 16:38:59,949 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000200012376, 'w': 0.8000000099874781}
2026-01-13 16:38:59,949 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:38:59,949 - INFO - integration_test -   Planner output success: True
2026-01-13 16:38:59,950 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:38:59,951 - INFO - integration_test - Step 5 completed in 0.737s
2026-01-13 16:38:59,963 - INFO - integration_test - Step 6 (contouring until path end)
2026-01-13 16:38:59,964 - DEBUG - integration_test - Syncing planner state at step 6: vehicle_state=[0.91675191 0.25382379 0.47999998 2.20000001 1.02      ]
2026-01-13 16:38:59,964 - DEBUG - integration_test - Step 6: Using propagated spline 1.0200 (close to path, dist=0.373m, drift=0.414m)
2026-01-13 16:38:59,965 - DEBUG - integration_test -   Set spline state to 1.0200
2026-01-13 16:38:59,965 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:00,032 - DEBUG - integration_test - Step 6: Checking path alignment: vehicle=(0.917, 0.254), path_start=(0.000, 0.000), dist=0.951m
2026-01-13 16:39:00,032 - INFO - integration_test - === Calling planner.solve_mpc() at step 6 ===
2026-01-13 16:39:00,083 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:00,092 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:00,093 - INFO - integration_test - Warmstart k=0: x0=0.9167519082615465 , y0=0.25382379277118733 , psi0=0.47999997522819615 , v0=2.2000000108986724 , spline0=0.6080808084598516 , a0=0.0 , w0=0.0
2026-01-13 16:39:00,093 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:00,094 - INFO - integration_test - Dyn residual k=0: pred=[1.1118907947562984, 0.35541520705964935, 0.47999997522819615, 2.2000000108986724, 0.8280808095497189], ws=[1.1118907947562984, 0.35541520705964935, 0.47999997522819626, 2.2000000108986724, 0.9559336013903501], res=[0.0, 0.0, -1.1102230246251565e-16, 0.0, -0.12785279184063125], res_norm=1.279e-01
2026-01-13 16:39:00,095 - INFO - integration_test - Dyn residual k=1: pred=[1.3070296812510502, 0.4570066213481114, 0.47999997522819626, 2.2000000108986724, 1.1759336024802174], ws=[1.3070296812510502, 0.45700662134811143, 0.47999997522819626, 2.2000000108986724, 1.1373145682668924], res=[0.0, -5.551115123125783e-17, 0.0, 0.0, 0.03861903421332502], res_norm=3.862e-02
2026-01-13 16:39:00,095 - INFO - integration_test - Dyn residual k=2: pred=[1.502168567745802, 0.5585980356365735, 0.47999997522819626, 2.2000000108986724, 1.3573145693567596], ws=[1.502168567745802, 0.5585980356365735, 0.47999997522819626, 2.2000000108986724, 1.4647139022885556], res=[0.0, 0.0, 0.0, 0.0, -0.10739933293179593], res_norm=1.074e-01
2026-01-13 16:39:00,109 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:00,178 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:00,192 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:00,204 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:00,219 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:00,231 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:00,246 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:00,257 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:00,271 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:00,282 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:00,296 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:00,308 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:00,322 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:00,334 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:00,348 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:00,359 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:00,374 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:00,386 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:00,400 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:00,410 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:00,423 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:00,433 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:00,580 - INFO - integration_test - Step 6: MPC solve successful
2026-01-13 16:39:00,626 - INFO - integration_test - Step 6: Computed 6 numeric contouring constraints for visualization (s=1.020)
2026-01-13 16:39:00,626 - DEBUG - integration_test - Step 6: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:00,626 - INFO - integration_test - === Applying control at step 6 ===
2026-01-13 16:39:00,626 - INFO - integration_test -   Control dict from planner: {'a': 2.000000019999701, 'w': 0.8000000099791642}
2026-01-13 16:39:00,626 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:00,626 - INFO - integration_test -   Planner output success: True
2026-01-13 16:39:00,627 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:00,628 - INFO - integration_test - Step 6 completed in 0.664s
2026-01-13 16:39:00,640 - INFO - integration_test - Step 7 (contouring until path end)
2026-01-13 16:39:00,641 - DEBUG - integration_test - Syncing planner state at step 7: vehicle_state=[1.11623087 0.36819143 0.55999998 2.40000001 1.26000001]
2026-01-13 16:39:00,641 - DEBUG - integration_test - Step 7: Using propagated spline 1.2600 (close to path, dist=0.475m, drift=0.654m)
2026-01-13 16:39:00,641 - DEBUG - integration_test -   Set spline state to 1.2600
2026-01-13 16:39:00,642 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:00,706 - DEBUG - integration_test - Step 7: Checking path alignment: vehicle=(1.116, 0.368), path_start=(0.000, 0.000), dist=1.175m
2026-01-13 16:39:00,706 - INFO - integration_test - === Calling planner.solve_mpc() at step 7 ===
2026-01-13 16:39:00,757 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:00,766 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:00,766 - INFO - integration_test - Warmstart k=0: x0=1.1162308712267552 , y0=0.3681914273448965 , psi0=0.5599999762261125 , v0=2.4000000128986425 , spline0=1.0117171725321041 , a0=0.0 , w0=0.0
2026-01-13 16:39:00,766 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:00,767 - INFO - integration_test - Dyn residual k=0: pred=[1.3195721019936257, 0.49567611069685513, 0.5599999762261125, 2.4000000128986425, 1.2517171738219683], ws=[1.3195721019936257, 0.49567611069685513, 0.5599999762261128, 2.4000000128986425, 1.1328713101513588], res=[0.0, 0.0, -2.220446049250313e-16, 0.0, 0.11884586367060956], res_norm=1.188e-01
2026-01-13 16:39:00,768 - INFO - integration_test - Dyn residual k=1: pred=[1.5229133327604962, 0.6231607940488137, 0.5599999762261128, 2.4000000128986425, 1.372871311441223], ws=[1.5229133327604962, 0.6231607940488137, 0.5599999762261128, 2.4000000128986425, 1.3250255386325263], res=[0.0, 0.0, 0.0, 0.0, 0.04784577280869673], res_norm=4.785e-02
2026-01-13 16:39:00,769 - INFO - integration_test - Dyn residual k=2: pred=[1.7262545635273667, 0.7506454774007724, 0.5599999762261128, 2.4000000128986425, 1.5650255399223905], ws=[1.7262545635273667, 0.7506454774007724, 0.5599999762261128, 2.4000000128986425, 1.6813405755625792], res=[0.0, 0.0, 0.0, 0.0, -0.11631503564018875], res_norm=1.163e-01
2026-01-13 16:39:00,782 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:00,851 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:00,866 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:00,877 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:00,892 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:00,903 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:00,917 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:00,929 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:00,943 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:00,954 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:00,969 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:00,980 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:00,995 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:01,006 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:01,020 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:01,032 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:01,047 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:01,058 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:01,073 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:01,083 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:01,096 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:01,106 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:01,269 - INFO - integration_test - Step 7: MPC solve successful
2026-01-13 16:39:01,318 - INFO - integration_test - Step 7: Computed 6 numeric contouring constraints for visualization (s=1.260)
2026-01-13 16:39:01,318 - DEBUG - integration_test - Step 7: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:01,318 - INFO - integration_test - === Applying control at step 7 ===
2026-01-13 16:39:01,318 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000199919885, 'w': 0.7999999845924073}
2026-01-13 16:39:01,318 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:01,318 - INFO - integration_test -   Planner output success: True
2026-01-13 16:39:01,319 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:01,320 - INFO - integration_test - Step 7 completed in 0.679s
2026-01-13 16:39:01,334 - INFO - integration_test - Step 8 (contouring until path end)
2026-01-13 16:39:01,335 - DEBUG - integration_test - Syncing planner state at step 8: vehicle_state=[1.3224345  0.50942442 0.63999997 2.60000001 1.52000001]
2026-01-13 16:39:01,335 - DEBUG - integration_test - Step 8: Using propagated spline 1.5200 (close to path, dist=0.429m, drift=0.308m)
2026-01-13 16:39:01,336 - DEBUG - integration_test -   Set spline state to 1.5200
2026-01-13 16:39:01,336 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:01,405 - DEBUG - integration_test - Step 8: Checking path alignment: vehicle=(1.322, 0.509), path_start=(0.000, 0.000), dist=1.417m
2026-01-13 16:39:01,405 - INFO - integration_test - === Calling planner.solve_mpc() at step 8 ===
2026-01-13 16:39:01,457 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:01,467 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:01,467 - INFO - integration_test - Warmstart k=0: x0=1.3224344989432655 , y0=0.5094244190104673 , psi0=0.6399999746853533 , v0=2.6000000148978413 , spline0=1.1854545466422144 , a0=0.0 , w0=0.0
2026-01-13 16:39:01,467 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:01,468 - INFO - integration_test - Dyn residual k=0: pred=[1.530979401118757, 0.6646952293751411, 0.6399999746853533, 2.6000000148978413, 1.4454545481319985], ws=[1.530979401118757, 0.6646952293751411, 0.6399999746853533, 2.6000000148978413, 1.311430806926345], res=[0.0, 0.0, 0.0, 0.0, 0.13402374120565352], res_norm=1.340e-01
2026-01-13 16:39:01,469 - INFO - integration_test - Dyn residual k=1: pred=[1.7395243032942485, 0.819966039739815, 0.6399999746853533, 2.6000000148978413, 1.571430808416129], ws=[1.7395243032942485, 0.819966039739815, 0.6399999746853533, 2.6000000148978413, 1.7389251265931651], res=[0.0, 0.0, 0.0, 0.0, -0.16749431817703608], res_norm=1.675e-01
2026-01-13 16:39:01,469 - INFO - integration_test - Dyn residual k=2: pred=[1.94806920546974, 0.9752368501044888, 0.6399999746853533, 2.6000000148978413, 1.9989251280829492], ws=[1.94806920546974, 0.9752368501044888, 0.6399999746853533, 2.6000000148978413, 2.1160617141529507], res=[0.0, 0.0, 0.0, 0.0, -0.11713658607000155], res_norm=1.171e-01
2026-01-13 16:39:01,484 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:01,554 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:01,568 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:01,580 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:01,595 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:01,606 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:01,620 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:01,632 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:01,646 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:01,658 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:01,672 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:01,683 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:01,697 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:01,709 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:01,724 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:01,735 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:01,750 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:01,761 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:01,776 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:01,786 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:01,798 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:01,808 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:01,978 - INFO - integration_test - Step 8: MPC solve successful
2026-01-13 16:39:02,028 - INFO - integration_test - Step 8: Computed 6 numeric contouring constraints for visualization (s=1.520)
2026-01-13 16:39:02,028 - DEBUG - integration_test - Step 8: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:02,028 - INFO - integration_test - === Applying control at step 8 ===
2026-01-13 16:39:02,028 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000199994656, 'w': 0.8000000097766905}
2026-01-13 16:39:02,029 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:02,029 - INFO - integration_test -   Planner output success: True
2026-01-13 16:39:02,030 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:02,030 - INFO - integration_test - Step 8 completed in 0.695s
2026-01-13 16:39:02,043 - INFO - integration_test - Step 9 (contouring until path end)
2026-01-13 16:39:02,044 - DEBUG - integration_test - Syncing planner state at step 9: vehicle_state=[1.53223934 0.67925691 0.71999998 2.80000002 1.80000001]
2026-01-13 16:39:02,045 - DEBUG - integration_test - Step 9: Using propagated spline 1.8000 (close to path, dist=0.464m, drift=0.588m)
2026-01-13 16:39:02,045 - DEBUG - integration_test -   Set spline state to 1.8000
2026-01-13 16:39:02,046 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:02,110 - DEBUG - integration_test - Step 9: Checking path alignment: vehicle=(1.532, 0.679), path_start=(0.000, 0.000), dist=1.676m
2026-01-13 16:39:02,110 - INFO - integration_test - === Calling planner.solve_mpc() at step 9 ===
2026-01-13 16:39:02,162 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:02,171 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:02,171 - INFO - integration_test - Warmstart k=0: x0=1.5322393439688344 , y0=0.6792569129434949 , psi0=0.7199999756630223 , v0=2.800000016897788 , spline0=1.5797979817081316 , a0=0.0 , w0=0.0
2026-01-13 16:39:02,171 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:02,172 - INFO - integration_test - Dyn residual k=0: pred=[1.7427449538919508, 0.8638846170866513, 0.7199999756630223, 2.800000016897788, 1.8597979833979104], ws=[1.7427449538919508, 0.8638846170866513, 0.7199999756630224, 2.800000016897788, 1.737086870022794], res=[0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.12271111337511642], res_norm=1.227e-01
2026-01-13 16:39:02,173 - INFO - integration_test - Dyn residual k=1: pred=[1.9532505638150672, 1.0485123212298078, 0.7199999756630224, 2.800000016897788, 2.0170868717125727], ws=[1.9532505638150672, 1.0485123212298078, 0.7199999756630224, 2.800000016897788, 1.9702467875304375], res=[0.0, 0.0, 0.0, 0.0, 0.046840084182135255], res_norm=4.684e-02
2026-01-13 16:39:02,174 - INFO - integration_test - Dyn residual k=2: pred=[2.1637561737381836, 1.2331400253729643, 0.7199999756630224, 2.800000016897788, 2.250246789220216], ws=[2.1637561737381836, 1.2331400253729643, 0.7199999756630224, 2.800000016897788, 2.3843881764981787], res=[0.0, 0.0, 0.0, 0.0, -0.13414138727796265], res_norm=1.341e-01
2026-01-13 16:39:02,187 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:02,256 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:02,271 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:02,283 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:02,297 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:02,308 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:02,323 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:02,334 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:02,349 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:02,360 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:02,375 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:02,386 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:02,400 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:02,411 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:02,426 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:02,437 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:02,452 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:02,463 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:02,478 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:02,487 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:02,500 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:02,510 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:02,662 - INFO - integration_test - Step 9: MPC solve successful
2026-01-13 16:39:02,715 - INFO - integration_test - Step 9: Computed 6 numeric contouring constraints for visualization (s=1.800)
2026-01-13 16:39:02,715 - DEBUG - integration_test - Step 9: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:02,715 - INFO - integration_test - === Applying control at step 9 ===
2026-01-13 16:39:02,715 - INFO - integration_test -   Control dict from planner: {'a': 2.000000019998987, 'w': 0.09977802330291843}
2026-01-13 16:39:02,715 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:02,715 - INFO - integration_test -   Planner output success: True
2026-01-13 16:39:02,716 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:02,717 - INFO - integration_test - Step 9 completed in 0.672s
2026-01-13 16:39:02,730 - INFO - integration_test - Step 10 (contouring until path end)
2026-01-13 16:39:02,731 - DEBUG - integration_test - Syncing planner state at step 10: vehicle_state=[1.74929439 0.87157543 0.72997778 3.00000002 2.10000001]
2026-01-13 16:39:02,732 - DEBUG - integration_test - Step 10: Using propagated spline 2.1000 (close to path, dist=0.407m, drift=0.283m)
2026-01-13 16:39:02,732 - DEBUG - integration_test -   Set spline state to 2.1000
2026-01-13 16:39:02,733 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:02,799 - DEBUG - integration_test - Step 10: Checking path alignment: vehicle=(1.749, 0.872), path_start=(0.000, 0.000), dist=1.954m
2026-01-13 16:39:02,799 - INFO - integration_test - === Calling planner.solve_mpc() at step 10 ===
2026-01-13 16:39:02,851 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:02,860 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:02,861 - INFO - integration_test - Warmstart k=0: x0=1.749294388781555 , y0=0.8715754276877407 , psi0=0.7299777779933142 , v0=3.0000000188976865 , spline0=1.7929292954827591 , a0=0.0 , w0=0.0
2026-01-13 16:39:02,861 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:02,862 - INFO - integration_test - Dyn residual k=0: pred=[1.9728511565925002, 1.0716313516184863, 0.7299777779933142, 3.0000000188976865, 2.0929292973725278], ws=[1.9728511551842651, 1.0716313503582884, 0.7299777779933141, 3.0, 1.9749090853035407], res=[1.408235084099374e-09, 1.2601979459958557e-09, 1.1102230246251565e-16, 1.8897686526742064e-08, 0.11802021206898705], res_norm=1.180e-01
2026-01-13 16:39:02,862 - INFO - integration_test - Dyn residual k=1: pred=[2.1964079215869754, 1.271687273028836, 0.7299777779933141, 3.0, 2.2749090853035407], ws=[2.1964079215869754, 1.271687273028836, 0.7299777779933141, 3.0, 2.398944897528147], res=[0.0, 0.0, 0.0, 0.0, -0.12403581222460636], res_norm=1.240e-01
2026-01-13 16:39:02,863 - INFO - integration_test - Dyn residual k=2: pred=[2.4199646879896854, 1.4717431956993836, 0.7299777779933141, 3.0, 2.698944897528147], ws=[2.4199646879896854, 1.4717431956993836, 0.7299777779933141, 3.0, 2.594976609087911], res=[0.0, 0.0, 0.0, 0.0, 0.10396828844023576], res_norm=1.040e-01
2026-01-13 16:39:02,877 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:02,946 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:02,961 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:02,973 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:02,987 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:02,999 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:03,013 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:03,024 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:03,039 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:03,051 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:03,065 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:03,077 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:03,091 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:03,102 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:03,117 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:03,129 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:03,144 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:03,156 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:03,171 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:03,181 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:03,194 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:03,204 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:03,401 - INFO - integration_test - Step 10: MPC solve successful
2026-01-13 16:39:03,455 - INFO - integration_test - Step 10: Computed 6 numeric contouring constraints for visualization (s=2.100)
2026-01-13 16:39:03,456 - DEBUG - integration_test - Step 10: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:03,456 - INFO - integration_test - === Applying control at step 10 ===
2026-01-13 16:39:03,456 - INFO - integration_test -   Control dict from planner: {'a': 1.1102194840558735e-07, 'w': -0.2717672735723066}
2026-01-13 16:39:03,456 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:03,456 - INFO - integration_test -   Planner output success: True
2026-01-13 16:39:03,457 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:03,457 - INFO - integration_test - Step 10 completed in 0.726s
2026-01-13 16:39:03,469 - INFO - integration_test - Step 11 (contouring until path end)
2026-01-13 16:39:03,470 - DEBUG - integration_test - Syncing planner state at step 11: vehicle_state=[1.9755419  1.06856914 0.70280105 3.00000003 2.40000001]
2026-01-13 16:39:03,471 - DEBUG - integration_test - Step 11: Using propagated spline 2.4000 (close to path, dist=0.441m, drift=0.583m)
2026-01-13 16:39:03,471 - DEBUG - integration_test -   Set spline state to 2.4000
2026-01-13 16:39:03,472 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:03,537 - DEBUG - integration_test - Step 11: Checking path alignment: vehicle=(1.976, 1.069), path_start=(0.000, 0.000), dist=2.246m
2026-01-13 16:39:03,537 - INFO - integration_test - === Calling planner.solve_mpc() at step 11 ===
2026-01-13 16:39:03,587 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:03,597 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:03,597 - INFO - integration_test - Warmstart k=0: x0=1.9755419045242935 , y0=1.0685691431933766 , psi0=0.7028010506360836 , v0=3.0000000299998812 , spline0=2.167676771517573 , a0=0.0 , w0=0.0
2026-01-13 16:39:03,597 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:03,598 - INFO - integration_test - Dyn residual k=0: pred=[2.2044523176688906, 1.2624764008037166, 0.7028010506360836, 3.0000000299998812, 2.467676774517561], ws=[2.2044523153797955, 1.2624763988646517, 0.7028010506360838, 3.0, 2.356889277661459], res=[2.289095135665775e-09, 1.9390649086403755e-09, -2.220446049250313e-16, 2.999988124585684e-08, 0.11078749685610223], res_norm=1.108e-01
2026-01-13 16:39:03,599 - INFO - integration_test - Dyn residual k=1: pred=[2.4333627262352975, 1.456383654535927, 0.7028010506360838, 3.0, 2.6568892776614588], ws=[2.4333627262352975, 1.456383654535927, 0.7028010506360838, 3.0, 2.812204265432963], res=[0.0, 0.0, 0.0, 0.0, -0.15531498777150432], res_norm=1.553e-01
2026-01-13 16:39:03,599 - INFO - integration_test - Dyn residual k=2: pred=[2.6622731370907995, 1.6502909102072023, 0.7028010506360838, 3.0, 3.112204265432963], ws=[2.6622731370907995, 1.6502909102072023, 0.7028010506360838, 3.0, 3.031706875119695], res=[0.0, 0.0, 0.0, 0.0, 0.08049739031326775], res_norm=8.050e-02
2026-01-13 16:39:03,613 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:03,681 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:03,696 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:03,707 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:03,721 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:03,733 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:03,747 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:03,758 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:03,773 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:03,784 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:03,798 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:03,809 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:03,823 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:03,835 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:03,849 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:03,860 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:03,875 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:03,886 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:03,900 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:03,910 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:03,923 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:03,933 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:04,096 - INFO - integration_test - Step 11: MPC solve successful
2026-01-13 16:39:04,154 - INFO - integration_test - Step 11: Computed 6 numeric contouring constraints for visualization (s=2.400)
2026-01-13 16:39:04,154 - DEBUG - integration_test - Step 11: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:04,154 - INFO - integration_test - === Applying control at step 11 ===
2026-01-13 16:39:04,154 - INFO - integration_test -   Control dict from planner: {'a': -9.999749749257544e-12, 'w': -0.16279266710391832}
2026-01-13 16:39:04,154 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:04,154 - INFO - integration_test -   Planner output success: True
2026-01-13 16:39:04,155 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:04,156 - INFO - integration_test - Step 11 completed in 0.686s
2026-01-13 16:39:04,169 - INFO - integration_test - Step 12 (contouring until path end)
2026-01-13 16:39:04,170 - DEBUG - integration_test - Syncing planner state at step 12: vehicle_state=[2.20602051 1.26060463 0.68652178 3.00000003 2.70000002]
2026-01-13 16:39:04,170 - DEBUG - integration_test - Step 12: Using propagated spline 2.7000 (close to path, dist=0.369m, drift=0.277m)
2026-01-13 16:39:04,170 - DEBUG - integration_test -   Set spline state to 2.7000
2026-01-13 16:39:04,171 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:04,240 - DEBUG - integration_test - Step 12: Checking path alignment: vehicle=(2.206, 1.261), path_start=(0.000, 0.000), dist=2.541m
2026-01-13 16:39:04,240 - INFO - integration_test - === Calling planner.solve_mpc() at step 12 ===
2026-01-13 16:39:04,291 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:04,300 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:04,301 - INFO - integration_test - Warmstart k=0: x0=2.2060205061697746 , y0=1.2606046305296488 , psi0=0.6865217839256917 , v0=3.000000029998881 , spline0=2.4111111161561585 , a0=0.0 , w0=0.0
2026-01-13 16:39:04,301 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:04,302 - INFO - integration_test - Dyn residual k=0: pred=[2.438057116230426, 1.4507598655127913, 0.6865217839256917, 3.000000029998881, 2.7111111191560466], ws=[2.4380571139101463, 1.45075986361131, 0.6865217839256919, 3.0, 2.621580810723637], res=[2.3202795240706564e-09, 1.9014814167661598e-09, -1.1102230246251565e-16, 2.999888115695626e-08, 0.08953030843240972], res_norm=8.953e-02
2026-01-13 16:39:04,302 - INFO - integration_test - Dyn residual k=1: pred=[2.670093721650518, 1.640915096692971, 0.6865217839256919, 3.0, 2.921580810723637], ws=[2.670093721650518, 1.640915096692971, 0.6865217839256919, 3.0, 3.0038652445959477], res=[0.0, 0.0, 0.0, 0.0, -0.08228443387231055], res_norm=8.228e-02
2026-01-13 16:39:04,303 - INFO - integration_test - Dyn residual k=2: pred=[2.9021303293908898, 1.8310703297746322, 0.6865217839256919, 3.0, 3.303865244595948], ws=[2.9021303293908898, 1.8310703297746322, 0.6865217839256919, 3.0, 3.2199727629135664], res=[0.0, 0.0, 0.0, 0.0, 0.08389248168238161], res_norm=8.389e-02
2026-01-13 16:39:04,316 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:04,385 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:04,399 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:04,410 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:04,425 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:04,436 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:04,450 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:04,461 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:04,475 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:04,486 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:04,500 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:04,511 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:04,526 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:04,537 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:04,552 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:04,563 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:04,578 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:04,589 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:04,603 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:04,614 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:04,627 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:04,636 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:04,776 - INFO - integration_test - Step 12: MPC solve successful
2026-01-13 16:39:04,949 - INFO - integration_test - Step 12: Computed 6 numeric contouring constraints for visualization (s=2.700)
2026-01-13 16:39:04,949 - DEBUG - integration_test - Step 12: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:04,949 - INFO - integration_test - === Applying control at step 12 ===
2026-01-13 16:39:04,949 - INFO - integration_test -   Control dict from planner: {'a': -1.89535001928492e-11, 'w': -0.16873012347452568}
2026-01-13 16:39:04,949 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:04,949 - INFO - integration_test -   Planner output success: True
2026-01-13 16:39:04,950 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:04,950 - INFO - integration_test - Step 12 completed in 0.781s
2026-01-13 16:39:04,963 - INFO - integration_test - Step 13 (contouring until path end)
2026-01-13 16:39:04,964 - DEBUG - integration_test - Syncing planner state at step 13: vehicle_state=[2.43965031 1.44879331 0.66964877 3.00000003 3.00000002]
2026-01-13 16:39:04,964 - DEBUG - integration_test - Step 13: Using propagated spline 3.0000 (close to path, dist=0.438m, drift=0.577m)
2026-01-13 16:39:04,964 - DEBUG - integration_test -   Set spline state to 3.0000
2026-01-13 16:39:04,965 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:05,030 - DEBUG - integration_test - Step 13: Checking path alignment: vehicle=(2.440, 1.449), path_start=(0.000, 0.000), dist=2.837m
2026-01-13 16:39:05,030 - INFO - integration_test - === Calling planner.solve_mpc() at step 13 ===
2026-01-13 16:39:05,081 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:05,091 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:05,091 - INFO - integration_test - Warmstart k=0: x0=2.4396503140664745 , y0=1.4487933109762179 , psi0=0.6696487715782392 , v0=3.000000029996986 , spline0=2.828282835039349 , a0=0.0 , w0=0.0
2026-01-13 16:39:05,091 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:05,092 - INFO - integration_test - Dyn residual k=0: pred=[2.6748622340557144, 1.6350065073259785, 0.6696487715782392, 3.000000029996986, 3.1282828380390475], ws=[2.6748622317038317, 1.6350065054640337, 0.6696487715782391, 3.0, 2.789153016854305], res=[2.3518826886004263e-09, 1.8619448205470235e-09, 1.1102230246251565e-16, 2.999698578420862e-08, 0.33912982118474266], res_norm=3.391e-01
2026-01-13 16:39:05,093 - INFO - integration_test - Dyn residual k=1: pred=[2.910074149341189, 1.8212196999518495, 0.6696487715782391, 3.0, 3.089153016854305], ws=[2.910074149341189, 1.8212196999518495, 0.6696487715782391, 3.0, 3.188468917751412], res=[0.0, 0.0, 0.0, 0.0, -0.09931590089710696], res_norm=9.932e-02
2026-01-13 16:39:05,094 - INFO - integration_test - Dyn residual k=2: pred=[3.1452860669785463, 2.007432894439665, 0.6696487715782391, 3.0, 3.488468917751412], ws=[3.0931875486652487, 2.232785629643521, 0.6696487715782391, 3.0, 3.6944957115574626], res=[0.05209851831329759, -0.225352735203856, 0.0, 0.0, -0.2060267938060507], res_norm=3.098e-01
2026-01-13 16:39:05,106 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:05,176 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:05,191 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:05,203 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:05,217 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:05,229 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:05,244 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:05,255 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:05,269 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:05,280 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:05,295 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:05,306 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:05,320 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:05,331 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:05,346 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:05,356 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:05,371 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:05,382 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:05,396 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:05,406 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:05,419 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:05,429 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:05,586 - INFO - integration_test - Step 13: MPC solve successful
2026-01-13 16:39:05,646 - INFO - integration_test - Step 13: Computed 6 numeric contouring constraints for visualization (s=3.000)
2026-01-13 16:39:05,646 - DEBUG - integration_test - Step 13: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:05,646 - INFO - integration_test - === Applying control at step 13 ===
2026-01-13 16:39:05,646 - INFO - integration_test -   Control dict from planner: {'a': 1.914342794031276e-11, 'w': -0.18755167059569613}
2026-01-13 16:39:05,646 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:05,646 - INFO - integration_test -   Planner output success: True
2026-01-13 16:39:05,647 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:05,648 - INFO - integration_test - Step 13 completed in 0.684s
2026-01-13 16:39:05,660 - INFO - integration_test - Step 14 (contouring until path end)
2026-01-13 16:39:05,662 - DEBUG - integration_test - Syncing planner state at step 14: vehicle_state=[2.67659462 1.63278994 0.6508936  3.00000003 3.30000002]
2026-01-13 16:39:05,663 - DEBUG - integration_test - Step 14: Using propagated spline 3.3000 (close to path, dist=0.346m, drift=0.271m)
2026-01-13 16:39:05,663 - DEBUG - integration_test -   Set spline state to 3.3000
2026-01-13 16:39:05,664 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:05,729 - DEBUG - integration_test - Step 14: Checking path alignment: vehicle=(2.677, 1.633), path_start=(0.000, 0.000), dist=3.135m
2026-01-13 16:39:05,729 - INFO - integration_test - === Calling planner.solve_mpc() at step 14 ===
2026-01-13 16:39:05,781 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:05,790 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:05,791 - INFO - integration_test - Warmstart k=0: x0=2.6765946233794917 , y0=1.6327899358107005 , psi0=0.6508936045186696 , v0=3.0000000299989003 , spline0=3.0181818262222513 , a0=0.0 , w0=0.0
2026-01-13 16:39:05,791 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:05,792 - INFO - integration_test - Dyn residual k=0: pred=[2.9152574308059025, 1.8145592020557895, 0.6508936045186696, 3.0000000299989003, 3.318181829222141], ws=[2.9152574284193618, 1.8145592002381636, 0.6508936045186697, 3.0, 3.2520813243255025], res=[2.3865407428047547e-09, 1.8176258276270119e-09, -1.1102230246251565e-16, 2.999890025279228e-08, 0.06610050489663877], res_norm=6.610e-02
2026-01-13 16:39:05,793 - INFO - integration_test - Dyn residual k=1: pred=[3.153920233459232, 1.9963284646656267, 0.6508936045186697, 3.0, 3.5520813243255027], ws=[3.153920233459232, 1.9963284646656267, 0.6508936045186697, 3.0, 3.6675937836173826], res=[0.0, 0.0, 0.0, 0.0, -0.11551245929187992], res_norm=1.155e-01
2026-01-13 16:39:05,793 - INFO - integration_test - Dyn residual k=2: pred=[3.392583038499102, 2.1780977290930896, 0.6508936045186697, 3.0, 3.9675937836173825], ws=[3.392583038499102, 2.1780977290930896, 0.6508936045186697, 3.0, 3.8339997649562934], res=[0.0, 0.0, 0.0, 0.0, 0.1335940186610891], res_norm=1.336e-01
2026-01-13 16:39:05,807 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:05,875 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:05,890 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:05,901 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:05,915 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:05,926 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:05,941 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:05,952 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:05,966 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:05,978 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:05,992 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:06,002 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:06,016 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:06,028 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:06,042 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:06,053 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:06,068 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:06,079 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:06,093 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:06,113 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:06,125 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:06,135 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:06,306 - INFO - integration_test - Step 14: MPC solve successful
2026-01-13 16:39:06,368 - INFO - integration_test - Step 14: Computed 6 numeric contouring constraints for visualization (s=3.300)
2026-01-13 16:39:06,368 - DEBUG - integration_test - Step 14: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:06,368 - INFO - integration_test - === Applying control at step 14 ===
2026-01-13 16:39:06,368 - INFO - integration_test -   Control dict from planner: {'a': 6.172749352884749e-12, 'w': -0.19788126340510115}
2026-01-13 16:39:06,368 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:06,368 - INFO - integration_test -   Planner output success: True
2026-01-13 16:39:06,369 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:06,370 - INFO - integration_test - Step 14 completed in 0.708s
2026-01-13 16:39:06,383 - INFO - integration_test - Step 15 (contouring until path end)
2026-01-13 16:39:06,384 - DEBUG - integration_test - Syncing planner state at step 15: vehicle_state=[2.91704023 1.81218607 0.63110548 3.00000003 3.60000003]
2026-01-13 16:39:06,384 - DEBUG - integration_test - Step 15: Using propagated spline 3.6000 (close to path, dist=0.442m, drift=0.035m)
2026-01-13 16:39:06,384 - DEBUG - integration_test -   Set spline state to 3.6000
2026-01-13 16:39:06,385 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:06,450 - DEBUG - integration_test - Step 15: Checking path alignment: vehicle=(2.917, 1.812), path_start=(0.000, 0.000), dist=3.434m
2026-01-13 16:39:06,450 - INFO - integration_test - === Calling planner.solve_mpc() at step 15 ===
2026-01-13 16:39:06,504 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:06,514 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:06,515 - INFO - integration_test - Warmstart k=0: x0=2.9170402335122407 , y0=1.812186071892606 , psi0=0.6311054781781595 , v0=3.0000000299995175 , spline0=3.214141423526387 , a0=0.0 , w0=0.0
2026-01-13 16:39:06,515 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:06,516 - INFO - integration_test - Dyn residual k=0: pred=[3.1592529543443, 1.9891973700266574, 0.6311054781781595, 3.0000000299995175, 3.5141414265263387], ws=[3.1592529519222117, 1.989197368256573, 0.6311054781781595, 3.0, 3.4381317226647186], res=[2.422088307696413e-09, 1.7700845234003282e-09, 0.0, 2.9999517536793974e-08, 0.07600970386162009], res_norm=7.601e-02
2026-01-13 16:39:06,517 - INFO - integration_test - Dyn residual k=1: pred=[3.4014656703321826, 2.1662086646205396, 0.6311054781781595, 3.0, 3.7381317226647184], ws=[3.3181165144191596, 2.3167478977514167, 0.6311054781781595, 3.0, 3.8715742544752882], res=[0.08334915591302305, -0.15053923313087703, 0.0, 0.0, -0.13344253181056986], res_norm=2.178e-01
2026-01-13 16:39:06,518 - INFO - integration_test - Dyn residual k=2: pred=[3.5603292328291305, 2.4937591941153836, 0.6311054781781595, 3.0, 4.1715742544752885], ws=[3.6436783887421536, 2.3432199609845066, 0.6311054781781595, 3.0, 4.022466109890186], res=[-0.08334915591302305, 0.15053923313087703, 0.0, 0.0, 0.14910814458510213], res_norm=2.277e-01
2026-01-13 16:39:06,533 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:06,601 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:06,616 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:06,627 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:06,642 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:06,654 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:06,668 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:06,679 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:06,693 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:06,704 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:06,718 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:06,730 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:06,744 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:06,755 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:06,769 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:06,781 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:06,795 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:06,806 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:06,821 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:06,831 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:06,844 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:06,853 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:07,025 - INFO - integration_test - Step 15: MPC solve successful
2026-01-13 16:39:07,088 - INFO - integration_test - Step 15: Computed 6 numeric contouring constraints for visualization (s=3.600)
2026-01-13 16:39:07,088 - DEBUG - integration_test - Step 15: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:07,088 - INFO - integration_test - === Applying control at step 15 ===
2026-01-13 16:39:07,088 - INFO - integration_test -   Control dict from planner: {'a': 2.277551899851672e-12, 'w': -0.20235808062316962}
2026-01-13 16:39:07,089 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:07,089 - INFO - integration_test -   Planner output success: True
2026-01-13 16:39:07,089 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:07,090 - INFO - integration_test - Step 15 completed in 0.706s
2026-01-13 16:39:07,102 - INFO - integration_test - Step 16 (contouring until path end)
2026-01-13 16:39:07,104 - DEBUG - integration_test - Syncing planner state at step 16: vehicle_state=[3.16102735 1.98673469 0.61086967 3.00000003 3.90000003]
2026-01-13 16:39:07,104 - DEBUG - integration_test - Step 16: Using propagated spline 3.9000 (close to path, dist=0.338m, drift=0.265m)
2026-01-13 16:39:07,104 - DEBUG - integration_test -   Set spline state to 3.9000
2026-01-13 16:39:07,105 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:07,173 - DEBUG - integration_test - Step 16: Checking path alignment: vehicle=(3.161, 1.987), path_start=(0.000, 0.000), dist=3.734m
2026-01-13 16:39:07,173 - INFO - integration_test - === Calling planner.solve_mpc() at step 16 ===
2026-01-13 16:39:07,226 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:07,237 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:07,237 - INFO - integration_test - Warmstart k=0: x0=3.161027346378383 , y0=1.986734688180736 , psi0=0.6108696701158426 , v0=3.0000000299997454 , spline0=3.416161626951742 , a0=0.0 , w0=0.0
2026-01-13 16:39:07,237 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:07,239 - INFO - integration_test - Dyn residual k=0: pred=[3.406772199507005, 2.15880870992945, 0.6108696701158426, 3.0000000299997454, 3.716161629951716], ws=[3.1368326245096396, 2.179063537962949, 0.6108696701158425, 3.0, 3.473098281180869], res=[0.2699395749973652, -0.020254828033499095, 1.1102230246251565e-16, 2.999974535455863e-08, 0.24306334877084712], res_norm=3.638e-01
2026-01-13 16:39:07,239 - INFO - integration_test - Dyn residual k=1: pred=[3.3825774751808337, 2.3511375579909375, 0.6108696701158425, 3.0, 3.773098281180869], ws=[3.6525170477207713, 2.3308827282367126, 0.6108696701158425, 3.0, 4.292687094889212], res=[-0.2699395725399376, 0.02025482975422488, 0.0, 0.0, -0.5195888137083431], res_norm=5.859e-01
2026-01-13 16:39:07,240 - INFO - integration_test - Dyn residual k=2: pred=[3.8982618983919655, 2.502956748264701, 0.6108696701158425, 3.0, 4.592687094889212], ws=[3.8982618983919655, 2.502956748264701, 0.6108696701158425, 3.0, 4.505588678038693], res=[0.0, 0.0, 0.0, 0.0, 0.08709841685051867], res_norm=8.710e-02
2026-01-13 16:39:07,254 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:07,323 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:07,338 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:07,349 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:07,364 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:07,375 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:07,390 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:07,401 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:07,416 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:07,428 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:07,443 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:07,454 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:07,469 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:07,480 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:07,495 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:07,506 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:07,521 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:07,532 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:07,547 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:07,557 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:07,570 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:07,580 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:07,739 - INFO - integration_test - Step 16: MPC solve successful
2026-01-13 16:39:07,803 - INFO - integration_test - Step 16: Computed 6 numeric contouring constraints for visualization (s=3.900)
2026-01-13 16:39:07,804 - DEBUG - integration_test - Step 16: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:07,804 - INFO - integration_test - === Applying control at step 16 ===
2026-01-13 16:39:07,804 - INFO - integration_test -   Control dict from planner: {'a': 7.573442509987469e-13, 'w': -0.21088919519203983}
2026-01-13 16:39:07,804 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:07,804 - INFO - integration_test -   Planner output success: True
2026-01-13 16:39:07,805 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:07,805 - INFO - integration_test - Step 16 completed in 0.702s
2026-01-13 16:39:07,818 - INFO - integration_test - Step 17 (contouring until path end)
2026-01-13 16:39:07,819 - DEBUG - integration_test - Syncing planner state at step 17: vehicle_state=[3.40856834 2.1562048  0.58978075 3.00000003 4.20000003]
2026-01-13 16:39:07,820 - DEBUG - integration_test - Step 17: Using propagated spline 4.2000 (close to path, dist=0.421m, drift=0.041m)
2026-01-13 16:39:07,820 - DEBUG - integration_test -   Set spline state to 4.2000
2026-01-13 16:39:07,821 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:07,886 - DEBUG - integration_test - Step 17: Checking path alignment: vehicle=(3.409, 2.156), path_start=(0.000, 0.000), dist=4.033m
2026-01-13 16:39:07,886 - INFO - integration_test - === Calling planner.solve_mpc() at step 17 ===
2026-01-13 16:39:07,937 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:07,947 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:07,947 - INFO - integration_test - Warmstart k=0: x0=3.40856834475083 , y0=2.156204804772288 , psi0=0.5897807505966386 , v0=3.0000000299998213 , spline0=3.8101010229854047 , a0=0.0 , w0=0.0
2026-01-13 16:39:07,947 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:07,948 - INFO - integration_test - Dyn residual k=0: pred=[3.657887139528922, 2.323058454328985, 0.5897807505966386, 3.0000000299998213, 4.1101010259853865], ws=[3.6578871370357486, 2.3230584526604585, 0.5897807505966384, 3.0, 4.050327565079738], res=[2.4931732234279025e-09, 1.668526650178137e-09, 2.220446049250313e-16, 2.999982129381351e-08, 0.05977346090564861], res_norm=5.977e-02
2026-01-13 16:39:07,948 - INFO - integration_test - Dyn residual k=1: pred=[3.9072059293206673, 2.489912100548629, 0.5897807505966384, 3.0, 4.350327565079738], ws=[3.9072059293206673, 2.489912100548629, 0.5897807505966384, 3.0, 4.513232946290684], res=[0.0, 0.0, 0.0, 0.0, -0.16290538121094666], res_norm=1.629e-01
2026-01-13 16:39:07,949 - INFO - integration_test - Dyn residual k=2: pred=[4.156524721605586, 2.6567657484367992, 0.5897807505966384, 3.0, 4.813232946290684], ws=[4.156524721605586, 2.6567657484367992, 0.5897807505966384, 3.0, 4.928944191894559], res=[0.0, 0.0, 0.0, 0.0, -0.11571124560387513], res_norm=1.157e-01
2026-01-13 16:39:07,962 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:08,031 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:08,046 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:08,057 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:08,072 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:08,083 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:08,097 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:08,108 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:08,123 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:08,134 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:08,149 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:08,160 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:08,174 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:08,185 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:08,199 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:08,210 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:08,225 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:08,237 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:08,251 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:08,261 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:08,273 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:08,283 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:08,410 - INFO - integration_test - Step 17: MPC solve successful
2026-01-13 16:39:08,480 - INFO - integration_test - Step 17: Computed 6 numeric contouring constraints for visualization (s=4.200)
2026-01-13 16:39:08,480 - DEBUG - integration_test - Step 17: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:08,480 - INFO - integration_test - === Applying control at step 17 ===
2026-01-13 16:39:08,480 - INFO - integration_test -   Control dict from planner: {'a': -3.898343699320408e-12, 'w': -0.2011366537279393}
2026-01-13 16:39:08,480 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:08,480 - INFO - integration_test -   Planner output success: True
2026-01-13 16:39:08,481 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:08,481 - INFO - integration_test - Step 17 completed in 0.662s
2026-01-13 16:39:08,494 - INFO - integration_test - Step 18 (contouring until path end)
2026-01-13 16:39:08,496 - DEBUG - integration_test - Syncing planner state at step 18: vehicle_state=[3.65954829 2.32053993 0.56966709 3.00000003 4.50000003]
2026-01-13 16:39:08,496 - DEBUG - integration_test - Step 18: Using propagated spline 4.5000 (close to path, dist=0.343m, drift=0.259m)
2026-01-13 16:39:08,496 - DEBUG - integration_test -   Set spline state to 4.5000
2026-01-13 16:39:08,497 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:08,562 - DEBUG - integration_test - Step 18: Checking path alignment: vehicle=(3.660, 2.321), path_start=(0.000, 0.000), dist=4.333m
2026-01-13 16:39:08,562 - INFO - integration_test - === Calling planner.solve_mpc() at step 18 ===
2026-01-13 16:39:08,615 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:08,624 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:08,624 - INFO - integration_test - Warmstart k=0: x0=3.6595482918331887 , y0=2.320539931318893 , psi0=0.5696670852238447 , v0=3.0000000299994314 , spline0=4.0303030447743815 , a0=0.0 , w0=0.0
2026-01-13 16:39:08,624 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:08,626 - INFO - integration_test - Dyn residual k=0: pred=[3.9121724683554144, 2.482345454204959, 0.5696670852238447, 3.0000000299994314, 4.330303047774325], ws=[4.211935978690772, 2.2106975528858417, 0.5696670852238448, 3.0, 4.592889086238567], res=[-0.299763510335358, 0.2716479013191173, -1.1102230246251565e-16, 2.999943138348726e-08, -0.2625860384642422], res_norm=4.823e-01
2026-01-13 16:39:08,627 - INFO - integration_test - Dyn residual k=1: pred=[4.464560152686804, 2.3725030741538835, 0.5696670852238448, 3.0, 4.892889086238567], ws=[4.164796639825252, 2.6441509738549764, 0.5696670852238448, 3.0, 4.685076015765903], res=[0.2997635128615519, -0.27164789970109293, 0.0, 0.0, 0.20781307047266395], res_norm=4.548e-01
2026-01-13 16:39:08,628 - INFO - integration_test - Dyn residual k=2: pred=[4.417420813821284, 2.8059564951230183, 0.5696670852238448, 3.0, 4.985076015765903], ws=[4.417420813821284, 2.8059564951230183, 0.5696670852238448, 3.0, 5.078939068099129], res=[0.0, 0.0, 0.0, 0.0, -0.09386305233322645], res_norm=9.386e-02
2026-01-13 16:39:08,641 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:08,711 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:08,726 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:08,737 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:08,752 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:08,765 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:08,780 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:08,791 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:08,808 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:08,819 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:08,833 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:08,845 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:08,859 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:08,870 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:08,884 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:08,895 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:08,910 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:08,921 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:08,936 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:08,946 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:08,958 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:08,968 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:09,521 - WARNING - integration_test - Step 18: MPC solve failed
2026-01-13 16:39:09,522 - WARNING - integration_test -   Consecutive MPC failures: 1/5
2026-01-13 16:39:09,589 - INFO - integration_test - Step 18: Computed 6 numeric contouring constraints for visualization (s=4.500)
2026-01-13 16:39:09,589 - DEBUG - integration_test - Step 18: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:09,589 - INFO - integration_test - === Applying control at step 18 ===
2026-01-13 16:39:09,589 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 16:39:09,589 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:09,589 - INFO - integration_test -   Planner output success: False
2026-01-13 16:39:09,589 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 16:39:09,591 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:09,591 - INFO - integration_test - Step 18 completed in 1.096s
2026-01-13 16:39:09,602 - INFO - integration_test - Step 19 (contouring until path end)
2026-01-13 16:39:09,604 - DEBUG - integration_test - Syncing planner state at step 19: vehicle_state=[3.91217247 2.48234545 0.56966709 3.00000003 4.80000004]
2026-01-13 16:39:09,604 - DEBUG - integration_test - Step 19: Using propagated spline 4.8000 (close to path, dist=0.407m, drift=0.046m)
2026-01-13 16:39:09,604 - DEBUG - integration_test -   Set spline state to 4.8000
2026-01-13 16:39:09,605 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:09,670 - DEBUG - integration_test - Step 19: Checking path alignment: vehicle=(3.912, 2.482), path_start=(0.000, 0.000), dist=4.633m
2026-01-13 16:39:09,670 - INFO - integration_test - === Calling planner.solve_mpc() at step 19 ===
2026-01-13 16:39:09,723 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:09,732 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:09,732 - INFO - integration_test - Warmstart k=0: x0=3.9121724683554144 , y0=2.482345454204959 , psi0=0.5696670852238447 , v0=3.0000000299994314 , spline0=4.454545471414085 , a0=0.0 , w0=0.0
2026-01-13 16:39:09,733 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:09,734 - INFO - integration_test - Dyn residual k=0: pred=[4.16479664487764, 2.644150977091025, 0.5696670852238447, 3.0000000299994314, 4.754545474414028], ws=[4.164796642351446, 2.644150975473001, 0.5696670852238448, 3.0, 4.683005087486261], res=[2.5261943648047236e-09, 1.618024381144778e-09, -1.1102230246251565e-16, 2.999943138348726e-08, 0.07154038692776687], res_norm=7.154e-02
2026-01-13 16:39:09,734 - INFO - integration_test - Dyn residual k=1: pred=[4.4174208163474775, 2.8059564967410426, 0.5696670852238448, 3.0, 4.983005087486261], ws=[4.034425825295223, 3.2716185339597863, 0.5696670852238448, 3.0, 5.056181336781639], res=[0.38299499105225454, -0.46566203721874366, 0.0, 0.0, -0.07317624929537736], res_norm=6.074e-01
2026-01-13 16:39:09,735 - INFO - integration_test - Dyn residual k=2: pred=[4.287049999291255, 3.433424055227828, 0.5696670852238448, 3.0, 5.356181336781638], ws=[4.670044990343509, 2.9677620180090845, 0.5696670852238448, 3.0, 5.298201105306938], res=[-0.38299499105225454, 0.46566203721874366, 0.0, 0.0, 0.05798023147470044], res_norm=6.057e-01
2026-01-13 16:39:09,748 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:09,820 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:09,835 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:09,846 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:09,861 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:09,872 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:09,887 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:09,898 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:09,912 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:09,924 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:09,939 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:09,951 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:09,965 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:09,977 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:09,991 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:10,002 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:10,017 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:10,029 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:10,043 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:10,053 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:10,066 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:10,076 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:10,278 - INFO - integration_test - Step 19: MPC solve successful
2026-01-13 16:39:10,500 - INFO - integration_test - Step 19: Computed 6 numeric contouring constraints for visualization (s=4.800)
2026-01-13 16:39:10,501 - DEBUG - integration_test - Step 19: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:10,501 - INFO - integration_test - === Applying control at step 19 ===
2026-01-13 16:39:10,501 - INFO - integration_test -   Control dict from planner: {'a': -2.0867270886832266e-11, 'w': -0.5624002971472951}
2026-01-13 16:39:10,501 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:10,501 - INFO - integration_test -   Planner output success: True
2026-01-13 16:39:10,502 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:10,502 - INFO - integration_test - Step 19 completed in 0.899s
2026-01-13 16:39:10,516 - INFO - integration_test - Step 20 (contouring until path end)
2026-01-13 16:39:10,518 - DEBUG - integration_test - Syncing planner state at step 20: vehicle_state=[4.16921227 2.63696377 0.51342706 3.00000003 5.10000004]
2026-01-13 16:39:10,518 - DEBUG - integration_test - Step 20: Using propagated spline 5.1000 (close to path, dist=0.354m, drift=0.254m)
2026-01-13 16:39:10,518 - DEBUG - integration_test -   Set spline state to 5.1000
2026-01-13 16:39:10,519 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:10,584 - DEBUG - integration_test - Step 20: Checking path alignment: vehicle=(4.169, 2.637), path_start=(0.000, 0.000), dist=4.933m
2026-01-13 16:39:10,584 - INFO - integration_test - === Calling planner.solve_mpc() at step 20 ===
2026-01-13 16:39:10,636 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:10,646 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:10,646 - INFO - integration_test - Warmstart k=0: x0=4.169212268830429 , y0=2.6369637708436753 , psi0=0.5134270555091152 , v0=3.0000000299973446 , spline0=4.645454585565266 , a0=0.0 , w0=0.0
2026-01-13 16:39:10,646 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:10,647 - INFO - integration_test - Dyn residual k=0: pred=[4.43053218404447, 2.784313367763271, 0.5134270555091152, 3.0000000299973446, 4.945454588565], ws=[4.430532181431501, 2.7843133662899056, 0.5134270555091152, 3.0, 5.123571132148935], res=[2.612968508231006e-09, 1.4733654296605891e-09, 0.0, 2.999734460829018e-08, -0.17811654358393447], res_norm=1.781e-01
2026-01-13 16:39:10,648 - INFO - integration_test - Dyn residual k=1: pred=[4.691852094032574, 2.931662961736136, 0.5134270555091152, 3.0, 5.423571132148934], ws=[4.520354279197632, 3.35820245282881, 0.5134270555091152, 3.0, 5.571445376664791], res=[0.1714978148349413, -0.4265394910926741, 0.0, 0.0, -0.1478742445158563], res_norm=4.829e-01
2026-01-13 16:39:10,648 - INFO - integration_test - Dyn residual k=2: pred=[4.781674191798705, 3.50555204827504, 0.5134270555091152, 3.0, 5.8714453766647905], ws=[4.953172006633646, 3.079012557182366, 0.5134270555091152, 3.0, 5.755256102429026], res=[-0.1714978148349413, 0.4265394910926741, 0.0, 0.0, 0.1161892742357642], res_norm=4.742e-01
2026-01-13 16:39:10,661 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:10,730 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:10,745 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:10,756 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:10,771 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:10,783 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:10,797 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:10,808 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:10,822 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:10,834 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:10,848 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:10,859 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:10,873 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:10,885 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:10,899 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:10,910 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:10,924 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:10,936 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:10,951 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:10,961 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:10,974 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:10,984 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:11,171 - INFO - integration_test - Step 20: MPC solve successful
2026-01-13 16:39:11,246 - INFO - integration_test - Step 20: Computed 6 numeric contouring constraints for visualization (s=5.100)
2026-01-13 16:39:11,246 - DEBUG - integration_test - Step 20: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:11,246 - INFO - integration_test - === Applying control at step 20 ===
2026-01-13 16:39:11,247 - INFO - integration_test -   Control dict from planner: {'a': -8.611560652282013e-11, 'w': -0.145620156531518}
2026-01-13 16:39:11,247 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:11,247 - INFO - integration_test -   Planner output success: True
2026-01-13 16:39:11,248 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:11,248 - INFO - integration_test - Step 20 completed in 0.730s
2026-01-13 16:39:11,261 - INFO - integration_test - Step 21 (contouring until path end)
2026-01-13 16:39:11,263 - DEBUG - integration_test - Syncing planner state at step 21: vehicle_state=[4.43159578 2.78240552 0.49886504 3.00000003 5.40000004]
2026-01-13 16:39:11,263 - DEBUG - integration_test - Step 21: Using propagated spline 5.4000 (close to path, dist=0.406m, drift=0.052m)
2026-01-13 16:39:11,263 - DEBUG - integration_test -   Set spline state to 5.4000
2026-01-13 16:39:11,264 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:11,331 - DEBUG - integration_test - Step 21: Checking path alignment: vehicle=(4.432, 2.782), path_start=(0.000, 0.000), dist=5.233m
2026-01-13 16:39:11,331 - INFO - integration_test - === Calling planner.solve_mpc() at step 21 ===
2026-01-13 16:39:11,383 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:11,393 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:11,393 - INFO - integration_test - Warmstart k=0: x0=4.431595783174732 , y0=2.7824055214577488 , psi0=0.49886503985596337 , v0=3.000000029988733 , spline0=5.04646468957424 , a0=0.0 , w0=0.0
2026-01-13 16:39:11,393 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:11,394 - INFO - integration_test - Dyn residual k=0: pred=[4.69503362343705, 2.925934285533976, 0.49886503985596337, 3.000000029988733, 5.346464692573113], ws=[4.695033620803661, 2.9259342840992275, 0.4988650398559633, 3.0, 5.260775289580061], res=[2.6333886182783317e-09, 1.4347483201504474e-09, 5.551115123125783e-17, 2.9988732830332765e-08, 0.08568940299305172], res_norm=8.569e-02
2026-01-13 16:39:11,395 - INFO - integration_test - Dyn residual k=1: pred=[4.958471458432591, 3.0694630467407062, 0.4988650398559633, 3.0, 5.560775289580061], ws=[4.958471458432591, 3.0694630467407062, 0.4988650398559633, 3.0, 5.754073084581059], res=[0.0, 0.0, 0.0, 0.0, -0.19329779500099775], res_norm=1.933e-01
2026-01-13 16:39:11,395 - INFO - integration_test - Dyn residual k=2: pred=[5.22190929606152, 3.212991809382185, 0.4988650398559633, 3.0, 6.054073084581058], ws=[5.22190929606152, 3.212991809382185, 0.4988650398559633, 3.0, 5.916364460731513], res=[0.0, 0.0, 0.0, 0.0, 0.1377086238495453], res_norm=1.377e-01
2026-01-13 16:39:11,410 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:11,480 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:11,496 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:11,507 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:11,523 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:11,534 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:11,549 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:11,560 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:11,575 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:11,586 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:11,600 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:11,612 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:11,626 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:11,638 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:11,653 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:11,664 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:11,680 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:11,691 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:11,706 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:11,716 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:11,729 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:11,739 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:11,909 - INFO - integration_test - Step 21: MPC solve successful
2026-01-13 16:39:11,986 - INFO - integration_test - Step 21: Computed 6 numeric contouring constraints for visualization (s=5.400)
2026-01-13 16:39:11,986 - DEBUG - integration_test - Step 21: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:11,986 - INFO - integration_test - === Applying control at step 21 ===
2026-01-13 16:39:11,986 - INFO - integration_test -   Control dict from planner: {'a': 7.412136249392192e-11, 'w': -0.2731178473198011}
2026-01-13 16:39:11,986 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:11,986 - INFO - integration_test -   Planner output success: True
2026-01-13 16:39:11,987 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:11,988 - INFO - integration_test - Step 21 completed in 0.725s
2026-01-13 16:39:12,001 - INFO - integration_test - Step 22 (contouring until path end)
2026-01-13 16:39:12,002 - DEBUG - integration_test - Syncing planner state at step 22: vehicle_state=[4.69696077 2.92231919 0.47155326 3.00000003 5.70000005]
2026-01-13 16:39:12,002 - DEBUG - integration_test - Step 22: Using propagated spline 5.7000 (close to path, dist=0.381m, drift=0.248m)
2026-01-13 16:39:12,002 - DEBUG - integration_test -   Set spline state to 5.7000
2026-01-13 16:39:12,003 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:12,068 - DEBUG - integration_test - Step 22: Checking path alignment: vehicle=(4.697, 2.922), path_start=(0.000, 0.000), dist=5.532m
2026-01-13 16:39:12,068 - INFO - integration_test - === Calling planner.solve_mpc() at step 22 ===
2026-01-13 16:39:12,119 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:12,128 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:12,128 - INFO - integration_test - Warmstart k=0: x0=4.6969607650413865 , y0=2.922319187231797 , psi0=0.4715532551239833 , v0=3.000000029996145 , spline0=5.548484894594057 , a0=0.0 , w0=0.0
2026-01-13 16:39:12,128 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:12,129 - INFO - integration_test - Dyn residual k=0: pred=[4.9642198972243055, 3.0586003600496223, 0.4715532551239833, 3.000000029996145, 5.848484897593671], ws=[4.964219894552057, 3.0586003586869857, 0.4715532551239834, 3.0, 5.716694711480591], res=[2.6722482004970516e-09, 1.3626366701657844e-09, -1.1102230246251565e-16, 2.999614512333437e-08, 0.13179018611308013], res_norm=1.318e-01
2026-01-13 16:39:12,130 - INFO - integration_test - Dyn residual k=1: pred=[5.231479024062728, 3.1948815301421742, 0.4715532551239834, 3.0, 6.016694711480591], ws=[5.231479024062728, 3.1948815301421742, 0.4715532551239834, 3.0, 6.15632256929093], res=[0.0, 0.0, 0.0, 0.0, -0.13962785781033915], res_norm=1.396e-01
2026-01-13 16:39:12,131 - INFO - integration_test - Dyn residual k=2: pred=[5.498738153573399, 3.331162701597363, 0.4715532551239834, 3.0, 6.45632256929093], ws=[5.498738153573399, 3.331162701597363, 0.4715532551239834, 3.0, 6.332948580713704], res=[0.0, 0.0, 0.0, 0.0, 0.12337398857722626], res_norm=1.234e-01
2026-01-13 16:39:12,144 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:12,213 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:12,228 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:12,240 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:12,255 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:12,266 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:12,281 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:12,292 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:12,306 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:12,318 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:12,333 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:12,344 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:12,359 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:12,370 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:12,384 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:12,396 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:12,412 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:12,424 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:12,439 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:12,450 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:12,463 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:12,472 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:12,622 - INFO - integration_test - Step 22: MPC solve successful
2026-01-13 16:39:12,702 - INFO - integration_test - Step 22: Computed 6 numeric contouring constraints for visualization (s=5.700)
2026-01-13 16:39:12,703 - DEBUG - integration_test - Step 22: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:12,703 - INFO - integration_test - === Applying control at step 22 ===
2026-01-13 16:39:12,703 - INFO - integration_test -   Control dict from planner: {'a': 2.4702483470345964e-11, 'w': -0.2432171914746346}
2026-01-13 16:39:12,703 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:12,703 - INFO - integration_test -   Planner output success: True
2026-01-13 16:39:12,704 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:12,704 - INFO - integration_test - Step 22 completed in 0.703s
2026-01-13 16:39:12,717 - INFO - integration_test - Step 23 (contouring until path end)
2026-01-13 16:39:12,718 - DEBUG - integration_test - Syncing planner state at step 23: vehicle_state=[4.96585076 3.05533698 0.44723154 3.00000003 6.00000005]
2026-01-13 16:39:12,719 - DEBUG - integration_test - Step 23: Using propagated spline 6.0000 (close to path, dist=0.558m, drift=0.548m)
2026-01-13 16:39:12,719 - DEBUG - integration_test -   Set spline state to 6.0000
2026-01-13 16:39:12,720 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:12,785 - DEBUG - integration_test - Step 23: Checking path alignment: vehicle=(4.966, 3.055), path_start=(0.000, 0.000), dist=5.831m
2026-01-13 16:39:12,785 - INFO - integration_test - === Calling planner.solve_mpc() at step 23 ===
2026-01-13 16:39:12,838 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:12,848 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:12,848 - INFO - integration_test - Warmstart k=0: x0=4.965850763199869 , y0=3.055336983801537 , psi0=0.4472315359765198 , v0=3.0000000299986156 , spline0=5.747474796583817 , a0=0.0 , w0=0.0
2026-01-13 16:39:12,848 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:12,849 - INFO - integration_test - Dyn residual k=0: pred=[5.2363451168724, 3.185078289603494, 0.4472315359765198, 3.0000000299986156, 6.047474799583679], ws=[5.236345114167581, 3.185078288306141, 0.44723153597652, 3.0, 6.1589415368454326], res=[2.704818591325875e-09, 1.297352891782566e-09, -1.6653345369377348e-16, 2.999861559160877e-08, -0.11146673726175393], res_norm=1.115e-01
2026-01-13 16:39:12,850 - INFO - integration_test - Dyn residual k=1: pred=[5.506839465135293, 3.314819592810745, 0.44723153597652, 3.0, 6.458941536845432], ws=[5.506839465135293, 3.314819592810745, 0.44723153597652, 3.0, 6.3434640049435576], res=[0.0, 0.0, 0.0, 0.0, 0.11547753190187482], res_norm=1.155e-01
2026-01-13 16:39:12,850 - INFO - integration_test - Dyn residual k=2: pred=[5.777333816103005, 3.4445608973153488, 0.44723153597652, 3.0, 6.643464004943557], ws=[5.777333816103005, 3.4445608973153488, 0.44723153597652, 3.0, 6.498976862370057], res=[0.0, 0.0, 0.0, 0.0, 0.14448714257350037], res_norm=1.445e-01
2026-01-13 16:39:12,864 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:12,933 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:12,948 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:12,960 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:12,974 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:12,986 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:13,000 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:13,011 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:13,026 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:13,038 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:13,052 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:13,064 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:13,078 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:13,089 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:13,104 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:13,116 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:13,133 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:13,144 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:13,159 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:13,170 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:13,182 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:13,193 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:13,346 - INFO - integration_test - Step 23: MPC solve successful
2026-01-13 16:39:13,425 - INFO - integration_test - Step 23: Computed 6 numeric contouring constraints for visualization (s=6.000)
2026-01-13 16:39:13,426 - DEBUG - integration_test - Step 23: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:13,426 - INFO - integration_test - === Applying control at step 23 ===
2026-01-13 16:39:13,426 - INFO - integration_test -   Control dict from planner: {'a': 8.201555599061718e-12, 'w': -0.27047836846474993}
2026-01-13 16:39:13,426 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:13,426 - INFO - integration_test -   Planner output success: True
2026-01-13 16:39:13,427 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:13,428 - INFO - integration_test - Step 23 completed in 0.709s
2026-01-13 16:39:13,439 - INFO - integration_test - Step 24 (contouring until path end)
2026-01-13 16:39:13,441 - DEBUG - integration_test - Syncing planner state at step 24: vehicle_state=[5.23806664 3.18140455 0.4201837  3.00000003 6.30000005]
2026-01-13 16:39:13,442 - DEBUG - integration_test - Step 24: Using propagated spline 6.3000 (close to path, dist=0.462m, drift=0.242m)
2026-01-13 16:39:13,442 - DEBUG - integration_test -   Set spline state to 6.3000
2026-01-13 16:39:13,443 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:13,508 - DEBUG - integration_test - Step 24: Checking path alignment: vehicle=(5.238, 3.181), path_start=(0.000, 0.000), dist=6.129m
2026-01-13 16:39:13,508 - INFO - integration_test - === Calling planner.solve_mpc() at step 24 ===
2026-01-13 16:39:13,561 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:13,571 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:13,571 - INFO - integration_test - Warmstart k=0: x0=5.238066640373689 , y0=3.1814045501716635 , psi0=0.42018369913004483 , v0=3.000000029999436 , spline0=6.1484849005938615 , a0=0.0 , w0=0.0
2026-01-13 16:39:13,571 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:13,573 - INFO - integration_test - Dyn residual k=0: pred=[5.511970849012472, 3.3037830053422055, 0.42018369913004483, 3.000000029999436, 6.448484903593805], ws=[5.511970846273481, 3.303783004118444, 0.4201836991300447, 3.0, 6.310664612276215], res=[2.7389903678454175e-09, 1.2237615365506826e-09, 1.1102230246251565e-16, 2.999943582437936e-08, 0.1378202913175901], res_norm=1.378e-01
2026-01-13 16:39:13,574 - INFO - integration_test - Dyn residual k=1: pred=[5.785875052173274, 3.4261614580652244, 0.4201836991300447, 3.0, 6.6106646122762145], ws=[5.785875052173274, 3.4261614580652244, 0.4201836991300447, 3.0, 6.514761623120201], res=[0.0, 0.0, 0.0, 0.0, 0.0959029891560137], res_norm=9.590e-02
2026-01-13 16:39:13,575 - INFO - integration_test - Dyn residual k=2: pred=[6.059779258073066, 3.548539912012005, 0.4201836991300447, 3.0, 6.814761623120201], ws=[6.059779258073066, 3.548539912012005, 0.4201836991300447, 3.0, 6.895901188451064], res=[0.0, 0.0, 0.0, 0.0, -0.0811395653308633], res_norm=8.114e-02
2026-01-13 16:39:13,588 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:13,658 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:13,673 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:13,685 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:13,699 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:13,711 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:13,725 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:13,737 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:13,752 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:13,763 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:13,777 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:13,789 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:13,803 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:13,815 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:13,829 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:13,841 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:13,855 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:13,867 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:13,882 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:13,891 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:13,904 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:13,914 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:14,083 - INFO - integration_test - Step 24: MPC solve successful
2026-01-13 16:39:14,165 - INFO - integration_test - Step 24: Computed 6 numeric contouring constraints for visualization (s=6.300)
2026-01-13 16:39:14,165 - DEBUG - integration_test - Step 24: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:14,165 - INFO - integration_test - === Applying control at step 24 ===
2026-01-13 16:39:14,165 - INFO - integration_test -   Control dict from planner: {'a': 2.8064746509674577e-12, 'w': -0.26259174132952645}
2026-01-13 16:39:14,166 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:14,166 - INFO - integration_test -   Planner output success: True
2026-01-13 16:39:14,167 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:14,167 - INFO - integration_test - Step 24 completed in 0.726s
2026-01-13 16:39:14,180 - INFO - integration_test - Step 25 (contouring until path end)
2026-01-13 16:39:14,182 - DEBUG - integration_test - Syncing planner state at step 25: vehicle_state=[5.51354606 3.3001729  0.39392452 3.00000003 6.60000006]
2026-01-13 16:39:14,182 - DEBUG - integration_test - Step 25: Using propagated spline 6.6000 (close to path, dist=0.417m, drift=0.542m)
2026-01-13 16:39:14,182 - DEBUG - integration_test -   Set spline state to 6.6000
2026-01-13 16:39:14,183 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:14,249 - DEBUG - integration_test - Step 25: Checking path alignment: vehicle=(5.514, 3.300), path_start=(0.000, 0.000), dist=6.426m
2026-01-13 16:39:14,249 - INFO - integration_test - === Calling planner.solve_mpc() at step 25 ===
2026-01-13 16:39:14,302 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:14,311 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:14,311 - INFO - integration_test - Warmstart k=0: x0=5.513546058221234 , y0=3.300172899108302 , psi0=0.3939245249970922 , v0=3.0000000299997165 , spline0=6.347474802583732 , a0=0.0 , w0=0.0
2026-01-13 16:39:14,311 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:14,312 - INFO - integration_test - Dyn residual k=0: pred=[5.790569025615738, 3.4153174922767464, 0.3939245249970922, 3.0000000299997165, 6.647474805583704], ws=[5.790569022845535, 3.4153174911253115, 0.3939245249970922, 3.0, 6.754893940908899], res=[2.7702027338705193e-09, 1.1514349473884522e-09, 0.0, 2.9999716488759987e-08, -0.10741913532519565], res_norm=1.074e-01
2026-01-13 16:39:14,313 - INFO - integration_test - Dyn residual k=1: pred=[6.067591987469835, 3.530462083142321, 0.3939245249970922, 3.0, 7.054893940908899], ws=[6.067591987469836, 3.530462083142321, 0.3939245249970922, 3.0, 6.934618621539805], res=[-8.881784197001252e-16, 0.0, 0.0, 0.0, 0.12027531936909419], res_norm=1.203e-01
2026-01-13 16:39:14,314 - INFO - integration_test - Dyn residual k=2: pred=[6.344614952094136, 3.6456066751593306, 0.3939245249970922, 3.0, 7.234618621539805], ws=[6.344614952094137, 3.6456066751593306, 0.3939245249970922, 3.0, 7.387556246297511], res=[-8.881784197001252e-16, 0.0, 0.0, 0.0, -0.15293762475770656], res_norm=1.529e-01
2026-01-13 16:39:14,328 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:14,398 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:14,413 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:14,424 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:14,440 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:14,452 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:14,467 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:14,478 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:14,492 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:14,504 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:14,518 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:14,530 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:14,544 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:14,556 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:14,571 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:14,583 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:14,598 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:14,609 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:14,624 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:14,634 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:14,648 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:14,658 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:14,818 - INFO - integration_test - Step 25: MPC solve successful
2026-01-13 16:39:14,902 - INFO - integration_test - Step 25: Computed 6 numeric contouring constraints for visualization (s=6.600)
2026-01-13 16:39:14,902 - DEBUG - integration_test - Step 25: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:14,902 - INFO - integration_test - === Applying control at step 25 ===
2026-01-13 16:39:14,902 - INFO - integration_test -   Control dict from planner: {'a': 8.272882802943705e-13, 'w': -0.28346771920572555}
2026-01-13 16:39:14,902 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:14,902 - INFO - integration_test -   Planner output success: True
2026-01-13 16:39:14,903 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:14,904 - INFO - integration_test - Step 25 completed in 0.722s
2026-01-13 16:39:14,918 - INFO - integration_test - Step 26 (contouring until path end)
2026-01-13 16:39:14,919 - DEBUG - integration_test - Syncing planner state at step 26: vehicle_state=[5.79216381 3.41137598 0.36557775 3.00000003 6.90000006]
2026-01-13 16:39:14,920 - DEBUG - integration_test - Step 26: Using propagated spline 6.9000 (close to path, dist=0.489m, drift=0.236m)
2026-01-13 16:39:14,920 - DEBUG - integration_test -   Set spline state to 6.9000
2026-01-13 16:39:14,921 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:14,986 - DEBUG - integration_test - Step 26: Checking path alignment: vehicle=(5.792, 3.411), path_start=(0.000, 0.000), dist=6.722m
2026-01-13 16:39:14,986 - INFO - integration_test - === Calling planner.solve_mpc() at step 26 ===
2026-01-13 16:39:15,039 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:15,049 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:15,049 - INFO - integration_test - Warmstart k=0: x0=5.792163806836147 , y0=3.4113759818547083 , psi0=0.36557775307651963 , v0=3.000000029999799 , spline0=6.748484906593813 , a0=0.0 , w0=0.0
2026-01-13 16:39:15,049 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:15,050 - INFO - integration_test - Dyn residual k=0: pred=[6.072339022653429, 3.518622661251916, 0.36557775307651963, 3.000000029999799, 7.0484849095937925], ws=[6.072339019851695, 3.5186226601794566, 0.3655777530765194, 3.0, 6.905597928069289], res=[2.8017339559482934e-09, 1.0724594545763466e-09, 2.220446049250313e-16, 2.999979908935302e-08, 0.1428869815245033], res_norm=1.429e-01
2026-01-13 16:39:15,051 - INFO - integration_test - Dyn residual k=1: pred=[6.352514232867243, 3.625869338504205, 0.3655777530765194, 3.0, 7.205597928069289], ws=[6.352514232867243, 3.625869338504205, 0.3655777530765194, 3.0, 7.105820552724922], res=[0.0, 0.0, 0.0, 0.0, 0.0997773753443667], res_norm=9.978e-02
2026-01-13 16:39:15,051 - INFO - integration_test - Dyn residual k=2: pred=[6.632689445882791, 3.733116016828953, 0.3655777530765194, 3.0, 7.405820552724922], ws=[6.632689445882791, 3.733116016828953, 0.3655777530765194, 3.0, 7.280392145084008], res=[0.0, 0.0, 0.0, 0.0, 0.12542840764091423], res_norm=1.254e-01
2026-01-13 16:39:15,065 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:15,135 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:15,150 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:15,161 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:15,176 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:15,187 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:15,202 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:15,213 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:15,228 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:15,240 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:15,254 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:15,266 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:15,280 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:15,291 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:15,306 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:15,318 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:15,333 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:15,345 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:15,359 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:15,369 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:15,383 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:15,392 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:15,574 - INFO - integration_test - Step 26: MPC solve successful
2026-01-13 16:39:15,660 - INFO - integration_test - Step 26: Computed 6 numeric contouring constraints for visualization (s=6.900)
2026-01-13 16:39:15,660 - DEBUG - integration_test - Step 26: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:15,660 - INFO - integration_test - === Applying control at step 26 ===
2026-01-13 16:39:15,660 - INFO - integration_test -   Control dict from planner: {'a': 3.8209647297086865e-13, 'w': -0.2654849143135479}
2026-01-13 16:39:15,660 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:15,660 - INFO - integration_test -   Planner output success: True
2026-01-13 16:39:15,661 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:15,662 - INFO - integration_test - Step 26 completed in 0.743s
2026-01-13 16:39:15,674 - INFO - integration_test - Step 27 (contouring until path end)
2026-01-13 16:39:15,676 - DEBUG - integration_test - Syncing planner state at step 27: vehicle_state=[6.07372965 3.51489117 0.33902926 3.00000003 7.20000006]
2026-01-13 16:39:15,676 - DEBUG - integration_test - Step 27: Using propagated spline 7.2000 (close to path, dist=0.453m, drift=0.536m)
2026-01-13 16:39:15,676 - DEBUG - integration_test -   Set spline state to 7.2000
2026-01-13 16:39:15,677 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:15,743 - DEBUG - integration_test - Step 27: Checking path alignment: vehicle=(6.074, 3.515), path_start=(0.000, 0.000), dist=7.017m
2026-01-13 16:39:15,743 - INFO - integration_test - === Calling planner.solve_mpc() at step 27 ===
2026-01-13 16:39:15,796 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:15,806 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:15,806 - INFO - integration_test - Warmstart k=0: x0=6.073729646727241 , y0=3.5148911671830736 , psi0=0.33902926164516484 , v0=3.0000000299998373 , spline0=6.947474808583696 , a0=0.0 , w0=0.0
2026-01-13 16:39:15,806 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:15,808 - INFO - integration_test - Dyn residual k=0: pred=[6.356653034554757, 3.6146626982938614, 0.33902926164516484, 3.0000000299998373, 7.24747481158368], ws=[6.356653031725539, 3.6146626972961515, 0.33902926164516467, 3.0, 7.3516880196102115], res=[2.829217748967494e-09, 9.977099146851742e-10, 1.6653345369377348e-16, 2.9999837281025066e-08, -0.10421320802653167], res_norm=1.042e-01
2026-01-13 16:39:15,809 - INFO - integration_test - Dyn residual k=1: pred=[6.639576416723838, 3.714434227409229, 0.33902926164516467, 3.0, 7.651688019610211], ws=[6.639576416723838, 3.714434227409229, 0.33902926164516467, 3.0, 7.5276126508125305], res=[0.0, 0.0, 0.0, 0.0, 0.12407536879768077], res_norm=1.241e-01
2026-01-13 16:39:15,809 - INFO - integration_test - Dyn residual k=2: pred=[6.922499801722136, 3.8142057575223065, 0.33902926164516467, 3.0, 7.82761265081253], ws=[6.922499801722136, 3.8142057575223065, 0.33902926164516467, 3.0, 7.9761763972932025], res=[0.0, 0.0, 0.0, 0.0, -0.14856374648067217], res_norm=1.486e-01
2026-01-13 16:39:15,824 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:15,900 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:15,924 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:15,944 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:15,968 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:15,988 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:16,015 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:16,030 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:16,052 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:16,070 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:16,089 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:16,103 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:16,120 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:16,133 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:16,151 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:16,173 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:16,192 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:16,205 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:16,223 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:16,236 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:16,252 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:16,263 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:16,492 - INFO - integration_test - Step 27: MPC solve successful
2026-01-13 16:39:16,769 - INFO - integration_test - Step 27: Computed 6 numeric contouring constraints for visualization (s=7.200)
2026-01-13 16:39:16,770 - DEBUG - integration_test - Step 27: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:16,770 - INFO - integration_test - === Applying control at step 27 ===
2026-01-13 16:39:16,770 - INFO - integration_test -   Control dict from planner: {'a': 2.510988407577298e-13, 'w': -0.2710333010048185}
2026-01-13 16:39:16,770 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:16,770 - INFO - integration_test -   Planner output success: True
2026-01-13 16:39:16,771 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:16,771 - INFO - integration_test - Step 27 completed in 1.096s
2026-01-13 16:39:16,784 - INFO - integration_test - Step 28 (contouring until path end)
2026-01-13 16:39:16,785 - DEBUG - integration_test - Syncing planner state at step 28: vehicle_state=[6.35797038 3.61081664 0.31192593 3.00000003 7.50000006]
2026-01-13 16:39:16,786 - DEBUG - integration_test - Step 28: Using propagated spline 7.5000 (close to path, dist=0.522m, drift=0.230m)
2026-01-13 16:39:16,786 - DEBUG - integration_test -   Set spline state to 7.5000
2026-01-13 16:39:16,787 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:16,853 - DEBUG - integration_test - Step 28: Checking path alignment: vehicle=(6.358, 3.611), path_start=(0.000, 0.000), dist=7.312m
2026-01-13 16:39:16,853 - INFO - integration_test - === Calling planner.solve_mpc() at step 28 ===
2026-01-13 16:39:16,904 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:16,914 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:16,914 - INFO - integration_test - Warmstart k=0: x0=6.357970384679674 , y0=3.6108166352715707 , psi0=0.311925931544683 , v0=3.0000000299998626 , spline0=7.348484912593784 , a0=0.0 , w0=0.0
2026-01-13 16:39:16,914 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:16,915 - INFO - integration_test - Dyn residual k=0: pred=[6.643493672133351, 3.7028842958350734, 0.311925931544683, 3.0000000299998626, 7.6484849155937695], ws=[6.643493669278132, 3.702884294914401, 0.3119259315446832, 3.0, 7.501545817866917], res=[2.8552191722042153e-09, 9.206724271848543e-10, -1.6653345369377348e-16, 2.999986259411003e-08, 0.1469390977268521], res_norm=1.469e-01
2026-01-13 16:39:16,916 - INFO - integration_test - Dyn residual k=1: pred=[6.92901695387659, 3.794951954557231, 0.3119259315446832, 3.0, 7.801545817866917], ws=[6.92901695387659, 3.794951954557231, 0.3119259315446832, 3.0, 8.001856356276557], res=[0.0, 0.0, 0.0, 0.0, -0.20031053840963953], res_norm=2.003e-01
2026-01-13 16:39:16,916 - INFO - integration_test - Dyn residual k=2: pred=[7.214540238475048, 3.8870196142000615, 0.3119259315446832, 3.0, 8.301856356276557], ws=[7.214540238475048, 3.8870196142000615, 0.3119259315446832, 3.0, 8.172995697063493], res=[0.0, 0.0, 0.0, 0.0, 0.1288606592130641], res_norm=1.289e-01
2026-01-13 16:39:16,931 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:17,000 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:17,015 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:17,027 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:17,043 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:17,054 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:17,069 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:17,081 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:17,095 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:17,107 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:17,121 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:17,133 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:17,149 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:17,161 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:17,175 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:17,187 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:17,201 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:17,213 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:17,229 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:17,239 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:17,252 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:17,262 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:17,453 - INFO - integration_test - Step 28: MPC solve successful
2026-01-13 16:39:17,547 - INFO - integration_test - Step 28: Computed 6 numeric contouring constraints for visualization (s=7.500)
2026-01-13 16:39:17,547 - DEBUG - integration_test - Step 28: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:17,547 - INFO - integration_test - === Applying control at step 28 ===
2026-01-13 16:39:17,547 - INFO - integration_test -   Control dict from planner: {'a': 9.166748210098944e-14, 'w': -0.3039329953972351}
2026-01-13 16:39:17,547 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:17,547 - INFO - integration_test -   Planner output success: True
2026-01-13 16:39:17,548 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:17,548 - INFO - integration_test - Step 28 completed in 0.763s
2026-01-13 16:39:17,561 - INFO - integration_test - Step 29 (contouring until path end)
2026-01-13 16:39:17,563 - DEBUG - integration_test - Syncing planner state at step 29: vehicle_state=[6.64484873 3.69853146 0.28153263 3.00000003 7.80000007]
2026-01-13 16:39:17,563 - DEBUG - integration_test - Step 29: Using propagated spline 7.8000 (close to path, dist=0.492m, drift=0.530m)
2026-01-13 16:39:17,563 - DEBUG - integration_test -   Set spline state to 7.8000
2026-01-13 16:39:17,564 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:17,629 - DEBUG - integration_test - Step 29: Checking path alignment: vehicle=(6.645, 3.699), path_start=(0.000, 0.000), dist=7.605m
2026-01-13 16:39:17,629 - INFO - integration_test - === Calling planner.solve_mpc() at step 29 ===
2026-01-13 16:39:17,681 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:17,690 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:17,690 - INFO - integration_test - Warmstart k=0: x0=6.644848727725393 , y0=3.6985314584939046 , psi0=0.2815326320049595 , v0=3.000000029999872 , spline0=7.547474814583669 , a0=0.0 , w0=0.0
2026-01-13 16:39:17,690 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:17,692 - INFO - integration_test - Dyn residual k=0: pred=[6.933037958074552, 3.7818799396483427, 0.2815326320049595, 3.000000029999872, 7.847474817583656], ws=[6.933037955192672, 3.781879938814862, 0.28153263200495937, 3.0, 7.74729889544199], res=[2.881879623828354e-09, 8.334808399013127e-10, 1.1102230246251565e-16, 2.9999871919983434e-08, 0.10017592214166626], res_norm=1.002e-01
2026-01-13 16:39:17,693 - INFO - integration_test - Dyn residual k=1: pred=[7.221227182659951, 3.8652284191358186, 0.28153263200495937, 3.0, 8.04729889544199], ws=[7.221227182659951, 3.8652284191358186, 0.28153263200495937, 3.0, 8.122447111735992], res=[0.0, 0.0, 0.0, 0.0, -0.07514821629400181], res_norm=7.515e-02
2026-01-13 16:39:17,693 - INFO - integration_test - Dyn residual k=2: pred=[7.50941641012723, 3.9485768994567754, 0.28153263200495937, 3.0, 8.422447111735993], ws=[7.50941641012723, 3.948576899456776, 0.28153263200495937, 3.0, 8.567855635179757], res=[0.0, -4.440892098500626e-16, 0.0, 0.0, -0.14540852344376454], res_norm=1.454e-01
2026-01-13 16:39:17,707 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:17,778 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:17,793 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:17,804 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:17,819 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:17,831 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:17,846 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:17,857 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:17,873 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:17,885 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:17,900 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:17,912 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:17,928 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:17,940 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:17,955 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:17,966 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:17,981 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:17,992 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:18,007 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:18,017 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:18,030 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:18,041 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:18,195 - INFO - integration_test - Step 29: MPC solve successful
2026-01-13 16:39:18,294 - INFO - integration_test - Step 29: Computed 6 numeric contouring constraints for visualization (s=7.800)
2026-01-13 16:39:18,295 - DEBUG - integration_test - Step 29: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:18,295 - INFO - integration_test - === Applying control at step 29 ===
2026-01-13 16:39:18,295 - INFO - integration_test -   Control dict from planner: {'a': -5.299760965311965e-14, 'w': -0.27867120062653833}
2026-01-13 16:39:18,295 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:18,295 - INFO - integration_test -   Planner output success: True
2026-01-13 16:39:18,296 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:18,296 - INFO - integration_test - Step 29 completed in 0.734s
2026-01-13 16:39:18,310 - INFO - integration_test - Step 30 (contouring until path end)
2026-01-13 16:39:18,312 - DEBUG - integration_test - Syncing planner state at step 30: vehicle_state=[6.93416193 3.77785391 0.25366551 3.00000003 8.10000007]
2026-01-13 16:39:18,312 - DEBUG - integration_test - Step 30: Using propagated spline 8.1000 (close to path, dist=0.533m, drift=0.225m)
2026-01-13 16:39:18,312 - DEBUG - integration_test -   Set spline state to 8.1000
2026-01-13 16:39:18,313 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:18,380 - DEBUG - integration_test - Step 30: Checking path alignment: vehicle=(6.934, 3.778), path_start=(0.000, 0.000), dist=7.897m
2026-01-13 16:39:18,380 - INFO - integration_test - === Calling planner.solve_mpc() at step 30 ===
2026-01-13 16:39:18,434 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:18,443 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:18,443 - INFO - integration_test - Warmstart k=0: x0=6.934161925336985 , y0=3.7778539102540023 , psi0=0.25366551194230563 , v0=3.0000000299998666 , spline0=7.746464716573555 , a0=0.0 , w0=0.0
2026-01-13 16:39:18,443 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:18,445 - INFO - integration_test - Dyn residual k=0: pred=[7.224561643972543, 3.853140065796576, 0.25366551194230563, 3.0000000299998666, 8.04646471957354], ws=[7.22456164106856, 3.8531400650437178, 0.2536655119423057, 3.0, 8.199522431326525], res=[2.903983720159431e-09, 7.528582202098733e-10, -5.551115123125783e-17, 2.9999866590912916e-08, -0.1530577117529841], res_norm=1.531e-01
2026-01-13 16:39:18,445 - INFO - integration_test - Dyn residual k=1: pred=[7.514961356800134, 3.928426219833433, 0.2536655119423057, 3.0, 8.499522431326525], ws=[7.514961356800134, 3.928426219833433, 0.2536655119423057, 3.0, 8.596811048224023], res=[0.0, 0.0, 0.0, 0.0, -0.09728861689749735], res_norm=9.729e-02
2026-01-13 16:39:18,446 - INFO - integration_test - Dyn residual k=2: pred=[7.805361072531708, 4.003712374623149, 0.2536655119423057, 3.0, 8.896811048224023], ws=[7.805361072531708, 4.003712374623149, 0.2536655119423057, 3.0, 8.765604551869153], res=[0.0, 0.0, 0.0, 0.0, 0.1312064963548707], res_norm=1.312e-01
2026-01-13 16:39:18,460 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:18,532 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:18,547 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:18,559 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:18,575 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:18,586 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:18,602 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:18,614 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:18,631 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:18,643 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:18,659 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:18,671 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:18,685 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:18,697 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:18,711 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:18,723 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:18,738 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:18,750 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:18,766 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:18,776 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:18,789 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:18,800 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:18,966 - INFO - integration_test - Step 30: MPC solve successful
2026-01-13 16:39:19,063 - INFO - integration_test - Step 30: Computed 6 numeric contouring constraints for visualization (s=8.100)
2026-01-13 16:39:19,063 - DEBUG - integration_test - Step 30: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:19,063 - INFO - integration_test - === Applying control at step 30 ===
2026-01-13 16:39:19,063 - INFO - integration_test -   Control dict from planner: {'a': 9.072201425967127e-14, 'w': -0.28698780005072666}
2026-01-13 16:39:19,063 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:19,063 - INFO - integration_test -   Planner output success: True
2026-01-13 16:39:19,064 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:19,064 - INFO - integration_test - Step 30 completed in 0.753s
2026-01-13 16:39:19,077 - INFO - integration_test - Step 31 (contouring until path end)
2026-01-13 16:39:19,079 - DEBUG - integration_test - Syncing planner state at step 31: vehicle_state=[7.22560202 3.84896296 0.22496673 3.00000003 8.40000007]
2026-01-13 16:39:19,080 - DEBUG - integration_test - Step 31: Using propagated spline 8.4000 (close to path, dist=0.544m, drift=0.081m)
2026-01-13 16:39:19,080 - DEBUG - integration_test -   Set spline state to 8.4000
2026-01-13 16:39:19,080 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:19,147 - DEBUG - integration_test - Step 31: Checking path alignment: vehicle=(7.226, 3.849), path_start=(0.000, 0.000), dist=8.187m
2026-01-13 16:39:19,147 - INFO - integration_test - === Calling planner.solve_mpc() at step 31 ===
2026-01-13 16:39:19,201 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:19,211 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:19,211 - INFO - integration_test - Warmstart k=0: x0=7.225602018777261 , y0=3.8489629588875536 , psi0=0.22496673193723296 , v0=3.0000000299998755 , spline0=8.147474820583643 , a0=0.0 , w0=0.0
2026-01-13 16:39:19,211 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:19,212 - INFO - integration_test - Dyn residual k=0: pred=[7.518042480355444, 3.9158851393057974, 0.22496673193723296, 3.0000000299998755, 8.44747482358363], ws=[7.5180424774310515, 3.9158851386365785, 0.22496673193723282, 3.0, 8.345747617612009], res=[2.9243922838873004e-09, 6.692189025159223e-10, 1.3877787807814457e-16, 2.999987547269711e-08, 0.10172720597162055], res_norm=1.017e-01
2026-01-13 16:39:19,212 - INFO - integration_test - Dyn residual k=1: pred=[7.810482936084842, 3.9828073183856034, 0.22496673193723282, 3.0, 8.64574761761201], ws=[7.810482936084842, 3.9828073183856034, 0.22496673193723282, 3.0, 9.022103371757087], res=[0.0, 0.0, 0.0, 0.0, -0.37635575414507727], res_norm=3.764e-01
2026-01-13 16:39:19,213 - INFO - integration_test - Dyn residual k=2: pred=[8.102923394738632, 4.049729498134628, 0.22496673193723282, 3.0, 9.322103371757088], ws=[8.102923394738632, 4.049729498134628, 0.22496673193723282, 3.0, 8.960464105419147], res=[0.0, 0.0, 0.0, 0.0, 0.3616392663379404], res_norm=3.616e-01
2026-01-13 16:39:19,227 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:19,300 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:19,315 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:19,326 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:19,343 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:19,354 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:19,369 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:19,381 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:19,397 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:19,410 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:19,425 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:19,437 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:19,452 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:19,464 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:19,479 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:19,491 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:19,506 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:19,518 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:19,534 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:19,544 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:19,557 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:19,567 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:19,731 - INFO - integration_test - Step 31: MPC solve successful
2026-01-13 16:39:19,825 - INFO - integration_test - Step 31: Computed 6 numeric contouring constraints for visualization (s=8.400)
2026-01-13 16:39:19,825 - DEBUG - integration_test - Step 31: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:19,826 - INFO - integration_test - === Applying control at step 31 ===
2026-01-13 16:39:19,826 - INFO - integration_test -   Control dict from planner: {'a': -3.123905192788689e-14, 'w': -0.2816475123256316}
2026-01-13 16:39:19,826 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:19,826 - INFO - integration_test -   Planner output success: True
2026-01-13 16:39:19,827 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:19,827 - INFO - integration_test - Step 31 completed in 0.749s
2026-01-13 16:39:19,839 - INFO - integration_test - Step 32 (contouring until path end)
2026-01-13 16:39:19,842 - DEBUG - integration_test - Syncing planner state at step 32: vehicle_state=[7.51894618 3.91175831 0.19680198 3.00000003 8.70000008]
2026-01-13 16:39:19,843 - DEBUG - integration_test - Step 32: Using propagated spline 8.7000 (close to path, dist=0.570m, drift=0.219m)
2026-01-13 16:39:19,843 - DEBUG - integration_test -   Set spline state to 8.7000
2026-01-13 16:39:19,844 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:19,910 - DEBUG - integration_test - Step 32: Checking path alignment: vehicle=(7.519, 3.912), path_start=(0.000, 0.000), dist=8.476m
2026-01-13 16:39:19,910 - INFO - integration_test - === Calling planner.solve_mpc() at step 32 ===
2026-01-13 16:39:19,963 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:19,973 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:19,973 - INFO - integration_test - Warmstart k=0: x0=7.518946179715417 , y0=3.9117583077671436 , psi0=0.1968019807046698 , v0=3.0000000299998724 , spline0=8.34646472257353 , a0=0.0 , w0=0.0
2026-01-13 16:39:19,973 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:19,975 - INFO - integration_test - Dyn residual k=0: pred=[7.813155256672969, 3.9704185228688447, 0.1968019807046698, 3.0000000299998724, 8.646464725573516], ws=[7.813155253730891, 3.970418522282245, 0.1968019807046697, 3.0, 8.797449732407484], res=[2.942078580758789e-09, 5.86599657736997e-10, 1.1102230246251565e-16, 2.9999872364072644e-08, -0.15098500683396843], res_norm=1.510e-01
2026-01-13 16:39:19,975 - INFO - integration_test - Dyn residual k=1: pred=[8.107364327746364, 4.029078736797346, 0.1968019807046697, 3.0, 9.097449732407485], ws=[8.107364327746364, 4.029078736797346, 0.1968019807046697, 3.0, 9.213415745236581], res=[0.0, 0.0, 0.0, 0.0, -0.11596601282909624], res_norm=1.160e-01
2026-01-13 16:39:19,976 - INFO - integration_test - Dyn residual k=2: pred=[8.401573401761837, 4.087738951312447, 0.1968019807046697, 3.0, 9.513415745236582], ws=[8.401573401761837, 4.087738951312447, 0.1968019807046697, 3.0, 9.370504904008676], res=[0.0, 0.0, 0.0, 0.0, 0.14291084122790565], res_norm=1.429e-01
2026-01-13 16:39:19,990 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:20,060 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:20,075 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:20,086 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:20,104 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:20,119 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:20,139 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:20,155 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:20,173 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:20,186 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:20,201 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:20,213 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:20,229 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:20,241 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:20,256 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:20,267 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:20,282 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:20,293 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:20,308 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:20,318 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:20,331 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:20,342 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:20,504 - INFO - integration_test - Step 32: MPC solve successful
2026-01-13 16:39:20,605 - INFO - integration_test - Step 32: Computed 6 numeric contouring constraints for visualization (s=8.700)
2026-01-13 16:39:20,605 - DEBUG - integration_test - Step 32: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:20,605 - INFO - integration_test - === Applying control at step 32 ===
2026-01-13 16:39:20,606 - INFO - integration_test -   Control dict from planner: {'a': 7.658629783723462e-14, 'w': -0.25373260590742047}
2026-01-13 16:39:20,606 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:20,606 - INFO - integration_test -   Planner output success: True
2026-01-13 16:39:20,607 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:20,607 - INFO - integration_test - Step 32 completed in 0.766s
2026-01-13 16:39:20,619 - INFO - integration_test - Step 33 (contouring until path end)
2026-01-13 16:39:20,621 - DEBUG - integration_test - Syncing planner state at step 33: vehicle_state=[7.81386785 3.96667991 0.17142872 3.00000003 9.00000008]
2026-01-13 16:39:20,621 - DEBUG - integration_test - Step 33: Using propagated spline 9.0000 (close to path, dist=0.580m, drift=0.087m)
2026-01-13 16:39:20,621 - DEBUG - integration_test -   Set spline state to 9.0000
2026-01-13 16:39:20,622 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:20,688 - DEBUG - integration_test - Step 33: Checking path alignment: vehicle=(7.814, 3.967), path_start=(0.000, 0.000), dist=8.763m
2026-01-13 16:39:20,688 - INFO - integration_test - === Calling planner.solve_mpc() at step 33 ===
2026-01-13 16:39:20,741 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:20,753 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:20,753 - INFO - integration_test - Warmstart k=0: x0=7.813867849518662 , y0=3.9666799072725993 , psi0=0.17142872011392776 , v0=3.00000002999988 , spline0=8.747474826583618 , a0=0.0 , w0=0.0
2026-01-13 16:39:20,753 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:20,754 - INFO - integration_test - Dyn residual k=0: pred=[8.109470466532326, 4.0178569979936025, 0.17142872011392776, 3.00000002999988, 9.047474829583606], ws=[8.109470463576312, 4.017856997481834, 0.17142872011392774, 3.0, 8.944984881471031], res=[2.956014100163884e-09, 5.117684054312122e-10, 2.7755575615628914e-17, 2.999987991358921e-08, 0.10248994811257539], res_norm=1.025e-01
2026-01-13 16:39:20,755 - INFO - integration_test - Dyn residual k=1: pred=[8.405073077633961, 4.069034087691069, 0.17142872011392774, 3.0, 9.244984881471032], ws=[8.405073077633961, 4.069034087691069, 0.17142872011392774, 3.0, 9.62046148692335], res=[0.0, 0.0, 0.0, 0.0, -0.3754766054523184], res_norm=3.755e-01
2026-01-13 16:39:20,756 - INFO - integration_test - Dyn residual k=2: pred=[8.700675691691611, 4.120211177900304, 0.17142872011392774, 3.0, 9.920461486923351], ws=[8.700675691691611, 4.120211177900304, 0.17142872011392774, 3.0, 9.557929096352657], res=[0.0, 0.0, 0.0, 0.0, 0.36253239057069386], res_norm=3.625e-01
2026-01-13 16:39:20,774 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:20,855 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:20,870 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:20,882 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:20,896 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:20,908 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:20,923 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:20,935 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:20,950 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:20,961 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:20,976 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:20,987 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:21,002 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:21,015 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:21,030 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:21,041 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:21,057 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:21,069 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:21,084 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:21,094 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:21,106 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:21,117 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:21,296 - INFO - integration_test - Step 33: MPC solve successful
2026-01-13 16:39:21,402 - INFO - integration_test - Step 33: Computed 6 numeric contouring constraints for visualization (s=9.000)
2026-01-13 16:39:21,402 - DEBUG - integration_test - Step 33: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:21,403 - INFO - integration_test - === Applying control at step 33 ===
2026-01-13 16:39:21,403 - INFO - integration_test -   Control dict from planner: {'a': -4.2290656289547644e-14, 'w': -0.30831505809280385}
2026-01-13 16:39:21,403 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:21,403 - INFO - integration_test -   Planner output success: True
2026-01-13 16:39:21,404 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:21,404 - INFO - integration_test - Step 33 completed in 0.784s
2026-01-13 16:39:21,422 - INFO - integration_test - Step 34 (contouring until path end)
2026-01-13 16:39:21,429 - DEBUG - integration_test - Syncing planner state at step 34: vehicle_state=[8.11021251 4.01329231 0.14059721 3.00000003 9.30000008]
2026-01-13 16:39:21,429 - DEBUG - integration_test - Step 34: Using propagated spline 9.3000 (close to path, dist=0.604m, drift=0.213m)
2026-01-13 16:39:21,429 - DEBUG - integration_test -   Set spline state to 9.3000
2026-01-13 16:39:21,430 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:21,502 - DEBUG - integration_test - Step 34: Checking path alignment: vehicle=(8.110, 4.013), path_start=(0.000, 0.000), dist=9.049m
2026-01-13 16:39:21,502 - INFO - integration_test - === Calling planner.solve_mpc() at step 34 ===
2026-01-13 16:39:21,555 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:21,564 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:21,564 - INFO - integration_test - Warmstart k=0: x0=8.110212507333745 , y0=4.013292314457307 , psi0=0.1405972143046474 , v0=3.0000000299998755 , spline0=8.946464728573503 , a0=0.0 , w0=0.0
2026-01-13 16:39:21,564 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:21,565 - INFO - integration_test - Dyn residual k=0: pred=[8.407252255049858, 4.0553326531422025, 0.1405972143046474, 3.0000000299998755, 9.24646473157349], ws=[8.407252252079473, 4.055332652721801, 0.14059721430464744, 3.0, 9.598296230147508], res=[2.970384826994632e-09, 4.204014913966603e-10, -5.551115123125783e-17, 2.999987547269711e-08, -0.3518314985740183], res_norm=3.518e-01
2026-01-13 16:39:21,566 - INFO - integration_test - Dyn residual k=1: pred=[8.704291996825201, 4.097372990986295, 0.14059721430464744, 3.0, 9.898296230147508], ws=[8.704291996825201, 4.097372990986295, 0.14059721430464744, 3.0, 9.810999914146496], res=[0.0, 0.0, 0.0, 0.0, 0.08729631600101229], res_norm=8.730e-02
2026-01-13 16:39:21,567 - INFO - integration_test - Dyn residual k=2: pred=[9.00133174157093, 4.139413329250789, 0.14059721430464744, 3.0, 10.110999914146497], ws=[9.00133174157093, 4.139413329250789, 0.14059721430464744, 3.0, 9.96753310539972], res=[0.0, 0.0, 0.0, 0.0, 0.1434668087467763], res_norm=1.435e-01
2026-01-13 16:39:21,581 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:21,651 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:21,667 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:21,679 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:21,694 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:21,705 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:21,720 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:21,732 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:21,746 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:21,758 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:21,772 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:21,784 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:21,798 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:21,810 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:21,824 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:21,837 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:21,852 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:21,864 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:21,879 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:21,889 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:21,902 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:21,912 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:22,119 - INFO - integration_test - Step 34: MPC solve successful
2026-01-13 16:39:22,224 - INFO - integration_test - Step 34: Computed 6 numeric contouring constraints for visualization (s=9.300)
2026-01-13 16:39:22,225 - DEBUG - integration_test - Step 34: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:22,225 - INFO - integration_test - === Applying control at step 34 ===
2026-01-13 16:39:22,225 - INFO - integration_test -   Control dict from planner: {'a': 3.2229656106549755e-14, 'w': -0.26011143529025177}
2026-01-13 16:39:22,225 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:22,225 - INFO - integration_test -   Planner output success: True
2026-01-13 16:39:22,226 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:22,227 - INFO - integration_test - Step 34 completed in 0.798s
2026-01-13 16:39:22,239 - INFO - integration_test - Step 35 (contouring until path end)
2026-01-13 16:39:22,240 - DEBUG - integration_test - Syncing planner state at step 35: vehicle_state=[8.40776549 4.05146496 0.11458607 3.00000003 9.60000009]
2026-01-13 16:39:22,241 - DEBUG - integration_test - Step 35: Using propagated spline 9.6000 (close to path, dist=0.614m, drift=0.093m)
2026-01-13 16:39:22,241 - DEBUG - integration_test -   Set spline state to 9.6000
2026-01-13 16:39:22,242 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:22,308 - DEBUG - integration_test - Step 35: Checking path alignment: vehicle=(8.408, 4.051), path_start=(0.000, 0.000), dist=9.333m
2026-01-13 16:39:22,309 - INFO - integration_test - === Calling planner.solve_mpc() at step 35 ===
2026-01-13 16:39:22,362 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:22,371 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:22,371 - INFO - integration_test - Warmstart k=0: x0=8.407765488873892 , y0=4.051464958753984 , psi0=0.11458607077562222 , v0=3.0000000299998786 , spline0=9.347474832583593 , a0=0.0 , w0=0.0
2026-01-13 16:39:22,371 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:22,372 - INFO - integration_test - Dyn residual k=0: pred=[8.70579815071953, 4.085765604129779, 0.11458607077562222, 3.0000000299998786, 9.647474835583582], ws=[8.705798147739216, 4.085765603786774, 0.11458607077562233, 3.0, 9.542988021219625], res=[2.9803146617268794e-09, 3.4300562390399136e-10, -1.1102230246251565e-16, 2.999987858132158e-08, 0.10448681436395724], res_norm=1.045e-01
2026-01-13 16:39:22,373 - INFO - integration_test - Dyn residual k=1: pred=[9.00383080660454, 4.1200662488195645, 0.11458607077562233, 3.0, 9.842988021219625], ws=[9.00383080660454, 4.1200662488195645, 0.11458607077562233, 3.0, 9.981618128001825], res=[0.0, 0.0, 0.0, 0.0, -0.1386301067822], res_norm=1.386e-01
2026-01-13 16:39:22,374 - INFO - integration_test - Dyn residual k=2: pred=[9.301863465469864, 4.154366893852355, 0.11458607077562233, 3.0, 10.281618128001826], ws=[9.301863465469864, 4.154366893852355, 0.11458607077562233, 3.0, 10.384075857823682], res=[0.0, 0.0, 0.0, 0.0, -0.10245772982185564], res_norm=1.025e-01
2026-01-13 16:39:22,388 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:22,458 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:22,474 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:22,485 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:22,500 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:22,511 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:22,526 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:22,538 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:22,552 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:22,564 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:22,579 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:22,590 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:22,605 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:22,617 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:22,631 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:22,643 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:22,657 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:22,669 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:22,684 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:22,694 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:22,706 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:22,717 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:22,891 - INFO - integration_test - Step 35: MPC solve successful
2026-01-13 16:39:23,226 - INFO - integration_test - Step 35: Computed 6 numeric contouring constraints for visualization (s=9.600)
2026-01-13 16:39:23,226 - DEBUG - integration_test - Step 35: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:23,226 - INFO - integration_test - === Applying control at step 35 ===
2026-01-13 16:39:23,226 - INFO - integration_test -   Control dict from planner: {'a': -7.009709544518114e-14, 'w': -0.2594817259349337}
2026-01-13 16:39:23,226 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:23,226 - INFO - integration_test -   Planner output success: True
2026-01-13 16:39:23,227 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:23,228 - INFO - integration_test - Step 35 completed in 0.988s
2026-01-13 16:39:23,240 - INFO - integration_test - Step 36 (contouring until path end)
2026-01-13 16:39:23,243 - DEBUG - integration_test - Syncing planner state at step 36: vehicle_state=[8.7062097  4.08189527 0.0886379  3.00000003 9.90000009]
2026-01-13 16:39:23,244 - DEBUG - integration_test - Step 36: Using propagated spline 9.9000 (close to path, dist=0.632m, drift=0.207m)
2026-01-13 16:39:23,244 - DEBUG - integration_test -   Set spline state to 9.9000
2026-01-13 16:39:23,245 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:23,310 - DEBUG - integration_test - Step 36: Checking path alignment: vehicle=(8.706, 4.082), path_start=(0.000, 0.000), dist=9.616m
2026-01-13 16:39:23,310 - INFO - integration_test - === Calling planner.solve_mpc() at step 36 ===
2026-01-13 16:39:23,364 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:23,374 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:23,374 - INFO - integration_test - Warmstart k=0: x0=8.706209701844124 , y0=4.081895270594006 , psi0=0.08863789818212886 , v0=3.0000000299998715 , spline0=9.54646473457348 , a0=0.0 , w0=0.0
2026-01-13 16:39:23,374 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:23,375 - INFO - integration_test - Dyn residual k=0: pred=[9.005031974673336, 4.10845183402334, 0.08863789818212886, 3.0000000299998715, 9.846464737573466], ws=[9.005031971685126, 4.108451833757775, 0.08863789818212897, 3.0, 10.19800186654195], res=[2.9882105678780135e-09, 2.6556445931191774e-10, -1.1102230246251565e-16, 2.9999871475894224e-08, -0.3515371289684843], res_norm=3.515e-01
2026-01-13 16:39:23,376 - INFO - integration_test - Dyn residual k=1: pred=[9.303854241526128, 4.1350083969215445, 0.08863789818212897, 3.0, 10.498001866541951], ws=[9.303854241526128, 4.1350083969215445, 0.08863789818212897, 3.0, 10.410478753055308], res=[0.0, 0.0, 0.0, 0.0, 0.08752311348664321], res_norm=8.752e-02
2026-01-13 16:39:23,377 - INFO - integration_test - Dyn residual k=2: pred=[9.60267651136713, 4.161564960085314, 0.08863789818212897, 3.0, 10.710478753055309], ws=[9.60267651136713, 4.161564960085314, 0.08863789818212897, 3.0, 10.567530674250861], res=[0.0, 0.0, 0.0, 0.0, 0.14294807880444793], res_norm=1.429e-01
2026-01-13 16:39:23,390 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:23,461 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:23,476 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:23,487 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:23,502 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:23,514 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:23,528 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:23,539 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:23,554 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:23,566 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:23,580 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:23,592 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:23,606 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:23,618 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:23,633 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:23,644 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:23,659 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:23,671 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:23,685 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:23,695 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:23,708 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:23,718 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:23,921 - INFO - integration_test - Step 36: MPC solve successful
2026-01-13 16:39:24,030 - INFO - integration_test - Step 36: Computed 6 numeric contouring constraints for visualization (s=9.900)
2026-01-13 16:39:24,030 - DEBUG - integration_test - Step 36: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:24,030 - INFO - integration_test - === Applying control at step 36 ===
2026-01-13 16:39:24,030 - INFO - integration_test -   Control dict from planner: {'a': 2.555401125131177e-13, 'w': -0.2509581210246288}
2026-01-13 16:39:24,030 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:24,030 - INFO - integration_test -   Planner output success: True
2026-01-13 16:39:24,031 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:24,032 - INFO - integration_test - Step 36 completed in 0.789s
2026-01-13 16:39:24,046 - INFO - integration_test - Step 37 (contouring until path end)
2026-01-13 16:39:24,047 - DEBUG - integration_test - Syncing planner state at step 37: vehicle_state=[ 9.00533382  4.10469965  0.06354209  3.00000003 10.20000009]
2026-01-13 16:39:24,048 - DEBUG - integration_test - Step 37: Using propagated spline 10.2000 (close to path, dist=0.644m, drift=0.099m)
2026-01-13 16:39:24,048 - DEBUG - integration_test -   Set spline state to 10.2000
2026-01-13 16:39:24,048 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:24,114 - DEBUG - integration_test - Step 37: Checking path alignment: vehicle=(9.005, 4.105), path_start=(0.000, 0.000), dist=9.897m
2026-01-13 16:39:24,114 - INFO - integration_test - === Calling planner.solve_mpc() at step 37 ===
2026-01-13 16:39:24,166 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:24,176 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:24,176 - INFO - integration_test - Warmstart k=0: x0=9.00533382110939 , y0=4.104699649542776 , psi0=0.06354208607966598 , v0=3.0000000299998972 , spline0=9.94747483858357 , a0=0.0 , w0=0.0
2026-01-13 16:39:24,176 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:24,177 - INFO - integration_test - Dyn residual k=0: pred=[9.304728388347739, 4.123749450280748, 0.06354208607966598, 3.0000000299998972, 10.24747484158356], ws=[9.304728385353803, 4.1237494500902505, 0.06354208607966605, 3.0, 10.344713206332568], res=[2.9939357659714005e-09, 1.9049739563570256e-10, -6.938893903907228e-17, 2.9999897233068396e-08, -0.09723836474900693], res_norm=9.724e-02
2026-01-13 16:39:24,177 - INFO - integration_test - Dyn residual k=1: pred=[9.604122949598215, 4.142799250637725, 0.06354208607966605, 3.0, 10.644713206332568], ws=[9.604122949598215, 4.142799250637725, 0.06354208607966605, 3.0, 10.581687833823684], res=[0.0, 0.0, 0.0, 0.0, 0.06302537250888385], res_norm=6.303e-02
2026-01-13 16:39:24,178 - INFO - integration_test - Dyn residual k=2: pred=[9.903517513842628, 4.161849051185199, 0.06354208607966605, 3.0, 10.881687833823685], ws=[9.903517513842628, 4.161849051185199, 0.06354208607966605, 3.0, 10.984659220332421], res=[0.0, 0.0, 0.0, 0.0, -0.10297138650873627], res_norm=1.030e-01
2026-01-13 16:39:24,192 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:24,262 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:24,277 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:24,288 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:24,304 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:24,315 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:24,330 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:24,342 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:24,357 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:24,368 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:24,383 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:24,402 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:24,418 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:24,430 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:24,445 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:24,456 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:24,472 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:24,484 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:24,498 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:24,508 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:24,521 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:24,532 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:24,708 - INFO - integration_test - Step 37: MPC solve successful
2026-01-13 16:39:24,818 - INFO - integration_test - Step 37: Computed 6 numeric contouring constraints for visualization (s=10.200)
2026-01-13 16:39:24,818 - DEBUG - integration_test - Step 37: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:24,818 - INFO - integration_test - === Applying control at step 37 ===
2026-01-13 16:39:24,818 - INFO - integration_test -   Control dict from planner: {'a': 6.89793903058706e-14, 'w': -0.2367886977460109}
2026-01-13 16:39:24,819 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:24,819 - INFO - integration_test -   Planner output success: True
2026-01-13 16:39:24,820 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:24,820 - INFO - integration_test - Step 37 completed in 0.773s
2026-01-13 16:39:24,836 - INFO - integration_test - Step 38 (contouring until path end)
2026-01-13 16:39:24,837 - DEBUG - integration_test - Syncing planner state at step 38: vehicle_state=[ 9.30492594  4.12020317  0.03986322  3.00000003 10.50000009]
2026-01-13 16:39:24,838 - DEBUG - integration_test - Step 38: Using propagated spline 10.5000 (close to path, dist=0.654m, drift=0.201m)
2026-01-13 16:39:24,838 - DEBUG - integration_test -   Set spline state to 10.5000
2026-01-13 16:39:24,839 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:24,904 - DEBUG - integration_test - Step 38: Checking path alignment: vehicle=(9.305, 4.120), path_start=(0.000, 0.000), dist=10.176m
2026-01-13 16:39:24,904 - WARNING - integration_test - Step 38: Vehicle is far from path start (dist=10.176m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:39:24,904 - INFO - integration_test - === Calling planner.solve_mpc() at step 38 ===
2026-01-13 16:39:24,956 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:24,966 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:24,966 - INFO - integration_test - Warmstart k=0: x0=9.30492593963521 , y0=4.120203173297335 , psi0=0.03986321630506489 , v0=3.0000000299999043 , spline0=10.348484942593661 , a0=0.0 , w0=0.0
2026-01-13 16:39:24,966 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:24,967 - INFO - integration_test - Dyn residual k=0: pred=[9.60468761279355, 4.132158971276011, 0.03986321630506489, 3.0000000299999043, 10.648484945593651], ws=[9.604687609795942, 4.1321589711564535, 0.03986321630506495, 3.0, 10.798587996608441], res=[2.997607495558441e-09, 1.1955769707583386e-10, -6.245004513516506e-17, 2.999990433849575e-08, -0.15010305101479027], res_norm=1.501e-01
2026-01-13 16:39:24,968 - INFO - integration_test - Dyn residual k=1: pred=[9.904449279956674, 4.144114769015572, 0.03986321630506495, 3.0, 11.098587996608442], ws=[9.904449279956674, 4.144114769015572, 0.03986321630506495, 3.0, 11.011857654045228], res=[0.0, 0.0, 0.0, 0.0, 0.08673034256321444], res_norm=8.673e-02
2026-01-13 16:39:24,968 - INFO - integration_test - Dyn residual k=2: pred=[10.204210950117407, 4.156070566874691, 0.03986321630506495, 3.0, 11.311857654045228], ws=[10.204210950117407, 4.156070566874691, 0.03986321630506495, 3.0, 11.170550498742637], res=[0.0, 0.0, 0.0, 0.0, 0.14130715530259153], res_norm=1.413e-01
2026-01-13 16:39:24,982 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:25,055 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:25,071 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:25,082 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:25,097 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:25,109 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:25,123 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:25,136 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:25,151 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:25,162 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:25,177 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:25,188 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:25,203 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:25,214 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:25,229 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:25,241 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:25,256 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:25,268 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:25,282 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:25,292 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:25,305 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:25,316 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:25,506 - INFO - integration_test - Step 38: MPC solve successful
2026-01-13 16:39:25,620 - INFO - integration_test - Step 38: Computed 6 numeric contouring constraints for visualization (s=10.500)
2026-01-13 16:39:25,621 - DEBUG - integration_test - Step 38: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:25,621 - INFO - integration_test - === Applying control at step 38 ===
2026-01-13 16:39:25,621 - INFO - integration_test -   Control dict from planner: {'a': -2.883921919239424e-14, 'w': -0.2381950257305564}
2026-01-13 16:39:25,621 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:25,621 - INFO - integration_test -   Planner output success: True
2026-01-13 16:39:25,622 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:25,622 - INFO - integration_test - Step 38 completed in 0.785s
2026-01-13 16:39:25,636 - INFO - integration_test - Step 39 (contouring until path end)
2026-01-13 16:39:25,638 - DEBUG - integration_test - Syncing planner state at step 39: vehicle_state=[ 9.60480165  4.12858792  0.01604371  3.00000003 10.8000001 ]
2026-01-13 16:39:25,638 - DEBUG - integration_test - Step 39: Using propagated spline 10.8000 (close to path, dist=0.669m, drift=0.104m)
2026-01-13 16:39:25,638 - DEBUG - integration_test -   Set spline state to 10.8000
2026-01-13 16:39:25,639 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:25,705 - DEBUG - integration_test - Step 39: Checking path alignment: vehicle=(9.605, 4.129), path_start=(0.000, 0.000), dist=10.455m
2026-01-13 16:39:25,705 - WARNING - integration_test - Step 39: Vehicle is far from path start (dist=10.455m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:39:25,705 - INFO - integration_test - === Calling planner.solve_mpc() at step 39 ===
2026-01-13 16:39:25,758 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:25,767 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:25,768 - INFO - integration_test - Warmstart k=0: x0=9.60480165158073 , y0=4.128587922571981 , psi0=0.016043713732009246 , v0=3.0000000299999017 , spline0=10.547474844583551 , a0=0.0 , w0=0.0
2026-01-13 16:39:25,768 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:25,769 - INFO - integration_test - Dyn residual k=0: pred=[9.90476304529597, 4.1334008302591725, 0.016043713732009246, 3.0000000299999017, 10.847474847583541], ws=[9.904763042296366, 4.133400830211044, 0.0160437137320093, 3.0, 11.248342486143645], res=[2.9996041206459267e-09, 4.8128612206710386e-11, -5.551115123125783e-17, 2.9999901673960494e-08, -0.4008676385601042], res_norm=4.009e-01
2026-01-13 16:39:25,769 - INFO - integration_test - Dyn residual k=1: pred=[10.204724433012002, 4.138213737850107, 0.0160437137320093, 3.0, 11.548342486143646], ws=[10.204724433012002, 4.138213737850107, 0.0160437137320093, 3.0, 11.385718414669345], res=[0.0, 0.0, 0.0, 0.0, 0.16262407147430125], res_norm=1.626e-01
2026-01-13 16:39:25,770 - INFO - integration_test - Dyn residual k=2: pred=[10.504685823727637, 4.1430266454891695, 0.0160437137320093, 3.0, 11.685718414669346], ws=[10.504685823727637, 4.1430266454891695, 0.0160437137320093, 3.0, 11.588378022035474], res=[0.0, 0.0, 0.0, 0.0, 0.09734039263387118], res_norm=9.734e-02
2026-01-13 16:39:25,784 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:25,854 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:25,870 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:25,881 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:25,896 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:25,907 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:25,922 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:25,933 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:25,948 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:25,960 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:25,974 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:25,985 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:26,000 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:26,011 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:26,026 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:26,037 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:26,053 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:26,065 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:26,079 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:26,089 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:26,102 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:26,113 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:36,514 - WARNING - integration_test - Step 39: MPC solve failed
2026-01-13 16:39:36,514 - WARNING - integration_test -   Consecutive MPC failures: 1/5
2026-01-13 16:39:36,637 - INFO - integration_test - Step 39: Computed 6 numeric contouring constraints for visualization (s=10.800)
2026-01-13 16:39:36,637 - DEBUG - integration_test - Step 39: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:36,637 - INFO - integration_test - === Applying control at step 39 ===
2026-01-13 16:39:36,637 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 16:39:36,637 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:36,637 - INFO - integration_test -   Planner output success: False
2026-01-13 16:39:36,637 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 16:39:36,638 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:36,638 - INFO - integration_test - Step 39 completed in 11.001s
2026-01-13 16:39:36,651 - INFO - integration_test - Step 40 (contouring until path end)
2026-01-13 16:39:36,653 - DEBUG - integration_test - Syncing planner state at step 40: vehicle_state=[ 9.90476305  4.13340083  0.01604371  3.00000003 11.1000001 ]
2026-01-13 16:39:36,653 - DEBUG - integration_test - Step 40: Using propagated spline 11.1000 (close to path, dist=0.667m, drift=0.196m)
2026-01-13 16:39:36,653 - DEBUG - integration_test -   Set spline state to 11.1000
2026-01-13 16:39:36,654 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:36,720 - DEBUG - integration_test - Step 40: Checking path alignment: vehicle=(9.905, 4.133), path_start=(0.000, 0.000), dist=10.733m
2026-01-13 16:39:36,720 - WARNING - integration_test - Step 40: Vehicle is far from path start (dist=10.733m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:39:36,720 - INFO - integration_test - === Calling planner.solve_mpc() at step 40 ===
2026-01-13 16:39:36,773 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:36,782 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:36,782 - INFO - integration_test - Warmstart k=0: x0=9.90476304529597 , y0=4.1334008302591725 , psi0=0.016043713732009246 , v0=3.0000000299999017 , spline0=11.251515251623946 , a0=0.0 , w0=0.0
2026-01-13 16:39:36,783 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:36,784 - INFO - integration_test - Dyn residual k=0: pred=[10.20472443901121, 4.138213737946364, 0.016043713732009246, 3.0000000299999017, 11.551515254623936], ws=[10.204724436011606, 4.138213737898235, 0.0160437137320093, 3.0, 11.400105312562625], res=[2.9996041206459267e-09, 4.8128612206710386e-11, -5.551115123125783e-17, 2.9999901673960494e-08, 0.15140994206131175], res_norm=1.514e-01
2026-01-13 16:39:36,784 - INFO - integration_test - Dyn residual k=1: pred=[10.504685826727242, 4.143026645537298, 0.0160437137320093, 3.0, 11.700105312562625], ws=[10.504685826727242, 4.143026645537298, 0.0160437137320093, 3.0, 11.817297076884284], res=[0.0, 0.0, 0.0, 0.0, -0.11719176432165845], res_norm=1.172e-01
2026-01-13 16:39:36,785 - INFO - integration_test - Dyn residual k=2: pred=[10.804647217442877, 4.147839553176361, 0.0160437137320093, 3.0, 12.117297076884284], ws=[10.804647217442877, 4.147839553176361, 0.0160437137320093, 3.0, 11.979004681275992], res=[0.0, 0.0, 0.0, 0.0, 0.13829239560829265], res_norm=1.383e-01
2026-01-13 16:39:36,799 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:36,868 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:36,883 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:36,894 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:36,909 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:36,920 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:36,935 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:36,947 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:36,961 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:36,973 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:36,987 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:36,999 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:37,013 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:37,025 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:37,040 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:37,051 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:37,066 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:37,077 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:37,092 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:37,102 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:37,115 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:37,125 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:48,308 - WARNING - integration_test - Step 40: MPC solve failed
2026-01-13 16:39:48,308 - WARNING - integration_test -   Consecutive MPC failures: 2/5
2026-01-13 16:39:48,425 - INFO - integration_test - Step 40: Computed 6 numeric contouring constraints for visualization (s=11.100)
2026-01-13 16:39:48,425 - DEBUG - integration_test - Step 40: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:48,425 - INFO - integration_test - === Applying control at step 40 ===
2026-01-13 16:39:48,426 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 16:39:48,426 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:48,426 - INFO - integration_test -   Planner output success: False
2026-01-13 16:39:48,426 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 16:39:48,427 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:48,427 - INFO - integration_test - Step 40 completed in 11.775s
2026-01-13 16:39:48,440 - INFO - integration_test - Step 41 (contouring until path end)
2026-01-13 16:39:48,443 - DEBUG - integration_test - Syncing planner state at step 41: vehicle_state=[10.20472444  4.13821374  0.01604371  3.00000003 11.4000001 ]
2026-01-13 16:39:48,444 - DEBUG - integration_test - Step 41: Using propagated spline 11.4000 (close to path, dist=0.678m, drift=0.110m)
2026-01-13 16:39:48,444 - DEBUG - integration_test -   Set spline state to 11.4000
2026-01-13 16:39:48,444 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:48,510 - DEBUG - integration_test - Step 41: Checking path alignment: vehicle=(10.205, 4.138), path_start=(0.000, 0.000), dist=11.012m
2026-01-13 16:39:48,510 - WARNING - integration_test - Step 41: Vehicle is far from path start (dist=11.012m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:39:48,510 - INFO - integration_test - === Calling planner.solve_mpc() at step 41 ===
2026-01-13 16:39:48,563 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:48,572 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:48,572 - INFO - integration_test - Warmstart k=0: x0=10.20472443901121 , y0=4.138213737946364 , psi0=0.016043713732009246 , v0=3.0000000299999017 , spline0=11.147474850583531 , a0=0.0 , w0=0.0
2026-01-13 16:39:48,572 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:48,574 - INFO - integration_test - Dyn residual k=0: pred=[10.50468583272645, 4.143026645633555, 0.016043713732009246, 3.0000000299999017, 11.447474853583522], ws=[10.504685829726846, 4.143026645585427, 0.0160437137320093, 3.0, 11.849890318948354], res=[2.9996041206459267e-09, 4.8128612206710386e-11, -5.551115123125783e-17, 2.9999901673960494e-08, -0.4024154653648324], res_norm=4.024e-01
2026-01-13 16:39:48,574 - INFO - integration_test - Dyn residual k=1: pred=[10.804647220442481, 4.14783955322449, 0.0160437137320093, 3.0, 12.149890318948355], ws=[10.804647220442481, 4.14783955322449, 0.0160437137320093, 3.0, 11.989987560255067], res=[0.0, 0.0, 0.0, 0.0, 0.1599027586932884], res_norm=1.599e-01
2026-01-13 16:39:48,575 - INFO - integration_test - Dyn residual k=2: pred=[11.104608611158117, 4.152652460863552, 0.0160437137320093, 3.0, 12.289987560255067], ws=[11.104608611158117, 4.152652460863552, 0.0160437137320093, 3.0, 12.39805638727571], res=[0.0, 0.0, 0.0, 0.0, -0.10806882702064335], res_norm=1.081e-01
2026-01-13 16:39:48,589 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:48,660 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:48,675 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:48,687 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:48,702 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:48,713 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:48,728 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:48,740 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:48,755 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:48,766 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:48,781 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:48,792 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:48,807 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:48,818 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:48,833 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:48,844 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:48,859 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:48,870 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:48,885 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:48,895 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:48,908 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:48,918 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:39:59,520 - WARNING - integration_test - Step 41: MPC solve failed
2026-01-13 16:39:59,520 - WARNING - integration_test -   Consecutive MPC failures: 3/5
2026-01-13 16:39:59,645 - INFO - integration_test - Step 41: Computed 6 numeric contouring constraints for visualization (s=11.400)
2026-01-13 16:39:59,645 - DEBUG - integration_test - Step 41: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:39:59,645 - INFO - integration_test - === Applying control at step 41 ===
2026-01-13 16:39:59,645 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 16:39:59,645 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:39:59,645 - INFO - integration_test -   Planner output success: False
2026-01-13 16:39:59,645 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 16:39:59,646 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:39:59,647 - INFO - integration_test - Step 41 completed in 11.204s
2026-01-13 16:39:59,659 - INFO - integration_test - Step 42 (contouring until path end)
2026-01-13 16:39:59,661 - DEBUG - integration_test - Syncing planner state at step 42: vehicle_state=[10.50468583  4.14302665  0.01604371  3.00000003 11.70000011]
2026-01-13 16:39:59,661 - DEBUG - integration_test - Step 42: Using propagated spline 11.7000 (close to path, dist=0.653m, drift=0.190m)
2026-01-13 16:39:59,661 - DEBUG - integration_test -   Set spline state to 11.7000
2026-01-13 16:39:59,662 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:59,728 - DEBUG - integration_test - Step 42: Checking path alignment: vehicle=(10.505, 4.143), path_start=(0.000, 0.000), dist=11.292m
2026-01-13 16:39:59,728 - WARNING - integration_test - Step 42: Vehicle is far from path start (dist=11.292m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:39:59,728 - INFO - integration_test - === Calling planner.solve_mpc() at step 42 ===
2026-01-13 16:39:59,781 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:39:59,790 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:39:59,790 - INFO - integration_test - Warmstart k=0: x0=10.50468583272645 , y0=4.143026645633555 , psi0=0.016043713732009246 , v0=3.0000000299999017 , spline0=11.851515257623927 , a0=0.0 , w0=0.0
2026-01-13 16:39:59,790 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:39:59,791 - INFO - integration_test - Dyn residual k=0: pred=[10.80464722644169, 4.147839553320747, 0.016043713732009246, 3.0000000299999017, 12.151515260623917], ws=[10.804647223442085, 4.147839553272618, 0.0160437137320093, 3.0, 12.002848039083347], res=[2.9996041206459267e-09, 4.8128612206710386e-11, -5.551115123125783e-17, 2.9999901673960494e-08, 0.14866722154057044], res_norm=1.487e-01
2026-01-13 16:39:59,792 - INFO - integration_test - Dyn residual k=1: pred=[11.104608614157721, 4.152652460911681, 0.0160437137320093, 3.0, 12.302848039083347], ws=[11.104608614157721, 4.152652460911681, 0.0160437137320093, 3.0, 12.423528523195662], res=[0.0, 0.0, 0.0, 0.0, -0.1206804841123148], res_norm=1.207e-01
2026-01-13 16:39:59,793 - INFO - integration_test - Dyn residual k=2: pred=[11.404570004873356, 4.157465368550744, 0.0160437137320093, 3.0, 12.723528523195663], ws=[11.404570004873356, 4.157465368550744, 0.0160437137320093, 3.0, 12.603881778454827], res=[0.0, 0.0, 0.0, 0.0, 0.11964674474083559], res_norm=1.196e-01
2026-01-13 16:39:59,808 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:59,878 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:59,893 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:59,904 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:59,919 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:59,932 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:59,947 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:59,958 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:59,973 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:39:59,984 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:39:59,999 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:00,010 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:00,025 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:00,036 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:00,051 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:00,063 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:00,078 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:00,089 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:00,104 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:00,114 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:00,127 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:00,137 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:09,964 - WARNING - integration_test - Step 42: MPC solve failed
2026-01-13 16:40:09,964 - WARNING - integration_test -   Consecutive MPC failures: 4/5
2026-01-13 16:40:10,089 - INFO - integration_test - Step 42: Computed 6 numeric contouring constraints for visualization (s=11.700)
2026-01-13 16:40:10,089 - DEBUG - integration_test - Step 42: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:40:10,089 - INFO - integration_test - === Applying control at step 42 ===
2026-01-13 16:40:10,089 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 16:40:10,089 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:40:10,089 - INFO - integration_test -   Planner output success: False
2026-01-13 16:40:10,089 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 16:40:10,090 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:40:10,091 - INFO - integration_test - Step 42 completed in 10.430s
2026-01-13 16:40:10,102 - INFO - integration_test - Step 43 (contouring until path end)
2026-01-13 16:40:10,104 - DEBUG - integration_test - Syncing planner state at step 43: vehicle_state=[10.80464723  4.14783955  0.01604371  3.00000003 12.00000011]
2026-01-13 16:40:10,105 - DEBUG - integration_test - Step 43: Using propagated spline 12.0000 (close to path, dist=0.662m, drift=0.116m)
2026-01-13 16:40:10,105 - DEBUG - integration_test -   Set spline state to 12.0000
2026-01-13 16:40:10,106 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:10,173 - DEBUG - integration_test - Step 43: Checking path alignment: vehicle=(10.805, 4.148), path_start=(0.000, 0.000), dist=11.573m
2026-01-13 16:40:10,173 - WARNING - integration_test - Step 43: Vehicle is far from path start (dist=11.573m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:40:10,173 - INFO - integration_test - === Calling planner.solve_mpc() at step 43 ===
2026-01-13 16:40:10,227 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:10,236 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:40:10,237 - INFO - integration_test - Warmstart k=0: x0=10.80464722644169 , y0=4.147839553320747 , psi0=0.016043713732009246 , v0=3.0000000299999017 , spline0=11.747474856583512 , a0=0.0 , w0=0.0
2026-01-13 16:40:10,237 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:40:10,238 - INFO - integration_test - Dyn residual k=0: pred=[11.10460862015693, 4.152652461007938, 0.016043713732009246, 3.0000000299999017, 12.047474859583502], ws=[11.104608617157325, 4.15265246095981, 0.0160437137320093, 3.0, 12.149818877642193], res=[2.9996041206459267e-09, 4.8128612206710386e-11, -5.551115123125783e-17, 2.9999901673960494e-08, -0.10234401805869098], res_norm=1.023e-01
2026-01-13 16:40:10,239 - INFO - integration_test - Dyn residual k=1: pred=[11.40457000787296, 4.1574653685988725, 0.0160437137320093, 3.0, 12.449818877642194], ws=[11.40457000787296, 4.1574653685988725, 0.0160437137320093, 3.0, 12.597520496494642], res=[0.0, 0.0, 0.0, 0.0, -0.14770161885244804], res_norm=1.477e-01
2026-01-13 16:40:10,240 - INFO - integration_test - Dyn residual k=2: pred=[11.704531398588596, 4.162278276237935, 0.0160437137320093, 3.0, 12.897520496494643], ws=[11.704531398588596, 4.162278276237935, 0.0160437137320093, 3.0, 13.011220321005947], res=[0.0, 0.0, 0.0, 0.0, -0.11369982451130412], res_norm=1.137e-01
2026-01-13 16:40:10,254 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:10,324 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:10,340 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:10,351 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:10,366 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:10,378 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:10,392 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:10,403 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:10,418 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:10,430 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:10,445 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:10,456 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:10,471 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:10,482 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:10,496 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:10,508 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:10,523 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:10,535 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:10,550 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:10,560 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:10,572 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:10,582 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:20,513 - WARNING - integration_test - Step 43: MPC solve failed
2026-01-13 16:40:20,513 - WARNING - integration_test -   Consecutive MPC failures: 5/5
2026-01-13 16:40:20,513 - WARNING - integration_test - Step 43: Checking if vehicle should continue despite 5 consecutive failures...
2026-01-13 16:40:20,513 - ERROR - integration_test - Max consecutive MPC failures (5) reached. No successful solve in last 5 attempts. Terminating test early at step 43.
2026-01-13 16:40:20,643 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=12.000)
2026-01-13 16:40:20,644 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:40:20,644 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:40:20,644 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 16:40:20,644 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:40:20,644 - INFO - integration_test -   Planner output success: False
2026-01-13 16:40:20,644 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 16:40:20,645 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:40:20,645 - INFO - integration_test - Step 200 completed in 10.541s
2026-01-13 16:40:20,659 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:40:20,661 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[11.10460862  4.15265246  0.01604371  3.00000003 12.30000011]
2026-01-13 16:40:20,661 - DEBUG - integration_test - Step 201: Using propagated spline 12.3000 (close to path, dist=0.613m, drift=0.184m)
2026-01-13 16:40:20,661 - DEBUG - integration_test -   Set spline state to 12.3000
2026-01-13 16:40:20,662 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:20,728 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(11.105, 4.153), path_start=(0.000, 0.000), dist=11.856m
2026-01-13 16:40:20,728 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=11.856m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:40:20,728 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:40:20,780 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:20,790 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:40:20,790 - INFO - integration_test - Warmstart k=0: x0=11.10460862015693 , y0=4.152652461007938 , psi0=0.016043713732009246 , v0=3.0000000299999017 , spline0=12.148484960593603 , a0=0.0 , w0=0.0
2026-01-13 16:40:20,790 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:40:20,791 - INFO - integration_test - Dyn residual k=0: pred=[11.404570013872169, 4.15746536869513, 0.016043713732009246, 3.0000000299999017, 12.448484963593593], ws=[11.404570010872565, 4.157465368647001, 0.0160437137320093, 3.0, 12.607273671773125], res=[2.9996041206459267e-09, 4.8128612206710386e-11, -5.551115123125783e-17, 2.9999901673960494e-08, -0.15878870817953228], res_norm=1.588e-01
2026-01-13 16:40:20,791 - INFO - integration_test - Dyn residual k=1: pred=[11.7045314015882, 4.162278276286064, 0.0160437137320093, 3.0, 12.907273671773126], ws=[11.7045314015882, 4.162278276286064, 0.0160437137320093, 3.0, 12.730478060329247], res=[0.0, 0.0, 0.0, 0.0, 0.1767956114438789], res_norm=1.768e-01
2026-01-13 16:40:20,792 - INFO - integration_test - Dyn residual k=2: pred=[12.004492792303836, 4.167091183925127, 0.0160437137320093, 3.0, 13.030478060329248], ws=[12.004492792303836, 4.167091183925127, 0.0160437137320093, 3.0, 13.220644122878172], res=[0.0, 0.0, 0.0, 0.0, -0.19016606254892388], res_norm=1.902e-01
2026-01-13 16:40:20,806 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:20,877 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:20,891 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:20,903 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:20,918 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:20,930 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:20,945 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:20,956 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:20,971 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:20,982 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:20,997 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:21,008 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:21,022 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:21,034 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:21,049 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:21,061 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:21,075 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:21,086 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:21,101 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:21,111 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:21,124 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:21,134 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:31,107 - WARNING - integration_test - Step 201: MPC solve failed
2026-01-13 16:40:31,107 - WARNING - integration_test -   Consecutive MPC failures: 6/5
2026-01-13 16:40:31,107 - WARNING - integration_test - Step 201: Checking if vehicle should continue despite 6 consecutive failures...
2026-01-13 16:40:31,107 - ERROR - integration_test - Max consecutive MPC failures (5) reached. No successful solve in last 5 attempts. Terminating test early at step 201.
2026-01-13 16:40:31,248 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=12.300)
2026-01-13 16:40:31,248 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:40:31,249 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:40:31,249 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 16:40:31,249 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:40:31,249 - INFO - integration_test -   Planner output success: False
2026-01-13 16:40:31,249 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 16:40:31,250 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:40:31,250 - INFO - integration_test - Step 200 completed in 10.590s
2026-01-13 16:40:31,264 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:40:31,266 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[11.40457001  4.15746537  0.01604371  3.00000003 12.60000012]
2026-01-13 16:40:31,266 - DEBUG - integration_test - Step 201: Using propagated spline 12.6000 (close to path, dist=0.628m, drift=0.122m)
2026-01-13 16:40:31,266 - DEBUG - integration_test -   Set spline state to 12.6000
2026-01-13 16:40:31,267 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:31,684 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(11.405, 4.157), path_start=(0.000, 0.000), dist=12.139m
2026-01-13 16:40:31,684 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=12.139m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:40:31,684 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:40:31,738 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:31,747 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:40:31,748 - INFO - integration_test - Warmstart k=0: x0=11.404570013872169 , y0=4.15746536869513 , psi0=0.016043713732009246 , v0=3.0000000299999017 , spline0=12.347474862583493 , a0=0.0 , w0=0.0
2026-01-13 16:40:31,748 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:40:31,749 - INFO - integration_test - Dyn residual k=0: pred=[11.704531407587409, 4.162278276382321, 0.016043713732009246, 3.0000000299999017, 12.647474865583483], ws=[11.704531404587804, 4.162278276334193, 0.0160437137320093, 3.0, 12.754587750594428], res=[2.9996041206459267e-09, 4.8128612206710386e-11, -5.551115123125783e-17, 2.9999901673960494e-08, -0.10711288501094529], res_norm=1.071e-01
2026-01-13 16:40:31,750 - INFO - integration_test - Dyn residual k=1: pred=[12.00449279530344, 4.167091183973255, 0.0160437137320093, 3.0, 13.054587750594429], ws=[12.00449279530344, 4.167091183973255, 0.0160437137320093, 3.0, 13.121510320805452], res=[0.0, 0.0, 0.0, 0.0, -0.06692257021102321], res_norm=6.692e-02
2026-01-13 16:40:31,751 - INFO - integration_test - Dyn residual k=2: pred=[12.304454186019075, 4.171904091612318, 0.0160437137320093, 3.0, 13.421510320805453], ws=[12.304454186019075, 4.171904091612318, 0.0160437137320093, 3.0, 13.328050546315115], res=[0.0, 0.0, 0.0, 0.0, 0.09345977449033782], res_norm=9.346e-02
2026-01-13 16:40:31,765 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:31,835 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:31,850 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:31,862 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:31,877 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:31,889 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:31,903 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:31,915 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:31,930 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:31,942 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:31,957 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:31,968 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:31,983 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:31,994 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:32,009 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:32,021 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:32,036 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:32,048 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:32,064 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:32,074 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:32,087 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:32,097 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:43,799 - WARNING - integration_test - Step 201: MPC solve failed
2026-01-13 16:40:43,799 - WARNING - integration_test -   Consecutive MPC failures: 7/5
2026-01-13 16:40:43,799 - WARNING - integration_test - Step 201: Checking if vehicle should continue despite 7 consecutive failures...
2026-01-13 16:40:43,799 - ERROR - integration_test - Max consecutive MPC failures (5) reached. No successful solve in last 5 attempts. Terminating test early at step 201.
2026-01-13 16:40:43,936 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=12.600)
2026-01-13 16:40:43,936 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:40:43,936 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:40:43,936 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 16:40:43,936 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:40:43,936 - INFO - integration_test -   Planner output success: False
2026-01-13 16:40:43,936 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 16:40:43,938 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:40:43,938 - INFO - integration_test - Step 200 completed in 12.672s
2026-01-13 16:40:43,950 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:40:43,952 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[11.70453141  4.16227828  0.01604371  3.00000003 12.90000012]
2026-01-13 16:40:43,953 - DEBUG - integration_test - Step 201: Using propagated spline 12.9000 (close to path, dist=0.552m, drift=0.178m)
2026-01-13 16:40:43,953 - DEBUG - integration_test -   Set spline state to 12.9000
2026-01-13 16:40:43,954 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:44,020 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(11.705, 4.162), path_start=(0.000, 0.000), dist=12.423m
2026-01-13 16:40:44,020 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=12.423m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:40:44,020 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:40:44,073 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:44,082 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:40:44,082 - INFO - integration_test - Warmstart k=0: x0=11.704531407587409 , y0=4.162278276382321 , psi0=0.016043713732009246 , v0=3.0000000299999017 , spline0=12.748484966593583 , a0=0.0 , w0=0.0
2026-01-13 16:40:44,082 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:40:44,083 - INFO - integration_test - Dyn residual k=0: pred=[12.004492801302648, 4.167091184069513, 0.016043713732009246, 3.0000000299999017, 13.048484969593574], ws=[12.004492798303044, 4.167091184021384, 0.0160437137320093, 3.0, 13.213533750574427], res=[2.9996041206459267e-09, 4.8128612206710386e-11, -5.551115123125783e-17, 2.9999901673960494e-08, -0.16504878098085385], res_norm=1.650e-01
2026-01-13 16:40:44,084 - INFO - integration_test - Dyn residual k=1: pred=[12.30445418901868, 4.171904091660447, 0.0160437137320093, 3.0, 13.513533750574428], ws=[12.30445418901868, 4.171904091660447, 0.0160437137320093, 3.0, 13.344465742332964], res=[0.0, 0.0, 0.0, 0.0, 0.16906800824146373], res_norm=1.691e-01
2026-01-13 16:40:44,085 - INFO - integration_test - Dyn residual k=2: pred=[12.604415579734315, 4.17671699929951, 0.0160437137320093, 3.0, 13.644465742332965], ws=[12.604415579734315, 4.17671699929951, 0.0160437137320093, 3.0, 13.742927821863997], res=[0.0, 0.0, 0.0, 0.0, -0.09846207953103203], res_norm=9.846e-02
2026-01-13 16:40:44,098 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:44,170 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:44,186 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:44,198 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:44,213 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:44,225 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:44,240 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:44,251 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:44,266 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:44,278 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:44,293 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:44,304 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:44,318 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:44,331 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:44,346 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:44,358 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:44,373 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:44,384 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:44,399 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:44,410 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:44,423 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:44,433 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:45,267 - WARNING - integration_test - Step 201: MPC solve failed
2026-01-13 16:40:45,267 - WARNING - integration_test -   Consecutive MPC failures: 8/5
2026-01-13 16:40:45,267 - WARNING - integration_test - Step 201: Checking if vehicle should continue despite 8 consecutive failures...
2026-01-13 16:40:45,267 - ERROR - integration_test - Max consecutive MPC failures (5) reached. No successful solve in last 5 attempts. Terminating test early at step 201.
2026-01-13 16:40:45,413 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=12.900)
2026-01-13 16:40:45,413 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:40:45,413 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:40:45,414 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 16:40:45,414 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:40:45,414 - INFO - integration_test -   Planner output success: False
2026-01-13 16:40:45,414 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 16:40:45,415 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:40:45,415 - INFO - integration_test - Step 200 completed in 1.463s
2026-01-13 16:40:45,432 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:40:45,433 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[12.0044928   4.16709118  0.01604371  3.00000003 13.20000012]
2026-01-13 16:40:45,434 - DEBUG - integration_test - Step 201: Using propagated spline 13.2000 (close to path, dist=0.585m, drift=0.128m)
2026-01-13 16:40:45,434 - DEBUG - integration_test -   Set spline state to 13.2000
2026-01-13 16:40:45,435 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:45,500 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(12.004, 4.167), path_start=(0.000, 0.000), dist=12.707m
2026-01-13 16:40:45,500 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=12.707m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:40:45,500 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:40:45,554 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:45,563 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:40:45,563 - INFO - integration_test - Warmstart k=0: x0=12.004492801302648 , y0=4.167091184069513 , psi0=0.016043713732009246 , v0=3.0000000299999017 , spline0=13.149495070603676 , a0=0.0 , w0=0.0
2026-01-13 16:40:45,563 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:40:45,564 - INFO - integration_test - Dyn residual k=0: pred=[12.304454195017888, 4.171904091756704, 0.016043713732009246, 3.0000000299999017, 13.449495073603666], ws=[12.304454192018284, 4.1719040917085755, 0.0160437137320093, 3.0, 13.361241090077007], res=[2.9996041206459267e-09, 4.8128612206710386e-11, -5.551115123125783e-17, 2.9999901673960494e-08, 0.08825398352665914], res_norm=8.825e-02
2026-01-13 16:40:45,565 - INFO - integration_test - Dyn residual k=1: pred=[12.60441558273392, 4.176716999347638, 0.0160437137320093, 3.0, 13.661241090077008], ws=[12.60441558273392, 4.176716999347638, 0.0160437137320093, 3.0, 13.736215810810005], res=[0.0, 0.0, 0.0, 0.0, -0.07497472073299782], res_norm=7.497e-02
2026-01-13 16:40:45,566 - INFO - integration_test - Dyn residual k=2: pred=[12.904376973449555, 4.181529906986701, 0.0160437137320093, 3.0, 14.036215810810006], ws=[12.548039398532453, 4.161324130071682, 0.0160437137320093, 3.0, 13.44777058068534], res=[0.3563375749171023, 0.020205776915019236, 0.0, 0.0, 0.5884452301246661], res_norm=6.882e-01
2026-01-13 16:40:45,580 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:45,650 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:45,666 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:45,677 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:45,693 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:45,704 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:45,718 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:45,731 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:45,746 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:45,757 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:45,772 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:45,783 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:45,798 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:45,810 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:45,825 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:45,837 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:45,852 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:45,864 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:45,878 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:45,888 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:45,901 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:45,912 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:46,637 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:40:46,785 - INFO - integration_test - Step 201: Computed 6 numeric contouring constraints for visualization (s=13.200)
2026-01-13 16:40:46,786 - DEBUG - integration_test - Step 201: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:40:46,786 - INFO - integration_test - === Applying control at step 201 ===
2026-01-13 16:40:46,786 - INFO - integration_test -   Control dict from planner: {'a': -1.6054334726011778e-08, 'w': -0.7953514996931268}
2026-01-13 16:40:46,786 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:40:46,786 - INFO - integration_test -   Planner output success: True
2026-01-13 16:40:46,787 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:40:46,788 - INFO - integration_test - Step 201 completed in 1.355s
2026-01-13 16:40:46,800 - INFO - integration_test - Step 202 (contouring until path end)
2026-01-13 16:40:46,802 - DEBUG - integration_test - Syncing planner state at step 202: vehicle_state=[12.30432934  4.15997657 -0.06349144  3.00000003 13.50000012]
2026-01-13 16:40:46,803 - DEBUG - integration_test - Step 202: Using propagated spline 13.5000 (close to path, dist=0.488m, drift=0.172m)
2026-01-13 16:40:46,803 - DEBUG - integration_test -   Set spline state to 13.5000
2026-01-13 16:40:46,804 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:46,870 - DEBUG - integration_test - Step 202: Checking path alignment: vehicle=(12.304, 4.160), path_start=(0.000, 0.000), dist=12.989m
2026-01-13 16:40:46,870 - WARNING - integration_test - Step 202: Vehicle is far from path start (dist=12.989m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:40:46,870 - INFO - integration_test - === Calling planner.solve_mpc() at step 202 ===
2026-01-13 16:40:46,922 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:46,931 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:40:46,931 - INFO - integration_test - Warmstart k=0: x0=12.30432934460878 , y0=4.159976568715575 , psi0=-0.06349143623730343 , v0=3.000000028394468 , spline0=13.34848497243302 , a0=0.0 , w0=0.0
2026-01-13 16:40:46,931 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:40:46,932 - INFO - integration_test - Dyn residual k=0: pred=[12.603724876172278, 4.140941932299854, -0.06349143623730343, 3.000000028394468, 13.648484975272467], ws=[12.603724873338551, 4.140941932480013, -0.06349143623730358, 3.0, 14.014019851989644], res=[2.833726142625892e-09, -1.801589988303931e-10, 1.5265566588595902e-16, 2.8394468110093385e-08, -0.3655348767171773], res_norm=3.655e-01
2026-01-13 16:40:46,933 - INFO - integration_test - Dyn residual k=1: pred=[12.903120402068323, 4.1219072962444505, -0.06349143623730358, 3.0, 14.314019851989645], ws=[12.903120402068323, 4.1219072962444505, -0.06349143623730358, 3.0, 13.912364436389531], res=[0.0, 0.0, 0.0, 0.0, 0.4016554156001142], res_norm=4.017e-01
2026-01-13 16:40:46,934 - INFO - integration_test - Dyn residual k=2: pred=[13.202515930798095, 4.102872660008888, -0.06349143623730358, 3.0, 14.212364436389532], ws=[13.186948443158903, 3.960284061227349, -0.06349143623730358, 3.0, 14.578257101204017], res=[0.015567487639192024, 0.14258859878153896, 0.0, 0.0, -0.3658926648144849], res_norm=3.930e-01
2026-01-13 16:40:46,948 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:47,017 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:47,033 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:47,045 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:47,060 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:47,071 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:47,086 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:47,097 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:47,112 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:47,124 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:47,139 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:47,150 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:47,165 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:47,177 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:47,192 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:47,204 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:47,220 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:47,232 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:47,248 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:47,258 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:47,272 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:47,282 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:47,433 - INFO - integration_test - Step 202: MPC solve successful
2026-01-13 16:40:47,584 - INFO - integration_test - Step 202: Computed 6 numeric contouring constraints for visualization (s=13.500)
2026-01-13 16:40:47,584 - DEBUG - integration_test - Step 202: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:40:47,584 - INFO - integration_test - === Applying control at step 202 ===
2026-01-13 16:40:47,584 - INFO - integration_test -   Control dict from planner: {'a': -2.000000019999065, 'w': -0.8000000099998926}
2026-01-13 16:40:47,584 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:40:47,584 - INFO - integration_test -   Planner output success: True
2026-01-13 16:40:47,585 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:40:47,586 - INFO - integration_test - Step 202 completed in 0.784s
2026-01-13 16:40:47,599 - INFO - integration_test - Step 203 (contouring until path end)
2026-01-13 16:40:47,601 - DEBUG - integration_test - Syncing planner state at step 203: vehicle_state=[12.59271457  4.13015817 -0.14349144  2.80000003 13.78000013]
2026-01-13 16:40:47,602 - DEBUG - integration_test - Step 203: Using propagated spline 13.7800 (close to path, dist=0.575m, drift=0.452m)
2026-01-13 16:40:47,602 - DEBUG - integration_test -   Set spline state to 13.7800
2026-01-13 16:40:47,603 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:47,670 - DEBUG - integration_test - Step 203: Checking path alignment: vehicle=(12.593, 4.130), path_start=(0.000, 0.000), dist=13.253m
2026-01-13 16:40:47,670 - WARNING - integration_test - Step 203: Vehicle is far from path start (dist=13.253m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:40:47,670 - INFO - integration_test - === Calling planner.solve_mpc() at step 203 ===
2026-01-13 16:40:47,729 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:47,740 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:40:47,740 - INFO - integration_test - Warmstart k=0: x0=12.59271457499116 , y0=4.130158170399159 , psi0=-0.14349143723729268 , v0=2.8000000263945615 , spline0=13.729495076082578 , a0=0.0 , w0=0.0
2026-01-13 16:40:47,740 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:40:47,742 - INFO - integration_test - Dyn residual k=0: pred=[12.86983694921324, 4.0901183004741375, -0.14349143723729268, 2.8000000263945615, 14.009495078722034], ws=[12.86983694921324, 4.0901183004741375, -0.14349143723729263, 2.8000000263945615, 13.92212722686752], res=[0.0, 0.0, -5.551115123125783e-17, 0.0, 0.08736785185451446], res_norm=8.737e-02
2026-01-13 16:40:47,743 - INFO - integration_test - Dyn residual k=1: pred=[13.146959323435322, 4.050078430549116, -0.14349143723729263, 2.8000000263945615, 14.202127229506976], ws=[13.146959323435322, 4.050078430549116, -0.14349143723729263, 2.8000000263945615, 14.577724158947632], res=[0.0, 0.0, 0.0, 0.0, -0.3755969294406558], res_norm=3.756e-01
2026-01-13 16:40:47,743 - INFO - integration_test - Dyn residual k=2: pred=[13.424081697657403, 4.010038560624095, -0.14349143723729263, 2.8000000263945615, 14.857724161587088], ws=[13.92168857529299, 3.5651104330411583, -0.14349143723729263, 2.8000000263945615, 15.273156449016632], res=[-0.49760687763558664, 0.4449281275829371, 0.0, 0.0, -0.4154322874295442], res_norm=7.862e-01
2026-01-13 16:40:47,759 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:47,834 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:47,851 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:47,864 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:47,880 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:47,892 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:47,908 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:47,920 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:47,937 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:47,949 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:47,965 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:47,978 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:47,993 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:48,005 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:48,021 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:48,035 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:48,053 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:48,066 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:48,083 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:48,095 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:48,109 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:48,119 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:48,262 - INFO - integration_test - Step 203: MPC solve successful
2026-01-13 16:40:48,420 - INFO - integration_test - Step 203: Computed 6 numeric contouring constraints for visualization (s=13.780)
2026-01-13 16:40:48,420 - DEBUG - integration_test - Step 203: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:40:48,420 - INFO - integration_test - === Applying control at step 203 ===
2026-01-13 16:40:48,420 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000199500234, 'w': -0.7999999889776547}
2026-01-13 16:40:48,420 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:40:48,420 - INFO - integration_test -   Planner output success: True
2026-01-13 16:40:48,422 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:40:48,422 - INFO - integration_test - Step 203 completed in 0.821s
2026-01-13 16:40:48,435 - INFO - integration_test - Step 204 (contouring until path end)
2026-01-13 16:40:48,439 - DEBUG - integration_test - Syncing planner state at step 204: vehicle_state=[12.87774589  4.0771268  -0.22349144  3.00000003 14.08000013]
2026-01-13 16:40:48,448 - DEBUG - integration_test - Step 204: Using propagated spline 14.0800 (close to path, dist=0.502m, drift=0.147m)
2026-01-13 16:40:48,448 - DEBUG - integration_test -   Set spline state to 14.0800
2026-01-13 16:40:48,449 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:48,514 - DEBUG - integration_test - Step 204: Checking path alignment: vehicle=(12.878, 4.077), path_start=(0.000, 0.000), dist=13.508m
2026-01-13 16:40:48,514 - WARNING - integration_test - Step 204: Vehicle is far from path start (dist=13.508m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:40:48,514 - INFO - integration_test - === Calling planner.solve_mpc() at step 204 ===
2026-01-13 16:40:48,566 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:48,575 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:40:48,576 - INFO - integration_test - Warmstart k=0: x0=12.877745892578634 , y0=4.077126802536202 , psi0=-0.22349143613505817 , v0=3.0000000283895636 , spline0=13.928484977911435 , a0=0.0 , w0=0.0
2026-01-13 16:40:48,576 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:40:48,577 - INFO - integration_test - Dyn residual k=0: pred=[13.170284765727882, 4.01063613101047, -0.22349143613505817, 3.0000000283895636, 14.228484980750391], ws=[13.17028476295953, 4.010636131639684, -0.22349143613505795, 3.0, 14.597440541917187], res=[2.7683508818654445e-09, -6.292140142249991e-10, -2.220446049250313e-16, 2.83895635888598e-08, -0.3689555611667963], res_norm=3.690e-01
2026-01-13 16:40:48,577 - INFO - integration_test - Dyn residual k=1: pred=[13.462823633340427, 3.944145460743166, -0.22349143613505795, 3.0, 14.897440541917188], ws=[13.095634417316083, 3.796189981114593, -0.22349143613505795, 3.0, 14.298406117785714], res=[0.36718921602434484, 0.14795547962857292, 0.0, 0.0, 0.5990344241314745], res_norm=7.180e-01
2026-01-13 16:40:48,578 - INFO - integration_test - Dyn residual k=2: pred=[13.38817328769698, 3.7296993102180753, -0.22349143613505795, 3.0, 14.598406117785714], ws=[14.395919161698213, 3.8373031061280205, -0.22349143613505795, 3.0, 15.777871716853742], res=[-1.007745874001234, -0.10760379590994518, 0.0, 0.0, -1.1794655990680276], res_norm=1.555e+00
2026-01-13 16:40:48,592 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:48,664 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:48,679 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:48,692 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:48,709 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:48,721 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:48,736 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:48,748 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:48,762 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:48,774 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:48,788 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:48,800 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:48,814 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:48,826 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:48,841 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:48,852 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:48,867 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:48,879 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:48,894 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:48,904 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:48,916 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:48,927 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:49,482 - WARNING - integration_test - Step 204: MPC solve failed
2026-01-13 16:40:49,482 - WARNING - integration_test -   Consecutive MPC failures: 1/5
2026-01-13 16:40:49,650 - INFO - integration_test - Step 204: Computed 6 numeric contouring constraints for visualization (s=14.080)
2026-01-13 16:40:49,651 - DEBUG - integration_test - Step 204: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:40:49,651 - INFO - integration_test - === Applying control at step 204 ===
2026-01-13 16:40:49,651 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 16:40:49,651 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:40:49,651 - INFO - integration_test -   Planner output success: False
2026-01-13 16:40:49,651 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 16:40:49,652 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:40:49,653 - INFO - integration_test - Step 204 completed in 1.214s
2026-01-13 16:40:49,665 - INFO - integration_test - Step 205 (contouring until path end)
2026-01-13 16:40:49,667 - DEBUG - integration_test - Syncing planner state at step 205: vehicle_state=[13.17028477  4.01063613 -0.22349144  3.00000003 14.38000013]
2026-01-13 16:40:49,667 - DEBUG - integration_test - Step 205: Using propagated spline 14.3800 (close to path, dist=0.589m, drift=0.447m)
2026-01-13 16:40:49,667 - DEBUG - integration_test -   Set spline state to 14.3800
2026-01-13 16:40:49,668 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:49,734 - DEBUG - integration_test - Step 205: Checking path alignment: vehicle=(13.170, 4.011), path_start=(0.000, 0.000), dist=13.767m
2026-01-13 16:40:49,734 - WARNING - integration_test - Step 205: Vehicle is far from path start (dist=13.767m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:40:49,734 - INFO - integration_test - === Calling planner.solve_mpc() at step 205 ===
2026-01-13 16:40:49,787 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:49,796 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:40:49,796 - INFO - integration_test - Warmstart k=0: x0=13.230746999772848 , y0=3.490697976638862 , psi0=-0.22349143613505817 , v0=3.0000000283895636 , spline0=14.632525384790796 , a0=0.0 , w0=0.0
2026-01-13 16:40:49,796 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:40:49,797 - INFO - integration_test - Dyn residual k=0: pred=[13.523285872922095, 3.4242073051131303, -0.22349143613505817, 3.0000000283895636, 14.932525387629752], ws=[13.462823636108778, 3.944145460113952, -0.22349143613505795, 3.0, 14.755037345987768], res=[0.06046223681331675, -0.5199381550008217, -2.220446049250313e-16, 2.83895635888598e-08, 0.1774880416419844], res_norm=5.527e-01
2026-01-13 16:40:49,798 - INFO - integration_test - Dyn residual k=1: pred=[13.755362506489675, 3.8776547892174342, -0.22349143613505795, 3.0, 15.055037345987769], ws=[13.869484998078441, 3.598341917902549, -0.22349143613505795, 3.0, 15.244822371718612], res=[-0.1141224915887662, 0.27931287131488514, 0.0, 0.0, -0.18978502573084377], res_norm=3.565e-01
2026-01-13 16:40:49,799 - INFO - integration_test - Dyn residual k=2: pred=[14.162023868459338, 3.5318512470060313, -0.22349143613505795, 3.0, 15.544822371718613], ws=[14.048609728954341, 3.5105503636637074, -0.22349143613505795, 3.0, 15.07392770697998], res=[0.11341413950499657, 0.02130088334232383, 0.0, 0.0, 0.4708946647386334], res_norm=4.848e-01
2026-01-13 16:40:49,813 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:49,883 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:49,899 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:49,910 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:49,926 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:49,938 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:49,953 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:49,964 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:49,979 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:49,990 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:50,005 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:50,017 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:50,032 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:50,044 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:50,058 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:50,070 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:50,085 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:50,096 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:50,112 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:50,123 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:50,137 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:50,147 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:50,318 - INFO - integration_test - Step 205: MPC solve successful
2026-01-13 16:40:50,483 - INFO - integration_test - Step 205: Computed 6 numeric contouring constraints for visualization (s=14.380)
2026-01-13 16:40:50,483 - DEBUG - integration_test - Step 205: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:40:50,483 - INFO - integration_test - === Applying control at step 205 ===
2026-01-13 16:40:50,483 - INFO - integration_test -   Control dict from planner: {'a': 1.0735119834438303e-08, 'w': 0.7046256562162155}
2026-01-13 16:40:50,483 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:40:50,483 - INFO - integration_test -   Planner output success: True
2026-01-13 16:40:50,484 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:40:50,484 - INFO - integration_test - Step 205 completed in 0.818s
2026-01-13 16:40:50,498 - INFO - integration_test - Step 206 (contouring until path end)
2026-01-13 16:40:50,500 - DEBUG - integration_test - Syncing planner state at step 206: vehicle_state=[13.46492321  3.95450272 -0.15302887  3.00000003 14.68000014]
2026-01-13 16:40:50,501 - DEBUG - integration_test - Step 206: Using propagated spline 14.6800 (close to path, dist=0.552m, drift=0.141m)
2026-01-13 16:40:50,501 - DEBUG - integration_test -   Set spline state to 14.6800
2026-01-13 16:40:50,502 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:50,569 - DEBUG - integration_test - Step 206: Checking path alignment: vehicle=(13.465, 3.955), path_start=(0.000, 0.000), dist=14.034m
2026-01-13 16:40:50,569 - WARNING - integration_test - Step 206: Vehicle is far from path start (dist=14.034m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:40:50,569 - INFO - integration_test - === Calling planner.solve_mpc() at step 206 ===
2026-01-13 16:40:50,621 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:50,631 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:40:50,631 - INFO - integration_test - Warmstart k=0: x0=13.345849954482485 , y0=3.8436895692646806 , psi0=-0.1530288705134366 , v0=3.0000000294630755 , spline0=14.427474882686596 , a0=0.0 , w0=0.0
2026-01-13 16:40:50,631 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:40:50,632 - INFO - integration_test - Dyn residual k=0: pred=[13.642344131701654, 3.797959878221414, -0.1530288705134366, 3.0000000294630755, 14.727474885632903], ws=[13.735799648036387, 4.438749395176576, -0.1530288705134364, 3.0, 14.902991789415028], res=[-0.0934555163347337, -0.6407895169551625, -2.220446049250313e-16, 2.9463075534863492e-08, -0.1755169037821247], res_norm=6.709e-01
2026-01-13 16:40:50,633 - INFO - integration_test - Dyn residual k=1: pred=[14.032293822343679, 4.393019704582422, -0.1530288705134364, 3.0, 15.202991789415028], ws=[13.73834381500482, 3.2006443850152735, -0.1530288705134364, 3.0, 14.917425311012334], res=[0.293950007338859, 1.192375319567149, 0.0, 0.0, 0.28556647840269456], res_norm=1.261e+00
2026-01-13 16:40:50,633 - INFO - integration_test - Dyn residual k=2: pred=[14.034837989312111, 3.154914694421119, -0.1530288705134364, 3.0, 15.217425311012335], ws=[14.287006800472419, 3.6682872076518747, -0.1530288705134364, 3.0, 15.702002894903801], res=[-0.252168811160308, -0.5133725132307556, 0.0, 0.0, -0.48457758389146655], res_norm=7.496e-01
2026-01-13 16:40:50,647 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:50,718 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:50,734 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:50,745 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:50,761 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:50,772 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:50,787 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:50,798 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:50,813 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:50,825 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:50,840 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:50,852 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:50,866 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:50,878 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:50,893 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:50,904 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:50,919 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:50,931 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:50,946 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:50,956 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:50,969 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:50,979 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:51,555 - WARNING - integration_test - Step 206: MPC solve failed
2026-01-13 16:40:51,555 - WARNING - integration_test -   Consecutive MPC failures: 1/5
2026-01-13 16:40:51,717 - INFO - integration_test - Step 206: Computed 6 numeric contouring constraints for visualization (s=14.680)
2026-01-13 16:40:51,717 - DEBUG - integration_test - Step 206: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:40:51,717 - INFO - integration_test - === Applying control at step 206 ===
2026-01-13 16:40:51,717 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 16:40:51,717 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:40:51,717 - INFO - integration_test -   Planner output success: False
2026-01-13 16:40:51,717 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 16:40:51,719 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:40:51,719 - INFO - integration_test - Step 206 completed in 1.219s
2026-01-13 16:40:51,733 - INFO - integration_test - Step 207 (contouring until path end)
2026-01-13 16:40:51,734 - DEBUG - integration_test - Syncing planner state at step 207: vehicle_state=[13.76141739  3.90877303 -0.15302887  3.00000003 14.98000014]
2026-01-13 16:40:51,735 - DEBUG - integration_test - Step 207: Using propagated spline 14.9800 (close to path, dist=0.552m, drift=0.165m)
2026-01-13 16:40:51,735 - DEBUG - integration_test -   Set spline state to 14.9800
2026-01-13 16:40:51,737 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:51,802 - DEBUG - integration_test - Step 207: Checking path alignment: vehicle=(13.761, 3.909), path_start=(0.000, 0.000), dist=14.306m
2026-01-13 16:40:51,802 - WARNING - integration_test - Step 207: Vehicle is far from path start (dist=14.306m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:40:51,802 - INFO - integration_test - === Calling planner.solve_mpc() at step 207 ===
2026-01-13 16:40:51,856 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:51,866 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:40:51,866 - INFO - integration_test - Warmstart k=0: x0=13.72247472840582 , y0=3.551025470937597 , psi0=-0.1530288705134366 , v0=3.0000000294630755 , spline0=14.929495087653105 , a0=0.0 , w0=0.0
2026-01-13 16:40:51,866 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:40:51,868 - INFO - integration_test - Dyn residual k=0: pred=[14.018968905624988, 3.5052957798943303, -0.1530288705134366, 3.0000000294630755, 15.229495090599412], ws=[13.365483762603551, 3.655626109437343, -0.1530288705134364, 3.0, 14.455237291630887], res=[0.6534851430214363, -0.15033032954301273, -2.220446049250313e-16, 2.9463075534863492e-08, 0.7742577989685255], res_norm=1.024e+00
2026-01-13 16:40:51,869 - INFO - integration_test - Dyn residual k=1: pred=[13.661977936910843, 3.6098964188431886, -0.1530288705134364, 3.0, 14.755237291630888], ws=[13.84856889035792, 3.382950755295064, -0.1530288705134364, 3.0, 15.258915341350944], res=[-0.18659095344707666, 0.22694566354812462, 0.0, 0.0, -0.5036780497200564], res_norm=5.831e-01
2026-01-13 16:40:51,870 - INFO - integration_test - Dyn residual k=2: pred=[14.14506306466521, 3.3372210647009095, -0.1530288705134364, 3.0, 15.558915341350945], ws=[14.773155170590249, 3.5001185259888006, -0.1530288705134364, 3.0, 16.010420212834596], res=[-0.6280921059250382, -0.16289746128789107, 0.0, 0.0, -0.45150487148365137], res_norm=7.905e-01
2026-01-13 16:40:51,883 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:51,956 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:51,972 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:51,984 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:51,999 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:52,011 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:52,027 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:52,039 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:52,053 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:52,065 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:52,080 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:52,093 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:52,108 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:52,119 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:52,136 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:52,148 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:52,163 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:52,175 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:52,190 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:52,200 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:52,213 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:52,224 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:52,782 - WARNING - integration_test - Step 207: MPC solve failed
2026-01-13 16:40:52,782 - WARNING - integration_test -   Consecutive MPC failures: 2/5
2026-01-13 16:40:52,961 - INFO - integration_test - Step 207: Computed 6 numeric contouring constraints for visualization (s=14.980)
2026-01-13 16:40:52,962 - DEBUG - integration_test - Step 207: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:40:52,962 - INFO - integration_test - === Applying control at step 207 ===
2026-01-13 16:40:52,962 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 16:40:52,962 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:40:52,962 - INFO - integration_test -   Planner output success: False
2026-01-13 16:40:52,962 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 16:40:52,963 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:40:52,963 - INFO - integration_test - Step 207 completed in 1.229s
2026-01-13 16:40:52,979 - INFO - integration_test - Step 208 (contouring until path end)
2026-01-13 16:40:52,981 - DEBUG - integration_test - Syncing planner state at step 208: vehicle_state=[14.05791156  3.86304334 -0.15302887  3.00000003 15.28000014]
2026-01-13 16:40:52,981 - DEBUG - integration_test - Step 208: Using propagated spline 15.2800 (close to path, dist=0.641m, drift=0.135m)
2026-01-13 16:40:52,981 - DEBUG - integration_test -   Set spline state to 15.2800
2026-01-13 16:40:52,982 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:53,049 - DEBUG - integration_test - Step 208: Checking path alignment: vehicle=(14.058, 3.863), path_start=(0.000, 0.000), dist=14.579m
2026-01-13 16:40:53,049 - WARNING - integration_test - Step 208: Vehicle is far from path start (dist=14.579m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:40:53,049 - INFO - integration_test - === Calling planner.solve_mpc() at step 208 ===
2026-01-13 16:40:53,103 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:53,113 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:40:53,113 - INFO - integration_test - Warmstart k=0: x0=14.085683272982399 , y0=3.4772476860570922 , psi0=-0.1530288705134366 , v0=3.0000000294630755 , spline0=15.330505191609513 , a0=0.0 , w0=0.0
2026-01-13 16:40:53,113 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:40:53,115 - INFO - integration_test - Dyn residual k=0: pred=[14.382177450201567, 3.4315179950138255, -0.1530288705134366, 3.0000000294630755, 15.63050519455582], ws=[14.57907963502788, 3.4507534534322857, -0.1530288705134364, 3.0, 15.613444567046413], res=[-0.19690218482631217, -0.019235458418460194, -2.220446049250313e-16, 2.9463075534863492e-08, 0.017060627509406956], res_norm=1.986e-01
2026-01-13 16:40:53,115 - INFO - integration_test - Dyn residual k=1: pred=[14.87557380933517, 3.4050237628381312, -0.1530288705134364, 3.0, 15.913444567046414], ws=[15.088918626538963, 3.501607897787524, -0.1530288705134364, 3.0, 16.144856867308192], res=[-0.21334481720379195, -0.09658413494939255, 0.0, 0.0, -0.23141230026177873], res_norm=3.292e-01
2026-01-13 16:40:53,116 - INFO - integration_test - Dyn residual k=2: pred=[15.385412800846254, 3.4558782071933694, -0.1530288705134364, 3.0, 16.444856867308193], ws=[15.522204235003572, 3.3657857372296522, -0.1530288705134364, 3.0, 16.640568986591585], res=[-0.13679143415731865, 0.09009246996371711, 0.0, 0.0, -0.19571211928339238], res_norm=2.552e-01
2026-01-13 16:40:53,132 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:53,205 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:53,221 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:53,232 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:53,247 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:53,259 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:53,273 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:53,285 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:53,300 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:53,311 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:53,326 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:53,338 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:53,354 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:53,366 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:53,382 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:53,394 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:53,410 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:53,422 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:53,437 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:53,448 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:53,461 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:53,471 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:53,658 - INFO - integration_test - Step 208: MPC solve successful
2026-01-13 16:40:53,842 - INFO - integration_test - Step 208: Computed 6 numeric contouring constraints for visualization (s=15.280)
2026-01-13 16:40:53,842 - DEBUG - integration_test - Step 208: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:40:53,843 - INFO - integration_test - === Applying control at step 208 ===
2026-01-13 16:40:53,843 - INFO - integration_test -   Control dict from planner: {'a': 3.5783950951989937e-09, 'w': 0.8000000098585504}
2026-01-13 16:40:53,843 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:40:53,843 - INFO - integration_test -   Planner output success: True
2026-01-13 16:40:53,844 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:40:53,844 - INFO - integration_test - Step 208 completed in 0.864s
2026-01-13 16:40:53,859 - INFO - integration_test - Step 209 (contouring until path end)
2026-01-13 16:40:53,860 - DEBUG - integration_test - Syncing planner state at step 209: vehicle_state=[14.3559178   3.82921585 -0.07302887  3.00000003 15.58000014]
2026-01-13 16:40:53,861 - DEBUG - integration_test - Step 209: Using propagated spline 15.5800 (close to path, dist=0.558m, drift=0.171m)
2026-01-13 16:40:53,861 - DEBUG - integration_test -   Set spline state to 15.5800
2026-01-13 16:40:53,862 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:53,927 - DEBUG - integration_test - Step 209: Checking path alignment: vehicle=(14.356, 3.829), path_start=(0.000, 0.000), dist=14.858m
2026-01-13 16:40:53,927 - WARNING - integration_test - Step 209: Vehicle is far from path start (dist=14.858m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:40:53,927 - INFO - integration_test - === Calling planner.solve_mpc() at step 209 ===
2026-01-13 16:40:53,979 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:53,989 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:40:53,989 - INFO - integration_test - Warmstart k=0: x0=14.355917798463372 , y0=3.8292158547436506 , psi0=-0.07302886952758157 , v0=3.000000029820915 , spline0=15.731515295601707 , a0=0.0 , w0=0.0
2026-01-13 16:40:53,989 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:40:53,990 - INFO - integration_test - Dyn residual k=0: pred=[14.655118174546526, 3.807326662411499, -0.07302886952758157, 3.000000029820915, 16.0315152985838], ws=[14.655118171572383, 3.8073266626290847, -0.07302886952758136, 3.0, 15.873999191840868], res=[2.974143598066803e-09, -2.1758550516892683e-10, -2.0816681711721685e-16, 2.9820915070644105e-08, 0.15751610674293026], res_norm=1.575e-01
2026-01-13 16:40:53,991 - INFO - integration_test - Dyn residual k=1: pred=[14.954318544681394, 3.785437470514519, -0.07302886952758136, 3.0, 16.173999191840867], ws=[15.4258941733969, 3.979139795289489, -0.07302886952758136, 3.0, 16.791528459143493], res=[-0.47157562871550596, -0.19370232477497007, 0.0, 0.0, -0.6175292673026256], res_norm=8.008e-01
2026-01-13 16:40:53,991 - INFO - integration_test - Dyn residual k=2: pred=[15.725094546505911, 3.957250603174923, -0.07302886952758136, 3.0, 17.091528459143493], ws=[15.253518917790405, 3.763548278399953, -0.07302886952758136, 3.0, 16.458340344871225], res=[0.47157562871550596, 0.19370232477497007, 0.0, 0.0, 0.6331881142722686], res_norm=8.129e-01
2026-01-13 16:40:54,005 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:54,075 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:54,090 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:54,102 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:54,119 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:54,132 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:54,147 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:54,160 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:54,177 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:54,190 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:54,206 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:54,218 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:54,237 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:54,249 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:54,265 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:54,277 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:54,292 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:54,304 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:54,320 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:54,331 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:54,345 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:54,355 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:54,897 - WARNING - integration_test - Step 209: MPC solve failed
2026-01-13 16:40:54,897 - WARNING - integration_test -   Consecutive MPC failures: 1/5
2026-01-13 16:40:55,082 - INFO - integration_test - Step 209: Computed 6 numeric contouring constraints for visualization (s=15.580)
2026-01-13 16:40:55,082 - DEBUG - integration_test - Step 209: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:40:55,082 - INFO - integration_test - === Applying control at step 209 ===
2026-01-13 16:40:55,082 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 16:40:55,082 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:40:55,082 - INFO - integration_test -   Planner output success: False
2026-01-13 16:40:55,082 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 16:40:55,083 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:40:55,084 - INFO - integration_test - Step 209 completed in 1.224s
2026-01-13 16:40:55,097 - INFO - integration_test - Step 210 (contouring until path end)
2026-01-13 16:40:55,099 - DEBUG - integration_test - Syncing planner state at step 210: vehicle_state=[14.65511817  3.80732666 -0.07302887  3.00000003 15.88000015]
2026-01-13 16:40:55,099 - DEBUG - integration_test - Step 210: Using propagated spline 15.8800 (close to path, dist=0.602m, drift=0.129m)
2026-01-13 16:40:55,099 - DEBUG - integration_test -   Set spline state to 15.8800
2026-01-13 16:40:55,100 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:55,171 - DEBUG - integration_test - Step 210: Checking path alignment: vehicle=(14.655, 3.807), path_start=(0.000, 0.000), dist=15.142m
2026-01-13 16:40:55,171 - WARNING - integration_test - Step 210: Vehicle is far from path start (dist=15.142m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:40:55,171 - INFO - integration_test - === Calling planner.solve_mpc() at step 210 ===
2026-01-13 16:40:55,226 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:55,236 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:40:55,236 - INFO - integration_test - Warmstart k=0: x0=14.6307128022279 , y0=3.4345408156694273 , psi0=-0.07302886952758157 , v0=3.000000029820915 , spline0=15.930505197573696 , a0=0.0 , w0=0.0
2026-01-13 16:40:55,236 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:40:55,238 - INFO - integration_test - Dyn residual k=0: pred=[14.929913178311054, 3.412651623337276, -0.07302886952758157, 3.000000029820915, 16.230505200555786], ws=[14.75934040367495, 3.6444553525741883, -0.07302886952758136, 3.0, 15.921427245873993], res=[0.17057277463610454, -0.2318037292369124, -2.0816681711721685e-16, 2.9820915070644105e-08, 0.30907795468179344], res_norm=4.223e-01
2026-01-13 16:40:55,238 - INFO - integration_test - Dyn residual k=1: pred=[15.05854077678396, 3.6225661604596224, -0.07302886952758136, 3.0, 16.221427245873993], ws=[15.438707254994997, 3.2448487684054084, -0.07302886952758136, 3.0, 16.56764819051996], res=[-0.3801664782110361, 0.37771739205421406, 0.0, 0.0, -0.3462209446459674], res_norm=6.380e-01
2026-01-13 16:40:55,239 - INFO - integration_test - Dyn residual k=2: pred=[15.737907628104008, 3.2229595762908425, -0.07302886952758136, 3.0, 16.86764819051996], ws=[15.55271929387356, 3.7416590860678016, -0.07302886952758136, 3.0, 16.87778633940544], res=[0.1851883342304479, -0.5186995097769591, 0.0, 0.0, -0.010138148885477705], res_norm=5.509e-01
2026-01-13 16:40:55,253 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:55,327 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:55,343 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:55,355 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:55,370 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:55,381 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:55,396 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:55,408 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:55,423 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:55,436 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:55,451 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:55,463 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:55,478 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:55,490 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:55,506 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:55,517 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:55,534 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:55,546 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:55,561 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:55,571 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:55,584 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:55,596 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:55,805 - INFO - integration_test - Step 210: MPC solve successful
2026-01-13 16:40:56,394 - INFO - integration_test - Step 210: Computed 6 numeric contouring constraints for visualization (s=15.880)
2026-01-13 16:40:56,394 - DEBUG - integration_test - Step 210: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:40:56,394 - INFO - integration_test - === Applying control at step 210 ===
2026-01-13 16:40:56,394 - INFO - integration_test -   Control dict from planner: {'a': 1.1926995503812201e-09, 'w': 0.8000000098464412}
2026-01-13 16:40:56,394 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:40:56,394 - INFO - integration_test -   Planner output success: True
2026-01-13 16:40:56,395 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:40:56,396 - INFO - integration_test - Step 210 completed in 1.297s
2026-01-13 16:40:56,414 - INFO - integration_test - Step 211 (contouring until path end)
2026-01-13 16:40:56,415 - DEBUG - integration_test - Syncing planner state at step 211: vehicle_state=[1.49548746e+01 3.79742244e+00 6.97113146e-03 3.00000003e+00
 1.61800002e+01]
2026-01-13 16:40:56,416 - DEBUG - integration_test - Step 211: Using propagated spline 16.1800 (close to path, dist=0.529m, drift=0.176m)
2026-01-13 16:40:56,416 - DEBUG - integration_test -   Set spline state to 16.1800
2026-01-13 16:40:56,417 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:56,483 - DEBUG - integration_test - Step 211: Checking path alignment: vehicle=(14.955, 3.797), path_start=(0.000, 0.000), dist=15.429m
2026-01-13 16:40:56,483 - WARNING - integration_test - Step 211: Vehicle is far from path start (dist=15.429m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:40:56,483 - INFO - integration_test - === Calling planner.solve_mpc() at step 211 ===
2026-01-13 16:40:56,539 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:56,549 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:40:56,549 - INFO - integration_test - Warmstart k=0: x0=14.954874610769702 , y0=3.7974224445509424 , psi0=0.006971131457062532 , v0=3.000000029940185 , spline0=16.028484998547512 , a0=0.0 , w0=0.0
2026-01-13 16:40:56,549 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:40:56,550 - INFO - integration_test - Dyn residual k=0: pred=[15.2548673242921, 3.799513767070284, 0.006971131457062532, 3.000000029940185, 16.32848500154153], ws=[14.86772412724531, 3.1595485069693736, 0.006971131457062629, 3.0, 16.284394050975596], res=[0.38714319704678957, 0.6399652601009103, -9.71445146547012e-17, 2.9940184997911956e-08, 0.04409095056593415], res_norm=7.493e-01
2026-01-13 16:40:56,550 - INFO - integration_test - Dyn residual k=1: pred=[15.167716837773762, 3.1616398294678434, 0.006971131457062629, 3.0, 16.584394050975597], ws=[15.554860031826605, 3.801605089547882, 0.006971131457062629, 3.0, 16.610942563181766], res=[-0.38714319405284314, -0.6399652600800385, 0.0, 0.0, -0.02654851220616905], res_norm=7.484e-01
2026-01-13 16:40:56,551 - INFO - integration_test - Dyn residual k=2: pred=[15.854852742355057, 3.8036964120463517, 0.006971131457062629, 3.0, 16.910942563181766], ws=[16.044856139825683, 3.6555717390062363, 0.006971131457062629, 3.0, 17.40691895330038], res=[-0.1900033974706261, 0.14812467304011534, 0.0, 0.0, -0.4959763901186136], res_norm=5.514e-01
2026-01-13 16:40:56,565 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:56,636 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:56,651 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:56,663 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:56,678 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:56,689 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:56,704 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:56,716 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:56,731 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:56,743 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:56,758 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:56,769 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:56,784 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:56,796 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:56,810 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:56,823 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:56,839 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:56,850 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:56,865 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:56,876 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:56,889 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:56,899 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:57,113 - INFO - integration_test - Step 211: MPC solve successful
2026-01-13 16:40:57,312 - INFO - integration_test - Step 211: Computed 6 numeric contouring constraints for visualization (s=16.180)
2026-01-13 16:40:57,313 - DEBUG - integration_test - Step 211: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:40:57,313 - INFO - integration_test - === Applying control at step 211 ===
2026-01-13 16:40:57,313 - INFO - integration_test -   Control dict from planner: {'a': 3.608777682487729e-10, 'w': 0.7999999997979428}
2026-01-13 16:40:57,313 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:40:57,313 - INFO - integration_test -   Planner output success: True
2026-01-13 16:40:57,314 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:40:57,314 - INFO - integration_test - Step 211 completed in 0.899s
2026-01-13 16:40:57,332 - INFO - integration_test - Step 212 (contouring until path end)
2026-01-13 16:40:57,334 - DEBUG - integration_test - Syncing planner state at step 212: vehicle_state=[15.25446383  3.81150485  0.08697113  3.00000003 16.48000015]
2026-01-13 16:40:57,334 - DEBUG - integration_test - Step 212: Using propagated spline 16.4800 (close to path, dist=0.516m, drift=0.124m)
2026-01-13 16:40:57,334 - DEBUG - integration_test -   Set spline state to 16.4800
2026-01-13 16:40:57,336 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:57,405 - DEBUG - integration_test - Step 212: Checking path alignment: vehicle=(15.254, 3.812), path_start=(0.000, 0.000), dist=15.723m
2026-01-13 16:40:57,405 - WARNING - integration_test - Step 212: Vehicle is far from path start (dist=15.723m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:40:57,405 - INFO - integration_test - === Calling planner.solve_mpc() at step 212 ===
2026-01-13 16:40:57,460 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:57,469 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:40:57,469 - INFO - integration_test - Warmstart k=0: x0=15.254463830414462 , y0=3.8115048472988824 , psi0=0.08697113143685681 , v0=3.0000000299762726 , spline0=16.22747490053504 , a0=0.0 , w0=0.0
2026-01-13 16:40:57,470 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:40:57,471 - INFO - integration_test - Dyn residual k=0: pred=[15.553329951736938, 3.8375633070429895, 0.08697113143685681, 3.0000000299762726, 16.527474903532667], ws=[15.945964138346557, 3.5967315604034464, 0.08697113143685664, 3.0, 17.342840351104932], res=[-0.39263418660961946, 0.2408317466395431, 1.6653345369377348e-16, 2.997627257528279e-08, -0.8153654475722654], res_norm=9.365e-01
2026-01-13 16:40:57,471 - INFO - integration_test - Dyn residual k=1: pred=[16.244830256682736, 3.622790019887175, 0.08697113143685664, 3.0, 17.642840351104933], ws=[15.852196067086819, 3.86362176626634, 0.08697113143685664, 3.0, 17.005704771178934], res=[0.3926341895959169, -0.2408317463791647, 0.0, 0.0, 0.6371355799259995], res_norm=7.862e-01
2026-01-13 16:40:57,472 - INFO - integration_test - Dyn residual k=2: pred=[16.151062185422997, 3.8896802257500687, 0.08697113143685664, 3.0, 17.305704771178934], ws=[16.151062185422997, 3.8896802257500687, 0.08697113143685664, 3.0, 17.42178929463735], res=[0.0, 0.0, 0.0, 0.0, -0.11608452345841513], res_norm=1.161e-01
2026-01-13 16:40:57,485 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:57,555 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:57,570 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:57,581 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:57,596 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:57,607 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:57,622 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:57,634 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:57,649 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:57,660 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:57,674 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:57,686 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:57,700 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:57,712 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:57,726 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:57,738 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:57,752 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:57,763 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:57,778 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:57,788 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:57,801 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:57,811 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:57,990 - INFO - integration_test - Step 212: MPC solve successful
2026-01-13 16:40:58,186 - INFO - integration_test - Step 212: Computed 6 numeric contouring constraints for visualization (s=16.480)
2026-01-13 16:40:58,187 - DEBUG - integration_test - Step 212: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:40:58,187 - INFO - integration_test - === Applying control at step 212 ===
2026-01-13 16:40:58,187 - INFO - integration_test -   Control dict from planner: {'a': -1.1008232037112626e-10, 'w': 0.7999998048197646}
2026-01-13 16:40:58,187 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:40:58,187 - INFO - integration_test -   Planner output success: True
2026-01-13 16:40:58,188 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:40:58,188 - INFO - integration_test - Step 212 completed in 0.855s
2026-01-13 16:40:58,201 - INFO - integration_test - Step 213 (contouring until path end)
2026-01-13 16:40:58,205 - DEBUG - integration_test - Syncing planner state at step 213: vehicle_state=[15.55196949  3.84948379  0.16697111  3.00000003 16.78000016]
2026-01-13 16:40:58,205 - DEBUG - integration_test - Step 213: Using propagated spline 16.7800 (close to path, dist=0.447m, drift=0.182m)
2026-01-13 16:40:58,205 - DEBUG - integration_test -   Set spline state to 16.7800
2026-01-13 16:40:58,207 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:58,272 - DEBUG - integration_test - Step 213: Checking path alignment: vehicle=(15.552, 3.849), path_start=(0.000, 0.000), dist=16.021m
2026-01-13 16:40:58,272 - WARNING - integration_test - Step 213: Vehicle is far from path start (dist=16.021m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:40:58,272 - INFO - integration_test - === Calling planner.solve_mpc() at step 213 ===
2026-01-13 16:40:58,326 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:58,335 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:40:58,336 - INFO - integration_test - Warmstart k=0: x0=15.551969485251217 , y0=3.8494837882899415 , psi0=0.16697111191883326 , v0=3.0000000299652645 , spline0=16.628485004541666 , a0=0.0 , w0=0.0
2026-01-13 16:40:58,336 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:40:58,337 - INFO - integration_test - Dyn residual k=0: pred=[15.84779729207781, 3.899342694275568, 0.16697111191883326, 3.0000000299652645, 16.928485007538193], ws=[15.847797289122957, 3.899342693777556, 0.16697111191883307, 3.0, 17.00085703687554], res=[2.9548541391477556e-09, 4.980118539776868e-10, 1.942890293094024e-16, 2.996526449194903e-08, -0.07237202933734821], res_norm=7.237e-02
2026-01-13 16:40:58,338 - INFO - integration_test - Dyn residual k=1: pred=[16.143625092994697, 3.949201599265171, 0.16697111191883307, 3.0, 17.30085703687554], ws=[16.143625092994697, 3.949201599265171, 0.16697111191883307, 3.0, 17.447790883263217], res=[0.0, 0.0, 0.0, 0.0, -0.14693384638767526], res_norm=1.469e-01
2026-01-13 16:40:58,338 - INFO - integration_test - Dyn residual k=2: pred=[16.439452896866438, 3.9990605047527854, 0.16697111191883307, 3.0, 17.747790883263217], ws=[16.439452896866438, 3.9990605047527854, 0.16697111191883307, 3.0, 17.56045055409698], res=[0.0, 0.0, 0.0, 0.0, 0.18734032916623633], res_norm=1.873e-01
2026-01-13 16:40:58,352 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:58,422 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:58,437 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:58,449 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:58,464 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:58,475 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:58,489 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:58,501 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:58,515 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:58,527 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:58,542 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:58,553 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:58,568 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:58,580 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:58,595 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:58,606 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:58,621 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:58,633 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:58,648 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:58,659 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:58,671 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:58,681 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:58,900 - INFO - integration_test - Step 213: MPC solve successful
2026-01-13 16:40:59,093 - INFO - integration_test - Step 213: Computed 6 numeric contouring constraints for visualization (s=16.780)
2026-01-13 16:40:59,093 - DEBUG - integration_test - Step 213: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:40:59,093 - INFO - integration_test - === Applying control at step 213 ===
2026-01-13 16:40:59,093 - INFO - integration_test -   Control dict from planner: {'a': 2.304116643273324e-10, 'w': -0.44731914647675364}
2026-01-13 16:40:59,093 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:40:59,093 - INFO - integration_test -   Planner output success: True
2026-01-13 16:40:59,094 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:40:59,094 - INFO - integration_test - Step 213 completed in 0.890s
2026-01-13 16:40:59,110 - INFO - integration_test - Step 214 (contouring until path end)
2026-01-13 16:40:59,111 - DEBUG - integration_test - Syncing planner state at step 214: vehicle_state=[15.8488136   3.8927107   0.1222392   3.00000003 17.08000016]
2026-01-13 16:40:59,112 - DEBUG - integration_test - Step 214: Using propagated spline 17.0800 (close to path, dist=0.370m, drift=0.118m)
2026-01-13 16:40:59,112 - DEBUG - integration_test -   Set spline state to 17.0800
2026-01-13 16:40:59,113 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:59,180 - DEBUG - integration_test - Step 214: Checking path alignment: vehicle=(15.849, 3.893), path_start=(0.000, 0.000), dist=16.320m
2026-01-13 16:40:59,180 - WARNING - integration_test - Step 214: Vehicle is far from path start (dist=16.320m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:40:59,180 - INFO - integration_test - === Calling planner.solve_mpc() at step 214 ===
2026-01-13 16:40:59,233 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:40:59,243 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:40:59,243 - INFO - integration_test - Warmstart k=0: x0=15.84881360277075 , y0=3.892710699607597 , psi0=0.1222391972711579 , v0=3.0000000299883056 , spline0=17.0294951085506 , a0=0.0 , w0=0.0
2026-01-13 16:40:59,243 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:40:59,244 - INFO - integration_test - Dyn residual k=0: pred=[16.14657503210448, 3.929291199883468, 0.1222391972711579, 3.0000000299883056, 17.32949511154943], ws=[16.146575029128027, 3.9292911995178055, 0.12223919727115806, 3.0, 17.45413506570491], res=[2.9764528619580233e-09, 3.656626113013317e-10, -1.6653345369377348e-16, 2.998830561651289e-08, -0.12463995415548013], res_norm=1.246e-01
2026-01-13 16:40:59,245 - INFO - integration_test - Dyn residual k=1: pred=[16.444336455485303, 3.965871699428014, 0.12223919727115806, 3.0, 17.75413506570491], ws=[16.444336455485303, 3.965871699428014, 0.12223919727115806, 3.0, 17.641186722876988], res=[0.0, 0.0, 0.0, 0.0, 0.11294834282792365], res_norm=1.129e-01
2026-01-13 16:40:59,245 - INFO - integration_test - Dyn residual k=2: pred=[16.74209788184258, 4.002452199338223, 0.12223919727115806, 3.0, 17.94118672287699], ws=[16.74209788184258, 4.002452199338223, 0.12223919727115806, 3.0, 17.776471878109156], res=[0.0, 0.0, 0.0, 0.0, 0.1647148447678326], res_norm=1.647e-01
2026-01-13 16:40:59,259 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:59,328 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:59,343 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:59,355 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:59,369 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:59,381 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:59,395 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:59,406 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:59,421 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:59,433 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:59,447 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:59,459 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:59,473 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:59,485 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:59,499 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:59,511 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:59,526 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:59,537 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:40:59,552 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:59,562 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:59,575 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:40:59,585 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:40:59,758 - INFO - integration_test - Step 214: MPC solve successful
2026-01-13 16:40:59,961 - INFO - integration_test - Step 214: Computed 6 numeric contouring constraints for visualization (s=17.080)
2026-01-13 16:40:59,961 - DEBUG - integration_test - Step 214: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:40:59,961 - INFO - integration_test - === Applying control at step 214 ===
2026-01-13 16:40:59,961 - INFO - integration_test -   Control dict from planner: {'a': -3.038015249651664e-09, 'w': -0.7999987780629626}
2026-01-13 16:40:59,961 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:40:59,961 - INFO - integration_test -   Planner output success: True
2026-01-13 16:40:59,962 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:40:59,963 - INFO - integration_test - Step 214 completed in 0.851s
2026-01-13 16:40:59,978 - INFO - integration_test - Step 215 (contouring until path end)
2026-01-13 16:40:59,979 - DEBUG - integration_test - Syncing planner state at step 215: vehicle_state=[16.14771996  3.91734811  0.04223932  3.00000003 17.38000016]
2026-01-13 16:40:59,980 - DEBUG - integration_test - Step 215: Using propagated spline 17.3800 (close to path, dist=0.392m, drift=0.188m)
2026-01-13 16:40:59,980 - DEBUG - integration_test -   Set spline state to 17.3800
2026-01-13 16:40:59,981 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:00,048 - DEBUG - integration_test - Step 215: Checking path alignment: vehicle=(16.148, 3.917), path_start=(0.000, 0.000), dist=16.616m
2026-01-13 16:41:00,048 - WARNING - integration_test - Step 215: Vehicle is far from path start (dist=16.616m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:00,048 - INFO - integration_test - === Calling planner.solve_mpc() at step 215 ===
2026-01-13 16:41:00,100 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:00,109 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:00,109 - INFO - integration_test - Warmstart k=0: x0=16.147719964302098 , y0=3.9173481055146286 , psi0=0.04223931946486163 , v0=3.000000029684504 , spline0=17.430505212529148 , a0=0.0 , w0=0.0
2026-01-13 16:41:00,109 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:00,110 - INFO - integration_test - Dyn residual k=0: pred=[16.447452383039547, 3.9300161337301236, 0.04223931946486163, 3.000000029684504, 17.730505215497598], ws=[16.447452380073745, 3.9300161336047754, 0.04223931946486159, 3.0, 17.603224297862567], res=[2.9658018263489794e-09, 1.2534817628306882e-10, 4.163336342344337e-17, 2.968450418805446e-08, 0.12728091763503002], res_norm=1.273e-01
2026-01-13 16:41:00,111 - INFO - integration_test - Dyn residual k=1: pred=[16.747184795845392, 3.942684161694922, 0.04223931946486159, 3.0, 17.903224297862568], ws=[16.747184795845392, 3.942684161694922, 0.04223931946486159, 3.0, 18.024618375824012], res=[0.0, 0.0, 0.0, 0.0, -0.12139407796144397], res_norm=1.214e-01
2026-01-13 16:41:00,112 - INFO - integration_test - Dyn residual k=2: pred=[17.04691721161704, 3.955352189785069, 0.04223931946486159, 3.0, 18.324618375824013], ws=[17.04691721161704, 3.955352189785069, 0.04223931946486159, 3.0, 18.207040505671536], res=[0.0, 0.0, 0.0, 0.0, 0.117577870152477], res_norm=1.176e-01
2026-01-13 16:41:00,126 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:00,196 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:00,211 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:00,223 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:00,238 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:00,249 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:00,264 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:00,275 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:00,290 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:00,301 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:00,316 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:00,328 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:00,343 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:00,354 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:00,369 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:00,380 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:00,396 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:00,408 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:00,425 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:00,436 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:00,449 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:00,460 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:00,639 - INFO - integration_test - Step 215: MPC solve successful
2026-01-13 16:41:00,841 - INFO - integration_test - Step 215: Computed 6 numeric contouring constraints for visualization (s=17.380)
2026-01-13 16:41:00,841 - DEBUG - integration_test - Step 215: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:00,842 - INFO - integration_test - === Applying control at step 215 ===
2026-01-13 16:41:00,842 - INFO - integration_test -   Control dict from planner: {'a': 2.1021558755359337e-09, 'w': -0.8000000092076254}
2026-01-13 16:41:00,842 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:00,842 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:00,843 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:00,843 - INFO - integration_test - Step 215 completed in 0.864s
2026-01-13 16:41:00,858 - INFO - integration_test - Step 216 (contouring until path end)
2026-01-13 16:41:00,860 - DEBUG - integration_test - Syncing planner state at step 216: vehicle_state=[16.44763923  3.91801972 -0.03776068  3.00000003 17.68000017]
2026-01-13 16:41:00,860 - DEBUG - integration_test - Step 216: Using propagated spline 17.6800 (close to path, dist=0.303m, drift=0.112m)
2026-01-13 16:41:00,860 - DEBUG - integration_test -   Set spline state to 17.6800
2026-01-13 16:41:00,861 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:00,928 - DEBUG - integration_test - Step 216: Checking path alignment: vehicle=(16.448, 3.918), path_start=(0.000, 0.000), dist=16.908m
2026-01-13 16:41:00,928 - WARNING - integration_test - Step 216: Vehicle is far from path start (dist=16.908m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:00,928 - INFO - integration_test - === Calling planner.solve_mpc() at step 216 ===
2026-01-13 16:41:00,982 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:00,992 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:00,992 - INFO - integration_test - Warmstart k=0: x0=16.447639225962945 , y0=3.918019721539553 , psi0=-0.03776068145590089 , v0=3.0000000298947196 , spline0=17.326464811478218 , a0=0.0 , w0=0.0
2026-01-13 16:41:00,992 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:00,993 - INFO - integration_test - Dyn residual k=0: pred=[16.747425374003257, 3.9066942088873797, -0.03776068145590089, 3.0000000298947196, 17.62646481446769], ws=[16.747425371015918, 3.9066942090002374, -0.03776068145590106, 3.0, 17.765013141699182], res=[2.987338376669868e-09, -1.1285772316682596e-10, 1.6653345369377348e-16, 2.9894719588696717e-08, -0.13854832723149357], res_norm=1.385e-01
2026-01-13 16:41:00,994 - INFO - integration_test - Dyn residual k=1: pred=[17.04721151606889, 3.8953686964609213, -0.03776068145590106, 3.0, 18.065013141699183], ws=[17.04721151606889, 3.8953686964609213, -0.03776068145590106, 3.0, 18.16954224283678], res=[0.0, 0.0, 0.0, 0.0, -0.10452910113759728], res_norm=1.045e-01
2026-01-13 16:41:00,995 - INFO - integration_test - Dyn residual k=2: pred=[17.346997661121865, 3.884043183921605, -0.03776068145590106, 3.0, 18.46954224283678], ws=[17.346997661121865, 3.884043183921605, -0.03776068145590106, 3.0, 18.322657071655918], res=[0.0, 0.0, 0.0, 0.0, 0.14688517118086253], res_norm=1.469e-01
2026-01-13 16:41:01,009 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:01,080 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:01,096 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:01,107 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:01,123 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:01,135 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:01,150 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:01,162 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:01,177 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:01,188 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:01,203 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:01,214 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:01,230 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:01,241 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:01,256 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:01,268 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:01,283 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:01,294 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:01,309 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:01,320 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:01,333 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:01,344 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:01,509 - INFO - integration_test - Step 216: MPC solve successful
2026-01-13 16:41:01,736 - INFO - integration_test - Step 216: Computed 6 numeric contouring constraints for visualization (s=17.680)
2026-01-13 16:41:01,736 - DEBUG - integration_test - Step 216: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:01,736 - INFO - integration_test - === Applying control at step 216 ===
2026-01-13 16:41:01,736 - INFO - integration_test -   Control dict from planner: {'a': 7.009000587417471e-10, 'w': 0.1538232166575346}
2026-01-13 16:41:01,736 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:01,737 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:01,738 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:01,738 - INFO - integration_test - Step 216 completed in 0.879s
2026-01-13 16:41:01,751 - INFO - integration_test - Step 217 (contouring until path end)
2026-01-13 16:41:01,754 - DEBUG - integration_test - Syncing planner state at step 217: vehicle_state=[16.74750066  3.90900031 -0.02237836  3.00000003 17.98000017]
2026-01-13 16:41:01,755 - DEBUG - integration_test - Step 217: Using propagated spline 17.9800 (close to path, dist=0.429m, drift=0.194m)
2026-01-13 16:41:01,755 - DEBUG - integration_test -   Set spline state to 17.9800
2026-01-13 16:41:01,757 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:01,822 - DEBUG - integration_test - Step 217: Checking path alignment: vehicle=(16.748, 3.909), path_start=(0.000, 0.000), dist=17.198m
2026-01-13 16:41:01,822 - WARNING - integration_test - Step 217: Vehicle is far from path start (dist=17.198m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:01,822 - INFO - integration_test - === Calling planner.solve_mpc() at step 217 ===
2026-01-13 16:41:01,873 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:01,883 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:01,883 - INFO - integration_test - Warmstart k=0: x0=16.7475006564167 , y0=3.909000313530979 , psi0=-0.022378359790147434 , v0=3.0000000299648097 , spline0=18.030505218515103 , a0=0.0 , w0=0.0
2026-01-13 16:41:01,883 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:01,884 - INFO - integration_test - Dyn residual k=0: pred=[17.04742554389924, 3.902287365856898, -0.022378359790147434, 3.0000000299648097, 18.330505221511583], ws=[17.04742554090351, 3.9022873659239488, -0.02237835979014724, 3.0, 18.216464794302837], res=[2.995729886379195e-09, -6.70508093492117e-11, -1.942890293094024e-16, 2.996480974459814e-08, 0.11404042720874585], res_norm=1.140e-01
2026-01-13 16:41:01,885 - INFO - integration_test - Dyn residual k=1: pred=[17.34735042539032, 3.8955744183169183, -0.02237835979014724, 3.0, 18.516464794302838], ws=[17.34735042539032, 3.8955744183169183, -0.02237835979014724, 3.0, 18.350707178236274], res=[0.0, 0.0, 0.0, 0.0, 0.16575761606656414], res_norm=1.658e-01
2026-01-13 16:41:01,886 - INFO - integration_test - Dyn residual k=2: pred=[17.64727530987713, 3.888861470709888, -0.02237835979014724, 3.0, 18.650707178236274], ws=[17.64727530987713, 3.888861470709888, -0.02237835979014724, 3.0, 18.75361693669896], res=[0.0, 0.0, 0.0, 0.0, -0.1029097584626868], res_norm=1.029e-01
2026-01-13 16:41:01,899 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:01,968 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:01,983 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:01,995 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:02,009 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:02,021 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:02,036 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:02,047 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:02,062 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:02,073 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:02,088 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:02,099 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:02,114 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:02,125 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:02,140 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:02,152 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:02,167 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:02,178 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:02,193 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:02,203 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:02,216 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:02,227 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:02,414 - INFO - integration_test - Step 217: MPC solve successful
2026-01-13 16:41:02,644 - INFO - integration_test - Step 217: Computed 6 numeric contouring constraints for visualization (s=17.980)
2026-01-13 16:41:02,645 - DEBUG - integration_test - Step 217: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:02,645 - INFO - integration_test - === Applying control at step 217 ===
2026-01-13 16:41:02,645 - INFO - integration_test -   Control dict from planner: {'a': -1.5614029863563135e-09, 'w': 0.7999993193906955}
2026-01-13 16:41:02,645 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:02,645 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:02,646 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:02,646 - INFO - integration_test - Step 217 completed in 0.892s
2026-01-13 16:41:02,661 - INFO - integration_test - Step 218 (contouring until path end)
2026-01-13 16:41:02,663 - DEBUG - integration_test - Syncing planner state at step 218: vehicle_state=[17.04737411  3.91428511  0.05762157  3.00000003 18.28000017]
2026-01-13 16:41:02,663 - DEBUG - integration_test - Step 218: Using propagated spline 18.2800 (close to path, dist=0.298m, drift=0.106m)
2026-01-13 16:41:02,663 - DEBUG - integration_test -   Set spline state to 18.2800
2026-01-13 16:41:02,664 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:02,730 - DEBUG - integration_test - Step 218: Checking path alignment: vehicle=(17.047, 3.914), path_start=(0.000, 0.000), dist=17.491m
2026-01-13 16:41:02,730 - WARNING - integration_test - Step 218: Vehicle is far from path start (dist=17.491m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:02,730 - INFO - integration_test - === Calling planner.solve_mpc() at step 218 ===
2026-01-13 16:41:02,783 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:02,792 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:02,792 - INFO - integration_test - Warmstart k=0: x0=17.04737410567977 , y0=3.91428511238245 , psi0=0.05762157214892212 , v0=3.0000000298086693 , spline0=18.128485019475765 , a0=0.0 , w0=0.0
2026-01-13 16:41:02,792 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:02,794 - INFO - integration_test - Dyn residual k=0: pred=[17.346876209604286, 3.93156201989822, 0.05762157214892212, 3.0000000298086693, 18.42848502245663], ws=[17.346876206628366, 3.931562019726553, 0.05762157214892216, 3.0, 18.580799666699555], res=[2.975919954906203e-09, 1.716671249596402e-10, -4.163336342344337e-17, 2.980866931068249e-08, -0.1523146442429244], res_norm=1.523e-01
2026-01-13 16:41:02,794 - INFO - integration_test - Dyn residual k=1: pred=[17.646378307576963, 3.9488389270706556, 0.05762157214892216, 3.0, 18.880799666699556], ws=[17.646378307576963, 3.9488389270706556, 0.05762157214892216, 3.0, 19.001436823590794], res=[0.0, 0.0, 0.0, 0.0, -0.1206371568912381], res_norm=1.206e-01
2026-01-13 16:41:02,795 - INFO - integration_test - Dyn residual k=2: pred=[17.94588040852556, 3.9661158344147585, 0.05762157214892216, 3.0, 19.301436823590794], ws=[17.94588040852556, 3.9661158344147585, 0.05762157214892216, 3.0, 19.173371983456068], res=[0.0, 0.0, 0.0, 0.0, 0.1280648401347264], res_norm=1.281e-01
2026-01-13 16:41:02,809 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:02,878 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:02,893 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:02,905 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:02,920 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:02,932 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:02,946 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:02,957 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:02,972 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:02,983 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:02,998 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:03,009 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:03,024 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:03,036 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:03,051 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:03,062 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:03,077 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:03,089 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:03,104 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:03,114 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:03,128 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:03,139 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:03,340 - INFO - integration_test - Step 218: MPC solve successful
2026-01-13 16:41:03,569 - INFO - integration_test - Step 218: Computed 6 numeric contouring constraints for visualization (s=18.280)
2026-01-13 16:41:03,569 - DEBUG - integration_test - Step 218: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:03,569 - INFO - integration_test - === Applying control at step 218 ===
2026-01-13 16:41:03,569 - INFO - integration_test -   Control dict from planner: {'a': 1.2743869332338371e-09, 'w': 0.8000000097522345}
2026-01-13 16:41:03,569 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:03,569 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:03,570 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:03,571 - INFO - integration_test - Step 218 completed in 0.908s
2026-01-13 16:41:03,584 - INFO - integration_test - Step 219 (contouring until path end)
2026-01-13 16:41:03,587 - DEBUG - integration_test - Syncing planner state at step 219: vehicle_state=[17.34586614  3.94351729  0.13762157  3.00000003 18.58000017]
2026-01-13 16:41:03,588 - DEBUG - integration_test - Step 219: Using propagated spline 18.5800 (close to path, dist=0.400m, drift=0.406m)
2026-01-13 16:41:03,588 - DEBUG - integration_test -   Set spline state to 18.5800
2026-01-13 16:41:03,589 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:03,658 - DEBUG - integration_test - Step 219: Checking path alignment: vehicle=(17.346, 3.944), path_start=(0.000, 0.000), dist=17.788m
2026-01-13 16:41:03,658 - WARNING - integration_test - Step 219: Vehicle is far from path start (dist=17.788m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:03,658 - INFO - integration_test - === Calling planner.solve_mpc() at step 219 ===
2026-01-13 16:41:03,710 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:03,719 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:03,719 - INFO - integration_test - Warmstart k=0: x0=17.34586613933885 , y0=3.9435172937967202 , psi0=0.13762157312414558 , v0=3.000000029936108 , spline0=18.327474921459274 , a0=0.0 , w0=0.0
2026-01-13 16:41:03,720 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:03,721 - INFO - integration_test - Dyn residual k=0: pred=[17.64302966876766, 3.9846735639578728, 0.13762157312414558, 3.000000029936108, 18.627474924452883], ws=[17.643029665802356, 3.9846735635471866, 0.1376215731241457, 3.0, 18.72931895296776], res=[2.9653044464339473e-09, 4.1068615175277046e-10, -1.1102230246251565e-16, 2.993610781487632e-08, -0.10184402851487562], res_norm=1.018e-01
2026-01-13 16:41:03,722 - INFO - integration_test - Dyn residual k=1: pred=[17.940193192265863, 4.025829833297653, 0.1376215731241457, 3.0, 19.02931895296776], ws=[17.940193192265863, 4.025829833297653, 0.1376215731241457, 3.0, 18.87976193533947], res=[0.0, 0.0, 0.0, 0.0, 0.14955701762828966], res_norm=1.496e-01
2026-01-13 16:41:03,722 - INFO - integration_test - Dyn residual k=2: pred=[18.23735671872937, 4.066986103048119, 0.1376215731241457, 3.0, 19.17976193533947], ws=[18.23735671872937, 4.066986103048119, 0.1376215731241457, 3.0, 19.30136849546023], res=[0.0, 0.0, 0.0, 0.0, -0.12160656012076032], res_norm=1.216e-01
2026-01-13 16:41:03,736 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:03,806 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:03,822 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:03,833 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:03,849 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:03,860 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:03,875 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:03,887 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:03,906 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:03,919 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:03,934 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:03,946 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:03,960 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:03,972 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:03,986 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:03,997 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:04,012 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:04,024 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:04,040 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:04,049 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:04,062 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:04,072 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:04,250 - INFO - integration_test - Step 219: MPC solve successful
2026-01-13 16:41:04,489 - INFO - integration_test - Step 219: Computed 6 numeric contouring constraints for visualization (s=18.580)
2026-01-13 16:41:04,489 - DEBUG - integration_test - Step 219: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:04,490 - INFO - integration_test - === Applying control at step 219 ===
2026-01-13 16:41:04,490 - INFO - integration_test -   Control dict from planner: {'a': -2.3836885152285225e-10, 'w': 0.7999998635234378}
2026-01-13 16:41:04,490 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:04,490 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:04,491 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:04,491 - INFO - integration_test - Step 219 completed in 0.904s
2026-01-13 16:41:04,510 - INFO - integration_test - Step 220 (contouring until path end)
2026-01-13 16:41:04,512 - DEBUG - integration_test - Syncing planner state at step 220: vehicle_state=[17.64106743  3.99650988  0.21762156  3.00000003 18.88000018]
2026-01-13 16:41:04,512 - DEBUG - integration_test - Step 220: Using propagated spline 18.8800 (close to path, dist=0.252m, drift=0.100m)
2026-01-13 16:41:04,512 - DEBUG - integration_test -   Set spline state to 18.8800
2026-01-13 16:41:04,513 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:04,580 - DEBUG - integration_test - Step 220: Checking path alignment: vehicle=(17.641, 3.997), path_start=(0.000, 0.000), dist=18.088m
2026-01-13 16:41:04,580 - WARNING - integration_test - Step 220: Vehicle is far from path start (dist=18.088m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:04,580 - INFO - integration_test - === Calling planner.solve_mpc() at step 220 ===
2026-01-13 16:41:04,635 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:04,644 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:04,644 - INFO - integration_test - Warmstart k=0: x0=17.641067427345853 , y0=3.9965098797670366 , psi0=0.21762155947648937 , v0=3.000000029912271 , spline0=18.7284850254606 , a0=0.0 , w0=0.0
2026-01-13 16:41:04,644 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:04,645 - INFO - integration_test - Dyn residual k=0: pred=[17.933991550678225, 4.061282248603585, 0.21762155947648937, 3.000000029912271, 19.028485028451826], ws=[17.93399154775755, 4.061282247957756, 0.21762155947648942, 3.0, 18.89188143014674], res=[2.9206752572008554e-09, 6.458291679223294e-10, -5.551115123125783e-17, 2.991227088244841e-08, 0.1366035983050864], res_norm=1.366e-01
2026-01-13 16:41:04,646 - INFO - integration_test - Dyn residual k=1: pred=[18.226915668169248, 4.126054616148475, 0.21762155947648942, 3.0, 19.19188143014674], ws=[18.226915668169248, 4.126054616148475, 0.21762155947648942, 3.0, 19.32900619240015], res=[0.0, 0.0, 0.0, 0.0, -0.13712476225341064], res_norm=1.371e-01
2026-01-13 16:41:04,647 - INFO - integration_test - Dyn residual k=2: pred=[18.519839788580946, 4.1908269843391945, 0.21762155947648942, 3.0, 19.62900619240015], ws=[18.519839788580946, 4.1908269843391945, 0.21762155947648942, 3.0, 19.73190267125194], res=[0.0, 0.0, 0.0, 0.0, -0.10289647885178965], res_norm=1.029e-01
2026-01-13 16:41:04,661 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:04,732 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:04,747 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:04,759 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:04,774 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:04,785 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:04,800 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:04,811 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:04,826 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:04,838 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:04,852 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:04,864 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:04,878 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:04,890 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:04,904 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:04,916 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:04,931 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:04,943 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:04,958 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:04,968 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:04,981 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:04,991 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:05,194 - INFO - integration_test - Step 220: MPC solve successful
2026-01-13 16:41:05,451 - INFO - integration_test - Step 220: Computed 6 numeric contouring constraints for visualization (s=18.880)
2026-01-13 16:41:05,451 - DEBUG - integration_test - Step 220: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:05,451 - INFO - integration_test - === Applying control at step 220 ===
2026-01-13 16:41:05,451 - INFO - integration_test -   Control dict from planner: {'a': 5.797397622335662e-10, 'w': 0.8000000086795391}
2026-01-13 16:41:05,451 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:05,451 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:05,453 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:05,453 - INFO - integration_test - Step 220 completed in 0.942s
2026-01-13 16:41:05,466 - INFO - integration_test - Step 221 (contouring until path end)
2026-01-13 16:41:05,469 - DEBUG - integration_test - Syncing planner state at step 221: vehicle_state=[17.93108969  4.0729239   0.29762156  3.00000003 19.18000018]
2026-01-13 16:41:05,470 - DEBUG - integration_test - Step 221: Using propagated spline 19.1800 (close to path, dist=0.287m, drift=0.400m)
2026-01-13 16:41:05,470 - DEBUG - integration_test -   Set spline state to 19.1800
2026-01-13 16:41:05,471 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:05,538 - DEBUG - integration_test - Step 221: Checking path alignment: vehicle=(17.931, 4.073), path_start=(0.000, 0.000), dist=18.388m
2026-01-13 16:41:05,538 - WARNING - integration_test - Step 221: Vehicle is far from path start (dist=18.388m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:05,538 - INFO - integration_test - === Calling planner.solve_mpc() at step 221 ===
2026-01-13 16:41:05,590 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:05,599 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:05,599 - INFO - integration_test - Warmstart k=0: x0=17.931089689105356 , y0=4.072923898613915 , psi0=0.2976215603444433 , v0=3.000000029970245 , spline0=19.129495129467728 , a0=0.0 , w0=0.0
2026-01-13 16:41:05,599 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:05,600 - INFO - integration_test - Dyn residual k=0: pred=[18.217900690956217, 4.160898048314383, 0.2976215603444433, 3.000000029970245, 19.42949513246475], ws=[18.21790068809095, 4.160898047435514, 0.2976215603444432, 3.0, 19.54598445369116], res=[2.865267134666283e-09, 8.788694216832482e-10, 1.1102230246251565e-16, 2.99702449524375e-08, -0.11648932122641042], res_norm=1.165e-01
2026-01-13 16:41:05,601 - INFO - integration_test - Dyn residual k=1: pred=[18.504711687076544, 4.248872196257112, 0.2976215603444432, 3.0, 19.845984453691162], ws=[18.504711687076544, 4.248872196257112, 0.2976215603444432, 3.0, 19.71297585736999], res=[0.0, 0.0, 0.0, 0.0, 0.13300859632117223], res_norm=1.330e-01
2026-01-13 16:41:05,602 - INFO - integration_test - Dyn residual k=2: pred=[18.791522686062137, 4.336846345078711, 0.2976215603444432, 3.0, 20.01297585736999], ws=[18.791522686062137, 4.336846345078711, 0.2976215603444432, 3.0, 20.153561411572724], res=[0.0, 0.0, 0.0, 0.0, -0.14058555420273322], res_norm=1.406e-01
2026-01-13 16:41:05,616 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:05,685 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:05,700 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:05,712 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:05,728 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:05,739 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:05,754 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:05,765 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:05,780 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:05,791 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:05,806 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:05,818 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:05,833 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:05,845 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:05,859 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:05,871 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:05,885 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:05,897 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:05,912 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:05,922 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:05,935 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:05,946 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:06,161 - INFO - integration_test - Step 221: MPC solve successful
2026-01-13 16:41:06,417 - INFO - integration_test - Step 221: Computed 6 numeric contouring constraints for visualization (s=19.180)
2026-01-13 16:41:06,417 - DEBUG - integration_test - Step 221: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:06,417 - INFO - integration_test - === Applying control at step 221 ===
2026-01-13 16:41:06,417 - INFO - integration_test -   Control dict from planner: {'a': -1.6580193444553354e-10, 'w': 0.7999999240560991}
2026-01-13 16:41:06,417 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:06,417 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:06,418 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:06,419 - INFO - integration_test - Step 221 completed in 0.951s
2026-01-13 16:41:06,433 - INFO - integration_test - Step 222 (contouring until path end)
2026-01-13 16:41:06,435 - DEBUG - integration_test - Syncing planner state at step 222: vehicle_state=[18.21407777  4.17227056  0.37762155  3.00000003 19.48000018]
2026-01-13 16:41:06,435 - DEBUG - integration_test - Step 222: Using propagated spline 19.4800 (close to path, dist=0.187m, drift=0.095m)
2026-01-13 16:41:06,435 - DEBUG - integration_test -   Set spline state to 19.4800
2026-01-13 16:41:06,438 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:06,507 - DEBUG - integration_test - Step 222: Checking path alignment: vehicle=(18.214, 4.172), path_start=(0.000, 0.000), dist=18.686m
2026-01-13 16:41:06,507 - WARNING - integration_test - Step 222: Vehicle is far from path start (dist=18.686m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:06,507 - INFO - integration_test - === Calling planner.solve_mpc() at step 222 ===
2026-01-13 16:41:06,561 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:06,571 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:06,571 - INFO - integration_test - Warmstart k=0: x0=18.214077771913928 , y0=4.172270562333175 , psi0=0.3776215527500532 , v0=3.000000029953665 , spline0=19.328485031452992 , a0=0.0 , w0=0.0
2026-01-13 16:41:06,571 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:06,572 - INFO - integration_test - Dyn residual k=0: pred=[18.492941041533218, 4.282883756186619, 0.3776215527500532, 3.000000029953665, 19.62848503444836], ws=[18.492941038748892, 4.282883755082195, 0.37762155275005327, 3.0, 19.70819096737943], res=[2.784325658922171e-09, 1.1044241077229344e-09, -5.551115123125783e-17, 2.9953664881787745e-08, -0.07970593293106987], res_norm=7.971e-02
2026-01-13 16:41:06,573 - INFO - integration_test - Dyn residual k=1: pred=[18.771804305583856, 4.393496947831215, 0.37762155275005327, 3.0, 20.00819096737943], ws=[18.771804305583856, 4.393496947831215, 0.37762155275005327, 3.0, 19.85890142647551], res=[0.0, 0.0, 0.0, 0.0, 0.1492895409039221], res_norm=1.493e-01
2026-01-13 16:41:06,574 - INFO - integration_test - Dyn residual k=2: pred=[19.05066757241882, 4.504110140580235, 0.37762155275005327, 3.0, 20.15890142647551], ws=[19.05066757241882, 4.504110140580235, 0.37762155275005327, 3.0, 20.28115159386871], res=[0.0, 0.0, 0.0, 0.0, -0.12225016739320083], res_norm=1.223e-01
2026-01-13 16:41:06,587 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:06,657 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:06,672 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:06,684 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:06,699 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:06,710 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:06,725 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:06,737 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:06,751 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:06,763 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:06,777 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:06,789 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:06,803 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:06,815 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:06,829 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:06,841 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:06,855 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:06,867 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:06,882 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:06,892 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:06,905 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:06,915 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:07,094 - INFO - integration_test - Step 222: MPC solve successful
2026-01-13 16:41:07,353 - INFO - integration_test - Step 222: Computed 6 numeric contouring constraints for visualization (s=19.480)
2026-01-13 16:41:07,353 - DEBUG - integration_test - Step 222: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:07,353 - INFO - integration_test - === Applying control at step 222 ===
2026-01-13 16:41:07,353 - INFO - integration_test -   Control dict from planner: {'a': -4.1263688689965627e-10, 'w': 0.7999997438839721}
2026-01-13 16:41:07,353 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:07,354 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:07,355 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:07,355 - INFO - integration_test - Step 222 completed in 0.921s
2026-01-13 16:41:07,369 - INFO - integration_test - Step 223 (contouring until path end)
2026-01-13 16:41:07,372 - DEBUG - integration_test - Syncing planner state at step 223: vehicle_state=[18.48822152  4.29391439  0.45762153  3.00000003 19.78000019]
2026-01-13 16:41:07,373 - DEBUG - integration_test - Step 223: Using propagated spline 19.7800 (close to path, dist=0.146m, drift=0.395m)
2026-01-13 16:41:07,373 - DEBUG - integration_test -   Set spline state to 19.7800
2026-01-13 16:41:07,374 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:07,440 - DEBUG - integration_test - Step 223: Checking path alignment: vehicle=(18.488, 4.294), path_start=(0.000, 0.000), dist=18.980m
2026-01-13 16:41:07,440 - WARNING - integration_test - Step 223: Vehicle is far from path start (dist=18.980m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:07,440 - INFO - integration_test - === Calling planner.solve_mpc() at step 223 ===
2026-01-13 16:41:07,493 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:07,503 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:07,503 - INFO - integration_test - Warmstart k=0: x0=18.488221519542783 , y0=4.293914387740391 , psi0=0.45762152713845045 , v0=3.000000029912401 , spline0=19.729495135454336 , a0=0.0 , w0=0.0
2026-01-13 16:41:07,503 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:07,504 - INFO - integration_test - Dyn residual k=0: pred=[18.757353286379647, 4.4264590740692356, 0.45762152713845045, 3.000000029912401, 20.029495138445576], ws=[18.757353283696187, 4.426459072747659, 0.4576215271384503, 3.0, 19.858173972988183], res=[2.683460564867346e-09, 1.3215766259122574e-09, 1.6653345369377348e-16, 2.99124010005869e-08, 0.1713211654573925], res_norm=1.713e-01
2026-01-13 16:41:07,505 - INFO - integration_test - Dyn residual k=1: pred=[19.02648504784959, 4.559003757754927, 0.4576215271384503, 3.0, 20.158173972988184], ws=[19.02648504784959, 4.559003757754927, 0.4576215271384503, 3.0, 20.05435122494689], res=[0.0, 0.0, 0.0, 0.0, 0.10382274804129565], res_norm=1.038e-01
2026-01-13 16:41:07,506 - INFO - integration_test - Dyn residual k=2: pred=[19.295616812002994, 4.691548442762195, 0.4576215271384503, 3.0, 20.35435122494689], ws=[19.295616812002994, 4.691548442762195, 0.4576215271384503, 3.0, 20.702147536593564], res=[0.0, 0.0, 0.0, 0.0, -0.34779631164667535], res_norm=3.478e-01
2026-01-13 16:41:07,520 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:07,589 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:07,604 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:07,616 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:07,632 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:07,643 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:07,658 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:07,669 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:07,684 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:07,695 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:07,710 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:07,722 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:07,737 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:07,749 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:07,764 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:07,775 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:07,790 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:07,802 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:07,818 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:07,830 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:07,843 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:07,854 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:08,043 - INFO - integration_test - Step 223: MPC solve successful
2026-01-13 16:41:08,316 - INFO - integration_test - Step 223: Computed 6 numeric contouring constraints for visualization (s=19.780)
2026-01-13 16:41:08,316 - DEBUG - integration_test - Step 223: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:08,316 - INFO - integration_test - === Applying control at step 223 ===
2026-01-13 16:41:08,317 - INFO - integration_test -   Control dict from planner: {'a': -2.0937294151423635e-07, 'w': -0.5097451426415646}
2026-01-13 16:41:08,317 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:08,317 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:08,318 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:08,319 - INFO - integration_test - Step 223 completed in 0.946s
2026-01-13 16:41:08,334 - INFO - integration_test - Step 224 (contouring until path end)
2026-01-13 16:41:08,338 - DEBUG - integration_test - Syncing planner state at step 224: vehicle_state=[18.76061422  4.41954374  0.40664701  3.00000001 20.08000019]
2026-01-13 16:41:08,338 - DEBUG - integration_test - Step 224: Using propagated spline 20.0800 (close to path, dist=0.217m, drift=0.089m)
2026-01-13 16:41:08,338 - DEBUG - integration_test -   Set spline state to 20.0800
2026-01-13 16:41:08,339 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:08,405 - DEBUG - integration_test - Step 224: Checking path alignment: vehicle=(18.761, 4.420), path_start=(0.000, 0.000), dist=19.274m
2026-01-13 16:41:08,405 - WARNING - integration_test - Step 224: Vehicle is far from path start (dist=19.274m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:08,405 - INFO - integration_test - === Calling planner.solve_mpc() at step 224 ===
2026-01-13 16:41:08,458 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:08,468 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:08,468 - INFO - integration_test - Warmstart k=0: x0=18.76061421823082 , y0=4.419543735304182 , psi0=0.406647012874294 , v0=3.000000008975107 , spline0=20.130505237361945 , a0=0.0 , w0=0.0
2026-01-13 16:41:08,468 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:08,470 - INFO - integration_test - Dyn residual k=0: pred=[19.036149878121, 4.538203335284075, 0.406647012874294, 3.000000008975107, 20.430505238259457], ws=[19.036149877296683, 4.538203334929082, 0.40664701287429406, 3.0, 20.018043388506186], res=[8.243183913236862e-10, 3.5499336803468395e-10, -5.551115123125783e-17, 8.975106879915984e-09, 0.4124618497532708], res_norm=4.125e-01
2026-01-13 16:41:08,470 - INFO - integration_test - Dyn residual k=1: pred=[19.311685536362546, 4.656862934553982, 0.40664701287429406, 3.0, 20.318043388506187], ws=[19.311685536362546, 4.656862934553982, 0.40664701287429406, 3.0, 20.686861673892746], res=[0.0, 0.0, 0.0, 0.0, -0.3688182853865598], res_norm=3.688e-01
2026-01-13 16:41:08,471 - INFO - integration_test - Dyn residual k=2: pred=[19.58722119542841, 4.775522534178882, 0.40664701287429406, 3.0, 20.986861673892747], ws=[19.58722119542841, 4.775522534178882, 0.40664701287429406, 3.0, 20.617649769742414], res=[0.0, 0.0, 0.0, 0.0, 0.3692119041503332], res_norm=3.692e-01
2026-01-13 16:41:08,485 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:08,556 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:08,571 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:08,582 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:08,598 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:08,609 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:08,625 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:08,637 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:08,651 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:08,663 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:08,677 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:08,689 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:08,704 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:08,716 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:08,732 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:08,744 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:08,759 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:08,771 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:08,786 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:08,796 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:08,810 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:08,820 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:09,003 - INFO - integration_test - Step 224: MPC solve successful
2026-01-13 16:41:09,304 - INFO - integration_test - Step 224: Computed 6 numeric contouring constraints for visualization (s=20.080)
2026-01-13 16:41:09,304 - DEBUG - integration_test - Step 224: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:09,304 - INFO - integration_test - === Applying control at step 224 ===
2026-01-13 16:41:09,304 - INFO - integration_test -   Control dict from planner: {'a': 2.1011479342120875e-07, 'w': -0.7999739710827191}
2026-01-13 16:41:09,305 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:09,305 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:09,306 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:09,306 - INFO - integration_test - Step 224 completed in 0.969s
2026-01-13 16:41:09,322 - INFO - integration_test - Step 225 (contouring until path end)
2026-01-13 16:41:09,327 - DEBUG - integration_test - Syncing planner state at step 225: vehicle_state=[19.04059979  4.52706162  0.32664962  3.00000003 20.38000019]
2026-01-13 16:41:09,327 - DEBUG - integration_test - Step 225: Using propagated spline 20.3800 (close to path, dist=0.130m, drift=0.389m)
2026-01-13 16:41:09,327 - DEBUG - integration_test -   Set spline state to 20.3800
2026-01-13 16:41:09,329 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:09,394 - DEBUG - integration_test - Step 225: Checking path alignment: vehicle=(19.041, 4.527), path_start=(0.000, 0.000), dist=19.571m
2026-01-13 16:41:09,394 - WARNING - integration_test - Step 225: Vehicle is far from path start (dist=19.571m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:09,395 - INFO - integration_test - === Calling planner.solve_mpc() at step 225 ===
2026-01-13 16:41:09,448 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:09,458 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:09,458 - INFO - integration_test - Warmstart k=0: x0=19.040599790484876 , y0=4.527061624129733 , psi0=0.3266496157660221 , v0=3.000000029986586 , spline0=20.0264648363202 , a0=0.0 , w0=0.0
2026-01-13 16:41:09,458 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:09,459 - INFO - integration_test - Dyn residual k=0: pred=[19.324736603462313, 4.623323108173039, 0.3266496157660221, 3.000000029986586, 20.32646483931886], ws=[19.324736600622217, 4.6233231072108545, 0.3266496157660219, 3.0, 20.46850322849559], res=[2.8400961582519813e-09, 9.621841101647988e-10, 1.6653345369377348e-16, 2.998658610309235e-08, -0.1420383891767294], res_norm=1.420e-01
2026-01-13 16:41:09,460 - INFO - integration_test - Dyn residual k=1: pred=[19.608873410759557, 4.719584590291976, 0.3266496157660219, 3.0, 20.76850322849559], ws=[19.608873410759557, 4.719584590291976, 0.3266496157660219, 3.0, 20.875749715340916], res=[0.0, 0.0, 0.0, 0.0, -0.10724648684532667], res_norm=1.072e-01
2026-01-13 16:41:09,461 - INFO - integration_test - Dyn residual k=2: pred=[19.893010220896898, 4.815846073373098, 0.3266496157660219, 3.0, 21.175749715340917], ws=[19.893010220896898, 4.815846073373098, 0.3266496157660219, 3.0, 21.02527259970936], res=[0.0, 0.0, 0.0, 0.0, 0.1504771156315563], res_norm=1.505e-01
2026-01-13 16:41:09,475 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:09,547 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:09,562 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:09,574 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:09,590 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:09,601 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:09,616 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:09,628 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:09,643 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:09,655 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:09,669 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:09,681 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:09,695 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:09,707 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:09,722 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:09,733 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:09,749 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:09,760 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:09,775 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:09,785 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:09,798 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:09,808 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:20,162 - WARNING - integration_test - Step 225: MPC solve failed
2026-01-13 16:41:20,162 - WARNING - integration_test -   Consecutive MPC failures: 1/5
2026-01-13 16:41:20,909 - INFO - integration_test - Step 225: Computed 6 numeric contouring constraints for visualization (s=20.380)
2026-01-13 16:41:20,910 - DEBUG - integration_test - Step 225: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:20,910 - INFO - integration_test - === Applying control at step 225 ===
2026-01-13 16:41:20,910 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 16:41:20,910 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:20,910 - INFO - integration_test -   Planner output success: False
2026-01-13 16:41:20,910 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 16:41:20,911 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:20,911 - INFO - integration_test - Step 225 completed in 11.585s
2026-01-13 16:41:20,930 - INFO - integration_test - Step 226 (contouring until path end)
2026-01-13 16:41:20,931 - DEBUG - integration_test - Syncing planner state at step 226: vehicle_state=[19.3247366   4.62332311  0.32664962  3.00000003 20.68000019]
2026-01-13 16:41:20,932 - DEBUG - integration_test - Step 226: Using propagated spline 20.6800 (close to path, dist=0.282m, drift=0.083m)
2026-01-13 16:41:20,932 - DEBUG - integration_test -   Set spline state to 20.6800
2026-01-13 16:41:20,933 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:20,999 - DEBUG - integration_test - Step 226: Checking path alignment: vehicle=(19.325, 4.623), path_start=(0.000, 0.000), dist=19.870m
2026-01-13 16:41:20,999 - WARNING - integration_test - Step 226: Vehicle is far from path start (dist=19.870m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:20,999 - INFO - integration_test - === Calling planner.solve_mpc() at step 226 ===
2026-01-13 16:41:21,053 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:21,062 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:21,062 - INFO - integration_test - Warmstart k=0: x0=19.324736603462313 , y0=4.623323108173039 , psi0=0.3266496157660221 , v0=3.000000029986586 , spline0=20.73050524335926 , a0=0.0 , w0=0.0
2026-01-13 16:41:21,062 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:21,064 - INFO - integration_test - Dyn residual k=0: pred=[19.60887341643975, 4.719584592216345, 0.3266496157660221, 3.000000029986586, 21.03050524635792], ws=[19.608873413599653, 4.7195845912541605, 0.3266496157660219, 3.0, 20.61647085350678], res=[2.8400961582519813e-09, 9.621841101647988e-10, 1.6653345369377348e-16, 2.998658610309235e-08, 0.4140343928511392], res_norm=4.140e-01
2026-01-13 16:41:21,064 - INFO - integration_test - Dyn residual k=1: pred=[19.893010223736994, 4.8158460743352824, 0.3266496157660219, 3.0, 20.91647085350678], ws=[19.893010223736994, 4.8158460743352824, 0.3266496157660219, 3.0, 21.050131192084606], res=[0.0, 0.0, 0.0, 0.0, -0.1336603385778261], res_norm=1.337e-01
2026-01-13 16:41:21,065 - INFO - integration_test - Dyn residual k=2: pred=[20.177147033874334, 4.912107557416404, 0.3266496157660219, 3.0, 21.350131192084607], ws=[20.177147033874334, 4.912107557416404, 0.3266496157660219, 3.0, 21.44730526848877], res=[0.0, 0.0, 0.0, 0.0, -0.09717407640416198], res_norm=9.717e-02
2026-01-13 16:41:21,079 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:21,148 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:21,164 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:21,175 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:21,190 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:21,202 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:21,216 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:21,228 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:21,243 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:21,254 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:21,269 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:21,280 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:21,295 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:21,306 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:21,321 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:21,332 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:21,347 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:21,359 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:21,373 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:21,383 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:21,396 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:21,407 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:22,060 - INFO - integration_test - Step 226: MPC solve successful
2026-01-13 16:41:22,370 - INFO - integration_test - Step 226: Computed 6 numeric contouring constraints for visualization (s=20.680)
2026-01-13 16:41:22,370 - DEBUG - integration_test - Step 226: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:22,370 - INFO - integration_test - === Applying control at step 226 ===
2026-01-13 16:41:22,370 - INFO - integration_test -   Control dict from planner: {'a': 8.806541551713231e-11, 'w': 0.8000000094280059}
2026-01-13 16:41:22,370 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:22,370 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:22,371 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:22,372 - INFO - integration_test - Step 226 completed in 1.441s
2026-01-13 16:41:22,387 - INFO - integration_test - Step 227 (contouring until path end)
2026-01-13 16:41:22,389 - DEBUG - integration_test - Syncing planner state at step 227: vehicle_state=[19.60472203  4.73084136  0.40664962  3.00000003 20.9800002 ]
2026-01-13 16:41:22,390 - DEBUG - integration_test - Step 227: Using propagated spline 20.9800 (close to path, dist=0.175m, drift=0.383m)
2026-01-13 16:41:22,390 - DEBUG - integration_test -   Set spline state to 20.9800
2026-01-13 16:41:22,391 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:22,457 - DEBUG - integration_test - Step 227: Checking path alignment: vehicle=(19.605, 4.731), path_start=(0.000, 0.000), dist=20.167m
2026-01-13 16:41:22,457 - WARNING - integration_test - Step 227: Vehicle is far from path start (dist=20.167m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:22,457 - INFO - integration_test - === Calling planner.solve_mpc() at step 227 ===
2026-01-13 16:41:22,509 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:22,519 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:22,519 - INFO - integration_test - Warmstart k=0: x0=19.604722031852447 , y0=4.7308413600399355 , psi0=0.40664961670882266 , v0=3.000000029995393 , spline0=20.6264648423184 , a0=0.0 , w0=0.0
2026-01-13 16:41:22,519 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:22,520 - INFO - integration_test - Dyn residual k=0: pred=[19.880257384702343, 4.849501678300117, 0.40664961670882266, 3.000000029995393, 20.926464845317938], ws=[19.880257381947413, 4.849501677113696, 0.4066496167088225, 3.0, 21.27485168289227], res=[2.7549305059437756e-09, 1.18642073942965e-09, 1.6653345369377348e-16, 2.9995392836212886e-08, -0.3483868375743313], res_norm=3.484e-01
2026-01-13 16:41:22,521 - INFO - integration_test - Dyn residual k=1: pred=[20.15579273204238, 4.968161994187456, 0.4066496167088225, 3.0, 21.57485168289227], ws=[20.15579273204238, 4.968161994187456, 0.4066496167088225, 3.0, 21.484601704343273], res=[0.0, 0.0, 0.0, 0.0, 0.09024997854899652], res_norm=9.025e-02
2026-01-13 16:41:22,522 - INFO - integration_test - Dyn residual k=2: pred=[20.431328082137345, 5.0868223112612165, 0.4066496167088225, 3.0, 21.784601704343274], ws=[20.431328082137345, 5.0868223112612165, 0.4066496167088225, 3.0, 21.63713919752383], res=[0.0, 0.0, 0.0, 0.0, 0.14746250681944417], res_norm=1.475e-01
2026-01-13 16:41:22,536 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:22,606 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:22,622 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:22,633 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:22,649 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:22,661 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:22,675 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:22,687 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:22,701 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:22,713 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:22,727 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:22,739 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:22,754 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:22,765 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:22,779 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:22,791 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:22,805 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:22,817 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:22,831 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:22,842 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:22,855 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:22,865 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:23,083 - INFO - integration_test - Step 227: MPC solve successful
2026-01-13 16:41:23,386 - INFO - integration_test - Step 227: Computed 6 numeric contouring constraints for visualization (s=20.980)
2026-01-13 16:41:23,386 - DEBUG - integration_test - Step 227: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:23,386 - INFO - integration_test - === Applying control at step 227 ===
2026-01-13 16:41:23,386 - INFO - integration_test -   Control dict from planner: {'a': -1.7366718256868233e-09, 'w': -0.5629649224027824}
2026-01-13 16:41:23,386 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:23,386 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:23,387 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:23,388 - INFO - integration_test - Step 227 completed in 0.998s
2026-01-13 16:41:23,402 - INFO - integration_test - Step 228 (contouring until path end)
2026-01-13 16:41:23,405 - DEBUG - integration_test - Syncing planner state at step 228: vehicle_state=[19.88345106  4.84168522  0.35035312  3.00000003 21.2800002 ]
2026-01-13 16:41:23,406 - DEBUG - integration_test - Step 228: Using propagated spline 21.2800 (close to path, dist=0.335m, drift=0.077m)
2026-01-13 16:41:23,406 - DEBUG - integration_test -   Set spline state to 21.2800
2026-01-13 16:41:23,407 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:23,473 - DEBUG - integration_test - Step 228: Checking path alignment: vehicle=(19.883, 4.842), path_start=(0.000, 0.000), dist=20.464m
2026-01-13 16:41:23,473 - WARNING - integration_test - Step 228: Vehicle is far from path start (dist=20.464m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:23,473 - INFO - integration_test - === Calling planner.solve_mpc() at step 228 ===
2026-01-13 16:41:23,526 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:23,536 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:23,536 - INFO - integration_test - Warmstart k=0: x0=19.883451064384943 , y0=4.841685221590249 , psi0=0.3503531244685444 , v0=3.0000000298217255 , spline0=21.027474946310672 , a0=0.0 , w0=0.0
2026-01-13 16:41:23,536 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:23,537 - INFO - integration_test - Dyn residual k=0: pred=[20.165226537788588, 4.944654073081639, 0.3503531244685444, 3.0000000298217255, 21.327474949292846], ws=[20.165226534987575, 4.94465407205807, 0.3503531244685445, 3.0, 21.22047998392192], res=[2.801012755071497e-09, 1.0235696734639532e-09, -1.1102230246251565e-16, 2.982172553345208e-08, 0.10699496537092656], res_norm=1.070e-01
2026-01-13 16:41:23,538 - INFO - integration_test - Dyn residual k=1: pred=[20.447002005590207, 5.04762292252589, 0.3503531244685445, 3.0, 21.52047998392192], ws=[20.447002005590207, 5.04762292252589, 0.3503531244685445, 3.0, 21.656497563594122], res=[0.0, 0.0, 0.0, 0.0, -0.13601757967220252], res_norm=1.360e-01
2026-01-13 16:41:23,539 - INFO - integration_test - Dyn residual k=2: pred=[20.72877747619284, 5.15059177299371, 0.3503531244685445, 3.0, 21.956497563594123], ws=[20.72877747619284, 5.15059177299371, 0.3503531244685445, 3.0, 22.055936602548297], res=[0.0, 0.0, 0.0, 0.0, -0.0994390389541735], res_norm=9.944e-02
2026-01-13 16:41:23,553 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:23,623 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:23,638 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:23,649 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:23,665 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:23,676 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:23,691 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:23,703 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:23,718 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:23,730 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:23,745 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:23,757 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:23,772 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:23,784 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:23,799 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:23,810 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:23,825 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:23,837 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:23,852 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:23,862 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:23,875 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:23,885 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:27,070 - WARNING - integration_test - Step 228: MPC solve failed
2026-01-13 16:41:27,070 - WARNING - integration_test -   Consecutive MPC failures: 1/5
2026-01-13 16:41:27,387 - INFO - integration_test - Step 228: Computed 6 numeric contouring constraints for visualization (s=21.280)
2026-01-13 16:41:27,387 - DEBUG - integration_test - Step 228: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:27,387 - INFO - integration_test - === Applying control at step 228 ===
2026-01-13 16:41:27,387 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 16:41:27,387 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:27,387 - INFO - integration_test -   Planner output success: False
2026-01-13 16:41:27,387 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 16:41:27,388 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:27,389 - INFO - integration_test - Step 228 completed in 3.984s
2026-01-13 16:41:27,403 - INFO - integration_test - Step 229 (contouring until path end)
2026-01-13 16:41:27,405 - DEBUG - integration_test - Syncing planner state at step 229: vehicle_state=[20.16522654  4.94465407  0.35035312  3.00000003 21.5800002 ]
2026-01-13 16:41:27,406 - DEBUG - integration_test - Step 229: Using propagated spline 21.5800 (close to path, dist=0.214m, drift=0.377m)
2026-01-13 16:41:27,406 - DEBUG - integration_test -   Set spline state to 21.5800
2026-01-13 16:41:27,407 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:27,474 - DEBUG - integration_test - Step 229: Checking path alignment: vehicle=(20.165, 4.945), path_start=(0.000, 0.000), dist=20.763m
2026-01-13 16:41:27,474 - WARNING - integration_test - Step 229: Vehicle is far from path start (dist=20.763m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:27,474 - INFO - integration_test - === Calling planner.solve_mpc() at step 229 ===
2026-01-13 16:41:27,527 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:27,537 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:27,537 - INFO - integration_test - Warmstart k=0: x0=20.165226537788588 , y0=4.944654073081639 , psi0=0.3503531244685444 , v0=3.0000000298217255 , spline0=21.226464848282745 , a0=0.0 , w0=0.0
2026-01-13 16:41:27,537 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:27,538 - INFO - integration_test - Dyn residual k=0: pred=[20.447002011192232, 5.047622924573029, 0.3503531244685444, 3.0000000298217255, 21.52646485126492], ws=[20.44700200839122, 5.04762292354946, 0.3503531244685445, 3.0, 21.87579188662901], res=[2.801012755071497e-09, 1.0235696734639532e-09, -1.1102230246251565e-16, 2.982172553345208e-08, -0.34932703536409093], res_norm=3.493e-01
2026-01-13 16:41:27,539 - INFO - integration_test - Dyn residual k=1: pred=[20.72877747899385, 5.15059177401728, 0.3503531244685445, 3.0, 22.17579188662901], ws=[20.72877747899385, 5.15059177401728, 0.3503531244685445, 3.0, 22.08583796891971], res=[0.0, 0.0, 0.0, 0.0, 0.08995391770930183], res_norm=8.995e-02
2026-01-13 16:41:27,540 - INFO - integration_test - Dyn residual k=2: pred=[21.010552949596484, 5.2535606244851, 0.3503531244685445, 3.0, 22.38583796891971], ws=[21.010552949596484, 5.2535606244851, 0.3503531244685445, 3.0, 22.23668798547292], res=[0.0, 0.0, 0.0, 0.0, 0.1491499834467902], res_norm=1.491e-01
2026-01-13 16:41:27,553 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:27,622 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:27,637 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:27,649 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:27,665 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:27,676 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:27,691 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:27,702 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:27,717 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:27,728 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:27,744 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:27,755 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:27,770 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:27,782 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:27,796 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:27,808 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:27,822 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:27,834 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:27,850 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:27,860 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:27,873 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:27,883 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:30,113 - WARNING - integration_test - Step 229: MPC solve failed
2026-01-13 16:41:30,113 - WARNING - integration_test -   Consecutive MPC failures: 2/5
2026-01-13 16:41:30,454 - INFO - integration_test - Step 229: Computed 6 numeric contouring constraints for visualization (s=21.580)
2026-01-13 16:41:30,454 - DEBUG - integration_test - Step 229: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:30,454 - INFO - integration_test - === Applying control at step 229 ===
2026-01-13 16:41:30,454 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 16:41:30,454 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:30,455 - INFO - integration_test -   Planner output success: False
2026-01-13 16:41:30,455 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 16:41:30,456 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:30,456 - INFO - integration_test - Step 229 completed in 3.051s
2026-01-13 16:41:30,470 - INFO - integration_test - Step 230 (contouring until path end)
2026-01-13 16:41:30,472 - DEBUG - integration_test - Syncing planner state at step 230: vehicle_state=[20.44700201  5.04762292  0.35035312  3.00000003 21.8800002 ]
2026-01-13 16:41:30,473 - DEBUG - integration_test - Step 230: Using propagated spline 21.8800 (close to path, dist=0.350m, drift=0.071m)
2026-01-13 16:41:30,473 - DEBUG - integration_test -   Set spline state to 21.8800
2026-01-13 16:41:30,474 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:30,540 - DEBUG - integration_test - Step 230: Checking path alignment: vehicle=(20.447, 5.048), path_start=(0.000, 0.000), dist=21.061m
2026-01-13 16:41:30,540 - WARNING - integration_test - Step 230: Vehicle is far from path start (dist=21.061m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:30,540 - INFO - integration_test - === Calling planner.solve_mpc() at step 230 ===
2026-01-13 16:41:30,592 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:30,602 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:30,602 - INFO - integration_test - Warmstart k=0: x0=20.447002011192232 , y0=5.047622924573029 , psi0=0.3503531244685444 , v0=3.0000000298217255 , spline0=21.62747495227502 , a0=0.0 , w0=0.0
2026-01-13 16:41:30,602 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:30,603 - INFO - integration_test - Dyn residual k=0: pred=[20.728777484595877, 5.150591776064419, 0.3503531244685444, 3.0000000298217255, 21.927474955257193], ws=[20.728777481794864, 5.15059177504085, 0.3503531244685445, 3.0, 22.023036001665783], res=[2.801012755071497e-09, 1.0235696734639532e-09, -1.1102230246251565e-16, 2.982172553345208e-08, -0.09556104640859076], res_norm=9.556e-02
2026-01-13 16:41:30,604 - INFO - integration_test - Dyn residual k=1: pred=[21.010552952397497, 5.25356062550867, 0.3503531244685445, 3.0, 22.323036001665784], ws=[21.010552952397497, 5.25356062550867, 0.3503531244685445, 3.0, 22.255812027541577], res=[0.0, 0.0, 0.0, 0.0, 0.06722397412420733], res_norm=6.722e-02
2026-01-13 16:41:30,604 - INFO - integration_test - Dyn residual k=2: pred=[21.29232842300013, 5.35652947597649, 0.3503531244685445, 3.0, 22.555812027541577], ws=[21.29232842300013, 5.35652947597649, 0.3503531244685445, 3.0, 22.653837739861], res=[0.0, 0.0, 0.0, 0.0, -0.09802571231942281], res_norm=9.803e-02
2026-01-13 16:41:30,618 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:30,689 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:30,704 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:30,716 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:30,731 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:30,743 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:30,758 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:30,770 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:30,784 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:30,796 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:30,811 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:30,822 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:30,838 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:30,850 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:30,865 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:30,876 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:30,891 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:30,902 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:30,917 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:30,927 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:30,941 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:30,951 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:32,109 - WARNING - integration_test - Step 230: MPC solve failed
2026-01-13 16:41:32,109 - WARNING - integration_test -   Consecutive MPC failures: 3/5
2026-01-13 16:41:32,438 - INFO - integration_test - Step 230: Computed 6 numeric contouring constraints for visualization (s=21.880)
2026-01-13 16:41:32,438 - DEBUG - integration_test - Step 230: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:32,438 - INFO - integration_test - === Applying control at step 230 ===
2026-01-13 16:41:32,438 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 16:41:32,438 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:32,438 - INFO - integration_test -   Planner output success: False
2026-01-13 16:41:32,438 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 16:41:32,439 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:32,440 - INFO - integration_test - Step 230 completed in 1.968s
2026-01-13 16:41:32,455 - INFO - integration_test - Step 231 (contouring until path end)
2026-01-13 16:41:32,456 - DEBUG - integration_test - Syncing planner state at step 231: vehicle_state=[20.72877748  5.15059178  0.35035312  3.00000003 22.18000021]
2026-01-13 16:41:32,457 - DEBUG - integration_test - Step 231: Using propagated spline 22.1800 (close to path, dist=0.215m, drift=0.371m)
2026-01-13 16:41:32,457 - DEBUG - integration_test -   Set spline state to 22.1800
2026-01-13 16:41:32,458 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:32,524 - DEBUG - integration_test - Step 231: Checking path alignment: vehicle=(20.729, 5.151), path_start=(0.000, 0.000), dist=21.359m
2026-01-13 16:41:32,524 - WARNING - integration_test - Step 231: Vehicle is far from path start (dist=21.359m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:32,524 - INFO - integration_test - === Calling planner.solve_mpc() at step 231 ===
2026-01-13 16:41:32,577 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:32,586 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:32,586 - INFO - integration_test - Warmstart k=0: x0=20.728777484595877 , y0=5.150591776064419 , psi0=0.3503531244685444 , v0=3.0000000298217255 , spline0=22.028485056267293 , a0=0.0 , w0=0.0
2026-01-13 16:41:32,586 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:32,587 - INFO - integration_test - Dyn residual k=0: pred=[21.010552957999522, 5.253560627555809, 0.3503531244685444, 3.0000000298217255, 22.328485059249466], ws=[21.01055295519851, 5.25356062653224, 0.3503531244685445, 3.0, 22.271978444269312], res=[2.801012755071497e-09, 1.0235696734639532e-09, -1.1102230246251565e-16, 2.982172553345208e-08, 0.056506614980154524], res_norm=5.651e-02
2026-01-13 16:41:32,588 - INFO - integration_test - Dyn residual k=1: pred=[21.29232842580114, 5.35652947700006, 0.3503531244685445, 3.0, 22.571978444269313], ws=[21.29232842580114, 5.35652947700006, 0.3503531244685445, 3.0, 22.68198419512423], res=[0.0, 0.0, 0.0, 0.0, -0.11000575085491704], res_norm=1.100e-01
2026-01-13 16:41:32,589 - INFO - integration_test - Dyn residual k=2: pred=[21.574103896403773, 5.45949832746788, 0.3503531244685445, 3.0, 22.98198419512423], ws=[21.574103896403773, 5.45949832746788, 0.3503531244685445, 3.0, 23.131803753686924], res=[0.0, 0.0, 0.0, 0.0, -0.1498195585626938], res_norm=1.498e-01
2026-01-13 16:41:32,602 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:32,675 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:32,691 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:32,703 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:32,719 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:32,730 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:32,746 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:32,758 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:32,773 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:32,785 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:32,800 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:32,812 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:32,827 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:32,839 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:32,854 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:32,866 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:32,881 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:32,893 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:32,908 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:32,918 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:32,931 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:32,941 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:33,114 - INFO - integration_test - Step 231: MPC solve successful
2026-01-13 16:41:33,452 - INFO - integration_test - Step 231: Computed 6 numeric contouring constraints for visualization (s=22.180)
2026-01-13 16:41:33,452 - DEBUG - integration_test - Step 231: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:33,452 - INFO - integration_test - === Applying control at step 231 ===
2026-01-13 16:41:33,452 - INFO - integration_test -   Control dict from planner: {'a': -2.0000000136157534, 'w': 0.7999999781012403}
2026-01-13 16:41:33,452 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:33,452 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:33,453 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:33,454 - INFO - integration_test - Step 231 completed in 0.998s
2026-01-13 16:41:33,469 - INFO - integration_test - Step 232 (contouring until path end)
2026-01-13 16:41:33,472 - DEBUG - integration_test - Syncing planner state at step 232: vehicle_state=[20.99694138  5.26078843  0.43035312  2.80000003 22.46000021]
2026-01-13 16:41:33,472 - DEBUG - integration_test - Step 232: Using propagated spline 22.4600 (close to path, dist=0.248m, drift=0.046m)
2026-01-13 16:41:33,472 - DEBUG - integration_test -   Set spline state to 22.4600
2026-01-13 16:41:33,474 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:33,541 - DEBUG - integration_test - Step 232: Checking path alignment: vehicle=(20.997, 5.261), path_start=(0.000, 0.000), dist=21.646m
2026-01-13 16:41:33,542 - WARNING - integration_test - Step 232: Vehicle is far from path start (dist=21.646m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:33,542 - INFO - integration_test - === Calling planner.solve_mpc() at step 232 ===
2026-01-13 16:41:33,594 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:33,604 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:33,604 - INFO - integration_test - Warmstart k=0: x0=20.996941379864374 , y0=5.260788433727408 , psi0=0.4303531222786684 , v0=2.80000002846015 , spline0=22.51050526113351 , a0=0.0 , w0=0.0
2026-01-13 16:41:33,604 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:33,605 - INFO - integration_test - Dyn residual k=0: pred=[21.251410558709633, 5.377602125611486, 0.4303531222786684, 2.80000002846015, 22.790505263979526], ws=[21.251410558709633, 5.377602125611486, 0.4303531222786683, 2.80000002846015, 22.67681189793575], res=[0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.11369336604377622], res_norm=1.137e-01
2026-01-13 16:41:33,606 - INFO - integration_test - Dyn residual k=1: pred=[21.505879737554892, 5.494415817495565, 0.4303531222786683, 2.80000002846015, 22.956811900781766], ws=[21.505879737554892, 5.494415817495565, 0.4303531222786683, 2.80000002846015, 23.079047066879127], res=[0.0, 0.0, 0.0, 0.0, -0.12223516609736151], res_norm=1.222e-01
2026-01-13 16:41:33,607 - INFO - integration_test - Dyn residual k=2: pred=[21.76034891640015, 5.611229509379643, 0.4303531222786683, 2.80000002846015, 23.359047069725143], ws=[21.76034891640015, 5.611229509379643, 0.4303531222786683, 2.80000002846015, 23.238991346047357], res=[0.0, 0.0, 0.0, 0.0, 0.12005572367778683], res_norm=1.201e-01
2026-01-13 16:41:33,621 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:33,691 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:33,707 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:33,718 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:33,733 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:33,745 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:33,761 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:33,773 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:33,788 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:33,800 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:33,815 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:33,828 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:33,844 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:33,856 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:33,870 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:33,882 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:33,898 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:33,910 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:33,925 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:33,936 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:33,949 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:33,960 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:34,140 - INFO - integration_test - Step 232: MPC solve successful
2026-01-13 16:41:34,485 - INFO - integration_test - Step 232: Computed 6 numeric contouring constraints for visualization (s=22.460)
2026-01-13 16:41:34,486 - DEBUG - integration_test - Step 232: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:34,486 - INFO - integration_test - === Applying control at step 232 ===
2026-01-13 16:41:34,486 - INFO - integration_test -   Control dict from planner: {'a': -2.0000000198797894, 'w': 0.7999999999417816}
2026-01-13 16:41:34,486 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:34,486 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:34,487 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:34,487 - INFO - integration_test - Step 232 completed in 1.016s
2026-01-13 16:41:34,503 - INFO - integration_test - Step 233 (contouring until path end)
2026-01-13 16:41:34,505 - DEBUG - integration_test - Syncing planner state at step 233: vehicle_state=[21.23761786  5.38300128  0.51035312  2.60000003 22.72000021]
2026-01-13 16:41:34,506 - DEBUG - integration_test - Step 233: Using propagated spline 22.7200 (close to path, dist=0.307m, drift=0.300m)
2026-01-13 16:41:34,506 - DEBUG - integration_test -   Set spline state to 22.7200
2026-01-13 16:41:34,507 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:34,574 - DEBUG - integration_test - Step 233: Checking path alignment: vehicle=(21.238, 5.383), path_start=(0.000, 0.000), dist=21.909m
2026-01-13 16:41:34,574 - WARNING - integration_test - Step 233: Vehicle is far from path start (dist=21.909m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:34,574 - INFO - integration_test - === Calling planner.solve_mpc() at step 233 ===
2026-01-13 16:41:34,626 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:34,636 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:34,636 - INFO - integration_test - Warmstart k=0: x0=21.237617863432423 , y0=5.38300128032852 , psi0=0.5103531222728466 , v0=2.600000026472171 , spline0=22.66949516277063 , a0=0.0 , w0=0.0
2026-01-13 16:41:34,636 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:34,637 - INFO - integration_test - Dyn residual k=0: pred=[21.46448660315627, 5.510007486132272, 0.5103531222728466, 2.600000026472171, 22.929495165417848], ws=[21.46448660315627, 5.510007486132272, 0.5103531222728463, 2.600000026472171, 23.05661634093459], res=[0.0, 0.0, 2.220446049250313e-16, 0.0, -0.1271211755167414], res_norm=1.271e-01
2026-01-13 16:41:34,638 - INFO - integration_test - Dyn residual k=1: pred=[21.69135534288012, 5.6370136919360245, 0.5103531222728463, 2.600000026472171, 23.316616343581806], ws=[21.69135534288012, 5.6370136919360245, 0.5103531222728463, 2.600000026472171, 23.199744746016606], res=[0.0, 0.0, 0.0, 0.0, 0.1168715975652006], res_norm=1.169e-01
2026-01-13 16:41:34,639 - INFO - integration_test - Dyn residual k=2: pred=[21.918224082603967, 5.764019897739777, 0.5103531222728463, 2.600000026472171, 23.459744748663823], ws=[21.918224082603967, 5.764019897739777, 0.5103531222728463, 2.600000026472171, 23.372370824723518], res=[0.0, 0.0, 0.0, 0.0, 0.08737392394030508], res_norm=8.737e-02
2026-01-13 16:41:34,653 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:34,722 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:34,737 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:34,748 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:34,764 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:34,777 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:34,793 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:34,804 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:34,819 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:34,831 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:34,847 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:34,858 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:34,873 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:34,884 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:34,899 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:34,911 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:34,926 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:34,937 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:34,952 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:34,962 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:34,975 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:34,985 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:35,159 - INFO - integration_test - Step 233: MPC solve successful
2026-01-13 16:41:35,520 - INFO - integration_test - Step 233: Computed 6 numeric contouring constraints for visualization (s=22.720)
2026-01-13 16:41:35,520 - DEBUG - integration_test - Step 233: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:35,520 - INFO - integration_test - === Applying control at step 233 ===
2026-01-13 16:41:35,520 - INFO - integration_test -   Control dict from planner: {'a': -2.0000000199750487, 'w': 0.8000000037647104}
2026-01-13 16:41:35,520 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:35,520 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:35,521 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:35,522 - INFO - integration_test - Step 233 completed in 1.017s
2026-01-13 16:41:35,538 - INFO - integration_test - Step 234 (contouring until path end)
2026-01-13 16:41:35,543 - DEBUG - integration_test - Syncing planner state at step 234: vehicle_state=[21.45071574  5.51359987  0.59035312  2.40000002 22.96000022]
2026-01-13 16:41:35,543 - DEBUG - integration_test - Step 234: Using propagated spline 22.9600 (close to path, dist=0.263m, drift=0.060m)
2026-01-13 16:41:35,543 - DEBUG - integration_test -   Set spline state to 22.9600
2026-01-13 16:41:35,545 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:35,611 - DEBUG - integration_test - Step 234: Checking path alignment: vehicle=(21.451, 5.514), path_start=(0.000, 0.000), dist=22.148m
2026-01-13 16:41:35,611 - WARNING - integration_test - Step 234: Vehicle is far from path start (dist=22.148m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:35,611 - INFO - integration_test - === Calling planner.solve_mpc() at step 234 ===
2026-01-13 16:41:35,664 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:35,673 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:35,673 - INFO - integration_test - Warmstart k=0: x0=21.450715737769094 , y0=5.513599865880977 , psi0=0.5903531226493176 , v0=2.400000024474666 , spline0=22.808485064207993 , a0=0.0 , w0=0.0
2026-01-13 16:41:35,673 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:35,674 - INFO - integration_test - Dyn residual k=0: pred=[21.650094339070762, 5.647196926169649, 0.5903531226493176, 2.400000024474666, 23.04848506665546], ws=[21.650094339070762, 5.647196926169649, 0.5903531226493177, 2.400000024474666, 23.21139390834027], res=[0.0, 0.0, -1.1102230246251565e-16, 0.0, -0.16290884168481057], res_norm=1.629e-01
2026-01-13 16:41:35,675 - INFO - integration_test - Dyn residual k=1: pred=[21.84947294037243, 5.78079398645832, 0.5903531226493177, 2.400000024474666, 23.451393910787736], ws=[21.84947294037243, 5.78079398645832, 0.5903531226493177, 2.400000024474666, 23.3707109045378], res=[0.0, 0.0, 0.0, 0.0, 0.08068300624993796], res_norm=8.068e-02
2026-01-13 16:41:35,676 - INFO - integration_test - Dyn residual k=2: pred=[22.048851541674097, 5.914391046746992, 0.5903531226493177, 2.400000024474666, 23.610710906985265], ws=[22.048851541674097, 5.914391046746992, 0.5903531226493177, 2.400000024474666, 23.76351721886838], res=[0.0, 0.0, 0.0, 0.0, -0.1528063118831149], res_norm=1.528e-01
2026-01-13 16:41:35,689 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:35,759 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:35,775 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:35,786 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:35,801 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:35,813 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:35,827 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:35,839 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:35,854 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:35,866 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:35,880 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:35,892 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:35,906 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:35,918 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:35,932 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:35,944 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:35,959 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:35,970 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:35,985 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:35,995 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:36,007 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:36,017 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:36,206 - INFO - integration_test - Step 234: MPC solve successful
2026-01-13 16:41:36,585 - INFO - integration_test - Step 234: Computed 6 numeric contouring constraints for visualization (s=22.960)
2026-01-13 16:41:36,585 - DEBUG - integration_test - Step 234: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:36,585 - INFO - integration_test - === Applying control at step 234 ===
2026-01-13 16:41:36,585 - INFO - integration_test -   Control dict from planner: {'a': -2.000000019996935, 'w': 0.8000000084913519}
2026-01-13 16:41:36,585 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:36,585 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:36,586 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:36,587 - INFO - integration_test - Step 234 completed in 1.044s
2026-01-13 16:41:36,602 - INFO - integration_test - Step 235 (contouring until path end)
2026-01-13 16:41:36,604 - DEBUG - integration_test - Syncing planner state at step 235: vehicle_state=[21.63654324  5.64902495  0.67035312  2.20000002 23.18000022]
2026-01-13 16:41:36,605 - DEBUG - integration_test - Step 235: Using propagated spline 23.1800 (close to path, dist=0.407m, drift=0.160m)
2026-01-13 16:41:36,605 - DEBUG - integration_test -   Set spline state to 23.1800
2026-01-13 16:41:36,607 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:36,673 - DEBUG - integration_test - Step 235: Checking path alignment: vehicle=(21.637, 5.649), path_start=(0.000, 0.000), dist=22.362m
2026-01-13 16:41:36,673 - WARNING - integration_test - Step 235: Vehicle is far from path start (dist=22.362m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:36,673 - INFO - integration_test - === Calling planner.solve_mpc() at step 235 ===
2026-01-13 16:41:36,725 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:36,735 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:36,735 - INFO - integration_test - Warmstart k=0: x0=21.63654323571763 , y0=5.64902495233903 , psi0=0.6703531234984528 , v0=2.2000000224749727 , spline0=22.92747496544539 , a0=0.0 , w0=0.0
2026-01-13 16:41:36,735 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:36,736 - INFO - integration_test - Dyn residual k=0: pred=[21.80893575057848, 5.7857027552510285, 0.6703531234984528, 2.2000000224749727, 23.14747496769289], ws=[21.80893575057848, 5.7857027552510285, 0.6703531234984528, 2.2000000224749727, 23.345129055444744], res=[0.0, 0.0, 0.0, 0.0, -0.19765408775185378], res_norm=1.977e-01
2026-01-13 16:41:36,737 - INFO - integration_test - Dyn residual k=1: pred=[21.98132826543933, 5.922380558163027, 0.6703531234984528, 2.2000000224749727, 23.565129057692243], ws=[21.98132826543933, 5.922380558163027, 0.6703531234984528, 2.2000000224749727, 23.6880955066623], res=[0.0, 0.0, 0.0, 0.0, -0.12296644897005748], res_norm=1.230e-01
2026-01-13 16:41:36,738 - INFO - integration_test - Dyn residual k=2: pred=[22.15372078030018, 6.059058361075026, 0.6703531234984528, 2.2000000224749727, 23.9080955089098], ws=[22.15372078030018, 6.059058361075026, 0.6703531234984528, 2.2000000224749727, 23.580756057165587], res=[0.0, 0.0, 0.0, 0.0, 0.3273394517442121], res_norm=3.273e-01
2026-01-13 16:41:36,752 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:36,821 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:36,836 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:36,848 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:36,863 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:36,875 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:36,889 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:36,901 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:36,915 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:36,928 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:36,943 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:36,955 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:36,969 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:36,980 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:36,995 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:37,007 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:37,022 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:37,034 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:37,049 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:37,060 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:37,073 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:37,083 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:37,278 - INFO - integration_test - Step 235: MPC solve successful
2026-01-13 16:41:37,659 - INFO - integration_test - Step 235: Computed 6 numeric contouring constraints for visualization (s=23.180)
2026-01-13 16:41:37,659 - DEBUG - integration_test - Step 235: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:37,659 - INFO - integration_test - === Applying control at step 235 ===
2026-01-13 16:41:37,659 - INFO - integration_test -   Control dict from planner: {'a': -2.0000000193498395, 'w': 0.7999989697140156}
2026-01-13 16:41:37,659 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:37,659 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:37,660 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:37,661 - INFO - integration_test - Step 235 completed in 1.056s
2026-01-13 16:41:37,677 - INFO - integration_test - Step 236 (contouring until path end)
2026-01-13 16:41:37,678 - DEBUG - integration_test - Syncing planner state at step 236: vehicle_state=[21.79579537  5.7858287   0.75035302  2.00000002 23.38000022]
2026-01-13 16:41:37,679 - DEBUG - integration_test - Step 236: Using propagated spline 23.3800 (close to path, dist=0.368m, drift=0.246m)
2026-01-13 16:41:37,679 - DEBUG - integration_test -   Set spline state to 23.3800
2026-01-13 16:41:37,680 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:37,747 - DEBUG - integration_test - Step 236: Checking path alignment: vehicle=(21.796, 5.786), path_start=(0.000, 0.000), dist=22.551m
2026-01-13 16:41:37,747 - WARNING - integration_test - Step 236: Vehicle is far from path start (dist=22.551m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:37,747 - INFO - integration_test - === Calling planner.solve_mpc() at step 236 ===
2026-01-13 16:41:37,800 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:37,809 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:37,809 - INFO - integration_test - Warmstart k=0: x0=21.795795365054627 , y0=5.785828696089937 , psi0=0.7503530204698543 , v0=2.000000020539989 , spline0=23.32949516951959 , a0=0.0 , w0=0.0
2026-01-13 16:41:37,809 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:37,810 - INFO - integration_test - Dyn residual k=0: pred=[21.942085004727158, 5.922208101228985, 0.7503530204698543, 2.000000020539989, 23.529495171573586], ws=[21.942085004727158, 5.922208101228985, 0.7503530204698543, 2.000000020539989, 23.452618907181392], res=[0.0, 0.0, 0.0, 0.0, 0.07687626439219386], res_norm=7.688e-02
2026-01-13 16:41:37,811 - INFO - integration_test - Dyn residual k=1: pred=[22.08837464439969, 6.058587506368032, 0.7503530204698543, 2.000000020539989, 23.65261890923539], ws=[22.08837464439969, 6.058587506368032, 0.7503530204698543, 2.000000020539989, 23.805356438279283], res=[0.0, 0.0, 0.0, 0.0, -0.15273752904389326], res_norm=1.527e-01
2026-01-13 16:41:37,812 - INFO - integration_test - Dyn residual k=2: pred=[22.23466428407222, 6.19496691150708, 0.7503530204698543, 2.000000020539989, 24.00535644033328], ws=[22.23466428407222, 6.19496691150708, 0.7503530204698543, 2.000000020539989, 23.909752334950227], res=[0.0, 0.0, 0.0, 0.0, 0.0956041053830532], res_norm=9.560e-02
2026-01-13 16:41:37,826 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:37,895 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:37,910 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:37,921 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:37,937 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:37,948 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:37,963 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:37,975 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:37,989 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:38,001 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:38,016 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:38,028 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:38,044 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:38,056 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:38,070 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:38,082 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:38,097 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:38,109 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:38,124 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:38,134 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:38,148 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:38,158 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:38,351 - INFO - integration_test - Step 236: MPC solve successful
2026-01-13 16:41:38,748 - INFO - integration_test - Step 236: Computed 6 numeric contouring constraints for visualization (s=23.380)
2026-01-13 16:41:38,748 - DEBUG - integration_test - Step 236: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:38,748 - INFO - integration_test - === Applying control at step 236 ===
2026-01-13 16:41:38,748 - INFO - integration_test -   Control dict from planner: {'a': -2.000000019642007, 'w': 0.7999997736905246}
2026-01-13 16:41:38,748 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:38,748 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:38,749 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:38,750 - INFO - integration_test - Step 236 completed in 1.072s
2026-01-13 16:41:38,765 - INFO - integration_test - Step 237 (contouring until path end)
2026-01-13 16:41:38,769 - DEBUG - integration_test - Syncing planner state at step 237: vehicle_state=[21.9295374   5.92071323  0.830353    1.80000002 23.56000022]
2026-01-13 16:41:38,770 - DEBUG - integration_test - Step 237: Using propagated spline 23.5600 (close to path, dist=0.414m, drift=0.066m)
2026-01-13 16:41:38,770 - DEBUG - integration_test -   Set spline state to 23.5600
2026-01-13 16:41:38,771 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:38,837 - DEBUG - integration_test - Step 237: Checking path alignment: vehicle=(21.930, 5.921), path_start=(0.000, 0.000), dist=22.715m
2026-01-13 16:41:38,837 - WARNING - integration_test - Step 237: Vehicle is far from path start (dist=22.715m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:38,837 - INFO - integration_test - === Calling planner.solve_mpc() at step 237 ===
2026-01-13 16:41:38,890 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:38,900 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:38,900 - INFO - integration_test - Warmstart k=0: x0=21.929537401030426 , y0=5.920713232398198 , psi0=0.8303529978389068 , v0=1.800000018575788 , spline0=23.408485070367067 , a0=0.0 , w0=0.0
2026-01-13 16:41:38,901 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:38,902 - INFO - integration_test - Dyn residual k=0: pred=[22.0509681436566, 6.0535837536359205, 0.8303529978389068, 1.800000018575788, 23.588485072224646], ws=[22.0509681436566, 6.0535837536359205, 0.830352997838907, 1.800000018575788, 23.537583110471264], res=[0.0, 0.0, -2.220446049250313e-16, 0.0, 0.05090196175338235], res_norm=5.090e-02
2026-01-13 16:41:38,902 - INFO - integration_test - Dyn residual k=1: pred=[22.172398886282775, 6.186454274873643, 0.830352997838907, 1.800000018575788, 23.717583112328843], ws=[22.172398886282775, 6.186454274873643, 0.830352997838907, 1.800000018575788, 23.92227627239118], res=[0.0, 0.0, 0.0, 0.0, -0.2046931600623374], res_norm=2.047e-01
2026-01-13 16:41:38,903 - INFO - integration_test - Dyn residual k=2: pred=[22.29382962890895, 6.319324796111366, 0.830352997838907, 1.800000018575788, 24.10227627424876], ws=[22.29382962890895, 6.319324796111366, 0.830352997838907, 1.800000018575788, 24.025576348730315], res=[0.0, 0.0, 0.0, 0.0, 0.07669992551844373], res_norm=7.670e-02
2026-01-13 16:41:38,917 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:38,988 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:39,003 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:39,015 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:39,030 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:39,043 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:39,059 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:39,071 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:39,086 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:39,098 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:39,113 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:39,124 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:39,139 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:39,151 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:39,166 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:39,178 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:39,193 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:39,204 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:39,219 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:39,229 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:39,242 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:39,253 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:39,432 - INFO - integration_test - Step 237: MPC solve successful
2026-01-13 16:41:39,816 - INFO - integration_test - Step 237: Computed 6 numeric contouring constraints for visualization (s=23.560)
2026-01-13 16:41:39,816 - DEBUG - integration_test - Step 237: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:39,816 - INFO - integration_test - === Applying control at step 237 ===
2026-01-13 16:41:39,816 - INFO - integration_test -   Control dict from planner: {'a': -2.0000000199962176, 'w': -0.5249235775272698}
2026-01-13 16:41:39,816 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:39,816 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:39,818 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:39,818 - INFO - integration_test - Step 237 completed in 1.049s
2026-01-13 16:41:39,832 - INFO - integration_test - Step 238 (contouring until path end)
2026-01-13 16:41:39,836 - DEBUG - integration_test - Syncing planner state at step 238: vehicle_state=[22.04739917  6.04319578  0.77786064  1.60000002 23.72000022]
2026-01-13 16:41:39,837 - DEBUG - integration_test - Step 238: Using propagated spline 23.7200 (close to path, dist=0.517m, drift=0.094m)
2026-01-13 16:41:39,838 - DEBUG - integration_test -   Set spline state to 23.7200
2026-01-13 16:41:39,840 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:39,907 - DEBUG - integration_test - Step 238: Checking path alignment: vehicle=(22.047, 6.043), path_start=(0.000, 0.000), dist=22.861m
2026-01-13 16:41:39,907 - WARNING - integration_test - Step 238: Vehicle is far from path start (dist=22.861m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:39,907 - INFO - integration_test - === Calling planner.solve_mpc() at step 238 ===
2026-01-13 16:41:39,960 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:39,970 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:39,970 - INFO - integration_test - Warmstart k=0: x0=22.04739917483435 , y0=6.043195783200256 , psi0=0.7778606400861798 , v0=1.6000000165761663 , spline0=23.770505274044886 , a0=0.0 , w0=0.0
2026-01-13 16:41:39,970 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:39,971 - INFO - integration_test - Dyn residual k=0: pred=[22.161385812461134, 6.155476890128259, 0.7778606400861798, 1.6000000165761663, 23.930505275702505], ws=[22.161385812461134, 6.155476890128259, 0.77786064008618, 1.6000000165761663, 23.605799374153573], res=[0.0, 0.0, -2.220446049250313e-16, 0.0, 0.3247059015489313], res_norm=3.247e-01
2026-01-13 16:41:39,972 - INFO - integration_test - Dyn residual k=1: pred=[22.275372450087918, 6.267757997056263, 0.77786064008618, 1.6000000165761663, 23.76579937581119], ws=[22.275372450087918, 6.267757997056263, 0.77786064008618, 1.6000000165761663, 23.96235117022544], res=[0.0, 0.0, 0.0, 0.0, -0.19655179441424764], res_norm=1.966e-01
2026-01-13 16:41:39,973 - INFO - integration_test - Dyn residual k=2: pred=[22.389359087714702, 6.3800391039842665, 0.77786064008618, 1.6000000165761663, 24.122351171883057], ws=[22.389359087714702, 6.3800391039842665, 0.77786064008618, 1.6000000165761663, 24.33675186924405], res=[0.0, 0.0, 0.0, 0.0, -0.21440069736099332], res_norm=2.144e-01
2026-01-13 16:41:39,986 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:40,058 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:40,073 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:40,092 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:40,108 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:40,120 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:40,135 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:40,147 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:40,162 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:40,174 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:40,189 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:40,200 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:40,215 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:40,227 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:40,242 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:40,253 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:40,269 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:40,280 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:40,295 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:40,306 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:40,319 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:40,329 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:40,486 - INFO - integration_test - Step 238: MPC solve successful
2026-01-13 16:41:40,876 - INFO - integration_test - Step 238: Computed 6 numeric contouring constraints for visualization (s=23.720)
2026-01-13 16:41:40,876 - DEBUG - integration_test - Step 238: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:40,877 - INFO - integration_test - === Applying control at step 238 ===
2026-01-13 16:41:40,877 - INFO - integration_test -   Control dict from planner: {'a': -2.0000000199963743, 'w': -0.7961743613749555}
2026-01-13 16:41:40,877 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:40,877 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:40,878 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:40,878 - INFO - integration_test - Step 238 completed in 1.042s
2026-01-13 16:41:40,894 - INFO - integration_test - Step 239 (contouring until path end)
2026-01-13 16:41:40,896 - DEBUG - integration_test - Syncing planner state at step 239: vehicle_state=[22.15824772  6.14419448  0.6982432   1.40000001 23.86000022]
2026-01-13 16:41:40,897 - DEBUG - integration_test - Step 239: Using propagated spline 23.8600 (close to path, dist=0.626m, drift=0.234m)
2026-01-13 16:41:40,897 - DEBUG - integration_test -   Set spline state to 23.8600
2026-01-13 16:41:40,898 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:40,964 - DEBUG - integration_test - Step 239: Checking path alignment: vehicle=(22.158, 6.144), path_start=(0.000, 0.000), dist=22.994m
2026-01-13 16:41:40,964 - WARNING - integration_test - Step 239: Vehicle is far from path start (dist=22.994m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:40,965 - INFO - integration_test - === Calling planner.solve_mpc() at step 239 ===
2026-01-13 16:41:41,017 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:41,026 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:41,026 - INFO - integration_test - Warmstart k=0: x0=22.158247718797092 , y0=6.14419447626464 , psi0=0.6982432039486843 , v0=1.4000000145765288 , spline0=23.60747497247224 , a0=0.0 , w0=0.0
2026-01-13 16:41:41,026 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:41,028 - INFO - integration_test - Dyn residual k=0: pred=[22.265483907085457, 6.234196700290079, 0.6982432039486843, 1.4000000145765288, 23.747474973929894], ws=[22.265483907085457, 6.234196700290079, 0.6982432039486843, 1.4000000145765288, 23.94535976977761], res=[0.0, 0.0, 0.0, 0.0, -0.1978847958477168], res_norm=1.979e-01
2026-01-13 16:41:41,028 - INFO - integration_test - Dyn residual k=1: pred=[22.372720095373822, 6.324198924315518, 0.6982432039486843, 1.4000000145765288, 24.085359771235265], ws=[22.372720095373822, 6.324198924315518, 0.6982432039486843, 1.4000000145765288, 24.2984226303571], res=[0.0, 0.0, 0.0, 0.0, -0.21306285912183398], res_norm=2.131e-01
2026-01-13 16:41:41,029 - INFO - integration_test - Dyn residual k=2: pred=[22.479956283662187, 6.414201148340958, 0.6982432039486843, 1.4000000145765288, 24.438422631814753], ws=[22.479956283662187, 6.414201148340958, 0.6982432039486843, 1.4000000145765288, 24.365389921379787], res=[0.0, 0.0, 0.0, 0.0, 0.07303271043496551], res_norm=7.303e-02
2026-01-13 16:41:41,043 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:41,113 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:41,128 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:41,140 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:41,155 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:41,167 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:41,182 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:41,193 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:41,208 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:41,220 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:41,235 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:41,247 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:41,262 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:41,273 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:41,288 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:41,300 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:41,315 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:41,326 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:41,342 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:41,352 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:41,365 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:41,375 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:41,535 - INFO - integration_test - Step 239: MPC solve successful
2026-01-13 16:41:41,953 - INFO - integration_test - Step 239: Computed 6 numeric contouring constraints for visualization (s=23.860)
2026-01-13 16:41:41,954 - DEBUG - integration_test - Step 239: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:41,954 - INFO - integration_test - === Applying control at step 239 ===
2026-01-13 16:41:41,954 - INFO - integration_test -   Control dict from planner: {'a': -2.00000001999724, 'w': -0.699323995070333}
2026-01-13 16:41:41,954 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:41,954 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:41,955 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:41,955 - INFO - integration_test - Step 239 completed in 1.059s
2026-01-13 16:41:41,971 - INFO - integration_test - Step 240 (contouring until path end)
2026-01-13 16:41:41,973 - DEBUG - integration_test - Syncing planner state at step 240: vehicle_state=[22.26059235  6.2243113   0.6283108   1.20000001 23.98000023]
2026-01-13 16:41:41,974 - DEBUG - integration_test - Step 240: Using propagated spline 23.9800 (close to path, dist=0.674m, drift=0.252m)
2026-01-13 16:41:41,974 - DEBUG - integration_test -   Set spline state to 23.9800
2026-01-13 16:41:41,975 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:42,042 - DEBUG - integration_test - Step 240: Checking path alignment: vehicle=(22.261, 6.224), path_start=(0.000, 0.000), dist=23.114m
2026-01-13 16:41:42,042 - WARNING - integration_test - Step 240: Vehicle is far from path start (dist=23.114m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:42,043 - INFO - integration_test - === Calling planner.solve_mpc() at step 240 ===
2026-01-13 16:41:42,095 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:42,105 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:42,105 - INFO - integration_test - Warmstart k=0: x0=22.260592345035068 , y0=6.224311299120185 , psi0=0.628310804441651 , v0=1.2000000125768049 , spline0=23.92949517575012 , a0=0.0 , w0=0.0
2026-01-13 16:41:42,105 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:42,106 - INFO - integration_test - Dyn residual k=0: pred=[22.357674930341606, 6.294844780049754, 0.628310804441651, 1.2000000125768049, 24.0494951770078], ws=[22.357674930341606, 6.294844780049754, 0.628310804441651, 1.2000000125768049, 24.26149466016534], res=[0.0, 0.0, 0.0, 0.0, -0.21199948315754114], res_norm=2.120e-01
2026-01-13 16:41:42,107 - INFO - integration_test - Dyn residual k=1: pred=[22.454757515648144, 6.365378260979323, 0.628310804441651, 1.2000000125768049, 24.38149466142302], ws=[22.454757515648144, 6.365378260979323, 0.628310804441651, 1.2000000125768049, 24.102656673474783], res=[0.0, 0.0, 0.0, 0.0, 0.27883798794823633], res_norm=2.788e-01
2026-01-13 16:41:42,108 - INFO - integration_test - Dyn residual k=2: pred=[22.55184010095468, 6.4359117419088925, 0.628310804441651, 1.2000000125768049, 24.222656674732463], ws=[22.55184010095468, 6.4359117419088925, 0.628310804441651, 1.2000000125768049, 24.190305593059154], res=[0.0, 0.0, 0.0, 0.0, 0.03235108167330836], res_norm=3.235e-02
2026-01-13 16:41:42,121 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:42,193 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:42,208 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:42,220 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:42,236 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:42,248 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:42,263 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:42,275 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:42,290 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:42,301 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:42,316 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:42,328 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:42,343 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:42,354 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:42,369 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:42,381 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:42,396 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:42,407 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:42,422 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:42,432 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:42,445 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:42,455 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:42,621 - INFO - integration_test - Step 240: MPC solve successful
2026-01-13 16:41:43,043 - INFO - integration_test - Step 240: Computed 6 numeric contouring constraints for visualization (s=23.980)
2026-01-13 16:41:43,043 - DEBUG - integration_test - Step 240: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:43,043 - INFO - integration_test - === Applying control at step 240 ===
2026-01-13 16:41:43,043 - INFO - integration_test -   Control dict from planner: {'a': -2.000000019999668, 'w': -0.799999393346771}
2026-01-13 16:41:43,043 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:43,043 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:43,044 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:43,045 - INFO - integration_test - Step 240 completed in 1.072s
2026-01-13 16:41:43,062 - INFO - integration_test - Step 241 (contouring until path end)
2026-01-13 16:41:43,064 - DEBUG - integration_test - Syncing planner state at step 241: vehicle_state=[22.35200069  6.28545114  0.54831087  1.00000001 24.08000023]
2026-01-13 16:41:43,064 - DEBUG - integration_test - Step 241: Using propagated spline 24.0800 (close to path, dist=0.615m, drift=0.152m)
2026-01-13 16:41:43,064 - DEBUG - integration_test -   Set spline state to 24.0800
2026-01-13 16:41:43,066 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:43,131 - DEBUG - integration_test - Step 241: Checking path alignment: vehicle=(22.352, 6.285), path_start=(0.000, 0.000), dist=23.219m
2026-01-13 16:41:43,132 - WARNING - integration_test - Step 241: Vehicle is far from path start (dist=23.219m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:43,132 - INFO - integration_test - === Calling planner.solve_mpc() at step 241 ===
2026-01-13 16:41:43,187 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:43,197 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:43,197 - INFO - integration_test - Warmstart k=0: x0=22.35200069374207 , y0=6.28545114052125 , psi0=0.5483108651069739 , v0=1.000000010576838 , spline0=24.029495176807806 , a0=0.0 , w0=0.0
2026-01-13 16:41:43,197 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:43,198 - INFO - integration_test - Dyn residual k=0: pred=[22.4373413141122, 6.337575786576437, 0.5483108651069739, 1.000000010576838, 24.12949517786549], ws=[22.4373413141122, 6.337575786576437, 0.5483108651069739, 1.000000010576838, 24.35260697972641], res=[0.0, 0.0, 0.0, 0.0, -0.22311180186092017], res_norm=2.231e-01
2026-01-13 16:41:43,199 - INFO - integration_test - Dyn residual k=1: pred=[22.52268193448233, 6.389700432631624, 0.5483108651069739, 1.000000010576838, 24.452606980784093], ws=[22.52268193448233, 6.389700432631624, 0.5483108651069739, 1.000000010576838, 24.38584680156015], res=[0.0, 0.0, 0.0, 0.0, 0.0667601792239445], res_norm=6.676e-02
2026-01-13 16:41:43,200 - INFO - integration_test - Dyn residual k=2: pred=[22.608022554852457, 6.441825078686811, 0.5483108651069739, 1.000000010576838, 24.485846802617832], ws=[22.608022554852457, 6.441825078686811, 0.5483108651069739, 1.000000010576838, 24.461800406594854], res=[0.0, 0.0, 0.0, 0.0, 0.0240463960229782], res_norm=2.405e-02
2026-01-13 16:41:43,215 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:43,287 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:43,302 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:43,314 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:43,330 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:43,342 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:43,357 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:43,368 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:43,383 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:43,395 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:43,411 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:43,422 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:43,437 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:43,449 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:43,464 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:43,476 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:43,490 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:43,502 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:43,517 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:43,527 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:43,540 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:43,550 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:43,717 - INFO - integration_test - Step 241: MPC solve successful
2026-01-13 16:41:44,138 - INFO - integration_test - Step 241: Computed 6 numeric contouring constraints for visualization (s=24.080)
2026-01-13 16:41:44,139 - DEBUG - integration_test - Step 241: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:44,139 - INFO - integration_test - === Applying control at step 241 ===
2026-01-13 16:41:44,139 - INFO - integration_test -   Control dict from planner: {'a': -2.000000019999668, 'w': -0.8000000050650368}
2026-01-13 16:41:44,139 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:44,139 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:44,140 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:44,140 - INFO - integration_test - Step 241 completed in 1.077s
2026-01-13 16:41:44,156 - INFO - integration_test - Step 242 (contouring until path end)
2026-01-13 16:41:44,158 - DEBUG - integration_test - Syncing planner state at step 242: vehicle_state=[22.43053596  6.32935912  0.46831086  0.80000001 24.16000023]
2026-01-13 16:41:44,159 - DEBUG - integration_test - Step 242: Using propagated spline 24.1600 (close to path, dist=0.571m, drift=0.072m)
2026-01-13 16:41:44,159 - DEBUG - integration_test -   Set spline state to 24.1600
2026-01-13 16:41:44,160 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:44,227 - DEBUG - integration_test - Step 242: Checking path alignment: vehicle=(22.431, 6.329), path_start=(0.000, 0.000), dist=23.306m
2026-01-13 16:41:44,227 - WARNING - integration_test - Step 242: Vehicle is far from path start (dist=23.306m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:44,227 - INFO - integration_test - === Calling planner.solve_mpc() at step 242 ===
2026-01-13 16:41:44,824 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:44,834 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:44,834 - INFO - integration_test - Warmstart k=0: x0=22.43053596275798 , y0=6.3293591194425165 , psi0=0.4683108646004702 , v0=0.8000000085768713 , spline0=24.311515379685694 , a0=0.0 , w0=0.0
2026-01-13 16:41:44,834 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:44,835 - INFO - integration_test - Dyn residual k=0: pred=[22.501922523698262, 6.365469492666138, 0.4683108646004702, 0.8000000085768713, 24.39151538054338], ws=[22.501922523698262, 6.365469492666138, 0.4683108646004701, 0.8000000085768713, 24.1179494362115], res=[0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.27356594433188164], res_norm=2.736e-01
2026-01-13 16:41:44,836 - INFO - integration_test - Dyn residual k=1: pred=[22.573309084638545, 6.40157986588976, 0.4683108646004701, 0.8000000085768713, 24.197949437069187], ws=[22.573309084638545, 6.40157986588976, 0.4683108646004701, 0.8000000085768713, 24.167099162758433], res=[0.0, 0.0, 0.0, 0.0, 0.0308502743107546], res_norm=3.085e-02
2026-01-13 16:41:44,837 - INFO - integration_test - Dyn residual k=2: pred=[22.644695645578828, 6.4376902391133815, 0.4683108646004701, 0.8000000085768713, 24.24709916361612], ws=[22.644695645578828, 6.4376902391133815, 0.4683108646004701, 0.8000000085768713, 24.221389705499593], res=[0.0, 0.0, 0.0, 0.0, 0.025709458116526918], res_norm=2.571e-02
2026-01-13 16:41:44,851 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:44,921 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:44,937 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:44,949 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:44,964 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:44,976 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:44,990 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:45,002 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:45,016 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:45,028 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:45,043 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:45,054 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:45,069 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:45,089 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:45,104 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:45,115 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:45,131 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:45,143 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:45,157 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:45,168 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:45,180 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:45,190 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:45,357 - INFO - integration_test - Step 242: MPC solve successful
2026-01-13 16:41:45,785 - INFO - integration_test - Step 242: Computed 6 numeric contouring constraints for visualization (s=24.160)
2026-01-13 16:41:45,786 - DEBUG - integration_test - Step 242: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:45,786 - INFO - integration_test - === Applying control at step 242 ===
2026-01-13 16:41:45,786 - INFO - integration_test -   Control dict from planner: {'a': -2.0000000142457006, 'w': -0.799975298999839}
2026-01-13 16:41:45,786 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:45,786 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:45,787 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:45,787 - INFO - integration_test - Step 242 completed in 1.629s
2026-01-13 16:41:45,803 - INFO - integration_test - Step 243 (contouring until path end)
2026-01-13 16:41:45,807 - DEBUG - integration_test - Syncing planner state at step 243: vehicle_state=[22.49414039  6.35854614  0.38831333  0.60000001 24.22000023]
2026-01-13 16:41:45,808 - DEBUG - integration_test - Step 243: Using propagated spline 24.2200 (close to path, dist=0.539m, drift=0.012m)
2026-01-13 16:41:45,808 - DEBUG - integration_test -   Set spline state to 24.2200
2026-01-13 16:41:45,809 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:45,875 - DEBUG - integration_test - Step 243: Checking path alignment: vehicle=(22.494, 6.359), path_start=(0.000, 0.000), dist=23.376m
2026-01-13 16:41:45,875 - WARNING - integration_test - Step 243: Vehicle is far from path start (dist=23.376m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:45,875 - INFO - integration_test - === Calling planner.solve_mpc() at step 243 ===
2026-01-13 16:41:45,927 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:45,937 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:45,937 - INFO - integration_test - Warmstart k=0: x0=22.494140391022306 , y0=6.358546138940078 , psi0=0.38831333470048635 , v0=0.6000000071523013 , spline0=24.371515380400925 , a0=0.0 , w0=0.0
2026-01-13 16:41:45,937 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:45,939 - INFO - integration_test - Dyn residual k=0: pred=[22.549673331357383, 6.381263810994419, 0.38831333470048635, 0.6000000071523013, 24.431515381116157], ws=[22.549673331357383, 6.381263810994419, 0.3883133347004861, 0.6000000071523013, 24.16372549441167], res=[0.0, 0.0, 2.220446049250313e-16, 0.0, 0.2677898867044881], res_norm=2.678e-01
2026-01-13 16:41:45,939 - INFO - integration_test - Dyn residual k=1: pred=[22.60520627169246, 6.40398148304876, 0.3883133347004861, 0.6000000071523013, 24.2237254951269], ws=[22.60520627169246, 6.40398148304876, 0.3883133347004861, 0.6000000071523013, 24.196849306110042], res=[0.0, 0.0, 0.0, 0.0, 0.026876189016856955], res_norm=2.688e-02
2026-01-13 16:41:45,940 - INFO - integration_test - Dyn residual k=2: pred=[22.660739212027536, 6.426699155103101, 0.3883133347004861, 0.6000000071523013, 24.256849306825274], ws=[22.660739212027536, 6.426699155103101, 0.3883133347004861, 0.6000000071523013, 24.23355377708336], res=[0.0, 0.0, 0.0, 0.0, 0.02329552974191529], res_norm=2.330e-02
2026-01-13 16:41:45,954 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:46,024 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:46,039 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:46,051 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:46,066 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:46,078 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:46,093 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:46,104 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:46,119 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:46,131 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:46,146 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:46,158 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:46,172 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:46,184 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:46,198 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:46,210 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:46,226 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:46,238 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:46,253 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:46,263 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:46,276 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:46,286 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:46,432 - INFO - integration_test - Step 243: MPC solve successful
2026-01-13 16:41:46,880 - INFO - integration_test - Step 243: Computed 6 numeric contouring constraints for visualization (s=24.220)
2026-01-13 16:41:46,881 - DEBUG - integration_test - Step 243: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:46,881 - INFO - integration_test - === Applying control at step 243 ===
2026-01-13 16:41:46,881 - INFO - integration_test -   Control dict from planner: {'a': -2.0000000085875405, 'w': -0.7999698290062224}
2026-01-13 16:41:46,881 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:46,881 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:46,882 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:46,882 - INFO - integration_test - Step 243 completed in 1.076s
2026-01-13 16:41:46,897 - INFO - integration_test - Step 244 (contouring until path end)
2026-01-13 16:41:46,900 - DEBUG - integration_test - Syncing planner state at step 244: vehicle_state=[22.54107983  6.37573259  0.30831635  0.40000001 24.26000023]
2026-01-13 16:41:46,901 - DEBUG - integration_test - Step 244: Using propagated spline 24.2600 (close to path, dist=0.517m, drift=0.028m)
2026-01-13 16:41:46,901 - DEBUG - integration_test -   Set spline state to 24.2600
2026-01-13 16:41:46,902 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:46,968 - DEBUG - integration_test - Step 244: Checking path alignment: vehicle=(22.541, 6.376), path_start=(0.000, 0.000), dist=23.425m
2026-01-13 16:41:46,968 - WARNING - integration_test - Step 244: Vehicle is far from path start (dist=23.425m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:46,968 - INFO - integration_test - === Calling planner.solve_mpc() at step 244 ===
2026-01-13 16:41:47,021 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:47,031 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:47,031 - INFO - integration_test - Warmstart k=0: x0=22.541079827652506 , y0=6.375732594236956 , psi0=0.3083163517998641 , v0=0.4000000062935472 , spline0=24.41151538103028 , a0=0.0 , w0=0.0
2026-01-13 16:41:47,031 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:47,032 - INFO - integration_test - Dyn residual k=0: pred=[22.579193661503837, 6.387870786833125, 0.3083163517998641, 0.4000000062935472, 24.451515381659636], ws=[22.579193661503837, 6.387870786833125, 0.30831635179986394, 0.4125000055068538, 24.41151538103028], res=[0.0, 0.0, 1.6653345369377348e-16, -0.012499999213306578, 0.04000000062935527], res_norm=4.191e-02
2026-01-13 16:41:47,033 - INFO - integration_test - Dyn residual k=1: pred=[22.61849855256932, 6.400388297918084, 0.30831635179986394, 0.4125000055068538, 24.452765381580967], ws=[22.61849855256932, 6.400388297918084, 0.30831635179986394, 0.42343750481849707, 24.209495179010077], res=[0.0, 0.0, 0.0, -0.010937499311643284, 0.2432702025708906], res_norm=2.435e-01
2026-01-13 16:41:47,034 - INFO - integration_test - Dyn residual k=2: pred=[22.65884561869719, 6.4132377126807345, 0.30831635179986394, 0.42343750481849707, 24.251838929491925], ws=[22.65884561869719, 6.4132377126807345, 0.30831635179986394, 0.43300781671618493, 24.209495179010077], res=[0.0, 0.0, 0.0, -0.009570311897687866, 0.04234375048184802], res_norm=4.341e-02
2026-01-13 16:41:47,048 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:47,118 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:47,133 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:47,145 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:47,160 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:47,172 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:47,187 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:47,198 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:47,213 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:47,225 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:47,240 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:47,252 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:47,267 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:47,278 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:47,293 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:47,305 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:47,319 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:47,331 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:47,346 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:47,357 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:47,370 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:47,380 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:47,542 - INFO - integration_test - Step 244: MPC solve successful
2026-01-13 16:41:47,997 - INFO - integration_test - Step 244: Computed 6 numeric contouring constraints for visualization (s=24.260)
2026-01-13 16:41:47,997 - DEBUG - integration_test - Step 244: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:47,997 - INFO - integration_test - === Applying control at step 244 ===
2026-01-13 16:41:47,997 - INFO - integration_test -   Control dict from planner: {'a': -1.9999998877776788, 'w': -0.7995268763124563}
2026-01-13 16:41:47,997 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:47,997 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:47,998 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:47,999 - INFO - integration_test - Step 244 completed in 1.099s
2026-01-13 16:41:48,014 - INFO - integration_test - Step 245 (contouring until path end)
2026-01-13 16:41:48,016 - DEBUG - integration_test - Syncing planner state at step 245: vehicle_state=[22.56996317  6.38381286  0.22836366  0.20000002 24.28000023]
2026-01-13 16:41:48,017 - DEBUG - integration_test - Step 245: Using propagated spline 24.2800 (close to path, dist=0.504m, drift=0.048m)
2026-01-13 16:41:48,018 - DEBUG - integration_test -   Set spline state to 24.2800
2026-01-13 16:41:48,018 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:48,084 - DEBUG - integration_test - Step 245: Checking path alignment: vehicle=(22.570, 6.384), path_start=(0.000, 0.000), dist=23.455m
2026-01-13 16:41:48,084 - WARNING - integration_test - Step 245: Vehicle is far from path start (dist=23.455m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:48,085 - INFO - integration_test - === Calling planner.solve_mpc() at step 245 ===
2026-01-13 16:41:48,138 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:48,148 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:48,148 - INFO - integration_test - Warmstart k=0: x0=22.56996317494789 , y0=6.383812864217527 , psi0=0.22836366416861847 , v0=0.2000000175157793 , spline0=24.431515382781857 , a0=0.0 , w0=0.0
2026-01-13 16:41:48,148 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:48,149 - INFO - integration_test - Dyn residual k=0: pred=[22.589443939435746, 6.388340544090467, 0.22836366416861847, 0.2000000175157793, 24.451515384533433], ws=[22.589443939435746, 6.388340544090467, 0.22836366416861864, 0.2375000153263069, 24.431515382781857], res=[0.0, 0.0, -1.6653345369377348e-16, -0.0374999978105276, 0.020000001751576235], res_norm=4.250e-02
2026-01-13 16:41:48,150 - INFO - integration_test - Dyn residual k=1: pred=[22.612577346731918, 6.393717163815669, 0.22836366416861864, 0.2375000153263069, 24.455265384314487], ws=[22.612577346731918, 6.393717163815669, 0.22836366416861864, 0.27031251341051854, 24.431515382781857], res=[0.0, 0.0, 0.0, -0.03281249808421163, 0.02375000153262974], res_norm=4.051e-02
2026-01-13 16:41:48,151 - INFO - integration_test - Dyn residual k=2: pred=[22.638906816485363, 6.399836605911599, 0.22836366416861864, 0.27031251341051854, 24.458546634122907], ws=[22.638906816485363, 6.399836605911599, 0.22836366416861864, 0.2990234492342037, 24.229495180761653], res=[0.0, 0.0, 0.0, -0.02871093582368517, 0.22905145336125443], res_norm=2.308e-01
2026-01-13 16:41:48,165 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:48,238 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:48,254 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:48,267 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:48,285 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:48,297 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:48,314 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:48,326 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:48,342 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:48,354 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:48,370 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:48,381 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:48,397 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:48,409 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:48,424 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:48,437 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:48,454 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:48,466 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:48,483 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:48,494 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:48,509 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:48,520 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:48,668 - INFO - integration_test - Step 245: MPC solve successful
2026-01-13 16:41:49,155 - INFO - integration_test - Step 245: Computed 6 numeric contouring constraints for visualization (s=24.280)
2026-01-13 16:41:49,155 - DEBUG - integration_test - Step 245: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:49,155 - INFO - integration_test - === Applying control at step 245 ===
2026-01-13 16:41:49,156 - INFO - integration_test -   Control dict from planner: {'a': -2.0000000157968807, 'w': -0.4332055650625928}
2026-01-13 16:41:49,156 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:49,156 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:49,157 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:49,157 - INFO - integration_test - Step 245 completed in 1.141s
2026-01-13 16:41:49,173 - INFO - integration_test - Step 246 (contouring until path end)
2026-01-13 16:41:49,175 - DEBUG - integration_test - Syncing planner state at step 246: vehicle_state=[2.25797347e+01 6.38593571e+00 1.85043108e-01 1.59360913e-08
 2.42800002e+01]
2026-01-13 16:41:49,176 - DEBUG - integration_test - Step 246: Using propagated spline 24.2800 (close to path, dist=0.500m, drift=0.048m)
2026-01-13 16:41:49,176 - DEBUG - integration_test -   Set spline state to 24.2800
2026-01-13 16:41:49,177 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:49,242 - DEBUG - integration_test - Step 246: Checking path alignment: vehicle=(22.580, 6.386), path_start=(0.000, 0.000), dist=23.465m
2026-01-13 16:41:49,242 - WARNING - integration_test - Step 246: Vehicle is far from path start (dist=23.465m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:49,242 - INFO - integration_test - === Calling planner.solve_mpc() at step 246 ===
2026-01-13 16:41:49,295 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:49,305 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:49,305 - INFO - integration_test - Warmstart k=0: x0=22.57973472245406 , y0=6.38593570835715 , psi0=0.1850431076623592 , v0=1.5936091252166662e-08 , spline0=24.431515384375466 , a0=0.0 , w0=0.0
2026-01-13 16:41:49,305 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:49,307 - INFO - integration_test - Dyn residual k=0: pred=[22.57973472402046, 6.385935708650356, 0.1850431076623592, 1.5936091252166662e-08, 24.431515385969075], ws=[22.57973472402046, 6.385935708650356, 0.18504310766235932, 0.18750001394407984, 24.431515384375466], res=[0.0, 0.0, -1.1102230246251565e-16, -0.18749999800798858, 1.5936088004764315e-09], res_norm=1.875e-01
2026-01-13 16:41:49,308 - INFO - integration_test - Dyn residual k=1: pred=[22.598164631395036, 6.389385500883933, 0.18504310766235932, 0.18750001394407984, 24.450265385769875], ws=[22.598164631395036, 6.389385500883933, 0.18504310766235932, 0.3515625122010699, 24.431515384375466], res=[0.0, 0.0, 0.0, -0.16406249825699004, 0.018750001394408855], res_norm=1.651e-01
2026-01-13 16:41:49,309 - INFO - integration_test - Dyn residual k=2: pred=[22.632720706351762, 6.395853861065334, 0.18504310766235932, 0.3515625122010699, 24.466671635595574], ws=[22.632720706351762, 6.395853861065334, 0.18504310766235932, 0.49511719817593614, 24.229495182355265], res=[0.0, 0.0, 0.0, -0.14355468597486626, 0.23717645324030912], res_norm=2.772e-01
2026-01-13 16:41:49,323 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:49,394 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:49,409 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:49,421 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:49,436 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:49,448 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:49,464 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:49,475 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:49,490 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:49,502 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:49,517 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:49,528 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:49,543 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:49,555 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:49,569 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:49,580 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:49,595 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:49,607 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:49,622 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:49,632 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:49,645 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:49,655 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:49,772 - INFO - integration_test - Step 246: MPC solve successful
2026-01-13 16:41:50,242 - INFO - integration_test - Step 246: Computed 6 numeric contouring constraints for visualization (s=24.280)
2026-01-13 16:41:50,243 - DEBUG - integration_test - Step 246: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:50,243 - INFO - integration_test - === Applying control at step 246 ===
2026-01-13 16:41:50,243 - INFO - integration_test -   Control dict from planner: {'a': -0.1000002580241595, 'w': 0.5266018310019605}
2026-01-13 16:41:50,243 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:50,243 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:50,244 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:50,244 - INFO - integration_test - Step 246 completed in 1.069s
2026-01-13 16:41:50,261 - INFO - integration_test - Step 247 (contouring until path end)
2026-01-13 16:41:50,263 - DEBUG - integration_test - Syncing planner state at step 247: vehicle_state=[ 2.25792468e+01  6.38582653e+00  2.37703291e-01 -1.00000099e-02
  2.42790002e+01]
2026-01-13 16:41:50,264 - DEBUG - integration_test - Step 247: Using propagated spline 24.2790 (close to path, dist=0.500m, drift=0.047m)
2026-01-13 16:41:50,264 - DEBUG - integration_test -   Set spline state to 24.2790
2026-01-13 16:41:50,265 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:50,330 - DEBUG - integration_test - Step 247: Checking path alignment: vehicle=(22.579, 6.386), path_start=(0.000, 0.000), dist=23.465m
2026-01-13 16:41:50,330 - WARNING - integration_test - Step 247: Vehicle is far from path start (dist=23.465m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:50,330 - INFO - integration_test - === Calling planner.solve_mpc() at step 247 ===
2026-01-13 16:41:50,383 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:50,393 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:50,393 - INFO - integration_test - Warmstart k=0: x0=22.57924682795017 , y0=6.3858265289782645 , psi0=0.23770329076255525 , v0=-0.010000009866324697 , spline0=24.430515383388833 , a0=0.0 , w0=0.0
2026-01-13 16:41:50,393 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:50,394 - INFO - integration_test - Dyn residual k=0: pred=[22.57827494564493, 6.385591057625377, 0.23770329076255525, -0.010000009866324697, 24.4295153824022], ws=[22.57827494660382, 6.385591057857701, 0.23770329076255514, 0.17875, 24.430515383388833], res=[-9.588880800492916e-10, -2.3232349377622086e-10, 1.1102230246251565e-16, -0.18875000986632468, -0.0010000009866324433], res_norm=1.888e-01
2026-01-13 16:41:50,395 - INFO - integration_test - Dyn residual k=1: pred=[22.595647325669802, 6.389800104137774, 0.23770329076255514, 0.17875, 24.448390383388833], ws=[22.595647325669802, 6.389800104137774, 0.23770329076255514, 0.34390624999999997, 24.430515383388833], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:41:50,395 - INFO - integration_test - Dyn residual k=2: pred=[22.629070932596576, 6.397898103143405, 0.23770329076255514, 0.34390624999999997, 24.464906008388834], ws=[22.629070932596576, 6.397898103143405, 0.23770329076255514, 0.48841796875, 24.22849518136863], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.23641082702020455], res_norm=2.771e-01
2026-01-13 16:41:50,409 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:50,479 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:50,494 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:50,505 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:50,520 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:50,531 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:50,546 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:50,558 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:50,573 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:50,584 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:50,599 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:50,610 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:50,625 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:50,637 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:50,651 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:50,663 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:50,678 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:50,690 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:50,704 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:50,714 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:50,727 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:50,737 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:50,855 - INFO - integration_test - Step 247: MPC solve successful
2026-01-13 16:41:51,330 - INFO - integration_test - Step 247: Computed 6 numeric contouring constraints for visualization (s=24.279)
2026-01-13 16:41:51,330 - DEBUG - integration_test - Step 247: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:51,330 - INFO - integration_test - === Applying control at step 247 ===
2026-01-13 16:41:51,331 - INFO - integration_test -   Control dict from planner: {'a': 2.2803885935158497e-10, 'w': 0.44786913261230893}
2026-01-13 16:41:51,331 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:51,331 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:51,332 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:51,332 - INFO - integration_test - Step 247 completed in 1.069s
2026-01-13 16:41:51,348 - INFO - integration_test - Step 248 (contouring until path end)
2026-01-13 16:41:51,353 - DEBUG - integration_test - Syncing planner state at step 248: vehicle_state=[ 2.25782805e+01  6.38556938e+00  2.82490204e-01 -1.00000098e-02
  2.42780002e+01]
2026-01-13 16:41:51,354 - DEBUG - integration_test - Step 248: Using propagated spline 24.2780 (close to path, dist=0.500m, drift=0.046m)
2026-01-13 16:41:51,354 - DEBUG - integration_test -   Set spline state to 24.2780
2026-01-13 16:41:51,354 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:51,420 - DEBUG - integration_test - Step 248: Checking path alignment: vehicle=(22.578, 6.386), path_start=(0.000, 0.000), dist=23.464m
2026-01-13 16:41:51,420 - WARNING - integration_test - Step 248: Vehicle is far from path start (dist=23.464m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:51,420 - INFO - integration_test - === Calling planner.solve_mpc() at step 248 ===
2026-01-13 16:41:51,473 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:51,483 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:51,483 - INFO - integration_test - Warmstart k=0: x0=22.57828054265947 , y0=6.385569376171598 , psi0=0.28249020402378616 , v0=-0.010000009843520811 , spline0=24.42951538240448 , a0=0.0 , w0=0.0
2026-01-13 16:41:51,483 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:51,484 - INFO - integration_test - Dyn residual k=0: pred=[22.577320177436867, 6.385290627883858, 0.28249020402378616, -0.010000009843520811, 24.42851538142013], ws=[22.5773201783822, 6.385290628158244, 0.282490204023786, 0.17875, 24.42951538240448], res=[-9.453344773646677e-10, -2.743858473763794e-10, 1.6653345369377348e-16, -0.1887500098435208, -0.0010000009843516011], res_norm=1.888e-01
2026-01-13 16:41:51,485 - INFO - integration_test - Dyn residual k=1: pred=[22.594486689838355, 6.390273248896946, 0.282490204023786, 0.17875, 24.447390382404482], ws=[22.594486689838355, 6.390273248896946, 0.282490204023786, 0.34390624999999997, 24.42951538240448], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:41:51,486 - INFO - integration_test - Dyn residual k=2: pred=[22.627514217561252, 6.399859567293697, 0.282490204023786, 0.34390624999999997, 24.463906007404482], ws=[22.627514217561252, 6.399859567293697, 0.282490204023786, 0.48841796875, 24.22749518038428], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.236410827020201], res_norm=2.771e-01
2026-01-13 16:41:51,500 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:51,571 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:51,586 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:51,598 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:51,613 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:51,625 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:51,640 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:51,651 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:51,666 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:51,677 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:51,692 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:51,703 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:51,718 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:51,729 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:51,744 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:51,756 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:51,770 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:51,782 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:51,797 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:51,807 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:51,820 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:51,830 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:51,959 - INFO - integration_test - Step 248: MPC solve successful
2026-01-13 16:41:51,959 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 248!
2026-01-13 16:41:51,959 - ERROR - integration_test -   Vehicle has moved only 0.0915m in last 5 steps
2026-01-13 16:41:51,959 - ERROR - integration_test -   Current position: (22.578, 6.386)
2026-01-13 16:41:51,959 - ERROR - integration_test -   Position 5 steps ago: (22.494, 6.359)
2026-01-13 16:41:51,959 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:41:51,959 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:41:52,457 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.278)
2026-01-13 16:41:52,458 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:52,458 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:41:52,458 - INFO - integration_test -   Control dict from planner: {'a': -2.699183210277721e-10, 'w': 0.3998830404658795}
2026-01-13 16:41:52,458 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:52,458 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:52,459 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:52,459 - INFO - integration_test - Step 200 completed in 1.106s
2026-01-13 16:41:52,476 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:41:52,478 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25773260e+01  6.38527150e+00  3.22478508e-01 -1.00000099e-02
  2.42770002e+01]
2026-01-13 16:41:52,479 - DEBUG - integration_test - Step 201: Using propagated spline 24.2770 (close to path, dist=0.501m, drift=0.045m)
2026-01-13 16:41:52,479 - DEBUG - integration_test -   Set spline state to 24.2770
2026-01-13 16:41:52,480 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:52,546 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.577, 6.385), path_start=(0.000, 0.000), dist=23.463m
2026-01-13 16:41:52,546 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.463m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:52,546 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:41:52,599 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:52,609 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:52,609 - INFO - integration_test - Warmstart k=0: x0=22.577326005954923 , y0=6.38527150303699 , psi0=0.3224785080703741 , v0=-0.010000009870512644 , spline0=24.42851538141743 , a0=0.0 , w0=0.0
2026-01-13 16:41:52,609 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:52,610 - INFO - integration_test - Dyn residual k=0: pred=[22.576377552171206, 6.384954584444515, 0.3224785080703741, -0.010000009870512644, 24.42751538043038], ws=[22.576377553107378, 6.384954584757329, 0.32247850807037404, 0.17875, 24.42851538141743], res=[-9.361720287870412e-10, -3.128146630615447e-10, 5.551115123125783e-17, -0.18875000987051263, -0.0010000009870516635], res_norm=1.888e-01
2026-01-13 16:41:52,611 - INFO - integration_test - Dyn residual k=1: pred=[22.59333114775725, 6.390619499006265, 0.32247850807037404, 0.17875, 24.44639038141743], ws=[22.59333114775725, 6.390619499006265, 0.32247850807037404, 0.34390624999999997, 24.42851538141743], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:41:52,612 - INFO - integration_test - Dyn residual k=2: pred=[22.625949033967366, 6.401518516717721, 0.32247850807037404, 0.34390624999999997, 24.46290600641743], ws=[22.625949033967366, 6.401518516717721, 0.32247850807037404, 0.48841796875, 24.226495179397226], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.23641082702020455], res_norm=2.771e-01
2026-01-13 16:41:52,626 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:52,696 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:52,711 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:52,722 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:52,737 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:52,749 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:52,764 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:52,775 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:52,790 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:52,801 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:52,816 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:52,827 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:52,842 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:52,854 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:52,869 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:52,880 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:52,896 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:52,908 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:52,922 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:52,932 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:52,946 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:52,956 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:53,111 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:41:53,111 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:41:53,111 - ERROR - integration_test -   Vehicle has moved only 0.0425m in last 5 steps
2026-01-13 16:41:53,111 - ERROR - integration_test -   Current position: (22.577, 6.385)
2026-01-13 16:41:53,111 - ERROR - integration_test -   Position 5 steps ago: (22.541, 6.376)
2026-01-13 16:41:53,111 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:41:53,111 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:41:53,603 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.277)
2026-01-13 16:41:53,604 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:53,604 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:41:53,604 - INFO - integration_test -   Control dict from planner: {'a': -8.543041270970663e-10, 'w': 0.7997967060897969}
2026-01-13 16:41:53,604 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:53,604 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:53,605 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:53,605 - INFO - integration_test - Step 200 completed in 1.128s
2026-01-13 16:41:53,624 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:41:53,626 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25763912e+01  6.38491701e+00  4.02458179e-01 -1.00000100e-02
  2.42760002e+01]
2026-01-13 16:41:53,627 - DEBUG - integration_test - Step 201: Using propagated spline 24.2760 (close to path, dist=0.501m, drift=0.044m)
2026-01-13 16:41:53,627 - DEBUG - integration_test -   Set spline state to 24.2760
2026-01-13 16:41:53,628 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:53,693 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.576, 6.385), path_start=(0.000, 0.000), dist=23.462m
2026-01-13 16:41:53,693 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.462m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:53,693 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:41:53,745 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:53,755 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:53,755 - INFO - integration_test - Warmstart k=0: x0=22.5763912297685 , y0=6.384917013907919 , psi0=0.4024581786793538 , v0=-0.010000009955943056 , spline0=24.427515380421834 , a0=0.0 , w0=0.0
2026-01-13 16:41:53,755 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:53,756 - INFO - integration_test - Dyn residual k=0: pred=[22.575471127900173, 6.384525332221994, 0.4024581786793538, -0.010000009955943056, 24.426515379426238], ws=[22.57547112881622, 6.38452533261195, 0.40245817867935374, 0.17875, 24.427515380421834], res=[-9.160459057966364e-10, -3.899565115261794e-10, 5.551115123125783e-17, -0.18875000995594304, -0.00100000099559594], res_norm=1.888e-01
2026-01-13 16:41:53,757 - INFO - integration_test - Dyn residual k=1: pred=[22.591917933338237, 6.391526635777396, 0.40245817867935374, 0.17875, 24.445390380421834], ws=[22.591917933338237, 6.391526635777396, 0.40245817867935374, 0.34390624999999997, 24.427515380421834], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:41:53,758 - INFO - integration_test - Dyn residual k=2: pred=[22.62356078015027, 6.404996800346579, 0.40245817867935374, 0.34390624999999997, 24.461906005421834], ws=[22.62356078015027, 6.404996800346579, 0.40245817867935374, 0.48841796875, 24.22549517840163], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.23641082702020455], res_norm=2.771e-01
2026-01-13 16:41:53,771 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:53,842 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:53,857 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:53,868 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:53,883 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:53,894 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:53,909 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:53,920 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:53,935 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:53,946 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:53,961 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:53,972 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:53,993 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:54,005 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:54,020 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:54,031 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:54,046 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:54,058 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:54,073 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:54,083 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:54,096 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:54,107 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:54,261 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:41:54,261 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:41:54,261 - ERROR - integration_test -   Vehicle has moved only 0.0135m in last 5 steps
2026-01-13 16:41:54,261 - ERROR - integration_test -   Current position: (22.576, 6.385)
2026-01-13 16:41:54,261 - ERROR - integration_test -   Position 5 steps ago: (22.570, 6.384)
2026-01-13 16:41:54,261 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:41:54,261 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:41:54,774 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.276)
2026-01-13 16:41:54,774 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:54,774 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:41:54,774 - INFO - integration_test -   Control dict from planner: {'a': -6.96465716357373e-11, 'w': -0.004449494996608135}
2026-01-13 16:41:54,774 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:54,774 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:54,775 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:54,775 - INFO - integration_test - Step 200 completed in 1.149s
2026-01-13 16:41:54,792 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:41:54,794 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25754710e+01  6.38452554e+00  4.02013229e-01 -1.00000100e-02
  2.42750002e+01]
2026-01-13 16:41:54,795 - DEBUG - integration_test - Step 201: Using propagated spline 24.2750 (close to path, dist=0.501m, drift=0.043m)
2026-01-13 16:41:54,795 - DEBUG - integration_test -   Set spline state to 24.2750
2026-01-13 16:41:54,796 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:54,862 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.575, 6.385), path_start=(0.000, 0.000), dist=23.461m
2026-01-13 16:41:54,862 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.461m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:54,862 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:41:54,914 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:54,923 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:54,923 - INFO - integration_test - Warmstart k=0: x0=22.57547104079093 , y0=6.384525536934212 , psi0=0.40201322917969295 , v0=-0.010000009962907714 , spline0=24.426515379425542 , a0=0.0 , w0=0.0
2026-01-13 16:41:54,923 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:54,924 - INFO - integration_test - Dyn residual k=0: pred=[22.57455076473448, 6.38413426468564, 0.40201322917969295, -0.010000009962907714, 24.42551537842925], ws=[22.57455076565134, 6.38413426507546, 0.4020132291796932, 0.17875, 24.426515379425542], res=[-9.168594772290817e-10, -3.8981973204954556e-10, -2.220446049250313e-16, -0.1887500099629077, -0.0010000009962922718], res_norm=1.888e-01
2026-01-13 16:41:54,925 - INFO - integration_test - Dyn residual k=1: pred=[22.591000683771526, 6.391128249550644, 0.4020132291796932, 0.17875, 24.444390379425542], ws=[22.591000683771526, 6.391128249550644, 0.4020132291796932, 0.34390624999999997, 24.426515379425542], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:41:54,926 - INFO - integration_test - Dyn residual k=2: pred=[22.62264952099402, 6.404584333318023, 0.4020132291796932, 0.34390624999999997, 24.460906004425542], ws=[22.62264952099402, 6.404584333318023, 0.4020132291796932, 0.48841796875, 24.224495177405338], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.23641082702020455], res_norm=2.771e-01
2026-01-13 16:41:54,940 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:55,009 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:55,025 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:55,036 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:55,051 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:55,063 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:55,078 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:55,089 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:55,104 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:55,116 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:55,130 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:55,143 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:55,157 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:55,169 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:55,183 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:55,195 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:55,211 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:55,223 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:55,239 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:55,249 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:55,262 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:55,272 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:55,417 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:41:55,417 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:41:55,417 - ERROR - integration_test -   Vehicle has moved only 0.0045m in last 5 steps
2026-01-13 16:41:55,417 - ERROR - integration_test -   Current position: (22.575, 6.385)
2026-01-13 16:41:55,417 - ERROR - integration_test -   Position 5 steps ago: (22.580, 6.386)
2026-01-13 16:41:55,417 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:41:55,417 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:41:55,922 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.275)
2026-01-13 16:41:55,923 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:55,923 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:41:55,923 - INFO - integration_test -   Control dict from planner: {'a': -2.461488398539866e-10, 'w': 0.05360682979889836}
2026-01-13 16:41:55,923 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:55,923 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:55,924 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:55,924 - INFO - integration_test - Step 200 completed in 1.130s
2026-01-13 16:41:55,942 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:41:55,944 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25745518e+01  6.38413180e+00  4.07373912e-01 -1.00000100e-02
  2.42740002e+01]
2026-01-13 16:41:55,944 - DEBUG - integration_test - Step 201: Using propagated spline 24.2740 (close to path, dist=0.501m, drift=0.042m)
2026-01-13 16:41:55,944 - DEBUG - integration_test -   Set spline state to 24.2740
2026-01-13 16:41:55,945 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:56,012 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.575, 6.384), path_start=(0.000, 0.000), dist=23.460m
2026-01-13 16:41:56,012 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.460m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:56,012 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:41:56,065 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:56,075 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:56,075 - INFO - integration_test - Warmstart k=0: x0=22.57455181788172 , y0=6.384131799910955 , psi0=0.4073739121595828 , v0=-0.010000009987522599 , spline0=24.42551537842679 , a0=0.0 , w0=0.0
2026-01-13 16:41:56,075 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:56,076 - INFO - integration_test - Dyn residual k=0: pred=[22.573633652522364, 6.3837355999988095, 0.4073739121595828, -0.010000009987522599, 24.42451537742804], ws=[22.573633653439384, 6.383735600394515, 0.40737391215958274, 0.17875, 24.42551537842679], res=[-9.170193493446277e-10, -3.957056904368983e-10, 5.551115123125783e-17, -0.1887500099875226, -0.0010000009987507497], res_norm=1.888e-01
2026-01-13 16:41:56,077 - INFO - integration_test - Dyn residual k=1: pred=[22.590045842846163, 6.390817666750885, 0.40737391215958274, 0.17875, 24.44339037842679], ws=[22.590045842846163, 6.390817666750885, 0.40737391215958274, 0.34390624999999997, 24.42551537842679], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:41:56,078 - INFO - integration_test - Dyn residual k=2: pred=[22.62162209187092, 6.404443215745963, 0.40737391215958274, 0.34390624999999997, 24.45990600342679], ws=[22.62162209187092, 6.404443215745963, 0.40737391215958274, 0.48841796875, 24.223495176406587], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.23641082702020455], res_norm=2.771e-01
2026-01-13 16:41:56,092 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:56,162 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:56,177 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:56,189 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:56,204 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:56,215 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:56,230 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:56,242 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:56,257 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:56,269 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:56,284 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:56,296 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:56,311 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:56,322 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:56,338 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:56,350 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:56,365 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:56,377 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:56,391 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:56,401 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:56,414 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:56,425 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:56,582 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:41:56,582 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:41:56,582 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:41:56,582 - ERROR - integration_test -   Current position: (22.575, 6.384)
2026-01-13 16:41:56,582 - ERROR - integration_test -   Position 5 steps ago: (22.579, 6.386)
2026-01-13 16:41:56,582 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:41:56,582 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:41:57,097 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.274)
2026-01-13 16:41:57,097 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:57,097 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:41:57,097 - INFO - integration_test -   Control dict from planner: {'a': -8.203758090356615e-11, 'w': 0.02455535293486611}
2026-01-13 16:41:57,097 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:57,097 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:57,098 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:57,099 - INFO - integration_test - Step 200 completed in 1.155s
2026-01-13 16:41:57,114 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:41:57,117 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25736341e+01  6.38373447e+00  4.09829447e-01 -1.00000100e-02
  2.42730002e+01]
2026-01-13 16:41:57,118 - DEBUG - integration_test - Step 201: Using propagated spline 24.2730 (close to path, dist=0.502m, drift=0.041m)
2026-01-13 16:41:57,118 - DEBUG - integration_test -   Set spline state to 24.2730
2026-01-13 16:41:57,118 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:57,185 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.574, 6.384), path_start=(0.000, 0.000), dist=23.459m
2026-01-13 16:41:57,185 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.459m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:57,185 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:41:57,240 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:57,251 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:57,251 - INFO - integration_test - Warmstart k=0: x0=22.57363413988588 , y0=6.383734473103648 , psi0=0.40982944745306943 , v0=-0.010000009995726358 , spline0=24.42451537742722 , a0=0.0 , w0=0.0
2026-01-13 16:41:57,251 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:57,252 - INFO - integration_test - Dyn residual k=0: pred=[22.572716950175767, 6.3833360198004705, 0.40982944745306943, -0.010000009995726358, 24.42351537642765], ws=[22.572716951092566, 6.383336020198753, 0.4098294474530695, 0.17875, 24.42451537742722], res=[-9.167990810965421e-10, -3.9828229603244836e-10, -5.551115123125783e-17, -0.18875000999572636, -0.0010000009995714265], res_norm=1.888e-01
2026-01-13 16:41:57,253 - INFO - integration_test - Dyn residual k=1: pred=[22.58911170077305, 6.390458365873761, 0.4098294474530695, 0.17875, 24.44239037742722], ws=[22.58911170077305, 6.390458365873761, 0.4098294474530695, 0.34390624999999997, 24.42451537742722], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:41:57,254 - INFO - integration_test - Dyn residual k=2: pred=[22.620654396618104, 6.404161410306187, 0.4098294474530695, 0.34390624999999997, 24.45890600242722], ws=[22.620654396618104, 6.404161410306187, 0.4098294474530695, 0.48841796875, 24.22249517540702], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.236410827020201], res_norm=2.771e-01
2026-01-13 16:41:57,268 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:57,338 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:57,353 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:57,364 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:57,379 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:57,391 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:57,405 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:57,417 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:57,431 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:57,443 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:57,458 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:57,469 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:57,483 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:57,495 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:57,509 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:57,521 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:57,537 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:57,549 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:57,564 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:57,574 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:57,587 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:57,597 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:57,717 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:41:57,717 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:41:57,717 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:41:57,717 - ERROR - integration_test -   Current position: (22.574, 6.384)
2026-01-13 16:41:57,717 - ERROR - integration_test -   Position 5 steps ago: (22.578, 6.386)
2026-01-13 16:41:57,717 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:41:57,717 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:41:58,250 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.273)
2026-01-13 16:41:58,250 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:58,250 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:41:58,250 - INFO - integration_test -   Control dict from planner: {'a': 5.0692885871341015e-08, 'w': 0.25966410931565403}
2026-01-13 16:41:58,250 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:58,250 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:58,251 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:58,252 - INFO - integration_test - Step 200 completed in 1.135s
2026-01-13 16:41:58,268 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:41:58,271 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25727222e+01  6.38332416e+00  4.35795858e-01 -1.00000049e-02
  2.42720002e+01]
2026-01-13 16:41:58,272 - DEBUG - integration_test - Step 201: Using propagated spline 24.2720 (close to path, dist=0.502m, drift=0.040m)
2026-01-13 16:41:58,272 - DEBUG - integration_test -   Set spline state to 24.2720
2026-01-13 16:41:58,273 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:58,339 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.573, 6.383), path_start=(0.000, 0.000), dist=23.458m
2026-01-13 16:41:58,339 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.458m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:58,340 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:41:58,391 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:58,401 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:58,401 - INFO - integration_test - Warmstart k=0: x0=22.572722226383156 , y0=6.383324157287001 , psi0=0.4357958583846348 , v0=-0.01000000492643777 , spline0=24.423515376934574 , a0=0.0 , w0=0.0
2026-01-13 16:41:58,401 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:58,402 - INFO - integration_test - Dyn residual k=0: pred=[22.571815691564424, 6.382902025071082, 0.4357958583846348, -0.01000000492643777, 24.42251537644193], ws=[22.571815692011025, 6.3829020252790425, 0.43579585838463464, 0.17875, 24.423515376934574], res=[-4.4660097842097457e-10, -2.0796075972384642e-10, 1.6653345369377348e-16, -0.18875000492643776, -0.0010000004926453698], res_norm=1.888e-01
2026-01-13 16:41:58,403 - INFO - integration_test - Dyn residual k=1: pred=[22.588019993912884, 6.390447634921305, 0.43579585838463464, 0.17875, 24.441390376934574], ws=[22.588019993912884, 6.390447634921305, 0.43579585838463464, 0.34390624999999997, 24.423515376934574], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:41:58,404 - INFO - integration_test - Dyn residual k=2: pred=[22.619196277554487, 6.40496501850751, 0.43579585838463464, 0.34390624999999997, 24.457906001934575], ws=[22.619196277554487, 6.40496501850751, 0.43579585838463464, 0.48841796875, 24.221495174914374], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.236410827020201], res_norm=2.771e-01
2026-01-13 16:41:58,417 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:58,489 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:58,505 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:58,516 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:58,531 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:58,544 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:58,559 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:58,572 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:58,588 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:58,600 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:58,615 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:58,627 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:58,643 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:58,655 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:58,669 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:58,681 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:58,696 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:58,708 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:58,723 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:58,733 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:58,746 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:58,757 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:58,874 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:41:58,875 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:41:58,875 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:41:58,875 - ERROR - integration_test -   Current position: (22.573, 6.383)
2026-01-13 16:41:58,875 - ERROR - integration_test -   Position 5 steps ago: (22.577, 6.385)
2026-01-13 16:41:58,875 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:41:58,875 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:41:59,416 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.272)
2026-01-13 16:41:59,416 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:41:59,416 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:41:59,416 - INFO - integration_test -   Control dict from planner: {'a': 1.6320701285867034e-08, 'w': 0.23123409675540138}
2026-01-13 16:41:59,416 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:41:59,416 - INFO - integration_test -   Planner output success: True
2026-01-13 16:41:59,418 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:41:59,418 - INFO - integration_test - Step 200 completed in 1.147s
2026-01-13 16:41:59,438 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:41:59,442 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25718207e+01  6.38289158e+00  4.58919268e-01 -1.00000033e-02
  2.42710002e+01]
2026-01-13 16:41:59,442 - DEBUG - integration_test - Step 201: Using propagated spline 24.2710 (close to path, dist=0.502m, drift=0.039m)
2026-01-13 16:41:59,442 - DEBUG - integration_test -   Set spline state to 24.2710
2026-01-13 16:41:59,443 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:59,512 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.572, 6.383), path_start=(0.000, 0.000), dist=23.457m
2026-01-13 16:41:59,512 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.457m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:41:59,512 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:41:59,566 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:41:59,575 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:41:59,575 - INFO - integration_test - Warmstart k=0: x0=22.571820652772395 , y0=6.38289158210308 , psi0=0.4589192680601749 , v0=-0.010000003294367642 , spline0=24.422515376605137 , a0=0.0 , w0=0.0
2026-01-13 16:41:59,576 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:41:59,577 - INFO - integration_test - Dyn residual k=0: pred=[22.570924120714, 6.382448602501808, 0.4589192680601749, -0.010000003294367642, 24.4215153762757], ws=[22.57092412100935, 6.382448602647742, 0.4589192680601748, 0.17875, 24.422515376605137], res=[-2.9535129897340084e-10, -1.4593393160566848e-10, 1.1102230246251565e-16, -0.18875000329436764, -0.0010000003294372561], res_norm=1.888e-01
2026-01-13 16:41:59,577 - INFO - integration_test - Dyn residual k=1: pred=[22.586949626273775, 6.39036686041192, 0.4589192680601748, 0.17875, 24.440390376605137], ws=[22.586949626273775, 6.39036686041192, 0.4589192680601748, 0.34390624999999997, 24.422515376605137], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:41:59,578 - INFO - integration_test - Dyn residual k=2: pred=[22.617781913937232, 6.405601200743175, 0.4589192680601748, 0.34390624999999997, 24.456906001605137], ws=[22.617781913937232, 6.405601200743175, 0.4589192680601748, 0.48841796875, 24.220495174584933], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.23641082702020455], res_norm=2.771e-01
2026-01-13 16:41:59,592 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:59,662 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:59,677 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:59,689 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:59,704 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:59,715 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:59,730 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:59,742 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:59,756 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:59,768 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:59,783 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:59,794 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:59,809 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:59,820 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:59,835 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:59,846 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:59,861 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:59,873 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:41:59,888 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:59,898 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:41:59,911 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:41:59,921 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:00,041 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:00,041 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:00,041 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:00,041 - ERROR - integration_test -   Current position: (22.572, 6.383)
2026-01-13 16:42:00,041 - ERROR - integration_test -   Position 5 steps ago: (22.576, 6.385)
2026-01-13 16:42:00,041 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:00,041 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:00,587 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.271)
2026-01-13 16:42:00,587 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:00,587 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:00,587 - INFO - integration_test -   Control dict from planner: {'a': -1.3079063456769397e-08, 'w': 0.20605610520633852}
2026-01-13 16:42:00,587 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:00,587 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:00,588 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:00,589 - INFO - integration_test - Step 200 completed in 1.147s
2026-01-13 16:42:00,605 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:00,607 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25709287e+01  6.38243940e+00  4.79524879e-01 -1.00000046e-02
  2.42700002e+01]
2026-01-13 16:42:00,608 - DEBUG - integration_test - Step 201: Using propagated spline 24.2700 (close to path, dist=0.502m, drift=0.038m)
2026-01-13 16:42:00,608 - DEBUG - integration_test -   Set spline state to 24.2700
2026-01-13 16:42:00,608 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:00,677 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.571, 6.382), path_start=(0.000, 0.000), dist=23.456m
2026-01-13 16:42:00,677 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.456m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:00,677 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:00,729 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:00,739 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:00,739 - INFO - integration_test - Warmstart k=0: x0=22.570928747868724 , y0=6.382439397350492 , psi0=0.4795248785808088 , v0=-0.010000004602273987 , spline0=24.42151537614491 , a0=0.0 , w0=0.0
2026-01-13 16:42:00,739 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:00,740 - INFO - integration_test - Dyn residual k=0: pred=[22.57004153323657, 6.381978039445013, 0.4795248785808088, -0.010000004602273987, 24.420515375684683], ws=[22.57004153364489, 6.3819780396573424, 0.4795248785808086, 0.17875, 24.42151537614491], res=[-4.0832048853189917e-10, -2.1232970937035134e-10, 1.6653345369377348e-16, -0.18875000460227398, -0.0010000004602268575], res_norm=1.888e-01
2026-01-13 16:42:00,741 - INFO - integration_test - Dyn residual k=1: pred=[22.585900487895906, 6.390224808422394, 0.4795248785808086, 0.17875, 24.43939037614491], ws=[22.585900487895906, 6.390224808422394, 0.4795248785808086, 0.34390624999999997, 24.42151537614491], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:00,742 - INFO - integration_test - Dyn residual k=2: pred=[22.616412339562412, 6.406091187838371, 0.4795248785808086, 0.34390624999999997, 24.45590600114491], ws=[22.616412339562412, 6.406091187838371, 0.4795248785808086, 0.48841796875, 24.21949517412471], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.236410827020201], res_norm=2.771e-01
2026-01-13 16:42:00,755 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:00,825 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:00,840 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:00,852 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:00,867 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:00,879 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:00,894 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:00,905 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:00,920 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:00,931 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:00,947 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:00,959 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:00,973 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:00,986 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:01,001 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:01,012 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:01,027 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:01,039 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:01,054 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:01,064 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:01,077 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:01,087 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:01,208 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:01,208 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:01,208 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:01,208 - ERROR - integration_test -   Current position: (22.571, 6.382)
2026-01-13 16:42:01,208 - ERROR - integration_test -   Position 5 steps ago: (22.575, 6.385)
2026-01-13 16:42:01,208 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:01,209 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:01,768 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.270)
2026-01-13 16:42:01,769 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:01,769 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:01,769 - INFO - integration_test -   Control dict from planner: {'a': -8.043838905410204e-09, 'w': 0.18283781642919222}
2026-01-13 16:42:01,769 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:01,769 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:01,770 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:01,770 - INFO - integration_test - Step 200 completed in 1.163s
2026-01-13 16:42:01,786 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:01,789 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25700458e+01  6.38196995e+00  4.97808660e-01 -1.00000054e-02
  2.42690002e+01]
2026-01-13 16:42:01,789 - DEBUG - integration_test - Step 201: Using propagated spline 24.2690 (close to path, dist=0.503m, drift=0.037m)
2026-01-13 16:42:01,789 - DEBUG - integration_test -   Set spline state to 24.2690
2026-01-13 16:42:01,790 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:01,856 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.570, 6.382), path_start=(0.000, 0.000), dist=23.455m
2026-01-13 16:42:01,856 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.455m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:01,856 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:01,908 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:01,917 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:01,917 - INFO - integration_test - Warmstart k=0: x0=22.57004580019851 , y0=6.381969954537292 , psi0=0.497808660223728 , v0=-0.010000005406657879 , spline0=24.420515375604243 , a0=0.0 , w0=0.0
2026-01-13 16:42:01,917 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:01,918 - INFO - integration_test - Dyn residual k=0: pred=[22.569167168685226, 6.3814924529716475, 0.497808660223728, -0.010000005406657879, 24.419515375063575], ws=[22.56916716916027, 6.381492453229816, 0.49780866022372816, 0.17875, 24.420515375604243], res=[-4.750440041334514e-10, -2.581685976110748e-10, -1.6653345369377348e-16, -0.18875000540665787, -0.0010000005406674006], res_norm=1.888e-01
2026-01-13 16:42:01,919 - INFO - integration_test - Dyn residual k=1: pred=[22.584872698968816, 6.390027789100939, 0.49780866022372816, 0.17875, 24.438390375604243], ws=[22.584872698968816, 6.390027789100939, 0.49780866022372816, 0.34390624999999997, 24.420515375604243], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:01,920 - INFO - integration_test - Dyn residual k=2: pred=[22.6150893695183, 6.406449357503336, 0.49780866022372816, 0.34390624999999997, 24.454906000604243], ws=[22.6150893695183, 6.406449357503336, 0.49780866022372816, 0.48841796875, 24.21849517358404], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.23641082702020455], res_norm=2.771e-01
2026-01-13 16:42:01,933 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:02,004 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:02,018 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:02,030 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:02,045 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:02,056 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:02,071 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:02,082 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:02,097 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:02,108 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:02,123 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:02,135 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:02,150 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:02,161 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:02,175 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:02,187 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:02,201 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:02,213 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:02,227 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:02,238 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:02,251 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:02,261 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:02,383 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:02,383 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:02,383 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:02,383 - ERROR - integration_test -   Current position: (22.570, 6.382)
2026-01-13 16:42:02,383 - ERROR - integration_test -   Position 5 steps ago: (22.575, 6.384)
2026-01-13 16:42:02,383 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:02,383 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:02,951 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.269)
2026-01-13 16:42:02,951 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:02,951 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:02,951 - INFO - integration_test -   Control dict from planner: {'a': -8.129146278043998e-09, 'w': 0.16281218841868333}
2026-01-13 16:42:02,951 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:02,951 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:02,952 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:02,953 - INFO - integration_test - Step 200 completed in 1.164s
2026-01-13 16:42:02,969 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:02,972 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25691711e+01  6.38148532e+00  5.14089879e-01 -1.00000062e-02
  2.42680002e+01]
2026-01-13 16:42:02,972 - DEBUG - integration_test - Step 201: Using propagated spline 24.2680 (close to path, dist=0.503m, drift=0.036m)
2026-01-13 16:42:02,973 - DEBUG - integration_test -   Set spline state to 24.2680
2026-01-13 16:42:02,973 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:03,039 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.569, 6.381), path_start=(0.000, 0.000), dist=23.454m
2026-01-13 16:42:03,040 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.454m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:03,040 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:03,092 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:03,102 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:03,102 - INFO - integration_test - Warmstart k=0: x0=22.569171094534727 , y0=6.3814853216094525 , psi0=0.5140898790655963 , v0=-0.010000006219572507 , spline0=24.419515374982286 , a0=0.0 , w0=0.0
2026-01-13 16:42:03,102 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:03,103 - INFO - integration_test - Dyn residual k=0: pred=[22.568300353365093, 6.380993578730078, 0.5140898790655963, -0.010000006219572507, 24.41851537436033], ws=[22.568300353906654, 6.380993579035921, 0.5140898790655966, 0.17875, 24.419515374982286], res=[-5.415614623416332e-10, -3.058424624668987e-10, -2.220446049250313e-16, -0.1887500062195725, -0.0010000006219570423], res_norm=1.888e-01
2026-01-13 16:42:03,104 - INFO - integration_test - Dyn residual k=1: pred=[22.583864842633453, 6.389783477537798, 0.5140898790655966, 0.17875, 24.437390374982286], ws=[22.583864842633453, 6.389783477537798, 0.5140898790655966, 0.34390624999999997, 24.419515374982286], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:03,105 - INFO - integration_test - Dyn residual k=2: pred=[22.613810157045766, 6.406694811980658, 0.5140898790655966, 0.34390624999999997, 24.453905999982286], ws=[22.613810157045766, 6.406694811980658, 0.5140898790655966, 0.48841796875, 24.21749517296208], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.23641082702020455], res_norm=2.771e-01
2026-01-13 16:42:03,119 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:03,191 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:03,206 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:03,218 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:03,233 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:03,245 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:03,259 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:03,271 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:03,285 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:03,297 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:03,312 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:03,323 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:03,338 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:03,350 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:03,365 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:03,376 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:03,391 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:03,403 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:03,418 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:03,428 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:03,441 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:03,451 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:03,597 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:03,597 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:03,597 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:03,597 - ERROR - integration_test -   Current position: (22.569, 6.381)
2026-01-13 16:42:03,598 - ERROR - integration_test -   Position 5 steps ago: (22.574, 6.384)
2026-01-13 16:42:03,598 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:03,598 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:04,167 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.268)
2026-01-13 16:42:04,167 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:04,167 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:04,168 - INFO - integration_test -   Control dict from planner: {'a': -2.5196835818614126e-08, 'w': -0.7995415512103853}
2026-01-13 16:42:04,168 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:04,168 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:04,169 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:04,169 - INFO - integration_test - Step 200 completed in 1.197s
2026-01-13 16:42:04,185 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:04,188 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25682816e+01  6.38102889e+00  4.34135724e-01 -1.00000087e-02
  2.42670002e+01]
2026-01-13 16:42:04,189 - DEBUG - integration_test - Step 201: Using propagated spline 24.2670 (close to path, dist=0.503m, drift=0.035m)
2026-01-13 16:42:04,189 - DEBUG - integration_test -   Set spline state to 24.2670
2026-01-13 16:42:04,190 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:04,257 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.568, 6.381), path_start=(0.000, 0.000), dist=23.453m
2026-01-13 16:42:04,257 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.453m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:04,257 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:04,309 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:04,318 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:04,318 - INFO - integration_test - Warmstart k=0: x0=22.568281632696564 , y0=6.381028893572222 , psi0=0.4341357239445578 , v0=-0.010000008739256088 , spline0=24.41851537410836 , a0=0.0 , w0=0.0
2026-01-13 16:42:04,318 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:04,319 - INFO - integration_test - Dyn residual k=0: pred=[22.56737439798524, 6.3806082667466155, 0.4341357239445578, -0.010000008739256088, 24.417515373234433], ws=[22.567374398778096, 6.380608267114212, 0.434135723944558, 0.17875, 24.41851537410836], res=[-7.92855558984229e-10, -3.6759661981022873e-10, -2.220446049250313e-16, -0.18875000873925607, -0.0010000008739261546], res_norm=1.888e-01
2026-01-13 16:42:04,320 - INFO - integration_test - Dyn residual k=1: pred=[22.583591205070743, 6.388126965051144, 0.434135723944558, 0.17875, 24.43639037410836], ws=[22.583591205070743, 6.388126965051144, 0.434135723944558, 0.34390624999999997, 24.41851537410836], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:04,321 - INFO - integration_test - Dyn residual k=2: pred=[22.614791546548112, 6.402592571833649, 0.434135723944558, 0.34390624999999997, 24.45290599910836], ws=[22.614791546548112, 6.402592571833649, 0.434135723944558, 0.48841796875, 24.21649517208816], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.236410827020201], res_norm=2.771e-01
2026-01-13 16:42:04,335 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:04,414 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:04,430 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:04,442 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:04,457 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:04,469 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:04,484 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:04,495 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:04,510 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:04,522 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:04,537 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:04,550 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:04,565 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:04,576 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:04,591 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:04,603 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:04,617 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:04,629 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:04,644 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:04,654 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:04,667 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:04,677 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:04,864 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:04,864 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:04,864 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:04,864 - ERROR - integration_test -   Current position: (22.568, 6.381)
2026-01-13 16:42:04,864 - ERROR - integration_test -   Position 5 steps ago: (22.573, 6.383)
2026-01-13 16:42:04,864 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:04,864 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:05,431 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.267)
2026-01-13 16:42:05,432 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:05,432 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:05,432 - INFO - integration_test -   Control dict from planner: {'a': -8.384323528467518e-09, 'w': -0.11266451551990715}
2026-01-13 16:42:05,432 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:05,432 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:05,433 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:05,434 - INFO - integration_test - Step 200 completed in 1.246s
2026-01-13 16:42:05,451 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:05,455 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25673720e+01  6.38061339e+00  4.22869272e-01 -1.00000096e-02
  2.42660002e+01]
2026-01-13 16:42:05,455 - DEBUG - integration_test - Step 201: Using propagated spline 24.2660 (close to path, dist=0.503m, drift=0.034m)
2026-01-13 16:42:05,455 - DEBUG - integration_test -   Set spline state to 24.2660
2026-01-13 16:42:05,456 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:05,521 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.567, 6.381), path_start=(0.000, 0.000), dist=23.452m
2026-01-13 16:42:05,521 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.452m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:05,521 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:05,573 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:05,583 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:05,583 - INFO - integration_test - Warmstart k=0: x0=22.56737204767913 , y0=6.380613386231677 , psi0=0.42286927239256705 , v0=-0.010000009577688441 , spline0=24.41751537315059 , a0=0.0 , w0=0.0
2026-01-13 16:42:05,583 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:05,584 - INFO - integration_test - Dyn residual k=0: pred=[22.56646013159822, 6.380203007166765, 0.42286927239256705, -0.010000009577688441, 24.41651537219282], ws=[22.566460132471622, 6.380203007559812, 0.4228692723925671, 0.17875, 24.41751537315059], res=[-8.73402683509994e-10, -3.930473724267358e-10, -5.551115123125783e-17, -0.18875000957768842, -0.0010000009577701974], res_norm=1.888e-01
2026-01-13 16:42:05,585 - INFO - integration_test - Dyn residual k=1: pred=[22.58276061680577, 6.387538526319393, 0.4228692723925671, 0.17875, 24.43539037315059], ws=[22.58276061680577, 6.387538526319393, 0.4228692723925671, 0.34390624999999997, 24.41751537315059], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:05,586 - INFO - integration_test - Dyn residual k=2: pred=[22.614121950738866, 6.401651705331488, 0.4228692723925671, 0.34390624999999997, 24.45190599815059], ws=[22.614121950738866, 6.401651705331488, 0.4228692723925671, 0.48841796875, 24.215495171130385], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.23641082702020455], res_norm=2.771e-01
2026-01-13 16:42:05,599 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:05,670 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:05,685 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:05,696 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:05,711 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:05,722 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:05,737 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:05,749 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:05,764 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:05,775 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:05,790 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:05,801 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:05,815 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:05,827 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:05,842 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:05,853 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:05,868 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:05,879 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:05,894 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:05,904 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:05,916 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:05,926 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:06,046 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:06,046 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:06,046 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:06,046 - ERROR - integration_test -   Current position: (22.567, 6.381)
2026-01-13 16:42:06,047 - ERROR - integration_test -   Position 5 steps ago: (22.572, 6.383)
2026-01-13 16:42:06,047 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:06,047 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:06,624 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.266)
2026-01-13 16:42:06,625 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:06,625 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:06,625 - INFO - integration_test -   Control dict from planner: {'a': 2.2932483852946734e-08, 'w': 0.2811477690292456}
2026-01-13 16:42:06,625 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:06,625 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:06,626 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:06,626 - INFO - integration_test - Step 200 completed in 1.172s
2026-01-13 16:42:06,646 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:06,649 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25664660e+01  6.38019024e+00  4.50984049e-01 -1.00000073e-02
  2.42650002e+01]
2026-01-13 16:42:06,650 - DEBUG - integration_test - Step 201: Using propagated spline 24.2650 (close to path, dist=0.504m, drift=0.033m)
2026-01-13 16:42:06,650 - DEBUG - integration_test -   Set spline state to 24.2650
2026-01-13 16:42:06,651 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:06,716 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.566, 6.380), path_start=(0.000, 0.000), dist=23.451m
2026-01-13 16:42:06,716 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.451m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:06,716 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:06,769 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:06,778 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:06,778 - INFO - integration_test - Warmstart k=0: x0=22.566466020310806 , y0=6.380190242962718 , psi0=0.45098404929549163 , v0=-0.010000007284440057 , spline0=24.416515372422147 , a0=0.0 , w0=0.0
2026-01-13 16:42:06,778 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:06,779 - INFO - integration_test - Dyn residual k=0: pred=[22.565566001016272, 6.37975439123752, 0.45098404929549163, -0.010000007284440057, 24.415515371693704], ws=[22.565566001671886, 6.3797543915550134, 0.45098404929549174, 0.17875, 24.416515372422147], res=[-6.556142295721656e-10, -3.1749358697652497e-10, -1.1102230246251565e-16, -0.18875000728444005, -0.0010000007284425294], res_norm=1.888e-01
2026-01-13 16:42:06,780 - INFO - integration_test - Dyn residual k=1: pred=[22.581653834842566, 6.387545235467737, 0.45098404929549174, 0.17875, 24.434390372422147], ws=[22.581653834842566, 6.387545235467737, 0.45098404929549174, 0.34390624999999997, 24.416515372422147], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:06,781 - INFO - integration_test - Dyn residual k=2: pred=[22.61260603834664, 6.402534437785836, 0.45098404929549174, 0.34390624999999997, 24.450905997422147], ws=[22.61260603834664, 6.402534437785836, 0.45098404929549174, 0.48841796875, 24.214495170401946], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.236410827020201], res_norm=2.771e-01
2026-01-13 16:42:06,795 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:06,865 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:06,880 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:06,892 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:06,907 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:06,919 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:06,934 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:06,945 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:06,960 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:06,971 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:06,986 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:06,997 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:07,012 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:07,024 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:07,039 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:07,051 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:07,065 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:07,077 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:07,091 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:07,102 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:07,114 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:07,124 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:07,248 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:07,248 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:07,248 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:07,248 - ERROR - integration_test -   Current position: (22.566, 6.380)
2026-01-13 16:42:07,248 - ERROR - integration_test -   Position 5 steps ago: (22.571, 6.382)
2026-01-13 16:42:07,248 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:07,248 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:08,478 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.265)
2026-01-13 16:42:08,478 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:08,478 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:08,478 - INFO - integration_test -   Control dict from planner: {'a': 4.323064229607936e-08, 'w': 0.24152143300991996}
2026-01-13 16:42:08,478 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:08,478 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:08,479 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:08,479 - INFO - integration_test - Step 200 completed in 1.831s
2026-01-13 16:42:08,495 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:08,497 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25655714e+01  6.37974357e+00  4.75136193e-01 -1.00000030e-02
  2.42640002e+01]
2026-01-13 16:42:08,498 - DEBUG - integration_test - Step 201: Using propagated spline 24.2640 (close to path, dist=0.504m, drift=0.032m)
2026-01-13 16:42:08,498 - DEBUG - integration_test -   Set spline state to 24.2640
2026-01-13 16:42:08,499 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:08,569 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.566, 6.380), path_start=(0.000, 0.000), dist=23.450m
2026-01-13 16:42:08,569 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.450m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:08,569 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:08,621 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:08,631 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:08,631 - INFO - integration_test - Warmstart k=0: x0=22.565571351828204 , y0=6.379743565538338 , psi0=0.4751361925964836 , v0=-0.010000002961375827 , spline0=24.41551537212601 , a0=0.0 , w0=0.0
2026-01-13 16:42:08,631 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:08,633 - INFO - integration_test - Dyn residual k=0: pred=[22.564682121137604, 6.379286105844845, 0.4751361925964836, -0.010000002961375827, 24.41451537182987], ws=[22.56468212140094, 6.3792861059803165, 0.47513619259648365, 0.17875, 24.41551537212601], res=[-2.6333424330005073e-10, -1.35471189821601e-10, -5.551115123125783e-17, -0.1887500029613758, -0.0010000002961376708], res_norm=1.888e-01
2026-01-13 16:42:08,634 - INFO - integration_test - Dyn residual k=1: pred=[22.580577115288307, 6.387463195579959, 0.47513619259648365, 0.17875, 24.43339037212601], ws=[22.580577115288307, 6.387463195579959, 0.47513619259648365, 0.34390624999999997, 24.41551537212601], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:08,634 - INFO - integration_test - Dyn residual k=2: pred=[22.611158305450978, 6.403195515692556, 0.47513619259648365, 0.34390624999999997, 24.44990599712601], ws=[22.611158305450978, 6.403195515692556, 0.47513619259648365, 0.48841796875, 24.21349517010581], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.236410827020201], res_norm=2.771e-01
2026-01-13 16:42:08,648 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:08,719 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:08,734 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:08,745 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:08,761 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:08,772 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:08,787 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:08,798 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:08,813 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:08,825 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:08,839 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:08,851 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:08,866 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:08,877 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:08,891 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:08,902 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:08,917 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:08,928 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:08,943 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:08,953 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:08,966 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:08,975 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:09,112 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:09,112 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:09,112 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:09,112 - ERROR - integration_test -   Current position: (22.566, 6.380)
2026-01-13 16:42:09,112 - ERROR - integration_test -   Position 5 steps ago: (22.570, 6.382)
2026-01-13 16:42:09,112 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:09,112 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:09,709 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.264)
2026-01-13 16:42:09,709 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:09,709 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:09,709 - INFO - integration_test -   Control dict from planner: {'a': -4.687826735683467e-08, 'w': -0.2792457214494598}
2026-01-13 16:42:09,709 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:09,709 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:09,710 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:09,711 - INFO - integration_test - Step 200 completed in 1.214s
2026-01-13 16:42:09,728 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:09,730 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25646758e+01  6.37929858e+00  4.47211620e-01 -1.00000076e-02
  2.42630002e+01]
2026-01-13 16:42:09,731 - DEBUG - integration_test - Step 201: Using propagated spline 24.2630 (close to path, dist=0.504m, drift=0.031m)
2026-01-13 16:42:09,731 - DEBUG - integration_test -   Set spline state to 24.2630
2026-01-13 16:42:09,732 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:09,799 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.565, 6.379), path_start=(0.000, 0.000), dist=23.449m
2026-01-13 16:42:09,799 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.449m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:09,799 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:09,853 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:09,862 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:09,862 - INFO - integration_test - Warmstart k=0: x0=22.5646758497221 , y0=6.379298580078742 , psi0=0.4472116204515376 , v0=-0.010000007649202563 , spline0=24.414515371361087 , a0=0.0 , w0=0.0
2026-01-13 16:42:09,862 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:09,863 - INFO - integration_test - Dyn residual k=0: pred=[22.563774192583136, 6.37886612668981, 0.4472116204515376, -0.010000007649202563, 24.413515370596166], ws=[22.56377419327283, 6.378866127020602, 0.4472116204515375, 0.17875, 24.414515371361087], res=[-6.896954118928988e-10, -3.3079228245469494e-10, 1.1102230246251565e-16, -0.18875000764920255, -0.0010000007649217935], res_norm=1.888e-01
2026-01-13 16:42:09,864 - INFO - integration_test - Dyn residual k=1: pred=[22.579891302303487, 6.386596225434848, 0.4472116204515375, 0.17875, 24.432390371361087], ws=[22.579891302303487, 6.386596225434848, 0.4472116204515375, 0.34390624999999997, 24.414515371361087], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:09,865 - INFO - integration_test - Dyn residual k=2: pred=[22.61089983112908, 6.401468556387429, 0.4472116204515375, 0.34390624999999997, 24.448905996361088], ws=[22.61089983112908, 6.401468556387429, 0.4472116204515375, 0.48841796875, 24.212495169340883], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.23641082702020455], res_norm=2.771e-01
2026-01-13 16:42:09,879 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:09,948 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:09,963 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:09,975 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:09,989 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:10,001 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:10,015 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:10,027 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:10,041 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:10,053 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:10,068 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:10,079 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:10,093 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:10,105 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:10,119 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:10,130 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:10,147 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:10,159 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:10,173 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:10,183 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:10,196 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:10,206 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:10,346 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:10,346 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:10,346 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:10,346 - ERROR - integration_test -   Current position: (22.565, 6.379)
2026-01-13 16:42:10,346 - ERROR - integration_test -   Position 5 steps ago: (22.569, 6.381)
2026-01-13 16:42:10,346 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:10,346 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:10,944 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.263)
2026-01-13 16:42:10,945 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:10,945 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:10,945 - INFO - integration_test -   Control dict from planner: {'a': -1.5651072531120484e-08, 'w': -0.10118753871262927}
2026-01-13 16:42:10,945 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:10,945 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:10,946 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:10,946 - INFO - integration_test - Step 200 completed in 1.216s
2026-01-13 16:42:10,962 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:10,967 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25637720e+01  6.37887070e+00  4.37092867e-01 -1.00000092e-02
  2.42620002e+01]
2026-01-13 16:42:10,968 - DEBUG - integration_test - Step 201: Using propagated spline 24.2620 (close to path, dist=0.504m, drift=0.030m)
2026-01-13 16:42:10,968 - DEBUG - integration_test -   Set spline state to 24.2620
2026-01-13 16:42:10,969 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:11,034 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.564, 6.379), path_start=(0.000, 0.000), dist=23.448m
2026-01-13 16:42:11,034 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.448m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:11,034 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:11,088 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:11,097 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:11,097 - INFO - integration_test - Warmstart k=0: x0=22.56377201997289 , y0=6.378870695820574 , psi0=0.4370928665802747 , v0=-0.010000009214309817 , spline0=24.413515370439658 , a0=0.0 , w0=0.0
2026-01-13 16:42:11,097 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:11,099 - INFO - integration_test - Dyn residual k=0: pred=[22.562866033036975, 6.378447387995447, 0.4370928665802747, -0.010000009214309817, 24.41251536951823], ws=[22.562866033871778, 6.378447388385496, 0.4370928665802749, 0.17875, 24.413515370439658], res=[-8.348024493898265e-10, -3.900488820818282e-10, -2.220446049250313e-16, -0.18875000921430982, -0.0010000009214294892], res_norm=1.888e-01
2026-01-13 16:42:11,099 - INFO - integration_test - Dyn residual k=1: pred=[22.579060535429154, 6.386014008787511, 0.4370928665802749, 0.17875, 24.431390370439658], ws=[22.579060535429154, 6.386014008787511, 0.4370928665802749, 0.34390624999999997, 24.413515370439658], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:11,100 - INFO - integration_test - Dyn residual k=2: pred=[22.610217963687703, 6.400571816046982, 0.4370928665802749, 0.34390624999999997, 24.44790599543966], ws=[22.610217963687703, 6.400571816046982, 0.4370928665802749, 0.48841796875, 24.211495168419454], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.23641082702020455], res_norm=2.771e-01
2026-01-13 16:42:11,114 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:11,185 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:11,200 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:11,211 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:11,227 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:11,238 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:11,253 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:11,264 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:11,279 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:11,291 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:11,305 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:11,317 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:11,331 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:11,343 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:11,358 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:11,369 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:11,384 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:11,395 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:11,410 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:11,420 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:11,433 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:11,443 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:11,607 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:11,607 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:11,607 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:11,607 - ERROR - integration_test -   Current position: (22.564, 6.379)
2026-01-13 16:42:11,607 - ERROR - integration_test -   Position 5 steps ago: (22.568, 6.381)
2026-01-13 16:42:11,607 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:11,607 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:12,221 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.262)
2026-01-13 16:42:12,222 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:12,222 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:12,222 - INFO - integration_test -   Control dict from planner: {'a': -5.198411584076115e-09, 'w': 0.0006114911397969765}
2026-01-13 16:42:12,222 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:12,222 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:12,223 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:12,223 - INFO - integration_test - Step 200 completed in 1.256s
2026-01-13 16:42:12,242 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:12,245 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25628660e+01  6.37844736e+00  4.37154016e-01 -1.00000097e-02
  2.42610002e+01]
2026-01-13 16:42:12,246 - DEBUG - integration_test - Step 201: Using propagated spline 24.2610 (close to path, dist=0.505m, drift=0.029m)
2026-01-13 16:42:12,246 - DEBUG - integration_test -   Set spline state to 24.2610
2026-01-13 16:42:12,246 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:12,312 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.563, 6.378), path_start=(0.000, 0.000), dist=23.447m
2026-01-13 16:42:12,313 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.447m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:12,313 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:12,376 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:12,388 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:12,389 - INFO - integration_test - Warmstart k=0: x0=22.56286604595644 , y0=6.378447360284558 , psi0=0.4371540156942544 , v0=-0.010000009734150975 , spline0=24.41251536946624 , a0=0.0 , w0=0.0
2026-01-13 16:42:12,389 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:12,390 - INFO - integration_test - Dyn residual k=0: pred=[22.561960084860022, 6.378023997037917, 0.4371540156942544, -0.010000009734150975, 24.411515368492825], ws=[22.561960085741898, 6.378023997450025, 0.4371540156942544, 0.17875, 24.41251536946624], res=[-8.818759056339331e-10, -4.121076813135005e-10, 0.0, -0.18875000973415096, -0.0010000009734163484], res_norm=1.888e-01
2026-01-13 16:42:12,391 - INFO - integration_test - Dyn residual k=1: pred=[22.578154124576862, 6.3855916081173145, 0.4371540156942544, 0.17875, 24.43039036946624], ws=[22.578154124576862, 6.3855916081173145, 0.4371540156942544, 0.34390624999999997, 24.41251536946624], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:12,392 - INFO - integration_test - Dyn residual k=2: pred=[22.609310662580146, 6.4001513205987, 0.4371540156942544, 0.34390624999999997, 24.446905994466242], ws=[22.609310662580146, 6.4001513205987, 0.4371540156942544, 0.48841796875, 24.21049516744604], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.236410827020201], res_norm=2.771e-01
2026-01-13 16:42:12,412 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:12,497 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:12,512 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:12,523 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:12,538 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:12,550 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:12,565 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:12,576 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:12,591 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:12,602 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:12,617 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:12,629 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:12,643 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:12,654 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:12,669 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:12,680 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:12,696 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:12,707 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:12,722 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:12,732 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:12,746 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:12,756 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:12,920 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:12,920 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:12,920 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:12,920 - ERROR - integration_test -   Current position: (22.563, 6.378)
2026-01-13 16:42:12,920 - ERROR - integration_test -   Position 5 steps ago: (22.567, 6.381)
2026-01-13 16:42:12,920 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:12,920 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:13,554 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.261)
2026-01-13 16:42:13,554 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:13,554 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:13,554 - INFO - integration_test -   Control dict from planner: {'a': -1.771204409280007e-09, 'w': 0.03375562079197267}
2026-01-13 16:42:13,554 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:13,554 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:13,555 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:13,555 - INFO - integration_test - Step 200 completed in 1.311s
2026-01-13 16:42:13,572 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:13,574 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25619608e+01  6.37802247e+00  4.40529578e-01 -1.00000099e-02
  2.42600002e+01]
2026-01-13 16:42:13,575 - DEBUG - integration_test - Step 201: Using propagated spline 24.2600 (close to path, dist=0.505m, drift=0.028m)
2026-01-13 16:42:13,575 - DEBUG - integration_test -   Set spline state to 24.2600
2026-01-13 16:42:13,576 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:13,643 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.562, 6.378), path_start=(0.000, 0.000), dist=23.446m
2026-01-13 16:42:13,643 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.446m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:13,643 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:13,695 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:13,705 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:13,705 - INFO - integration_test - Warmstart k=0: x0=22.56196080111627 , y0=6.378022468775636 , psi0=0.44052957777345164 , v0=-0.010000009911271417 , spline0=24.411515368475115 , a0=0.0 , w0=0.0
2026-01-13 16:42:13,705 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:13,706 - INFO - integration_test - Dyn residual k=0: pred=[22.561056274251484, 6.377596049811314, 0.44052957777345164, -0.010000009911271417, 24.41051536748399], ws=[22.561056275147983, 6.377596050233949, 0.4405295777734515, 0.17875, 24.411515368475115], res=[-8.96498875135876e-10, -4.226352601222061e-10, 1.6653345369377348e-16, -0.18875000991127142, -0.001000000991126626], res_norm=1.888e-01
2026-01-13 16:42:13,707 - INFO - integration_test - Dyn residual k=1: pred=[22.577224676831115, 6.385218281666605, 0.4405295777734515, 0.17875, 24.429390368475115], ws=[22.577224676831115, 6.385218281666605, 0.4405295777734515, 0.34390624999999997, 24.411515368475115], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:13,707 - INFO - integration_test - Dyn residual k=2: pred=[22.608331890209236, 6.39988308182681, 0.4405295777734515, 0.34390624999999997, 24.445905993475115], ws=[22.608331890209236, 6.39988308182681, 0.4405295777734515, 0.48841796875, 24.209495166454914], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.236410827020201], res_norm=2.771e-01
2026-01-13 16:42:13,721 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:13,791 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:13,806 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:13,817 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:13,832 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:13,844 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:13,858 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:13,870 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:13,884 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:13,896 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:13,911 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:13,922 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:13,937 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:13,948 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:13,963 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:13,975 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:13,990 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:14,002 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:14,017 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:14,027 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:14,040 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:14,050 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:14,197 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:14,197 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:14,197 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:14,197 - ERROR - integration_test -   Current position: (22.562, 6.378)
2026-01-13 16:42:14,197 - ERROR - integration_test -   Position 5 steps ago: (22.566, 6.380)
2026-01-13 16:42:14,197 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:14,197 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:14,828 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.260)
2026-01-13 16:42:14,828 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:14,828 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:14,828 - INFO - integration_test -   Control dict from planner: {'a': -5.49967147827874e-10, 'w': 0.00849429918446112}
2026-01-13 16:42:14,828 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:14,828 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:14,829 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:14,829 - INFO - integration_test - Step 200 completed in 1.255s
2026-01-13 16:42:14,846 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:14,848 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25610565e+01  6.37759567e+00  4.41379008e-01 -1.00000100e-02
  2.42590002e+01]
2026-01-13 16:42:14,849 - DEBUG - integration_test - Step 201: Using propagated spline 24.2590 (close to path, dist=0.505m, drift=0.027m)
2026-01-13 16:42:14,849 - DEBUG - integration_test -   Set spline state to 24.2590
2026-01-13 16:42:14,850 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:14,916 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.561, 6.378), path_start=(0.000, 0.000), dist=23.445m
2026-01-13 16:42:14,916 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.445m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:14,916 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:14,971 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:14,980 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:14,980 - INFO - integration_test - Warmstart k=0: x0=22.561056455464275 , y0=6.377595665695352 , psi0=0.44137900769189775 , v0=-0.010000009966268132 , spline0=24.41051536747849 , a0=0.0 , w0=0.0
2026-01-13 16:42:14,980 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:14,981 - INFO - integration_test - Dyn residual k=0: pred=[22.56015229113382, 6.377168478550429, 0.44137900769189775, -0.010000009966268132, 24.409515366481862], ws=[22.56015229203493, 6.3771684789761744, 0.44137900769189775, 0.17875, 24.41051536747849], res=[-9.011102974909591e-10, -4.2574566094799593e-10, 0.0, -0.18875000996626812, -0.0010000009966262269], res_norm=1.888e-01
2026-01-13 16:42:14,982 - INFO - integration_test - Dyn residual k=1: pred=[22.576314213334413, 6.384804441581463, 0.44137900769189775, 0.17875, 24.42839036747849], ws=[22.576314213334413, 6.384804441581463, 0.44137900769189775, 0.34390624999999997, 24.41051536747849], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:14,983 - INFO - integration_test - Dyn residual k=2: pred=[22.607408958771614, 6.399495659845658, 0.44137900769189775, 0.34390624999999997, 24.44490599247849], ws=[22.607408958771614, 6.399495659845658, 0.44137900769189775, 0.48841796875, 24.208495165458288], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.236410827020201], res_norm=2.771e-01
2026-01-13 16:42:14,997 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:15,068 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:15,083 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:15,094 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:15,109 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:15,120 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:15,136 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:15,147 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:15,162 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:15,174 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:15,189 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:15,201 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:15,216 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:15,227 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:15,243 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:15,255 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:15,271 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:15,283 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:15,300 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:15,310 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:15,324 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:15,334 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:15,477 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:15,477 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:15,477 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:15,477 - ERROR - integration_test -   Current position: (22.561, 6.378)
2026-01-13 16:42:15,477 - ERROR - integration_test -   Position 5 steps ago: (22.566, 6.380)
2026-01-13 16:42:15,477 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:15,477 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:16,107 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.259)
2026-01-13 16:42:16,107 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:16,107 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:16,108 - INFO - integration_test -   Control dict from planner: {'a': -8.796746146602043e-11, 'w': 0.008980597980119954}
2026-01-13 16:42:16,108 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:16,108 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:16,109 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:16,109 - INFO - integration_test - Step 200 completed in 1.261s
2026-01-13 16:42:16,125 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:16,128 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25601525e+01  6.37716807e+00  4.42277067e-01 -1.00000100e-02
  2.42580002e+01]
2026-01-13 16:42:16,128 - DEBUG - integration_test - Step 201: Using propagated spline 24.2580 (close to path, dist=0.506m, drift=0.026m)
2026-01-13 16:42:16,128 - DEBUG - integration_test -   Set spline state to 24.2580
2026-01-13 16:42:16,129 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:16,195 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.560, 6.377), path_start=(0.000, 0.000), dist=23.444m
2026-01-13 16:42:16,195 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.444m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:16,195 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:16,248 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:16,257 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:16,258 - INFO - integration_test - Warmstart k=0: x0=22.560152483074745 , y0=6.377168072610872 , psi0=0.44227706748990975 , v0=-0.010000009975064878 , spline0=24.40951536648098 , a0=0.0 , w0=0.0
2026-01-13 16:42:16,258 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:16,259 - INFO - integration_test - Dyn residual k=0: pred=[22.559248702747652, 6.376740073644312, 0.44227706748990975, -0.010000009975064878, 24.408515365483474], ws=[22.55924870364918, 6.376740074071243, 0.4422770674899099, 0.17875, 24.40951536648098], res=[-9.015259649913787e-10, -4.269313791382956e-10, -1.6653345369377348e-16, -0.18875000997506486, -0.0010000009975072999], res_norm=1.888e-01
2026-01-13 16:42:16,259 - INFO - integration_test - Dyn residual k=1: pred=[22.57540376088116, 6.384390547967113, 0.4422770674899099, 0.17875, 24.42739036648098], ws=[22.57540376088116, 6.384390547967113, 0.4422770674899099, 0.34390624999999997, 24.40951536648098], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:16,260 - INFO - integration_test - Dyn residual k=2: pred=[22.606485300188496, 6.399109685244045, 0.4422770674899099, 0.34390624999999997, 24.44390599148098], ws=[22.606485300188496, 6.399109685244045, 0.4422770674899099, 0.48841796875, 24.20749516446078], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.236410827020201], res_norm=2.771e-01
2026-01-13 16:42:16,274 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:16,343 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:16,359 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:16,371 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:16,387 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:16,399 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:16,413 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:16,426 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:16,441 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:16,453 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:16,468 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:16,481 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:16,497 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:16,509 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:16,525 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:16,536 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:16,552 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:16,564 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:16,579 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:16,589 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:16,603 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:16,613 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:16,792 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:16,792 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:16,792 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:16,792 - ERROR - integration_test -   Current position: (22.560, 6.377)
2026-01-13 16:42:16,793 - ERROR - integration_test -   Position 5 steps ago: (22.565, 6.379)
2026-01-13 16:42:16,793 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:16,793 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:17,446 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.258)
2026-01-13 16:42:17,446 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:17,446 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:17,446 - INFO - integration_test -   Control dict from planner: {'a': -1.3272113521395737e-10, 'w': 0.04356976714390756}
2026-01-13 16:42:17,446 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:17,446 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:17,447 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:17,448 - INFO - integration_test - Step 200 completed in 1.320s
2026-01-13 16:42:17,464 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:17,469 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25592496e+01  6.37673811e+00  4.46634044e-01 -1.00000100e-02
  2.42570002e+01]
2026-01-13 16:42:17,469 - DEBUG - integration_test - Step 201: Using propagated spline 24.2570 (close to path, dist=0.506m, drift=0.025m)
2026-01-13 16:42:17,469 - DEBUG - integration_test -   Set spline state to 24.2570
2026-01-13 16:42:17,470 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:17,537 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.559, 6.377), path_start=(0.000, 0.000), dist=23.443m
2026-01-13 16:42:17,537 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.443m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:17,537 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:17,591 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:17,601 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:17,601 - INFO - integration_test - Warmstart k=0: x0=22.55924963799579 , y0=6.376738106126354 , psi0=0.44663404420430053 , v0=-0.010000009988336993 , spline0=24.40851536548215 , a0=0.0 , w0=0.0
2026-01-13 16:42:17,601 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:17,602 - INFO - integration_test - Dyn residual k=0: pred=[22.558347731021463, 6.376306173484237, 0.44663404420430053, -0.010000009988336993, 24.407515364483316], ws=[22.558347731922318, 6.376306173915666, 0.44663404420430064, 0.17875, 24.40851536548215], res=[-9.008545021060854e-10, -4.3142911465565703e-10, -1.1102230246251565e-16, -0.188750009988337, -0.001000000998832462], res_norm=1.888e-01
2026-01-13 16:42:17,603 - INFO - integration_test - Dyn residual k=1: pred=[22.574469302985673, 6.38402696218172, 0.44663404420430064, 0.17875, 24.42639036548215], ws=[22.574469302985673, 6.38402696218172, 0.44663404420430064, 0.34390624999999997, 24.40851536548215], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:17,603 - INFO - integration_test - Dyn residual k=2: pred=[22.60548641654375, 6.398881380864922, 0.44663404420430064, 0.34390624999999997, 24.44290599048215], ws=[22.60548641654375, 6.398881380864922, 0.44663404420430064, 0.48841796875, 24.206495163461945], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.23641082702020455], res_norm=2.771e-01
2026-01-13 16:42:17,617 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:17,688 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:17,704 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:17,716 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:17,732 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:17,743 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:17,758 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:17,769 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:17,784 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:17,796 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:17,811 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:17,822 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:17,838 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:17,849 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:17,864 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:17,876 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:17,891 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:17,903 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:17,918 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:17,928 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:17,942 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:17,952 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:18,110 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:18,110 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:18,110 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:18,110 - ERROR - integration_test -   Current position: (22.559, 6.377)
2026-01-13 16:42:18,110 - ERROR - integration_test -   Position 5 steps ago: (22.564, 6.379)
2026-01-13 16:42:18,110 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:18,110 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:18,765 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.257)
2026-01-13 16:42:18,766 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:18,766 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:18,766 - INFO - integration_test -   Control dict from planner: {'a': -4.4639279940564086e-11, 'w': 0.01900165628281314}
2026-01-13 16:42:18,766 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:18,766 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:18,767 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:18,768 - INFO - integration_test - Step 200 completed in 1.299s
2026-01-13 16:42:18,784 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:18,788 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25583481e+01  6.37630532e+00  4.48534210e-01 -1.00000100e-02
  2.42560002e+01]
2026-01-13 16:42:18,788 - DEBUG - integration_test - Step 201: Using propagated spline 24.2560 (close to path, dist=0.506m, drift=0.024m)
2026-01-13 16:42:18,788 - DEBUG - integration_test -   Set spline state to 24.2560
2026-01-13 16:42:18,789 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:18,856 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.558, 6.376), path_start=(0.000, 0.000), dist=23.442m
2026-01-13 16:42:18,856 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.442m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:18,856 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:18,908 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:18,918 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:18,918 - INFO - integration_test - Warmstart k=0: x0=22.55834814193566 , y0=6.376305316858007 , psi0=0.44853420983258185 , v0=-0.01000000999280092 , spline0=24.40751536448287 , a0=0.0 , w0=0.0
2026-01-13 16:42:18,918 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:18,919 - INFO - integration_test - Dyn residual k=0: pred=[22.557447057332222, 6.375871671223869, 0.44853420983258185, -0.01000000999280092, 24.40651536348359], ws=[22.557447058232658, 6.375871671657203, 0.44853420983258196, 0.17875, 24.40751536448287], res=[-9.00435281891987e-10, -4.333333691874941e-10, -1.1102230246251565e-16, -0.18875000999280092, -0.001000000999280104], res_norm=1.888e-01
2026-01-13 16:42:18,920 - INFO - integration_test - Dyn residual k=1: pred=[22.573553929423852, 6.383623079621582, 0.44853420983258196, 0.17875, 24.42539036448287], ws=[22.573553929423852, 6.383623079621582, 0.44853420983258196, 0.34390624999999997, 24.40751536448287], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:18,921 - INFO - integration_test - Dyn residual k=2: pred=[22.60454276114747, 6.398536409105497, 0.44853420983258196, 0.34390624999999997, 24.44190598948287], ws=[22.60454276114747, 6.398536409105497, 0.44853420983258196, 0.48841796875, 24.205495162462668], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.236410827020201], res_norm=2.771e-01
2026-01-13 16:42:18,934 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:19,004 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:19,020 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:19,031 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:19,047 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:19,059 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:19,074 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:19,085 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:19,100 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:19,112 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:19,127 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:19,139 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:19,154 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:19,166 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:19,181 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:19,192 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:19,207 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:19,219 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:19,234 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:19,245 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:19,258 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:19,268 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:19,393 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:19,393 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:19,393 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:19,393 - ERROR - integration_test -   Current position: (22.558, 6.376)
2026-01-13 16:42:19,393 - ERROR - integration_test -   Position 5 steps ago: (22.563, 6.378)
2026-01-13 16:42:19,393 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:19,393 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:20,056 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.256)
2026-01-13 16:42:20,056 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:20,056 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:20,056 - INFO - integration_test -   Control dict from planner: {'a': 7.963791551245202e-08, 'w': 0.2180086790965484}
2026-01-13 16:42:20,056 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:20,056 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:20,057 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:20,057 - INFO - integration_test - Step 200 completed in 1.270s
2026-01-13 16:42:20,075 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:20,077 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25574519e+01  6.37586188e+00  4.70335078e-01 -1.00000020e-02
  2.42550002e+01]
2026-01-13 16:42:20,078 - DEBUG - integration_test - Step 201: Using propagated spline 24.2550 (close to path, dist=0.506m, drift=0.023m)
2026-01-13 16:42:20,078 - DEBUG - integration_test -   Set spline state to 24.2550
2026-01-13 16:42:20,078 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:20,146 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.557, 6.376), path_start=(0.000, 0.000), dist=23.441m
2026-01-13 16:42:20,146 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.441m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:20,146 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:20,200 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:20,210 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:20,210 - INFO - integration_test - Warmstart k=0: x0=22.557451855802675 , y0=6.3758618839270556 , psi0=0.4703350777422367 , v0=-0.010000002029009369 , spline0=24.40651536427997 , a0=0.0 , w0=0.0
2026-01-13 16:42:20,210 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:20,211 - INFO - integration_test - Dyn residual k=0: pred=[22.556560439135772, 6.375408698830466, 0.4703350777422367, -0.010000002029009369, 24.40551536407707], ws=[22.55656043931664, 6.375408698922417, 0.4703350777422366, 0.17875, 24.40651536427997], res=[-1.808686533877335e-10, -9.195133543471457e-11, 1.1102230246251565e-16, -0.18875000202900935, -0.001000000202900253], res_norm=1.888e-01
2026-01-13 16:42:20,212 - INFO - integration_test - Dyn residual k=1: pred=[22.57249450900448, 6.383509380880324, 0.4703350777422366, 0.17875, 24.42439036427997], ws=[22.57249450900448, 6.383509380880324, 0.4703350777422366, 0.34390624999999997, 24.40651536427997], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:20,213 - INFO - integration_test - Dyn residual k=2: pred=[22.60315087909445, 6.399094696430458, 0.4703350777422366, 0.34390624999999997, 24.44090598927997], ws=[22.60315087909445, 6.399094696430458, 0.4703350777422366, 0.48841796875, 24.204495162259768], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.236410827020201], res_norm=2.771e-01
2026-01-13 16:42:20,227 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:20,299 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:20,314 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:20,325 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:20,341 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:20,352 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:20,367 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:20,379 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:20,393 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:20,405 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:20,420 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:20,431 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:20,448 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:20,460 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:20,475 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:20,486 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:20,501 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:20,512 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:20,527 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:20,539 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:20,552 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:20,563 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:20,683 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:20,683 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:20,684 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:20,684 - ERROR - integration_test -   Current position: (22.557, 6.376)
2026-01-13 16:42:20,684 - ERROR - integration_test -   Position 5 steps ago: (22.562, 6.378)
2026-01-13 16:42:20,684 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:20,684 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:21,348 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.255)
2026-01-13 16:42:21,348 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:21,348 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:21,348 - INFO - integration_test -   Control dict from planner: {'a': 3.0589633556707485e-08, 'w': 0.18335172985277257}
2026-01-13 16:42:21,348 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:21,349 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:21,350 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:21,350 - INFO - integration_test - Step 200 completed in 1.273s
2026-01-13 16:42:21,369 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:21,372 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25565646e+01  6.37540055e+00  4.88670251e-01 -9.99999897e-03
  2.42540002e+01]
2026-01-13 16:42:21,373 - DEBUG - integration_test - Step 201: Using propagated spline 24.2540 (close to path, dist=0.507m, drift=0.022m)
2026-01-13 16:42:21,373 - DEBUG - integration_test -   Set spline state to 24.2540
2026-01-13 16:42:21,374 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:21,441 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.557, 6.375), path_start=(0.000, 0.000), dist=23.440m
2026-01-13 16:42:21,441 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.440m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:21,441 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:21,495 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:21,505 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:21,505 - INFO - integration_test - Warmstart k=0: x0=22.556564643713426 , y0=6.375400552382392 , psi0=0.48867025072751397 , v0=-0.009999998970046014 , spline0=24.405515364382964 , a0=0.0 , w0=0.0
2026-01-13 16:42:21,505 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:21,506 - INFO - integration_test - Dyn residual k=0: pred=[22.555681685911594, 6.374931100239792, 0.48867025072751397, -0.009999998970046014, 24.40451536448596], ws=[22.555681685911594, 6.374931100239792, 0.4886702507275138, 0.17875000090120974, 24.405515364382964], res=[0.0, 0.0, 1.6653345369377348e-16, -0.18874999987125576, -0.0009999998970044999], res_norm=1.888e-01
2026-01-13 16:42:21,507 - INFO - integration_test - Dyn residual k=1: pred=[22.571464558324486, 6.383322558195367, 0.4886702507275138, 0.17875000090120974, 24.423390364473086], ws=[22.571464558324486, 6.383322558195367, 0.4886702507275138, 0.3439062507885585, 24.405515364382964], res=[0.0, 0.0, 0.0, -0.16515624988734878, 0.017875000090121773], res_norm=1.661e-01
2026-01-13 16:42:21,507 - INFO - integration_test - Dyn residual k=2: pred=[22.60183003217526, 6.399467312486846, 0.4886702507275138, 0.3439062507885585, 24.43990598946182], ws=[22.60183003217526, 6.399467312486846, 0.4886702507275138, 0.4884179694399887, 24.203495162362763], res=[0.0, 0.0, 0.0, -0.1445117186514302, 0.23641082709905703], res_norm=2.771e-01
2026-01-13 16:42:21,521 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:21,591 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:21,606 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:21,617 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:21,632 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:21,644 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:21,658 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:21,670 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:21,684 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:21,695 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:21,710 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:21,723 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:21,738 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:21,749 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:21,764 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:21,777 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:21,791 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:21,802 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:21,817 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:21,828 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:21,843 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:21,853 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:22,018 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:22,018 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:22,018 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:22,019 - ERROR - integration_test -   Current position: (22.557, 6.375)
2026-01-13 16:42:22,019 - ERROR - integration_test -   Position 5 steps ago: (22.561, 6.378)
2026-01-13 16:42:22,019 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:22,019 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:22,688 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.254)
2026-01-13 16:42:22,688 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:22,688 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:22,688 - INFO - integration_test -   Control dict from planner: {'a': -7.351637751965682e-08, 'w': -0.4136722528819935}
2026-01-13 16:42:22,688 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:22,689 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:22,690 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:22,690 - INFO - integration_test - Step 200 completed in 1.318s
2026-01-13 16:42:22,708 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:22,710 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25556722e+01  6.37494949e+00  4.47303025e-01 -1.00000063e-02
  2.42530002e+01]
2026-01-13 16:42:22,711 - DEBUG - integration_test - Step 201: Using propagated spline 24.2530 (close to path, dist=0.507m, drift=0.021m)
2026-01-13 16:42:22,711 - DEBUG - integration_test -   Set spline state to 24.2530
2026-01-13 16:42:22,712 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:22,778 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.556, 6.375), path_start=(0.000, 0.000), dist=23.439m
2026-01-13 16:42:22,778 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.439m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:22,778 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:22,830 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:22,840 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:22,840 - INFO - integration_test - Warmstart k=0: x0=22.55567222880482 , y0=6.374949494108754 , psi0=0.4473030254393146 , v0=-0.010000006321683765 , spline0=24.404515363750797 , a0=0.0 , w0=0.0
2026-01-13 16:42:22,840 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:22,841 - INFO - integration_test - Dyn residual k=0: pred=[22.55477061131771, 6.374516958363089, 0.4473030254393146, -0.010000006321683765, 24.40351536311863], ws=[22.554770611887687, 6.374516958636525, 0.44730302543931444, 0.17875, 24.404515363750797], res=[-5.699760663446796e-10, -2.7343549646730025e-10, 1.6653345369377348e-16, -0.18875000632168376, -0.0010000006321675414], res_norm=1.888e-01
2026-01-13 16:42:22,842 - INFO - integration_test - Dyn residual k=1: pred=[22.570887014281464, 6.382248530202629, 0.44730302543931444, 0.17875, 24.422390363750797], ws=[22.570887014281464, 6.382248530202629, 0.44730302543931444, 0.34390624999999997, 24.404515363750797], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:22,842 - INFO - integration_test - Dyn residual k=2: pred=[22.60189418357229, 6.397123695427276, 0.44730302543931444, 0.34390624999999997, 24.438905988750797], ws=[22.60189418357229, 6.397123695427276, 0.44730302543931444, 0.48841796875, 24.202495161730596], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.236410827020201], res_norm=2.771e-01
2026-01-13 16:42:22,857 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:22,927 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:22,942 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:22,954 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:22,969 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:22,980 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:22,995 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:23,006 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:23,021 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:23,033 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:23,047 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:23,059 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:23,073 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:23,085 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:23,099 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:23,111 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:23,125 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:23,137 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:23,153 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:23,163 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:23,177 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:23,187 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:23,307 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:23,307 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:23,307 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:23,307 - ERROR - integration_test -   Current position: (22.556, 6.375)
2026-01-13 16:42:23,308 - ERROR - integration_test -   Position 5 steps ago: (22.560, 6.377)
2026-01-13 16:42:23,308 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:23,308 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:23,987 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.253)
2026-01-13 16:42:23,987 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:23,988 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:23,988 - INFO - integration_test -   Control dict from planner: {'a': 4.893757739670186e-08, 'w': 0.22255827833123068}
2026-01-13 16:42:23,988 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:23,988 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:23,989 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:23,989 - INFO - integration_test - Step 200 completed in 1.279s
2026-01-13 16:42:24,007 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:24,009 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25547755e+01  6.37450696e+00  4.69558853e-01 -1.00000014e-02
  2.42520002e+01]
2026-01-13 16:42:24,009 - DEBUG - integration_test - Step 201: Using propagated spline 24.2520 (close to path, dist=0.507m, drift=0.020m)
2026-01-13 16:42:24,009 - DEBUG - integration_test -   Set spline state to 24.2520
2026-01-13 16:42:24,010 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:24,076 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.555, 6.375), path_start=(0.000, 0.000), dist=23.438m
2026-01-13 16:42:24,076 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.438m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:24,076 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:24,128 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:24,138 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:24,138 - INFO - integration_test - Warmstart k=0: x0=22.55477549898849 , y0=6.374506961471012 , psi0=0.4695588532724377 , v0=-0.010000001427926026 , spline0=24.403515363608005 , a0=0.0 , w0=0.0
2026-01-13 16:42:24,138 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:24,139 - INFO - integration_test - Dyn residual k=0: pred=[22.553883730870414, 6.3740544684775085, 0.4695588532724377, -0.010000001427926026, 24.402515363465213], ws=[22.553883730997754, 6.374054468542122, 0.46955885327243774, 0.17875, 24.403515363608005], res=[-1.2733991638924635e-10, -6.461320367634471e-11, -5.551115123125783e-17, -0.18875000142792603, -0.0010000001427918903], res_norm=1.888e-01
2026-01-13 16:42:24,140 - INFO - integration_test - Dyn residual k=1: pred=[22.569824083832184, 6.382142779646046, 0.46955885327243774, 0.17875, 24.421390363608005], ws=[22.569824083832184, 6.382142779646046, 0.46955885327243774, 0.34390624999999997, 24.403515363608005], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:24,141 - INFO - integration_test - Dyn residual k=2: pred=[22.600492542388636, 6.397704294278685, 0.46955885327243774, 0.34390624999999997, 24.437905988608005], ws=[22.600492542388636, 6.397704294278685, 0.46955885327243774, 0.48841796875, 24.2014951615878], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.23641082702020455], res_norm=2.771e-01
2026-01-13 16:42:24,154 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:24,224 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:24,239 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:24,251 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:24,266 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:24,277 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:24,292 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:24,303 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:24,318 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:24,329 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:24,344 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:24,356 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:24,371 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:24,383 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:24,397 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:24,409 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:24,423 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:24,435 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:24,450 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:24,460 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:24,473 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:24,483 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:24,603 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:24,603 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:24,603 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:24,603 - ERROR - integration_test -   Current position: (22.555, 6.375)
2026-01-13 16:42:24,603 - ERROR - integration_test -   Position 5 steps ago: (22.559, 6.377)
2026-01-13 16:42:24,603 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:24,603 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:25,293 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.252)
2026-01-13 16:42:25,294 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:25,294 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:25,294 - INFO - integration_test -   Control dict from planner: {'a': 1.9045606492982702e-08, 'w': 0.18893197899724395}
2026-01-13 16:42:25,294 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:25,294 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:25,295 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:25,295 - INFO - integration_test - Step 200 completed in 1.287s
2026-01-13 16:42:25,314 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:25,319 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25538881e+01  6.37404607e+00  4.88452051e-01 -9.99999952e-03
  2.42510002e+01]
2026-01-13 16:42:25,319 - DEBUG - integration_test - Step 201: Using propagated spline 24.2510 (close to path, dist=0.507m, drift=0.019m)
2026-01-13 16:42:25,319 - DEBUG - integration_test -   Set spline state to 24.2510
2026-01-13 16:42:25,320 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:25,386 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.554, 6.374), path_start=(0.000, 0.000), dist=23.437m
2026-01-13 16:42:25,387 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.437m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:25,387 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:25,439 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:25,449 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:25,449 - INFO - integration_test - Warmstart k=0: x0=22.553888058399696 , y0=6.374046071515762 , psi0=0.48845205117216206 , v0=-0.009999999523365376 , spline0=24.402515363655667 , a0=0.0 , w0=0.0
2026-01-13 16:42:25,449 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:25,450 - INFO - integration_test - Dyn residual k=0: pred=[22.553004998135773, 6.37357681201937, 0.48845205117216206, -0.009999999523365376, 24.40151536370333], ws=[22.553004998135773, 6.37357681201937, 0.48845205117216217, 0.17875000041705527, 24.402515363655667], res=[0.0, 0.0, -1.1102230246251565e-16, -0.18874999994042066, -0.0009999999523380154], res_norm=1.888e-01
2026-01-13 16:42:25,451 - INFO - integration_test - Dyn residual k=1: pred=[22.56878970114257, 6.3819648259367465, 0.48845205117216217, 0.17875000041705527, 24.420390363697372], ws=[22.56878970114257, 6.3819648259367465, 0.48845205117216217, 0.3439062503649234, 24.402515363655667], res=[0.0, 0.0, 0.0, -0.16515624994786812, 0.01787500004170539], res_norm=1.661e-01
2026-01-13 16:42:25,452 - INFO - integration_test - Dyn residual k=2: pred=[22.59915869701125, 6.398102954091171, 0.48845205117216217, 0.3439062503649234, 24.43690598869216], ws=[22.59915869701125, 6.398102954091171, 0.48845205117216217, 0.48841796906930796, 24.200495161635466], res=[0.0, 0.0, 0.0, -0.14451171870438456, 0.23641082705669447], res_norm=2.771e-01
2026-01-13 16:42:25,467 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:25,538 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:25,554 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:25,565 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:25,580 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:25,591 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:25,606 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:25,617 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:25,632 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:25,644 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:25,658 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:25,670 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:25,685 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:25,696 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:25,711 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:25,722 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:25,737 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:25,749 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:25,764 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:25,774 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:25,786 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:25,796 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:25,918 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:25,918 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:25,918 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:25,918 - ERROR - integration_test -   Current position: (22.554, 6.374)
2026-01-13 16:42:25,918 - ERROR - integration_test -   Position 5 steps ago: (22.558, 6.376)
2026-01-13 16:42:25,918 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:25,918 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:26,610 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.251)
2026-01-13 16:42:26,610 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:26,610 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:26,610 - INFO - integration_test -   Control dict from planner: {'a': -1.8457150694249915e-08, 'w': 0.1705952783365532}
2026-01-13 16:42:26,610 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:26,610 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:26,611 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:26,612 - INFO - integration_test - Step 200 completed in 1.293s
2026-01-13 16:42:26,629 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:26,632 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25530090e+01  6.37356930e+00  5.05511579e-01 -1.00000014e-02
  2.42500002e+01]
2026-01-13 16:42:26,633 - DEBUG - integration_test - Step 201: Using propagated spline 24.2500 (close to path, dist=0.508m, drift=0.018m)
2026-01-13 16:42:26,633 - DEBUG - integration_test -   Set spline state to 24.2500
2026-01-13 16:42:26,634 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:26,700 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.553, 6.374), path_start=(0.000, 0.000), dist=23.436m
2026-01-13 16:42:26,700 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.436m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:26,700 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:26,752 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:26,762 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:26,762 - INFO - integration_test - Warmstart k=0: x0=22.553009043462243 , y0=6.373569302623129 , psi0=0.5055115790058173 , v0=-0.010000001369080445 , spline0=24.401515363518758 , a0=0.0 , w0=0.0
2026-01-13 16:42:26,762 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:26,763 - INFO - integration_test - Dyn residual k=0: pred=[22.552134116488272, 6.373085047458948, 0.5055115790058173, -0.010000001369080445, 24.40051536338185], ws=[22.55213411660806, 6.3730850475252465, 0.5055115790058173, 0.17875, 24.401515363518758], res=[-1.197868471081165e-10, -6.629807813851585e-11, 0.0, -0.18875000136908043, -0.0010000001369085965], res_norm=1.888e-01
2026-01-13 16:42:26,764 - INFO - integration_test - Dyn residual k=1: pred=[22.56777343412662, 6.381741107399898, 0.5055115790058173, 0.17875, 24.419390363518758], ws=[22.56777343412662, 6.381741107399898, 0.5055115790058173, 0.34390624999999997, 24.401515363518758], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:26,765 - INFO - integration_test - Dyn residual k=2: pred=[22.59786271547134, 6.398394942875517, 0.5055115790058173, 0.34390624999999997, 24.43590598851876], ws=[22.59786271547134, 6.398394942875517, 0.5055115790058173, 0.48841796875, 24.199495161498554], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.23641082702020455], res_norm=2.771e-01
2026-01-13 16:42:26,778 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:26,848 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:26,863 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:26,875 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:26,890 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:26,901 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:26,915 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:26,927 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:26,941 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:26,953 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:26,968 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:26,979 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:26,994 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:27,005 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:27,020 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:27,032 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:27,047 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:27,058 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:27,073 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:27,083 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:27,096 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:27,106 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:27,268 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:27,268 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:27,269 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:27,269 - ERROR - integration_test -   Current position: (22.553, 6.374)
2026-01-13 16:42:27,269 - ERROR - integration_test -   Position 5 steps ago: (22.557, 6.376)
2026-01-13 16:42:27,269 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:27,269 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:27,959 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.250)
2026-01-13 16:42:27,959 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:27,960 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:27,960 - INFO - integration_test -   Control dict from planner: {'a': -5.748317902358219e-08, 'w': -0.5669724384251374}
2026-01-13 16:42:27,960 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:27,960 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:27,961 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:27,961 - INFO - integration_test - Step 200 completed in 1.330s
2026-01-13 16:42:27,978 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:27,981 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25521209e+01  6.37311010e+00  4.48814335e-01 -1.00000071e-02
  2.42490002e+01]
2026-01-13 16:42:27,981 - DEBUG - integration_test - Step 201: Using propagated spline 24.2490 (close to path, dist=0.508m, drift=0.017m)
2026-01-13 16:42:27,981 - DEBUG - integration_test -   Set spline state to 24.2490
2026-01-13 16:42:27,983 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:28,049 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.552, 6.373), path_start=(0.000, 0.000), dist=23.435m
2026-01-13 16:42:28,049 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.435m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:28,049 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:28,101 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:28,111 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:28,111 - INFO - integration_test - Warmstart k=0: x0=22.55212086061716 , y0=6.373110103062439 , psi0=0.4488143351633036 , v0=-0.010000007117398346 , spline0=24.400515362807017 , a0=0.0 , w0=0.0
2026-01-13 16:42:28,111 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:28,112 - INFO - integration_test - Dyn residual k=0: pred=[22.551219897783263, 6.37267620515346, 0.4488143351633036, -0.010000007117398346, 24.399515362095276], ws=[22.551219898424513, 6.372676205462282, 0.4488143351633038, 0.17875, 24.400515362807017], res=[-6.412506081687752e-10, -3.0882230106499264e-10, -2.220446049250313e-16, -0.18875000711739834, -0.0010000007117412224], res_norm=1.888e-01
2026-01-13 16:42:28,113 - INFO - integration_test - Dyn residual k=1: pred=[22.56732459761806, 6.380432125065094, 0.4488143351633038, 0.17875, 24.418390362807017], ws=[22.56732459761806, 6.380432125065094, 0.4488143351633038, 0.34390624999999997, 24.400515362807017], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:28,113 - INFO - integration_test - Dyn residual k=2: pred=[22.598309250524533, 6.395354134720505, 0.4488143351633038, 0.34390624999999997, 24.434905987807017], ws=[22.598309250524533, 6.395354134720505, 0.4488143351633038, 0.48841796875, 24.198495160786813], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.23641082702020455], res_norm=2.771e-01
2026-01-13 16:42:28,129 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:28,199 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:28,214 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:28,225 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:28,241 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:28,252 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:28,267 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:28,278 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:28,293 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:28,304 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:28,319 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:28,330 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:28,345 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:28,357 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:28,371 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:28,383 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:28,397 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:28,409 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:28,424 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:28,434 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:28,447 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:28,457 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:28,576 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:28,576 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:28,576 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:28,576 - ERROR - integration_test -   Current position: (22.552, 6.373)
2026-01-13 16:42:28,577 - ERROR - integration_test -   Position 5 steps ago: (22.557, 6.375)
2026-01-13 16:42:28,577 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:28,577 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:29,278 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.249)
2026-01-13 16:42:29,279 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:29,279 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:29,279 - INFO - integration_test -   Control dict from planner: {'a': 1.8337103884772835e-08, 'w': 0.22484957135692415}
2026-01-13 16:42:29,279 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:29,279 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:29,280 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:29,280 - INFO - integration_test - Step 200 completed in 1.300s
2026-01-13 16:42:29,297 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:29,302 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25512249e+01  6.37266611e+00  4.71299292e-01 -1.00000053e-02
  2.42480002e+01]
2026-01-13 16:42:29,303 - DEBUG - integration_test - Step 201: Using propagated spline 24.2480 (close to path, dist=0.508m, drift=0.016m)
2026-01-13 16:42:29,303 - DEBUG - integration_test -   Set spline state to 24.2480
2026-01-13 16:42:29,303 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:29,370 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.551, 6.373), path_start=(0.000, 0.000), dist=23.434m
2026-01-13 16:42:29,370 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.434m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:29,370 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:29,424 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:29,434 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:29,434 - INFO - integration_test - Warmstart k=0: x0=22.551224851662813 , y0=6.372666113126101 , psi0=0.47129929229899603 , v0=-0.010000005283687958 , spline0=24.39951536227865 , a0=0.0 , w0=0.0
2026-01-13 16:42:29,434 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:29,435 - INFO - integration_test - Dyn residual k=0: pred=[22.550333872087904, 6.372212068575607, 0.47129929229899603, -0.010000005283687958, 24.39851536175028], ws=[22.55033387255867, 6.372212068815509, 0.4712992922989958, 0.17875, 24.39951536227865], res=[-4.707665368641756e-10, -2.3990232023152203e-10, 2.220446049250313e-16, -0.18875000528368796, -0.0010000005283679059], res_norm=1.888e-01
2026-01-13 16:42:29,436 - INFO - integration_test - Dyn residual k=1: pred=[22.566260124045225, 6.380328110867336, 0.4712992922989958, 0.17875, 24.41739036227865], ws=[22.566260124045225, 6.380328110867336, 0.4712992922989958, 0.34390624999999997, 24.39951536227865], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:29,437 - INFO - integration_test - Dyn residual k=2: pred=[22.59690145229864, 6.395942978486279, 0.4712992922989958, 0.34390624999999997, 24.43390598727865], ws=[22.59690145229864, 6.395942978486279, 0.4712992922989958, 0.48841796875, 24.19749516025845], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.236410827020201], res_norm=2.771e-01
2026-01-13 16:42:29,451 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:29,520 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:29,537 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:29,549 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:29,564 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:29,575 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:29,590 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:29,601 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:29,616 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:29,627 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:29,642 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:29,654 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:29,669 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:29,680 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:29,695 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:29,706 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:29,721 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:29,732 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:29,748 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:29,758 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:29,771 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:29,781 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:29,901 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:29,901 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:29,901 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:29,901 - ERROR - integration_test -   Current position: (22.551, 6.373)
2026-01-13 16:42:29,901 - ERROR - integration_test -   Position 5 steps ago: (22.556, 6.375)
2026-01-13 16:42:29,901 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:29,901 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:30,609 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.248)
2026-01-13 16:42:30,609 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:30,609 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:30,609 - INFO - integration_test -   Control dict from planner: {'a': -5.775679343830564e-09, 'w': 0.1990669024511576}
2026-01-13 16:42:30,609 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:30,609 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:30,610 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:30,611 - INFO - integration_test - Step 200 completed in 1.309s
2026-01-13 16:42:30,629 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:30,632 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25503385e+01  6.37220323e+00  4.91205983e-01 -1.00000059e-02
  2.42470002e+01]
2026-01-13 16:42:30,633 - DEBUG - integration_test - Step 201: Using propagated spline 24.2470 (close to path, dist=0.509m, drift=0.015m)
2026-01-13 16:42:30,633 - DEBUG - integration_test -   Set spline state to 24.2470
2026-01-13 16:42:30,634 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:30,700 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.550, 6.372), path_start=(0.000, 0.000), dist=23.433m
2026-01-13 16:42:30,700 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.433m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:30,700 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:30,753 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:30,763 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:30,763 - INFO - integration_test - Warmstart k=0: x0=22.550338450019694 , y0=6.372203230615031 , psi0=0.4912059825441118 , v0=-0.010000005861255892 , spline0=24.398515361692525 , a0=0.0 , w0=0.0
2026-01-13 16:42:30,763 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:30,764 - INFO - integration_test - Dyn residual k=0: pred=[22.54945668485236, 6.37173154071486, 0.4912059825441118, -0.010000005861255892, 24.3975153611064], ws=[22.549456685369183, 6.3717315409913295, 0.49120598254411174, 0.17875, 24.398515361692525], res=[-5.168239169961453e-10, -2.764695139489959e-10, 5.551115123125783e-17, -0.1887500058612559, -0.0010000005861243721], res_norm=1.888e-01
2026-01-13 16:42:30,765 - INFO - integration_test - Dyn residual k=1: pred=[22.565218228497088, 6.380162993014987, 0.49120598254411174, 0.17875, 24.416390361692525], ws=[22.565218228497088, 6.380162993014987, 0.49120598254411174, 0.34390624999999997, 24.398515361692525], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:30,766 - INFO - integration_test - Dyn residual k=2: pred=[22.595542665931106, 6.396384693980084, 0.49120598254411174, 0.34390624999999997, 24.432905986692525], ws=[22.595542665931106, 6.396384693980084, 0.49120598254411174, 0.48841796875, 24.196495159672324], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.236410827020201], res_norm=2.771e-01
2026-01-13 16:42:30,780 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:30,850 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:30,865 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:30,876 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:30,891 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:30,903 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:30,917 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:30,928 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:30,943 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:30,955 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:30,969 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:30,981 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:30,996 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:31,007 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:31,022 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:31,034 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:31,049 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:31,060 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:31,075 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:31,085 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:31,097 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:31,107 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:31,232 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:31,232 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:31,233 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:31,233 - ERROR - integration_test -   Current position: (22.550, 6.372)
2026-01-13 16:42:31,233 - ERROR - integration_test -   Position 5 steps ago: (22.555, 6.375)
2026-01-13 16:42:31,233 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:31,233 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:31,953 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.247)
2026-01-13 16:42:31,953 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:31,953 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:31,953 - INFO - integration_test -   Control dict from planner: {'a': -3.021820800355894e-09, 'w': 0.17493969920735633}
2026-01-13 16:42:31,953 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:31,953 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:31,954 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:31,954 - INFO - integration_test - Step 200 completed in 1.323s
2026-01-13 16:42:31,973 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:31,975 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25494609e+01  6.37172385e+00  5.08699952e-01 -1.00000062e-02
  2.42460002e+01]
2026-01-13 16:42:31,976 - DEBUG - integration_test - Step 201: Using propagated spline 24.2460 (close to path, dist=0.509m, drift=0.014m)
2026-01-13 16:42:31,976 - DEBUG - integration_test -   Set spline state to 24.2460
2026-01-13 16:42:31,977 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:32,042 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.549, 6.372), path_start=(0.000, 0.000), dist=23.432m
2026-01-13 16:42:32,042 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.432m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:32,042 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:32,096 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:32,106 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:32,106 - INFO - integration_test - Warmstart k=0: x0=22.549460855573397 , y0=6.371723852176486 , psi0=0.5086999524648474 , v0=-0.010000006163437972 , spline0=24.39751536107618 , a0=0.0 , w0=0.0
2026-01-13 16:42:32,106 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:32,107 - INFO - integration_test - Dyn residual k=0: pred=[22.548587476611527, 6.371236809650984, 0.5086999524648474, -0.010000006163437972, 24.396515360459837], ws=[22.548587477149827, 6.37123680995117, 0.5086999524648474, 0.17875, 24.39751536107618], res=[-5.383000711844943e-10, -3.0018565411182863e-10, 0.0, -0.18875000616343796, -0.0010000006163437547], res_norm=1.888e-01
2026-01-13 16:42:32,108 - INFO - integration_test - Dyn residual k=1: pred=[22.56419911647115, 6.379942689728705, 0.5086999524648474, 0.17875, 24.41539036107618], ws=[22.56419911647115, 6.379942689728705, 0.5086999524648474, 0.34390624999999997, 24.39751536107618], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:32,109 - INFO - integration_test - Dyn residual k=2: pred=[22.594235146319257, 6.396692376258735, 0.5086999524648474, 0.34390624999999997, 24.43190598607618], ws=[22.594235146319257, 6.396692376258735, 0.5086999524648474, 0.48841796875, 24.19549515905598], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.236410827020201], res_norm=2.771e-01
2026-01-13 16:42:32,122 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:32,193 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:32,208 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:32,220 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:32,235 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:32,247 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:32,262 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:32,273 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:32,288 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:32,299 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:32,314 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:32,326 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:32,341 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:32,352 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:32,367 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:32,379 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:32,394 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:32,405 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:32,420 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:32,431 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:32,444 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:32,454 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:32,576 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:32,576 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:32,576 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:32,576 - ERROR - integration_test -   Current position: (22.549, 6.372)
2026-01-13 16:42:32,576 - ERROR - integration_test -   Position 5 steps ago: (22.554, 6.374)
2026-01-13 16:42:32,576 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:32,576 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:33,299 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.246)
2026-01-13 16:42:33,299 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:33,299 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:33,299 - INFO - integration_test -   Control dict from planner: {'a': -7.59061043511338e-10, 'w': 0.15171216619721142}
2026-01-13 16:42:33,299 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:33,299 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:33,301 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:33,301 - INFO - integration_test - Step 200 completed in 1.326s
2026-01-13 16:42:33,319 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:33,322 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25485912e+01  6.37123020e+00  5.23871169e-01 -1.00000062e-02
  2.42450002e+01]
2026-01-13 16:42:33,323 - DEBUG - integration_test - Step 201: Using propagated spline 24.2450 (close to path, dist=0.509m, drift=0.013m)
2026-01-13 16:42:33,323 - DEBUG - integration_test -   Set spline state to 24.2450
2026-01-13 16:42:33,323 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:33,390 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.549, 6.371), path_start=(0.000, 0.000), dist=23.431m
2026-01-13 16:42:33,390 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.431m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:33,390 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:33,442 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:33,452 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:33,452 - INFO - integration_test - Warmstart k=0: x0=22.54859120455446 , y0=6.371230203348662 , psi0=0.5238711690845685 , v0=-0.010000006239344076 , spline0=24.396515360452245 , a0=0.0 , w0=0.0
2026-01-13 16:42:33,452 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:33,453 - INFO - integration_test - Dyn residual k=0: pred=[22.547725314839287, 6.370729967155421, 0.5238711690845685, -0.010000006239344076, 24.39551535982831], ws=[22.547725315379544, 6.370729967467535, 0.5238711690845683, 0.17875, 24.396515360452245], res=[-5.402576164215134e-10, -3.121138902884013e-10, 2.220446049250313e-16, -0.18875000623934407, -0.0010000006239359038], res_norm=1.888e-01
2026-01-13 16:42:33,454 - INFO - integration_test - Dyn residual k=1: pred=[22.563203084381136, 6.379671683842671, 0.5238711690845683, 0.17875, 24.414390360452245], ws=[22.563203084381136, 6.379671683842671, 0.5238711690845683, 0.34390624999999997, 24.396515360452245], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:33,454 - INFO - integration_test - Dyn residual k=2: pred=[22.59298155428717, 6.396875108442035, 0.5238711690845683, 0.34390624999999997, 24.430905985452245], ws=[22.59298155428717, 6.396875108442035, 0.5238711690845683, 0.48841796875, 24.19449515843204], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.23641082702020455], res_norm=2.771e-01
2026-01-13 16:42:33,469 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:33,538 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:33,553 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:33,565 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:33,580 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:33,591 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:33,606 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:33,617 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:33,632 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:33,644 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:33,659 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:33,670 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:33,685 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:33,696 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:33,711 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:33,722 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:33,737 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:33,749 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:33,764 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:33,774 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:33,787 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:33,797 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:33,979 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:33,979 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:33,979 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:33,979 - ERROR - integration_test -   Current position: (22.549, 6.371)
2026-01-13 16:42:33,979 - ERROR - integration_test -   Position 5 steps ago: (22.553, 6.374)
2026-01-13 16:42:33,979 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:33,979 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:34,723 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.245)
2026-01-13 16:42:34,723 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:34,723 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:34,723 - INFO - integration_test -   Control dict from planner: {'a': -2.5075660704755228e-08, 'w': -0.7119054759944212}
2026-01-13 16:42:34,723 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:34,724 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:34,725 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:34,725 - INFO - integration_test - Step 200 completed in 1.403s
2026-01-13 16:42:34,746 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:34,750 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25477082e+01  6.37076120e+00  4.52680621e-01 -1.00000087e-02
  2.42440002e+01]
2026-01-13 16:42:34,751 - DEBUG - integration_test - Step 201: Using propagated spline 24.2440 (close to path, dist=0.509m, drift=0.012m)
2026-01-13 16:42:34,751 - DEBUG - integration_test -   Set spline state to 24.2440
2026-01-13 16:42:34,752 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:34,820 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.548, 6.371), path_start=(0.000, 0.000), dist=23.430m
2026-01-13 16:42:34,820 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.430m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:34,820 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:34,875 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:34,885 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:34,885 - INFO - integration_test - Warmstart k=0: x0=22.547708247411137 , y0=6.3707611980938355 , psi0=0.45268062148512644 , v0=-0.010000008746910146 , spline0=24.395515359577555 , a0=0.0 , w0=0.0
2026-01-13 16:42:34,885 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:34,886 - INFO - integration_test - Dyn residual k=0: pred=[22.546808968733938, 6.370323819984968, 0.45268062148512644, -0.010000008746910146, 24.394515358702865], ws=[22.546808969520526, 6.370323820367538, 0.45268062148512644, 0.17875, 24.395515359577555], res=[-7.865885720548249e-10, -3.8257041978795314e-10, 0.0, -0.18875000874691014, -0.001000000874689988], res_norm=1.888e-01
2026-01-13 16:42:34,887 - INFO - integration_test - Dyn residual k=1: pred=[22.56288356181517, 6.378141947225104, 0.45268062148512644, 0.17875, 24.413390359577555], ws=[22.56288356181517, 6.378141947225104, 0.45268062148512644, 0.34390624999999997, 24.395515359577555], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:34,888 - INFO - integration_test - Dyn residual k=2: pred=[22.59381029052191, 6.39318364059355, 0.45268062148512644, 0.34390624999999997, 24.429905984577555], ws=[22.59381029052191, 6.39318364059355, 0.45268062148512644, 0.48841796875, 24.19349515755735], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.23641082702020455], res_norm=2.771e-01
2026-01-13 16:42:34,902 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:34,975 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:34,990 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:35,002 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:35,018 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:35,029 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:35,045 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:35,056 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:35,071 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:35,083 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:35,098 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:35,110 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:35,124 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:35,136 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:35,151 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:35,162 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:35,178 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:35,189 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:35,204 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:35,214 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:35,227 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:35,238 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:35,364 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:35,364 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:35,364 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:35,364 - ERROR - integration_test -   Current position: (22.548, 6.371)
2026-01-13 16:42:35,364 - ERROR - integration_test -   Position 5 steps ago: (22.552, 6.373)
2026-01-13 16:42:35,364 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:35,364 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:36,100 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.244)
2026-01-13 16:42:36,100 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:36,100 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:36,100 - INFO - integration_test -   Control dict from planner: {'a': 1.922960300844776e-08, 'w': 0.22346487766501788}
2026-01-13 16:42:36,100 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:36,100 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:36,101 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:36,102 - INFO - integration_test - Step 200 completed in 1.351s
2026-01-13 16:42:36,120 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:36,123 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25468139e+01  6.37031381e+00  4.75027109e-01 -1.00000068e-02
  2.42430002e+01]
2026-01-13 16:42:36,123 - DEBUG - integration_test - Step 201: Using propagated spline 24.2430 (close to path, dist=0.510m, drift=0.011m)
2026-01-13 16:42:36,123 - DEBUG - integration_test -   Set spline state to 24.2430
2026-01-13 16:42:36,124 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:36,190 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.547, 6.370), path_start=(0.000, 0.000), dist=23.429m
2026-01-13 16:42:36,190 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.429m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:36,190 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:36,242 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:36,252 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:36,252 - INFO - integration_test - Warmstart k=0: x0=22.54681393039153 , y0=6.370313808987423 , psi0=0.4750271092516282 , v0=-0.010000006823949845 , spline0=24.39451535889516 , a0=0.0 , w0=0.0
2026-01-13 16:42:36,252 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:36,253 - INFO - integration_test - Dyn residual k=0: pred=[22.545924649461497, 6.3698564461202505, 0.4750271092516282, -0.010000006823949845, 24.393515358212763], ws=[22.545924650068336, 6.369856446432352, 0.47502710925162805, 0.17875, 24.4248485720691], res=[-6.068390234759136e-10, -3.121014557905255e-10, 1.6653345369377348e-16, -0.18875000682394982, -0.03133321385633536], res_norm=1.913e-01
2026-01-13 16:42:36,254 - INFO - integration_test - Dyn residual k=1: pred=[22.561820535845417, 6.378031802104247, 0.47502710925162805, 0.17875, 24.4427235720691], ws=[22.561820535845417, 6.378031802104247, 0.47502710925162805, 0.34390624999999997, 24.4248485720691], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:36,255 - INFO - integration_test - Dyn residual k=2: pred=[22.59240344196024, 6.393760786224738, 0.47502710925162805, 0.34390624999999997, 24.4592391970691], ws=[22.59240344196024, 6.393760786224738, 0.47502710925162805, 0.48841796875, 24.425479831744493], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.033759365324605994], res_norm=1.484e-01
2026-01-13 16:42:36,269 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:36,339 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:36,354 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:36,365 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:36,380 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:36,392 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:36,407 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:36,420 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:36,434 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:36,446 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:36,460 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:36,472 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:36,486 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:36,498 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:36,513 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:36,524 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:36,540 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:36,551 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:36,566 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:36,576 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:36,589 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:36,599 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:36,723 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:36,723 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:36,723 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:36,723 - ERROR - integration_test -   Current position: (22.547, 6.370)
2026-01-13 16:42:36,723 - ERROR - integration_test -   Position 5 steps ago: (22.551, 6.373)
2026-01-13 16:42:36,723 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:36,723 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:37,475 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.243)
2026-01-13 16:42:37,475 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:37,475 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:37,475 - INFO - integration_test -   Control dict from planner: {'a': -9.653965917170101e-10, 'w': 0.19999218863800725}
2026-01-13 16:42:37,475 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:37,475 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:37,476 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:37,476 - INFO - integration_test - Step 200 completed in 1.354s
2026-01-13 16:42:37,495 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:37,497 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25459293e+01  6.36984758e+00  4.95026328e-01 -1.00000069e-02
  2.42420002e+01]
2026-01-13 16:42:37,498 - DEBUG - integration_test - Step 201: Using propagated spline 24.2420 (close to path, dist=0.510m, drift=0.010m)
2026-01-13 16:42:37,498 - DEBUG - integration_test -   Set spline state to 24.2420
2026-01-13 16:42:37,499 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:37,565 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.546, 6.370), path_start=(0.000, 0.000), dist=23.428m
2026-01-13 16:42:37,565 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.428m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:37,565 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:37,618 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:37,628 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:37,628 - INFO - integration_test - Warmstart k=0: x0=22.54592928203437 , y0=6.3698475844402385 , psi0=0.49502632811542896 , v0=-0.010000006920489505 , spline0=24.39351535820311 , a0=0.0 , w0=0.0
2026-01-13 16:42:37,628 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:37,629 - INFO - integration_test - Dyn residual k=0: pred=[22.545049325222553, 6.369372529292453, 0.49502632811542896, -0.010000006920489505, 24.392515357511062], ws=[22.545049325831524, 6.369372529621215, 0.4950263281154288, 0.17875, 24.42371132855346], res=[-6.089706516831939e-10, -3.2876190658726046e-10, 1.6653345369377348e-16, -0.1887500069204895, -0.03119597104239702], res_norm=1.913e-01
2026-01-13 16:42:37,630 - INFO - integration_test - Dyn residual k=1: pred=[22.560778542957344, 6.37786413451127, 0.4950263281154288, 0.17875, 24.44158632855346], ws=[22.560778542957344, 6.37786413451127, 0.4950263281154288, 0.34390624999999997, 24.42371132855346], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:37,631 - INFO - integration_test - Dyn residual k=2: pred=[22.591040786745744, 6.39420156664677, 0.4950263281154288, 0.34390624999999997, 24.45810195355346], ws=[22.591040786745744, 6.39420156664677, 0.4950263281154288, 0.48841796875, 24.424223964662144], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.03387798889131588], res_norm=1.484e-01
2026-01-13 16:42:37,645 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:37,713 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:37,729 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:37,740 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:37,756 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:37,767 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:37,782 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:37,793 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:37,808 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:37,819 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:37,834 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:37,845 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:37,860 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:37,872 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:37,887 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:37,898 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:37,912 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:37,924 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:37,939 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:37,949 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:37,962 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:37,972 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:38,135 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:38,135 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:38,135 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:38,135 - ERROR - integration_test -   Current position: (22.546, 6.370)
2026-01-13 16:42:38,135 - ERROR - integration_test -   Position 5 steps ago: (22.550, 6.372)
2026-01-13 16:42:38,135 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:38,135 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:38,885 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.242)
2026-01-13 16:42:38,886 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:38,886 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:38,886 - INFO - integration_test -   Control dict from planner: {'a': -2.0485932921311735e-08, 'w': -0.29101960905462837}
2026-01-13 16:42:38,886 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:38,886 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:38,887 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:38,887 - INFO - integration_test - Step 200 completed in 1.390s
2026-01-13 16:42:38,905 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:38,908 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25450425e+01  6.36938540e+00  4.65924367e-01 -1.00000090e-02
  2.42410002e+01]
2026-01-13 16:42:38,908 - DEBUG - integration_test - Step 201: Using propagated spline 24.2410 (close to path, dist=0.510m, drift=0.009m)
2026-01-13 16:42:38,908 - DEBUG - integration_test -   Set spline state to 24.2410
2026-01-13 16:42:38,909 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:38,975 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.545, 6.369), path_start=(0.000, 0.000), dist=23.428m
2026-01-13 16:42:38,975 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.428m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:38,975 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:39,027 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:39,037 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:39,037 - INFO - integration_test - Warmstart k=0: x0=22.54504253730514 , y0=6.369385399629251 , psi0=0.4659243672099661 , v0=-0.010000008969082796 , spline0=24.392515357306202 , a0=0.0 , w0=0.0
2026-01-13 16:42:39,037 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:39,038 - INFO - integration_test - Dyn residual k=0: pred=[22.544149129827368, 6.36893615039722, 0.4659243672099661, -0.010000008969082796, 24.391515356409293], ws=[22.54414913062867, 6.368936150800154, 0.4659243672099662, 0.17875, 24.42257401805703], res=[-8.013039121124166e-10, -4.029345745948376e-10, -1.1102230246251565e-16, -0.18875000896908278, -0.031058661647737296], res_norm=1.913e-01
2026-01-13 16:42:39,039 - INFO - integration_test - Dyn residual k=1: pred=[22.560118774970515, 6.376966473620251, 0.4659243672099662, 0.17875, 24.44044901805703], ws=[22.560118774970515, 6.376966473620251, 0.4659243672099662, 0.34390624999999997, 24.42257401805703], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:39,040 - INFO - integration_test - Dyn residual k=2: pred=[22.590843588953383, 6.392416421633391, 0.4659243672099662, 0.34390624999999997, 24.45696464305703], ws=[22.590843588953383, 6.392416421633391, 0.4659243672099662, 0.48841796875, 24.42297736328549], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.03398727977154081], res_norm=1.485e-01
2026-01-13 16:42:39,054 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:39,124 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:39,139 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:39,151 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:39,166 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:39,177 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:39,192 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:39,203 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:39,218 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:39,230 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:39,244 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:39,256 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:39,270 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:39,282 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:39,296 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:39,308 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:39,322 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:39,334 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:39,349 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:39,359 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:39,372 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:39,381 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:39,537 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:39,537 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:39,537 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:39,537 - ERROR - integration_test -   Current position: (22.545, 6.369)
2026-01-13 16:42:39,537 - ERROR - integration_test -   Position 5 steps ago: (22.549, 6.372)
2026-01-13 16:42:39,537 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:39,537 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:41,047 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.241)
2026-01-13 16:42:41,047 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:41,047 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:41,047 - INFO - integration_test -   Control dict from planner: {'a': -6.754364707128447e-09, 'w': 0.07508541329867625}
2026-01-13 16:42:41,047 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:41,047 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:41,049 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:41,049 - INFO - integration_test - Step 200 completed in 2.141s
2026-01-13 16:42:41,067 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:41,071 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25441508e+01  6.36893280e+00  4.73432909e-01 -1.00000096e-02
  2.42400002e+01]
2026-01-13 16:42:41,071 - DEBUG - integration_test - Step 201: Using propagated spline 24.2400 (close to path, dist=0.510m, drift=0.008m)
2026-01-13 16:42:41,071 - DEBUG - integration_test -   Set spline state to 24.2400
2026-01-13 16:42:41,072 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:41,140 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.544, 6.369), path_start=(0.000, 0.000), dist=23.427m
2026-01-13 16:42:41,140 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.427m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:41,140 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:41,193 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:41,203 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:41,203 - INFO - integration_test - Warmstart k=0: x0=22.54415082478732 , y0=6.368932800525467 , psi0=0.4734329085398337 , v0=-0.010000009644519267 , spline0=24.39151535634175 , a0=0.0 , w0=0.0
2026-01-13 16:42:41,203 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:41,204 - INFO - integration_test - Dyn residual k=0: pred=[22.543260815608395, 6.368476855802571, 0.4734329085398337, -0.010000009644519267, 24.390515355377296], ws=[22.543260816466766, 6.3684768562423075, 0.4734329085398339, 0.17875, 24.421436539688145], res=[-8.58371151934989e-10, -4.397362474151123e-10, -1.6653345369377348e-16, -0.18875000964451927, -0.03092118431084856], res_norm=1.913e-01
2026-01-13 16:42:41,205 - INFO - integration_test - Dyn residual k=1: pred=[22.559169715196656, 6.376626860303784, 0.4734329085398339, 0.17875, 24.439311539688145], ws=[22.559169715196656, 6.376626860303784, 0.4734329085398339, 0.34390624999999997, 24.421436539688145], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:41,206 - INFO - integration_test - Dyn residual k=2: pred=[22.589777657595686, 6.392307069166816, 0.4734329085398339, 0.34390624999999997, 24.455827164688145], ws=[22.589777657595686, 6.392307069166816, 0.4734329085398339, 0.48841796875, 24.421723059663837], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.034104105024308495], res_norm=1.485e-01
2026-01-13 16:42:41,220 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:41,289 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:41,304 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:41,316 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:41,330 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:41,342 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:41,357 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:41,368 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:41,383 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:41,394 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:41,408 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:41,420 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:41,434 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:41,446 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:41,460 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:41,472 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:41,487 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:41,498 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:41,513 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:41,523 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:41,537 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:41,547 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:41,702 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:41,702 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:41,702 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:41,702 - ERROR - integration_test -   Current position: (22.544, 6.369)
2026-01-13 16:42:41,702 - ERROR - integration_test -   Position 5 steps ago: (22.549, 6.371)
2026-01-13 16:42:41,702 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:41,702 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:42,466 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.240)
2026-01-13 16:42:42,466 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:42,466 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:42,466 - INFO - integration_test -   Control dict from planner: {'a': -2.223383906960689e-09, 'w': 0.02691628650651815}
2026-01-13 16:42:42,466 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:42,466 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:42,467 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:42,468 - INFO - integration_test - Step 200 completed in 1.397s
2026-01-13 16:42:42,485 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:42,488 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25432614e+01  6.36847566e+00  4.76124537e-01 -1.00000099e-02
  2.42390002e+01]
2026-01-13 16:42:42,489 - DEBUG - integration_test - Step 201: Using propagated spline 24.2390 (close to path, dist=0.511m, drift=0.007m)
2026-01-13 16:42:42,489 - DEBUG - integration_test -   Set spline state to 24.2390
2026-01-13 16:42:42,490 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:42,556 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.543, 6.368), path_start=(0.000, 0.000), dist=23.426m
2026-01-13 16:42:42,556 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.426m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:42,556 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:42,608 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:42,617 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:42,617 - INFO - integration_test - Warmstart k=0: x0=22.543261430289746 , y0=6.368475658561648 , psi0=0.47612453719048553 , v0=-0.010000009866857658 , spline0=24.390515355355063 , a0=0.0 , w0=0.0
2026-01-13 16:42:42,617 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:42,618 - INFO - integration_test - Dyn residual k=0: pred=[22.542372651547456, 6.368017319908876, 0.47612453719048553, -0.010000009866857658, 24.389515354368378], ws=[22.5423726524244, 6.368017320361113, 0.4761245371904854, 0.17875, 24.42029915840605], res=[-8.76944739047758e-10, -4.5223647049397186e-10, 1.1102230246251565e-16, -0.18875000986685764, -0.030783804037671558], res_norm=1.912e-01
2026-01-13 16:42:42,619 - INFO - integration_test - Dyn residual k=1: pred=[22.55825955676747, 6.3762101156956845, 0.4761245371904854, 0.17875, 24.43817415840605], ws=[22.55825955676747, 6.3762101156956845, 0.4761245371904854, 0.34390624999999997, 24.42029915840605], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:42,620 - INFO - integration_test - Dyn residual k=2: pred=[22.588825183042903, 6.391972652873475, 0.4761245371904854, 0.34390624999999997, 24.45468978340605], ws=[22.588825183042903, 6.391972652873475, 0.4761245371904854, 0.48841796875, 24.420470060872656], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.03421972253339334], res_norm=1.485e-01
2026-01-13 16:42:42,635 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:42,704 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:42,719 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:42,730 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:42,746 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:42,757 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:42,772 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:42,783 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:42,797 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:42,809 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:42,823 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:42,835 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:42,849 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:42,861 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:42,875 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:42,886 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:42,901 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:42,912 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:42,927 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:42,937 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:42,950 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:42,960 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:43,118 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:43,118 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:43,118 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:43,118 - ERROR - integration_test -   Current position: (22.543, 6.368)
2026-01-13 16:42:43,119 - ERROR - integration_test -   Position 5 steps ago: (22.548, 6.371)
2026-01-13 16:42:43,119 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:43,119 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:43,890 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.239)
2026-01-13 16:42:43,890 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:43,890 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:43,890 - INFO - integration_test -   Control dict from planner: {'a': -7.402499154574495e-10, 'w': 0.02034997109013201}
2026-01-13 16:42:43,890 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:43,890 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:43,891 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:43,892 - INFO - integration_test - Step 200 completed in 1.404s
2026-01-13 16:42:43,910 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:43,912 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25423731e+01  6.36801642e+00  4.78159534e-01 -1.00000099e-02
  2.42380002e+01]
2026-01-13 16:42:43,913 - DEBUG - integration_test - Step 201: Using propagated spline 24.2380 (close to path, dist=0.511m, drift=0.006m)
2026-01-13 16:42:43,913 - DEBUG - integration_test -   Set spline state to 24.2380
2026-01-13 16:42:43,914 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:43,980 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.542, 6.368), path_start=(0.000, 0.000), dist=23.425m
2026-01-13 16:42:43,980 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.425m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:43,980 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:44,033 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:44,042 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:44,042 - INFO - integration_test - Warmstart k=0: x0=22.54237311851636 , y0=6.368016415892749 , psi0=0.47815953429949876 , v0=-0.010000009940882649 , spline0=24.389515354360974 , a0=0.0 , w0=0.0
2026-01-13 16:42:44,042 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:44,043 - INFO - integration_test - Dyn residual k=0: pred=[22.541485274324994, 6.3675562695246875, 0.47815953429949876, -0.010000009940882649, 24.388515353366884], ws=[22.54148527520759, 6.367556269982113, 0.47815953429949865, 0.17875, 24.419161823137383], res=[-8.825971065107296e-10, -4.5742520882186e-10, 1.1102230246251565e-16, -0.18875000994088265, -0.030646469770498896], res_norm=1.912e-01
2026-01-13 16:42:44,044 - INFO - integration_test - Dyn residual k=1: pred=[22.55735547435183, 6.37578137813473, 0.47815953429949865, 0.17875, 24.437036823137383], ws=[22.55735547435183, 6.37578137813473, 0.47815953429949865, 0.34390624999999997, 24.419161823137383], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:44,045 - INFO - integration_test - Dyn residual k=2: pred=[22.58788896064245, 6.391606083592692, 0.47815953429949865, 0.34390624999999997, 24.453552448137383], ws=[22.58788896064245, 6.391606083592692, 0.47815953429949865, 0.48841796875, 24.419217297197918], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.03433515093946582], res_norm=1.485e-01
2026-01-13 16:42:44,059 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:44,129 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:44,144 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:44,156 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:44,171 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:44,182 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:44,197 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:44,208 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:44,223 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:44,235 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:44,249 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:44,261 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:44,275 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:44,287 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:44,301 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:44,312 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:44,327 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:44,339 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:44,354 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:44,364 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:44,377 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:44,387 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:44,548 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:44,548 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:44,548 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:44,548 - ERROR - integration_test -   Current position: (22.542, 6.368)
2026-01-13 16:42:44,548 - ERROR - integration_test -   Position 5 steps ago: (22.547, 6.370)
2026-01-13 16:42:44,548 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:44,548 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:45,323 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.238)
2026-01-13 16:42:45,324 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:45,324 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:45,324 - INFO - integration_test -   Control dict from planner: {'a': -3.9163446521863744e-10, 'w': 0.019138852560904945}
2026-01-13 16:42:45,324 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:45,324 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:45,325 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:45,325 - INFO - integration_test - Step 200 completed in 1.414s
2026-01-13 16:42:45,345 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:45,349 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25414857e+01  6.36755542e+00  4.80073420e-01 -1.00000100e-02
  2.42370002e+01]
2026-01-13 16:42:45,349 - DEBUG - integration_test - Step 201: Using propagated spline 24.2370 (close to path, dist=0.511m, drift=0.005m)
2026-01-13 16:42:45,349 - DEBUG - integration_test -   Set spline state to 24.2370
2026-01-13 16:42:45,350 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:45,416 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.541, 6.368), path_start=(0.000, 0.000), dist=23.424m
2026-01-13 16:42:45,416 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.424m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:45,416 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:45,469 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:45,479 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:45,479 - INFO - integration_test - Warmstart k=0: x0=22.54148571519882 , y0=6.367555420189006 , psi0=0.48007341955558924 , v0=-0.010000009980046095 , spline0=24.38851535336297 , a0=0.0 , w0=0.0
2026-01-13 16:42:45,479 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:45,480 - INFO - integration_test - Dyn residual k=0: pred=[22.540598753296862, 6.367093575431013, 0.48007341955558924, -0.010000009980046095, 24.387515352364964], ws=[22.540598754182053, 6.367093575891936, 0.48007341955558935, 0.17875, 24.418024526173436], res=[-8.85190587496254e-10, -4.609228554386391e-10, -1.1102230246251565e-16, -0.1887500099800461, -0.030509173808471957], res_norm=1.912e-01
2026-01-13 16:42:45,481 - INFO - integration_test - Dyn residual k=1: pred=[22.55645318235676, 6.37534904270206, 0.48007341955558935, 0.17875, 24.435899526173436], ws=[22.55645318235676, 6.37534904270206, 0.48007341955558935, 0.34390624999999997, 24.418024526173436], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:45,482 - INFO - integration_test - Dyn residual k=2: pred=[22.586956326074006, 6.391232156730978, 0.48007341955558935, 0.34390624999999997, 24.452415151173437], ws=[22.586956326074006, 6.391232156730978, 0.48007341955558935, 0.48841796875, 24.418024526173436], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.03439062500000034], res_norm=1.485e-01
2026-01-13 16:42:45,496 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:45,567 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:45,581 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:45,593 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:45,608 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:45,619 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:45,634 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:45,645 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:45,660 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:45,671 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:45,691 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:45,704 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:45,718 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:45,730 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:45,745 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:45,756 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:45,771 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:45,782 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:45,796 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:45,806 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:45,819 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:45,829 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:45,985 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:45,985 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:45,985 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:45,985 - ERROR - integration_test -   Current position: (22.541, 6.368)
2026-01-13 16:42:45,985 - ERROR - integration_test -   Position 5 steps ago: (22.546, 6.370)
2026-01-13 16:42:45,985 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:45,985 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:46,774 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.237)
2026-01-13 16:42:46,774 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:46,774 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:46,774 - INFO - integration_test -   Control dict from planner: {'a': -1.2667048014905862e-10, 'w': 0.017971230499430637}
2026-01-13 16:42:46,774 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:46,774 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:46,775 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:46,775 - INFO - integration_test - Step 200 completed in 1.427s
2026-01-13 16:42:46,793 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:46,795 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25405992e+01  6.36709278e+00  4.81870543e-01 -1.00000100e-02
  2.42360002e+01]
2026-01-13 16:42:46,796 - DEBUG - integration_test - Step 201: Using propagated spline 24.2360 (close to path, dist=0.512m, drift=0.004m)
2026-01-13 16:42:46,796 - DEBUG - integration_test -   Set spline state to 24.2360
2026-01-13 16:42:46,797 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:46,864 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.541, 6.367), path_start=(0.000, 0.000), dist=23.423m
2026-01-13 16:42:46,864 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.423m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:46,864 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:46,917 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:46,926 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:46,926 - INFO - integration_test - Warmstart k=0: x0=22.54059916876955 , y0=6.3670927786896945 , psi0=0.4818705426055323 , v0=-0.010000009992713143 , spline0=24.387515352363696 , a0=0.0 , w0=0.0
2026-01-13 16:42:46,926 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:46,927 - INFO - integration_test - Dyn residual k=0: pred=[22.53971303829017, 6.366629340698093, 0.4818705426055323, -0.010000009992713143, 24.386515351364423], ws=[22.539713039175655, 6.366629341161193, 0.4818705426055323, 0.17875, 24.416887264591313], res=[-8.854854627315945e-10, -4.630997807453241e-10, 0.0, -0.18875000999271313, -0.030371913226890257], res_norm=1.912e-01
2026-01-13 16:42:46,928 - INFO - integration_test - Dyn residual k=1: pred=[22.555552605666527, 6.374913286983161, 0.4818705426055323, 0.17875, 24.434762264591313], ws=[22.555552605666527, 6.374913286983161, 0.4818705426055323, 0.34390624999999997, 24.416887264591313], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:46,929 - INFO - integration_test - Dyn residual k=2: pred=[22.586027156231566, 6.39085119323679, 0.4818705426055323, 0.34390624999999997, 24.451277889591314], ws=[22.586027156231566, 6.39085119323679, 0.4818705426055323, 0.48841796875, 24.416887264591313], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.03439062500000034], res_norm=1.485e-01
2026-01-13 16:42:46,943 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:47,012 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:47,027 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:47,039 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:47,054 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:47,065 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:47,080 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:47,091 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:47,105 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:47,116 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:47,131 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:47,143 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:47,157 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:47,169 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:47,183 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:47,195 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:47,209 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:47,221 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:47,237 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:47,247 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:47,259 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:47,269 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:47,392 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:47,393 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:47,393 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:47,393 - ERROR - integration_test -   Current position: (22.541, 6.367)
2026-01-13 16:42:47,393 - ERROR - integration_test -   Position 5 steps ago: (22.545, 6.369)
2026-01-13 16:42:47,393 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:47,393 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:48,189 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.236)
2026-01-13 16:42:48,189 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:48,189 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:48,189 - INFO - integration_test -   Control dict from planner: {'a': 4.292108826789227e-08, 'w': 0.18879356420393528}
2026-01-13 16:42:48,189 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:48,189 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:48,190 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:48,191 - INFO - integration_test - Step 200 completed in 1.396s
2026-01-13 16:42:48,209 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:48,212 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25397175e+01  6.36662100e+00  5.00749899e-01 -1.00000057e-02
  2.42350002e+01]
2026-01-13 16:42:48,213 - DEBUG - integration_test - Step 201: Using propagated spline 24.2350 (close to path, dist=0.512m, drift=0.003m)
2026-01-13 16:42:48,213 - DEBUG - integration_test -   Set spline state to 24.2350
2026-01-13 16:42:48,214 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:48,282 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.540, 6.367), path_start=(0.000, 0.000), dist=23.422m
2026-01-13 16:42:48,282 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.422m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:48,282 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:48,335 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:48,345 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:48,345 - INFO - integration_test - Warmstart k=0: x0=22.539717465694263 , y0=6.366621003791838 , psi0=0.5007498990259258 , v0=-0.010000005700604317 , spline0=24.386515351793637 , a0=0.0 , w0=0.0
2026-01-13 16:42:48,345 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:48,346 - INFO - integration_test - Dyn residual k=0: pred=[22.53884024239977, 6.366140920016113, 0.5007498990259258, -0.010000005700604317, 24.385515351223578], ws=[22.538840242899838, 6.36614092028979, 0.5007498990259256, 0.17875, 24.415750151308618], res=[-5.000693192869221e-10, -2.736770809974587e-10, 2.220446049250313e-16, -0.1887500057006043, -0.030234800085040092], res_norm=1.912e-01
2026-01-13 16:42:48,347 - INFO - integration_test - Dyn residual k=1: pred=[22.5545206003502, 6.374722412888911, 0.5007498990259256, 0.17875, 24.43362515130862], ws=[22.5545206003502, 6.374722412888911, 0.5007498990259256, 0.34390624999999997, 24.415750151308618], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:48,348 - INFO - integration_test - Dyn residual k=2: pred=[22.584688840514758, 6.391232784576555, 0.5007498990259256, 0.34390624999999997, 24.45014077630862], ws=[22.584688840514758, 6.391232784576555, 0.5007498990259256, 0.48841796875, 24.415750151308618], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.03439062500000034], res_norm=1.485e-01
2026-01-13 16:42:48,363 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:48,440 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:48,456 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:48,468 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:48,483 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:48,495 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:48,510 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:48,522 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:48,537 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:48,549 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:48,564 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:48,576 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:48,591 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:48,603 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:48,618 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:48,630 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:48,646 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:48,658 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:48,673 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:48,683 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:48,697 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:48,708 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:48,840 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:48,840 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:48,840 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:48,840 - ERROR - integration_test -   Current position: (22.540, 6.367)
2026-01-13 16:42:48,840 - ERROR - integration_test -   Position 5 steps ago: (22.544, 6.369)
2026-01-13 16:42:48,840 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:48,840 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:49,643 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.235)
2026-01-13 16:42:49,643 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:49,644 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:49,644 - INFO - integration_test -   Control dict from planner: {'a': 6.821826488240866e-09, 'w': 0.1660250182895305}
2026-01-13 16:42:49,644 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:49,644 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:49,645 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:49,645 - INFO - integration_test - Step 200 completed in 1.433s
2026-01-13 16:42:49,662 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:49,665 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25388443e+01  6.36613366e+00  5.17352401e-01 -1.00000050e-02
  2.42340002e+01]
2026-01-13 16:42:49,666 - DEBUG - integration_test - Step 201: Using propagated spline 24.2340 (close to path, dist=0.512m, drift=0.002m)
2026-01-13 16:42:49,666 - DEBUG - integration_test -   Set spline state to 24.2340
2026-01-13 16:42:49,667 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:49,731 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.539, 6.366), path_start=(0.000, 0.000), dist=23.421m
2026-01-13 16:42:49,731 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.421m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:49,731 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:49,785 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:49,794 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:49,794 - INFO - integration_test - Warmstart k=0: x0=22.538844267933353 , y0=6.3661336602043885 , psi0=0.5173524008548789 , v0=-0.010000005018421668 , spline0=24.385515351291794 , a0=0.0 , w0=0.0
2026-01-13 16:42:49,794 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:49,795 - INFO - integration_test - Dyn residual k=0: pred=[22.537975135821227, 6.365639079194486, 0.5173524008548789, -0.010000005018421668, 24.38451535078995], ws=[22.537975136257394, 6.365639079442688, 0.5173524008548789, 0.17875, 24.414613231135277], res=[-4.361666583463375e-10, -2.482014593852e-10, 0.0, -0.18875000501842165, -0.0300978803453269], res_norm=1.911e-01
2026-01-13 16:42:49,796 - INFO - integration_test - Dyn residual k=1: pred=[22.55351086496517, 6.374479710558081, 0.5173524008548789, 0.17875, 24.432488231135277], ws=[22.55351086496517, 6.374479710558081, 0.5173524008548789, 0.34390624999999997, 24.414613231135277], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:49,797 - INFO - integration_test - Dyn residual k=2: pred=[22.58340084650871, 6.391488652065931, 0.5173524008548789, 0.34390624999999997, 24.449003856135278], ws=[22.58340084650871, 6.391488652065931, 0.5173524008548789, 0.48841796875, 24.414613231135277], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.03439062500000034], res_norm=1.485e-01
2026-01-13 16:42:49,811 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:49,881 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:49,895 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:49,907 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:49,923 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:49,934 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:49,949 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:49,961 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:49,976 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:49,988 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:50,003 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:50,015 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:50,030 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:50,042 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:50,057 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:50,069 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:50,083 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:50,094 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:50,109 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:50,119 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:50,131 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:50,142 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:50,269 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:50,269 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:50,269 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:50,269 - ERROR - integration_test -   Current position: (22.539, 6.366)
2026-01-13 16:42:50,269 - ERROR - integration_test -   Position 5 steps ago: (22.543, 6.368)
2026-01-13 16:42:50,269 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:50,269 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:51,079 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.234)
2026-01-13 16:42:51,079 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:51,079 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:51,079 - INFO - integration_test -   Control dict from planner: {'a': -5.116235904541068e-09, 'w': 0.1466475541897424}
2026-01-13 16:42:51,079 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:51,079 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:51,080 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:51,081 - INFO - integration_test - Step 200 completed in 1.416s
2026-01-13 16:42:51,097 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:51,102 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25379788e+01  6.36563272e+00  5.32017156e-01 -1.00000055e-02
  2.42330002e+01]
2026-01-13 16:42:51,103 - DEBUG - integration_test - Step 201: Using propagated spline 24.2330 (close to path, dist=0.512m, drift=0.001m)
2026-01-13 16:42:51,103 - DEBUG - integration_test -   Set spline state to 24.2330
2026-01-13 16:42:51,103 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:51,172 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.538, 6.366), path_start=(0.000, 0.000), dist=23.420m
2026-01-13 16:42:51,172 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.420m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:51,172 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:51,224 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:51,234 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:51,234 - INFO - integration_test - Warmstart k=0: x0=22.537978793340425 , y0=6.3656327242177255 , psi0=0.5320171562738532 , v0=-0.010000005530045259 , spline0=24.384515350738788 , a0=0.0 , w0=0.0
2026-01-13 16:42:51,234 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:51,236 - INFO - integration_test - Dyn residual k=0: pred=[22.537117007287744, 6.365125451208968, 0.5320171562738532, -0.010000005530045259, 24.38351535018578], ws=[22.537117007764316, 6.365125451489493, 0.5320171562738532, 0.17875, 24.413476415319725], res=[-4.765716710153356e-10, -2.8052493661334665e-10, 0.0, -0.18875000553004526, -0.02996106513394281], res_norm=1.911e-01
2026-01-13 16:42:51,236 - INFO - integration_test - Dyn residual k=1: pred=[22.55252142493728, 6.37419295150666, 0.5320171562738532, 0.17875, 24.431351415319725], ws=[22.55252142493728, 6.37419295150666, 0.5320171562738532, 0.34390624999999997, 24.413476415319725], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:51,237 - INFO - integration_test - Dyn residual k=2: pred=[22.58215876951568, 6.391638377676053, 0.5320171562738532, 0.34390624999999997, 24.447867040319725], ws=[22.58215876951568, 6.391638377676053, 0.5320171562738532, 0.48841796875, 24.413476415319725], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.03439062500000034], res_norm=1.485e-01
2026-01-13 16:42:51,252 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:51,321 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:51,336 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:51,348 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:51,363 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:51,374 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:51,389 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:51,400 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:51,415 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:51,426 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:51,441 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:51,452 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:51,467 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:51,478 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:51,493 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:51,505 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:51,521 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:51,533 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:51,549 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:51,558 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:51,571 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:51,581 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:51,701 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:51,701 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:51,701 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:51,701 - ERROR - integration_test -   Current position: (22.538, 6.366)
2026-01-13 16:42:51,701 - ERROR - integration_test -   Position 5 steps ago: (22.542, 6.368)
2026-01-13 16:42:51,701 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:51,701 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:52,515 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.233)
2026-01-13 16:42:52,515 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:52,515 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:52,515 - INFO - integration_test -   Control dict from planner: {'a': -1.152956952824312e-08, 'w': 0.13021153300295069}
2026-01-13 16:42:52,516 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:52,516 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:52,517 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:52,517 - INFO - integration_test - Step 200 completed in 1.415s
2026-01-13 16:42:52,535 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:52,540 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25371203e+01  6.36511985e+00  5.45038310e-01 -1.00000067e-02
  2.42320002e+01]
2026-01-13 16:42:52,540 - DEBUG - integration_test - Step 201: Using propagated spline 24.2320 (close to path, dist=0.513m, drift=0.000m)
2026-01-13 16:42:52,540 - DEBUG - integration_test -   Set spline state to 24.2320
2026-01-13 16:42:52,541 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:52,606 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.537, 6.365), path_start=(0.000, 0.000), dist=23.419m
2026-01-13 16:42:52,606 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.419m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:52,606 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:52,658 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:52,668 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:52,668 - INFO - integration_test - Warmstart k=0: x0=22.537120334183946 , y0=6.365119854869017 , psi0=0.5450383095741482 , v0=-0.01000000668300221 , spline0=24.38351535007049 , a0=0.0 , w0=0.0
2026-01-13 16:42:52,668 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:52,669 - INFO - integration_test - Dyn residual k=0: pred=[22.5362652261827, 6.36460140367285, 0.5450383095741482, -0.01000000668300221, 24.38251534940219], ws=[22.536265226754168, 6.364601404019331, 0.5450383095741484, 0.17875, 24.412339640349224], res=[-5.714682060897758e-10, -3.4648106606027795e-10, -2.220446049250313e-16, -0.1887500066830022, -0.029824290947033205], res_norm=1.911e-01
2026-01-13 16:42:52,669 - INFO - integration_test - Dyn residual k=1: pred=[22.551550272061426, 6.373868712957476, 0.5450383095741484, 0.17875, 24.430214640349224], ws=[22.551550272061426, 6.373868712957476, 0.5450383095741484, 0.34390624999999997, 24.412339640349224], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:52,670 - INFO - integration_test - Dyn residual k=2: pred=[22.58095795101359, 6.3916985617099735, 0.5450383095741484, 0.34390624999999997, 24.446730265349224], ws=[22.58095795101359, 6.3916985617099735, 0.5450383095741484, 0.48841796875, 24.412339640349224], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.03439062500000034], res_norm=1.485e-01
2026-01-13 16:42:52,684 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:52,754 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:52,769 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:52,781 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:52,797 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:52,809 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:52,823 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:52,835 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:52,850 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:52,861 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:52,876 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:52,887 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:52,902 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:52,913 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:52,928 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:52,940 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:52,955 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:52,967 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:52,982 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:52,992 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:53,004 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:53,015 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:53,152 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:53,152 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:53,152 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:53,153 - ERROR - integration_test -   Current position: (22.537, 6.365)
2026-01-13 16:42:53,153 - ERROR - integration_test -   Position 5 steps ago: (22.541, 6.368)
2026-01-13 16:42:53,153 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:53,153 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:53,965 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.232)
2026-01-13 16:42:53,965 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:53,965 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:53,965 - INFO - integration_test -   Control dict from planner: {'a': -2.1402363560857726e-08, 'w': -0.3988323730348313}
2026-01-13 16:42:53,965 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:53,965 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:53,966 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:53,967 - INFO - integration_test - Step 200 completed in 1.427s
2026-01-13 16:42:53,983 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:53,987 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25362551e+01  6.36461859e+00  5.05155072e-01 -1.00000088e-02
  2.42310002e+01]
2026-01-13 16:42:53,988 - DEBUG - integration_test - Step 201: Using propagated spline 24.2310 (close to path, dist=0.513m, drift=0.001m)
2026-01-13 16:42:53,988 - DEBUG - integration_test -   Set spline state to 24.2310
2026-01-13 16:42:53,988 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:54,055 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.536, 6.365), path_start=(0.000, 0.000), dist=23.418m
2026-01-13 16:42:54,056 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.418m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:54,056 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:54,108 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:54,117 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:54,117 - INFO - integration_test - Warmstart k=0: x0=22.536255115384794 , y0=6.364618591033549 , psi0=0.5051550722706651 , v0=-0.010000008823238567 , spline0=24.382515349188164 , a0=0.0 , w0=0.0
2026-01-13 16:42:54,117 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:54,119 - INFO - integration_test - Dyn residual k=0: pred=[22.53538001517389, 6.364134647456756, 0.5051550722706651, -0.010000008823238567, 24.38151534830584], ws=[22.535380015946007, 6.36413464788375, 0.5051550722706653, 0.17875, 24.411202820208874], res=[-7.721183692410705e-10, -4.269944398060943e-10, -1.1102230246251565e-16, -0.18875000882323856, -0.02968747190303489], res_norm=1.911e-01
2026-01-13 16:42:54,119 - INFO - integration_test - Dyn residual k=1: pred=[22.551022418414295, 6.3727851316864115, 0.5051550722706653, 0.17875, 24.429077820208875], ws=[22.551022418414295, 6.3727851316864115, 0.5051550722706653, 0.34390624999999997, 24.411202820208874], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:54,120 - INFO - integration_test - Dyn residual k=2: pred=[22.58111763505127, 6.389428239072476, 0.5051550722706653, 0.34390624999999997, 24.445593445208875], ws=[22.58111763505127, 6.389428239072476, 0.5051550722706653, 0.48841796875, 24.411202820208874], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.03439062500000034], res_norm=1.485e-01
2026-01-13 16:42:54,136 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:54,205 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:54,220 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:54,232 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:54,248 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:54,259 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:54,274 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:54,285 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:54,300 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:54,311 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:54,327 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:54,339 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:54,354 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:54,365 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:54,379 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:54,391 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:54,405 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:54,417 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:54,432 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:54,443 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:54,456 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:54,466 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:54,585 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:54,585 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:54,585 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:54,585 - ERROR - integration_test -   Current position: (22.536, 6.365)
2026-01-13 16:42:54,585 - ERROR - integration_test -   Position 5 steps ago: (22.541, 6.367)
2026-01-13 16:42:54,585 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:54,585 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:55,405 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.231)
2026-01-13 16:42:55,406 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:55,406 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:55,406 - INFO - integration_test -   Control dict from planner: {'a': 1.8656755448484534e-08, 'w': 0.1586446786407505}
2026-01-13 16:42:55,406 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:55,406 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:55,407 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:55,407 - INFO - integration_test - Step 200 completed in 1.421s
2026-01-13 16:42:55,425 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:55,428 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25353839e+01  6.36412773e+00  5.21019540e-01 -1.00000070e-02
  2.42300002e+01]
2026-01-13 16:42:55,428 - DEBUG - integration_test - Step 201: Using propagated spline 24.2300 (close to path, dist=0.513m, drift=0.002m)
2026-01-13 16:42:55,428 - DEBUG - integration_test -   Set spline state to 24.2300
2026-01-13 16:42:55,429 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:55,496 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.535, 6.364), path_start=(0.000, 0.000), dist=23.417m
2026-01-13 16:42:55,496 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.417m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:55,496 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:55,549 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:55,559 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:55,559 - INFO - integration_test - Warmstart k=0: x0=22.535383890635437 , y0=6.364127726448421 , psi0=0.5210195401347402 , v0=-0.010000006957563022 , spline0=24.381515348492407 , a0=0.0 , w0=0.0
2026-01-13 16:42:55,559 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:55,560 - INFO - integration_test - Dyn residual k=0: pred=[22.534516577892507, 6.363629961446168, 0.5210195401347402, -0.010000006957563022, 24.38051534779665], ws=[22.534516578495946, 6.363629961792491, 0.5210195401347404, 0.17875, 24.41006595043243], res=[-6.034390764853015e-10, -3.4632297030157133e-10, -2.220446049250313e-16, -0.18875000695756303, -0.02955060263577991], res_norm=1.910e-01
2026-01-13 16:42:55,561 - INFO - integration_test - Dyn residual k=1: pred=[22.550019782989335, 6.372527505017237, 0.5210195401347404, 0.17875, 24.42794095043243], ws=[22.550019782989335, 6.372527505017237, 0.5210195401347404, 0.34390624999999997, 24.41006595043243], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:55,562 - INFO - integration_test - Dyn residual k=2: pred=[22.57984718953649, 6.389645942637573, 0.5210195401347404, 0.34390624999999997, 24.44445657543243], ws=[22.57984718953649, 6.389645942637573, 0.5210195401347404, 0.48841796875, 24.41006595043243], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.03439062500000034], res_norm=1.485e-01
2026-01-13 16:42:55,575 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:55,645 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:55,661 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:55,672 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:55,687 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:55,698 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:55,713 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:55,724 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:55,739 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:55,750 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:55,765 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:55,776 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:55,790 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:55,801 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:55,816 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:55,827 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:55,842 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:55,854 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:55,869 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:55,879 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:55,891 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:55,901 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:56,059 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:56,059 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:56,059 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:56,059 - ERROR - integration_test -   Current position: (22.535, 6.364)
2026-01-13 16:42:56,059 - ERROR - integration_test -   Position 5 steps ago: (22.540, 6.367)
2026-01-13 16:42:56,059 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:56,059 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:56,885 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.230)
2026-01-13 16:42:56,885 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:56,885 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:56,885 - INFO - integration_test -   Control dict from planner: {'a': -2.0087711464252453e-08, 'w': -0.23073970167236485}
2026-01-13 16:42:56,885 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:56,885 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:56,886 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:56,887 - INFO - integration_test - Step 200 completed in 1.459s
2026-01-13 16:42:56,904 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:56,906 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25345109e+01  6.36364001e+00  4.97945570e-01 -1.00000090e-02
  2.42290002e+01]
2026-01-13 16:42:56,907 - DEBUG - integration_test - Step 201: Using propagated spline 24.2290 (close to path, dist=0.513m, drift=0.003m)
2026-01-13 16:42:56,907 - DEBUG - integration_test -   Set spline state to 24.2290
2026-01-13 16:42:56,908 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:56,975 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.535, 6.364), path_start=(0.000, 0.000), dist=23.416m
2026-01-13 16:42:56,975 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.416m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:56,975 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:57,030 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:57,040 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:57,040 - INFO - integration_test - Warmstart k=0: x0=22.534510912310605 , y0=6.363640011295555 , psi0=0.49794556996750367 , v0=-0.010000008966334168 , spline0=24.38051534759577 , a0=0.0 , w0=0.0
2026-01-13 16:42:57,040 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:57,041 - INFO - integration_test - Dyn residual k=0: pred=[22.533632345867428, 6.363162389271153, 0.49794556996750367, -0.010000008966334168, 24.379515346699137], ws=[22.533632346655182, 6.363162389699405, 0.4979455699675035, 0.17875, 24.408929054987336], res=[-7.877538621414715e-10, -4.282521004483897e-10, 1.6653345369377348e-16, -0.18875000896633415, -0.029413708288199558], res_norm=1.910e-01
2026-01-13 16:42:57,042 - INFO - integration_test - Dyn residual k=1: pred=[22.54933670774589, 6.371699875730589, 0.4979455699675035, 0.17875, 24.426804054987336], ws=[22.54933670774589, 6.371699875730589, 0.4979455699675035, 0.34390624999999997, 24.408929054987336], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:57,042 - INFO - integration_test - Dyn residual k=2: pred=[22.579551129739464, 6.388125580935689, 0.4979455699675035, 0.34390624999999997, 24.443319679987336], ws=[22.579551129739464, 6.388125580935689, 0.4979455699675035, 0.48841796875, 24.408929054987336], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.03439062500000034], res_norm=1.485e-01
2026-01-13 16:42:57,057 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:57,127 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:57,143 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:57,155 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:57,170 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:57,181 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:57,196 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:57,208 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:57,223 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:57,235 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:57,250 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:57,261 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:57,276 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:57,288 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:57,302 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:57,314 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:57,328 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:57,340 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:57,355 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:57,365 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:57,378 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:57,388 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:57,518 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:57,518 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:57,518 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:57,518 - ERROR - integration_test -   Current position: (22.535, 6.364)
2026-01-13 16:42:57,518 - ERROR - integration_test -   Position 5 steps ago: (22.539, 6.366)
2026-01-13 16:42:57,518 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:57,518 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:58,352 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.229)
2026-01-13 16:42:58,353 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:58,353 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:58,353 - INFO - integration_test -   Control dict from planner: {'a': 3.972798321581191e-08, 'w': 0.16465360612266125}
2026-01-13 16:42:58,353 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:58,353 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:58,354 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:58,354 - INFO - integration_test - Step 200 completed in 1.448s
2026-01-13 16:42:58,372 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:58,375 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25336363e+01  6.36315518e+00  5.14410931e-01 -1.00000050e-02
  2.42280002e+01]
2026-01-13 16:42:58,376 - DEBUG - integration_test - Step 201: Using propagated spline 24.2280 (close to path, dist=0.514m, drift=0.004m)
2026-01-13 16:42:58,376 - DEBUG - integration_test -   Set spline state to 24.2280
2026-01-13 16:42:58,376 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:58,444 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.534, 6.363), path_start=(0.000, 0.000), dist=23.415m
2026-01-13 16:42:58,444 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.415m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:58,444 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:42:58,497 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:58,506 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:42:58,507 - INFO - integration_test - Warmstart k=0: x0=22.53363631775868 , y0=6.363155178155586 , psi0=0.5144109305797698 , v0=-0.010000004993535847 , spline0=24.37951534709642 , a0=0.0 , w0=0.0
2026-01-13 16:42:58,507 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:42:58,508 - INFO - integration_test - Dyn residual k=0: pred=[22.53276573461545, 6.362663155809113, 0.5144109305797698, -0.010000004993535847, 24.378515346597066], ws=[22.53276573505018, 6.362663156054805, 0.5144109305797699, 0.17875, 24.407792139987862], res=[-4.347313620201021e-10, -2.4569235534954714e-10, -1.1102230246251565e-16, -0.18875000499353584, -0.02927679339079603], res_norm=1.910e-01
2026-01-13 16:42:58,508 - INFO - integration_test - Dyn residual k=1: pred=[22.54832740096466, 6.371458051106264, 0.5144109305797699, 0.17875, 24.425667139987862], ws=[22.54832740096466, 6.371458051106264, 0.5144109305797699, 0.34390624999999997, 24.407792139987862], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:42:58,509 - INFO - integration_test - Dyn residual k=2: pred=[22.578267284424246, 6.3883789986659325, 0.5144109305797699, 0.34390624999999997, 24.442182764987862], ws=[22.578267284424246, 6.3883789986659325, 0.5144109305797699, 0.48841796875, 24.407792139987862], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.03439062500000034], res_norm=1.485e-01
2026-01-13 16:42:58,523 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:58,593 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:58,608 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:58,619 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:58,635 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:58,646 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:58,661 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:58,673 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:58,687 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:58,699 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:58,713 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:58,724 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:58,739 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:58,751 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:58,766 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:58,777 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:58,792 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:58,803 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:42:58,818 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:58,828 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:58,842 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:42:58,852 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:42:59,005 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:42:59,005 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:42:59,005 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:42:59,005 - ERROR - integration_test -   Current position: (22.534, 6.363)
2026-01-13 16:42:59,005 - ERROR - integration_test -   Position 5 steps ago: (22.538, 6.366)
2026-01-13 16:42:59,005 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:42:59,005 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:42:59,876 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.228)
2026-01-13 16:42:59,876 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:42:59,876 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:42:59,876 - INFO - integration_test -   Control dict from planner: {'a': -3.327361740970369e-08, 'w': -0.1659906763468044}
2026-01-13 16:42:59,876 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:42:59,876 - INFO - integration_test -   Planner output success: True
2026-01-13 16:42:59,877 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:42:59,878 - INFO - integration_test - Step 200 completed in 1.503s
2026-01-13 16:42:59,894 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:42:59,897 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25327617e+01  6.36267040e+00  4.97811863e-01 -1.00000083e-02
  2.42270002e+01]
2026-01-13 16:42:59,898 - DEBUG - integration_test - Step 201: Using propagated spline 24.2270 (close to path, dist=0.514m, drift=0.005m)
2026-01-13 16:42:59,898 - DEBUG - integration_test -   Set spline state to 24.2270
2026-01-13 16:42:59,899 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:42:59,966 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.533, 6.363), path_start=(0.000, 0.000), dist=23.414m
2026-01-13 16:42:59,966 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.414m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:42:59,966 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:00,018 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:00,028 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:00,028 - INFO - integration_test - Warmstart k=0: x0=22.532761690985293 , y0=6.362670403591286 , psi0=0.4978118629450894 , v0=-0.010000008320897587 , spline0=24.37851534626433 , a0=0.0 , w0=0.0
2026-01-13 16:43:00,028 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:00,029 - INFO - integration_test - Dyn residual k=0: pred=[22.531883060745262, 6.362192899072476, 0.4978118629450894, -0.010000008320897587, 24.37751534543224], ws=[22.53188306147636, 6.362192899469803, 0.49781186294508917, 0.17875, 24.406655229170187], res=[-7.310987371056399e-10, -3.97326616052851e-10, 2.220446049250313e-16, -0.18875000832089758, -0.029139883737947514], res_norm=1.910e-01
2026-01-13 16:43:00,030 - INFO - integration_test - Dyn residual k=1: pred=[22.547588563948523, 6.370728285641317, 0.49781186294508917, 0.17875, 24.424530229170188], ws=[22.547588563948523, 6.370728285641317, 0.49781186294508917, 0.34390624999999997, 24.406655229170187], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:43:00,031 - INFO - integration_test - Dyn residual k=2: pred=[22.577805181904143, 6.387149950819206, 0.49781186294508917, 0.34390624999999997, 24.441045854170188], ws=[22.577805181904143, 6.387149950819206, 0.49781186294508917, 0.48841796875, 24.406655229170187], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.03439062500000034], res_norm=1.485e-01
2026-01-13 16:43:00,046 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:00,117 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:00,133 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:00,145 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:00,161 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:00,172 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:00,187 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:00,199 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:00,213 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:00,225 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:00,240 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:00,252 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:00,266 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:00,277 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:00,292 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:00,304 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:00,318 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:00,329 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:00,345 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:00,355 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:00,368 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:00,378 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:00,521 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:00,521 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:00,521 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:00,521 - ERROR - integration_test -   Current position: (22.533, 6.363)
2026-01-13 16:43:00,521 - ERROR - integration_test -   Position 5 steps ago: (22.537, 6.365)
2026-01-13 16:43:00,521 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:00,521 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:01,361 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.227)
2026-01-13 16:43:01,361 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:01,361 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:01,361 - INFO - integration_test -   Control dict from planner: {'a': -1.1082729678461817e-08, 'w': -0.03237571900865151}
2026-01-13 16:43:01,361 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:01,361 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:01,362 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:01,363 - INFO - integration_test - Step 200 completed in 1.466s
2026-01-13 16:43:01,379 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:43:01,384 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25318823e+01  6.36219432e+00  4.94574291e-01 -1.00000094e-02
  2.42260002e+01]
2026-01-13 16:43:01,384 - DEBUG - integration_test - Step 201: Using propagated spline 24.2260 (close to path, dist=0.514m, drift=0.006m)
2026-01-13 16:43:01,384 - DEBUG - integration_test -   Set spline state to 24.2260
2026-01-13 16:43:01,385 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:01,452 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.532, 6.362), path_start=(0.000, 0.000), dist=23.413m
2026-01-13 16:43:01,452 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.413m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:43:01,452 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:01,506 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:01,516 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:01,516 - INFO - integration_test - Warmstart k=0: x0=22.531882289254533 , y0=6.362194322193357 , psi0=0.49457429104422423 , v0=-0.010000009429170556 , spline0=24.377515345321413 , a0=0.0 , w0=0.0
2026-01-13 16:43:01,516 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:01,517 - INFO - integration_test - Dyn residual k=0: pred=[22.531002117569283, 6.361719664748118, 0.49457429104422423, -0.010000009429170556, 24.376515344378497], ws=[22.53100211839921, 6.36171966519568, 0.49457429104422435, 0.17875, 24.405518226315948], res=[-8.299281262225122e-10, -4.475619874710901e-10, -1.1102230246251565e-16, -0.18875000942917056, -0.029002881937451264], res_norm=1.910e-01
2026-01-13 16:43:01,518 - INFO - integration_test - Dyn residual k=1: pred=[22.54673517243807, 6.370204159029159, 0.49457429104422435, 0.17875, 24.423393226315948], ws=[22.54673517243807, 6.370204159029159, 0.49457429104422435, 0.34390624999999997, 24.405518226315948], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:43:01,519 - INFO - integration_test - Dyn residual k=2: pred=[22.577004798259335, 6.3865279098398995, 0.49457429104422435, 0.34390624999999997, 24.43990885131595], ws=[22.577004798259335, 6.3865279098398995, 0.49457429104422435, 0.48841796875, 24.405518226315948], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.03439062500000034], res_norm=1.485e-01
2026-01-13 16:43:01,534 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:01,604 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:01,619 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:01,631 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:01,646 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:01,658 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:01,673 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:01,684 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:01,698 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:01,710 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:01,724 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:01,736 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:01,750 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:01,762 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:01,776 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:01,788 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:01,802 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:01,814 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:01,828 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:01,839 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:01,852 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:01,862 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:02,017 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:02,017 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:02,017 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:02,017 - ERROR - integration_test -   Current position: (22.532, 6.362)
2026-01-13 16:43:02,017 - ERROR - integration_test -   Position 5 steps ago: (22.536, 6.365)
2026-01-13 16:43:02,017 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:02,017 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:02,869 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.226)
2026-01-13 16:43:02,869 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:02,869 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:02,870 - INFO - integration_test -   Control dict from planner: {'a': -3.782979506127794e-09, 'w': 0.02745877345396404}
2026-01-13 16:43:02,870 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:02,870 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:02,871 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:02,871 - INFO - integration_test - Step 200 completed in 1.488s
2026-01-13 16:43:02,889 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:43:02,892 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25310028e+01  6.36171846e+00  4.97320168e-01 -1.00000098e-02
  2.42250002e+01]
2026-01-13 16:43:02,893 - DEBUG - integration_test - Step 201: Using propagated spline 24.2250 (close to path, dist=0.514m, drift=0.007m)
2026-01-13 16:43:02,893 - DEBUG - integration_test -   Set spline state to 24.2250
2026-01-13 16:43:02,894 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:02,961 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.531, 6.362), path_start=(0.000, 0.000), dist=23.412m
2026-01-13 16:43:02,961 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.412m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:43:02,961 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:03,016 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:03,026 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:03,026 - INFO - integration_test - Warmstart k=0: x0=22.531002770333863 , y0=6.361718456914597 , psi0=0.4973201683896206 , v0=-0.010000009807468506 , spline0=24.376515344340667 , a0=0.0 , w0=0.0
2026-01-13 16:43:03,026 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:03,027 - INFO - integration_test - Dyn residual k=0: pred=[22.53012390528303, 6.361241384400277, 0.4973201683896206, -0.010000009807468506, 24.375515343359922], ws=[22.530123906144976, 6.361241384868163, 0.4973201683896207, 0.17875, 24.40438122640401], res=[-8.619451818958623e-10, -4.678861742490881e-10, -5.551115123125783e-17, -0.1887500098074685, -0.028865883044087326], res_norm=1.909e-01
2026-01-13 16:43:03,028 - INFO - integration_test - Dyn residual k=1: pred=[22.54583360352137, 6.36976904769816, 0.4973201683896207, 0.17875, 24.42225622640401], ws=[22.54583360352137, 6.36976904769816, 0.4973201683896207, 0.34390624999999997, 24.40438122640401], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:43:03,029 - INFO - integration_test - Dyn residual k=2: pred=[22.576058292267387, 6.3861758535450335, 0.4973201683896207, 0.34390624999999997, 24.43877185140401], ws=[22.576058292267387, 6.3861758535450335, 0.4973201683896207, 0.48841796875, 24.40438122640401], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.03439062500000034], res_norm=1.485e-01
2026-01-13 16:43:03,044 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:03,114 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:03,130 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:03,141 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:03,156 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:03,168 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:03,183 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:03,194 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:03,209 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:03,220 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:03,236 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:03,248 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:03,263 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:03,275 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:03,289 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:03,301 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:03,316 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:03,328 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:03,343 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:03,353 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:03,366 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:03,376 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:03,541 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:03,541 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:03,541 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:03,542 - ERROR - integration_test -   Current position: (22.531, 6.362)
2026-01-13 16:43:03,542 - ERROR - integration_test -   Position 5 steps ago: (22.535, 6.364)
2026-01-13 16:43:03,542 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:03,542 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:04,414 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.225)
2026-01-13 16:43:04,415 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:04,415 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:04,415 - INFO - integration_test -   Control dict from planner: {'a': -1.257520187961118e-09, 'w': 0.016743625297902315}
2026-01-13 16:43:04,415 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:04,415 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:04,416 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:04,416 - INFO - integration_test - Step 200 completed in 1.525s
2026-01-13 16:43:04,435 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:43:04,440 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25301243e+01  6.36124065e+00  4.98994531e-01 -1.00000099e-02
  2.42240002e+01]
2026-01-13 16:43:04,440 - DEBUG - integration_test - Step 201: Using propagated spline 24.2240 (close to path, dist=0.515m, drift=0.008m)
2026-01-13 16:43:04,440 - DEBUG - integration_test -   Set spline state to 24.2240
2026-01-13 16:43:04,441 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:04,506 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.530, 6.361), path_start=(0.000, 0.000), dist=23.411m
2026-01-13 16:43:04,506 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.411m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:43:04,506 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:04,559 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:04,569 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:04,569 - INFO - integration_test - Warmstart k=0: x0=22.530124305084232 , y0=6.361240648850999 , psi0=0.4989945309194109 , v0=-0.010000009933220524 , spline0=24.375515343347345 , a0=0.0 , w0=0.0
2026-01-13 16:43:04,569 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:04,570 - INFO - integration_test - Dyn residual k=0: pred=[22.52924624004627, 6.360762105461372, 0.4989945309194109, -0.010000009933220524, 24.374515342354023], ws=[22.52924624091847, 6.36076210593672, 0.4989945309194108, 0.17875, 24.403244256718107], res=[-8.722018662865594e-10, -4.753477611529888e-10, 5.551115123125783e-17, -0.18875000993322053, -0.02872891436408409], res_norm=1.909e-01
2026-01-13 16:43:04,571 - INFO - integration_test - Dyn residual k=1: pred=[22.544941637881443, 6.369316060529463, 0.4989945309194108, 0.17875, 24.421119256718107], ws=[22.544941637881443, 6.369316060529463, 0.4989945309194108, 0.34390624999999997, 24.403244256718107], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:43:04,572 - INFO - integration_test - Dyn residual k=2: pred=[22.575138813332057, 6.385773450440849, 0.4989945309194108, 0.34390624999999997, 24.437634881718107], ws=[22.575138813332057, 6.385773450440849, 0.4989945309194108, 0.48841796875, 24.403244256718107], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.03439062500000034], res_norm=1.485e-01
2026-01-13 16:43:04,586 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:04,657 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:04,672 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:04,684 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:04,699 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:04,710 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:04,725 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:04,737 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:04,751 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:04,763 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:04,777 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:04,789 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:04,803 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:04,815 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:04,829 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:04,841 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:04,856 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:04,867 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:04,882 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:04,892 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:04,905 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:04,915 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:05,072 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:05,072 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:05,072 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:05,072 - ERROR - integration_test -   Current position: (22.530, 6.361)
2026-01-13 16:43:05,072 - ERROR - integration_test -   Position 5 steps ago: (22.535, 6.364)
2026-01-13 16:43:05,072 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:05,072 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:05,935 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.224)
2026-01-13 16:43:05,936 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:05,936 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:05,936 - INFO - integration_test -   Control dict from planner: {'a': -4.368594991713894e-10, 'w': 0.010865900563647099}
2026-01-13 16:43:05,936 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:05,936 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:05,937 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:05,937 - INFO - integration_test - Step 200 completed in 1.498s
2026-01-13 16:43:05,955 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:43:05,958 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25292465e+01  6.36076163e+00  5.00081121e-01 -1.00000100e-02
  2.42230002e+01]
2026-01-13 16:43:05,958 - DEBUG - integration_test - Step 201: Using propagated spline 24.2230 (close to path, dist=0.515m, drift=0.009m)
2026-01-13 16:43:05,958 - DEBUG - integration_test -   Set spline state to 24.2230
2026-01-13 16:43:05,959 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:06,026 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.529, 6.361), path_start=(0.000, 0.000), dist=23.410m
2026-01-13 16:43:06,026 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.410m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:43:06,026 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:06,079 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:06,089 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:06,089 - INFO - integration_test - Warmstart k=0: x0=22.529246500207357 , y0=6.360761628506171 , psi0=0.5000811209757756 , v0=-0.010000009976906475 , spline0=24.374515342349653 , a0=0.0 , w0=0.0
2026-01-13 16:43:06,089 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:06,090 - INFO - integration_test - Dyn residual k=0: pred=[22.528368955664305, 6.3602821313004005, 0.5000811209757756, -0.010000009976906475, 24.37351534135196], ws=[22.528368956539822, 6.36028213177879, 0.5000811209757758, 0.17875, 24.402107307308675], res=[-8.755165481488802e-10, -4.783897722404618e-10, -2.220446049250313e-16, -0.18875000997690647, -0.028591965956714205], res_norm=1.909e-01
2026-01-13 16:43:06,091 - INFO - integration_test - Dyn residual k=1: pred=[22.544055049597016, 6.368853135780715, 0.5000811209757758, 0.17875, 24.419982307308675], ws=[22.544055049597016, 6.368853135780715, 0.5000811209757758, 0.34390624999999997, 24.402107307308675], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:43:06,091 - INFO - integration_test - Dyn residual k=2: pred=[22.57423432478835, 6.385343327920782, 0.5000811209757758, 0.34390624999999997, 24.436497932308676], ws=[22.57423432478835, 6.385343327920782, 0.5000811209757758, 0.48841796875, 24.402107307308675], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.03439062500000034], res_norm=1.485e-01
2026-01-13 16:43:06,106 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:06,175 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:06,190 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:06,201 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:06,216 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:06,227 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:06,243 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:06,254 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:06,269 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:06,281 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:06,295 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:06,307 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:06,321 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:06,333 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:06,348 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:06,359 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:06,374 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:06,386 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:06,400 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:06,410 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:06,423 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:06,433 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:06,608 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:06,608 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:06,608 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:06,608 - ERROR - integration_test -   Current position: (22.529, 6.361)
2026-01-13 16:43:06,608 - ERROR - integration_test -   Position 5 steps ago: (22.534, 6.363)
2026-01-13 16:43:06,608 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:06,608 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:07,479 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.223)
2026-01-13 16:43:07,479 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:07,479 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:07,479 - INFO - integration_test -   Control dict from planner: {'a': -9.961632885713016e-11, 'w': -0.007731356588973965}
2026-01-13 16:43:07,479 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:07,479 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:07,481 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:07,481 - INFO - integration_test - Step 200 completed in 1.524s
2026-01-13 16:43:07,498 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:43:07,502 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25283688e+01  6.36028247e+00  4.99307985e-01 -1.00000100e-02
  2.42220002e+01]
2026-01-13 16:43:07,503 - DEBUG - integration_test - Step 201: Using propagated spline 24.2220 (close to path, dist=0.515m, drift=0.010m)
2026-01-13 16:43:07,503 - DEBUG - integration_test -   Set spline state to 24.2220
2026-01-13 16:43:07,504 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:07,570 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.528, 6.360), path_start=(0.000, 0.000), dist=23.409m
2026-01-13 16:43:07,570 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.409m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:43:07,570 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:07,622 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:07,632 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:07,632 - INFO - integration_test - Warmstart k=0: x0=22.528368770393108 , y0=6.360282470578404 , psi0=0.4993079853168782 , v0=-0.010000009986868107 , spline0=24.373515341350966 , a0=0.0 , w0=0.0
2026-01-13 16:43:07,632 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:07,633 - INFO - integration_test - Dyn residual k=0: pred=[22.5274908553951, 6.3598036519763745, 0.4993079853168782, -0.010000009986868107, 24.37251534035228], ws=[22.52749085627186, 6.3598036524545645, 0.49930798531687826, 0.17875, 24.40097036511302], res=[-8.767599979364604e-10, -4.781899320960292e-10, -5.551115123125783e-17, -0.1887500099868681, -0.02845502476074202], res_norm=1.909e-01
2026-01-13 16:43:07,634 - INFO - integration_test - Dyn residual k=1: pred=[22.54318357118913, 6.368362526418196, 0.49930798531687826, 0.17875, 24.41884536511302], ws=[22.54318357118913, 6.368362526418196, 0.49930798531687826, 0.34390624999999997, 24.40097036511302], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:43:07,635 - INFO - integration_test - Dyn residual k=2: pred=[22.5733755865151, 6.384829380958363, 0.49930798531687826, 0.34390624999999997, 24.435360990113022], ws=[22.5733755865151, 6.384829380958363, 0.49930798531687826, 0.48841796875, 24.198950163092817], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.23641082702020455], res_norm=2.771e-01
2026-01-13 16:43:07,648 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:07,718 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:07,733 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:07,745 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:07,760 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:07,772 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:07,786 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:07,798 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:07,813 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:07,825 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:07,840 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:07,852 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:07,867 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:07,878 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:07,893 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:07,904 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:07,919 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:07,930 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:07,946 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:07,964 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:07,978 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:07,988 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:08,112 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:08,112 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:08,112 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:08,112 - ERROR - integration_test -   Current position: (22.528, 6.360)
2026-01-13 16:43:08,112 - ERROR - integration_test -   Position 5 steps ago: (22.533, 6.363)
2026-01-13 16:43:08,112 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:08,112 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:08,998 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.222)
2026-01-13 16:43:08,998 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:08,998 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:08,998 - INFO - integration_test -   Control dict from planner: {'a': 5.209987131871643e-08, 'w': 0.16057074736730184}
2026-01-13 16:43:08,999 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:08,999 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:09,000 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:09,000 - INFO - integration_test - Step 200 completed in 1.498s
2026-01-13 16:43:09,017 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:43:09,020 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25274947e+01  6.35979662e+00  5.15365060e-01 -1.00000048e-02
  2.42210002e+01]
2026-01-13 16:43:09,021 - DEBUG - integration_test - Step 201: Using propagated spline 24.2210 (close to path, dist=0.516m, drift=0.011m)
2026-01-13 16:43:09,021 - DEBUG - integration_test -   Set spline state to 24.2210
2026-01-13 16:43:09,021 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:09,088 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.527, 6.360), path_start=(0.000, 0.000), dist=23.408m
2026-01-13 16:43:09,088 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.408m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:43:09,088 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:09,140 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:09,150 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:09,150 - INFO - integration_test - Warmstart k=0: x0=22.527494737477802 , y0=6.359796624456946 , psi0=0.5153650600536084 , v0=-0.010000004776880974 , spline0=24.372515340873278 , a0=0.0 , w0=0.0
2026-01-13 16:43:09,150 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:09,151 - INFO - integration_test - Dyn residual k=0: pred=[22.526624624202647, 6.359303771696199, 0.5153650600536084, -0.010000004776880974, 24.37151534039559], ws=[22.52662462461829, 6.3593037719316285, 0.5153650600536084, 0.17875, 24.399833498154965], res=[-4.15642631423907e-10, -2.354294537099122e-10, 0.0, -0.18875000477688098, -0.02831815775937585], res_norm=1.909e-01
2026-01-13 16:43:09,152 - INFO - integration_test - Dyn residual k=1: pred=[22.54217789198207, 6.368113510821672, 0.5153650600536084, 0.17875, 24.417708498154965], ws=[22.54217789198207, 6.368113510821672, 0.5153650600536084, 0.34390624999999997, 24.399833498154965], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:43:09,153 - INFO - integration_test - Dyn residual k=2: pred=[22.572101617041234, 6.385063017200157, 0.5153650600536084, 0.34390624999999997, 24.434224123154966], ws=[22.572101617041234, 6.385063017200157, 0.5153650600536084, 0.48841796875, 24.19781329613476], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.23641082702020455], res_norm=2.771e-01
2026-01-13 16:43:09,167 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:09,236 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:09,251 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:09,263 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:09,278 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:09,289 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:09,304 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:09,315 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:09,330 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:09,343 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:09,359 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:09,370 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:09,385 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:09,396 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:09,411 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:09,422 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:09,438 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:09,449 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:09,464 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:09,474 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:09,487 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:09,497 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:09,656 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:09,656 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:09,656 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:09,656 - ERROR - integration_test -   Current position: (22.527, 6.360)
2026-01-13 16:43:09,656 - ERROR - integration_test -   Position 5 steps ago: (22.532, 6.362)
2026-01-13 16:43:09,656 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:09,656 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:10,537 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.221)
2026-01-13 16:43:10,537 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:10,537 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:10,538 - INFO - integration_test -   Control dict from planner: {'a': -3.478222959716621e-08, 'w': -0.10966910719519318}
2026-01-13 16:43:10,538 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:10,538 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:10,539 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:10,539 - INFO - integration_test - Step 200 completed in 1.519s
2026-01-13 16:43:10,558 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:43:10,560 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25266219e+01  6.35930855e+00  5.04398149e-01 -1.00000083e-02
  2.42200002e+01]
2026-01-13 16:43:10,561 - DEBUG - integration_test - Step 201: Using propagated spline 24.2200 (close to path, dist=0.516m, drift=0.012m)
2026-01-13 16:43:10,561 - DEBUG - integration_test -   Set spline state to 24.2200
2026-01-13 16:43:10,562 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:10,628 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.527, 6.359), path_start=(0.000, 0.000), dist=23.407m
2026-01-13 16:43:10,628 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.407m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:43:10,628 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:10,681 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:10,691 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:10,691 - INFO - integration_test - Warmstart k=0: x0=22.526621938983443 , y0=6.359308552670506 , psi0=0.5043981493340891 , v0=-0.010000008255103934 , spline0=24.371515340047768 , a0=0.0 , w0=0.0
2026-01-13 16:43:10,691 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:10,692 - INFO - integration_test - Dyn residual k=0: pred=[22.525746472765004, 6.358825271643161, 0.5043981493340891, -0.010000008255103934, 24.37051533922226], ws=[22.525746473487708, 6.358825272042114, 0.5043981493340892, 0.17875, 24.39869665793875], res=[-7.227036746826343e-10, -3.9895287073932195e-10, -1.1102230246251565e-16, -0.18875000825510393, -0.028181318716491432], res_norm=1.908e-01
2026-01-13 16:43:10,693 - INFO - integration_test - Dyn residual k=1: pred=[22.541395419223953, 6.367463913274624, 0.5043981493340892, 0.17875, 24.41657165793875], ws=[22.541395419223953, 6.367463913274624, 0.5043981493340892, 0.34390624999999997, 24.39869665793875], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:43:10,693 - INFO - integration_test - Dyn residual k=2: pred=[22.57150322478818, 6.384084236135423, 0.5043981493340892, 0.34390624999999997, 24.43308728293875], ws=[22.57150322478818, 6.384084236135423, 0.5043981493340892, 0.48841796875, 24.19667645591855], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.236410827020201], res_norm=2.771e-01
2026-01-13 16:43:10,707 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:10,777 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:10,792 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:10,804 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:10,819 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:10,831 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:10,845 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:10,857 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:10,871 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:10,883 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:10,898 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:10,909 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:10,923 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:10,935 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:10,950 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:10,961 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:10,977 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:10,988 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:11,003 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:11,013 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:11,026 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:11,036 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:11,162 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:11,162 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:11,162 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:11,162 - ERROR - integration_test -   Current position: (22.527, 6.359)
2026-01-13 16:43:11,162 - ERROR - integration_test -   Position 5 steps ago: (22.531, 6.362)
2026-01-13 16:43:11,162 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:11,162 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:12,052 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.220)
2026-01-13 16:43:12,053 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:12,053 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:12,053 - INFO - integration_test -   Control dict from planner: {'a': 4.1515835902201364e-08, 'w': 0.1510229818576762}
2026-01-13 16:43:12,053 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:12,053 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:12,054 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:12,054 - INFO - integration_test - Step 200 completed in 1.494s
2026-01-13 16:43:12,073 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:43:12,075 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25257502e+01  6.35881868e+00  5.19500448e-01 -1.00000041e-02
  2.42190002e+01]
2026-01-13 16:43:12,076 - DEBUG - integration_test - Step 201: Using propagated spline 24.2190 (close to path, dist=0.516m, drift=0.013m)
2026-01-13 16:43:12,076 - DEBUG - integration_test -   Set spline state to 24.2190
2026-01-13 16:43:12,076 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:12,143 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.526, 6.359), path_start=(0.000, 0.000), dist=23.406m
2026-01-13 16:43:12,143 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.406m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:43:12,143 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:12,198 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:12,208 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:12,208 - INFO - integration_test - Warmstart k=0: x0=22.52575015548235 , y0=6.358818679465867 , psi0=0.5195004475198567 , v0=-0.010000004103520343 , spline0=24.370515339637418 , a0=0.0 , w0=0.0
2026-01-13 16:43:12,208 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:12,209 - INFO - integration_test - Dyn residual k=0: pred=[22.524882087837046, 6.3583222327075095, 0.5195004475198567, -0.010000004103520343, 24.369515339227068], ws=[22.52488208819326, 6.3583222329112274, 0.5195004475198566, 0.17875, 24.39755983777031], res=[-3.562128370049322e-10, -2.0371793141293892e-10, 1.1102230246251565e-16, -0.18875000410352033, -0.028044498543241758], res_norm=1.908e-01
2026-01-13 16:43:12,210 - INFO - integration_test - Dyn residual k=1: pred=[22.54039879098573, 6.367196215075406, 0.5195004475198566, 0.17875, 24.41543483777031], ws=[22.54039879098573, 6.367196215075406, 0.5195004475198566, 0.34390624999999997, 24.39755983777031], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:43:12,211 - INFO - integration_test - Dyn residual k=2: pred=[22.570252167599563, 6.38426932236855, 0.5195004475198566, 0.34390624999999997, 24.43195046277031], ws=[22.570252167599563, 6.38426932236855, 0.5195004475198566, 0.48841796875, 24.19553963575011], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.236410827020201], res_norm=2.771e-01
2026-01-13 16:43:12,225 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:12,296 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:12,311 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:12,323 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:12,338 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:12,350 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:12,364 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:12,376 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:12,391 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:12,403 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:12,418 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:12,430 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:12,445 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:12,457 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:12,472 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:12,483 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:12,498 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:12,510 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:12,525 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:12,536 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:12,549 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:12,559 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:12,719 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:12,719 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:12,719 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:12,719 - ERROR - integration_test -   Current position: (22.526, 6.359)
2026-01-13 16:43:12,719 - ERROR - integration_test -   Position 5 steps ago: (22.530, 6.361)
2026-01-13 16:43:12,719 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:12,719 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:13,618 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.219)
2026-01-13 16:43:13,619 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:13,619 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:13,619 - INFO - integration_test -   Control dict from planner: {'a': -3.927992962993953e-08, 'w': -0.12592070993498605}
2026-01-13 16:43:13,619 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:13,619 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:13,620 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:13,620 - INFO - integration_test - Step 200 completed in 1.546s
2026-01-13 16:43:13,640 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:43:13,643 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25248790e+01  6.35832771e+00  5.06908377e-01 -1.00000080e-02
  2.42180002e+01]
2026-01-13 16:43:13,644 - DEBUG - integration_test - Step 201: Using propagated spline 24.2180 (close to path, dist=0.516m, drift=0.014m)
2026-01-13 16:43:13,644 - DEBUG - integration_test -   Set spline state to 24.2180
2026-01-13 16:43:13,644 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:13,710 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.525, 6.358), path_start=(0.000, 0.000), dist=23.405m
2026-01-13 16:43:13,710 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.405m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:43:13,710 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:13,764 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:13,774 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:13,774 - INFO - integration_test - Warmstart k=0: x0=22.524878985000615 , y0=6.358327711043281 , psi0=0.5069083765263581 , v0=-0.010000008031513305 , spline0=24.369515338834265 , a0=0.0 , w0=0.0
2026-01-13 16:43:13,774 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:13,775 - INFO - integration_test - Dyn residual k=0: pred=[22.524004734703887, 6.357842233932625, 0.5069083765263581, -0.010000008031513305, 24.368515338031113], ws=[22.52400473540604, 6.357842234322536, 0.5069083765263582, 0.17875, 24.39642303165625], res=[-7.021547787644522e-10, -3.899112144267747e-10, -1.1102230246251565e-16, -0.1887500080315133, -0.027907693625138563], res_norm=1.908e-01
2026-01-13 16:43:13,776 - INFO - integration_test - Dyn residual k=1: pred=[22.539631946909076, 6.366520130705845, 0.5069083765263582, 0.17875, 24.41429803165625], ws=[22.539631946909076, 6.366520130705845, 0.5069083765263582, 0.34390624999999997, 24.39642303165625], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:43:13,777 - INFO - integration_test - Dyn residual k=2: pred=[22.56969793687252, 6.3832159785552, 0.5069083765263582, 0.34390624999999997, 24.43081365665625], ws=[22.56969793687252, 6.3832159785552, 0.5069083765263582, 0.48841796875, 24.194402829636047], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.23641082702020455], res_norm=2.771e-01
2026-01-13 16:43:13,790 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:13,860 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:13,875 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:13,886 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:13,901 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:13,913 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:13,928 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:13,940 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:13,954 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:13,966 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:13,980 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:13,992 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:14,006 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:14,018 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:14,033 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:14,045 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:14,060 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:14,072 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:14,087 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:14,097 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:14,110 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:14,120 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:14,249 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:14,250 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:14,250 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:14,250 - ERROR - integration_test -   Current position: (22.525, 6.358)
2026-01-13 16:43:14,250 - ERROR - integration_test -   Position 5 steps ago: (22.529, 6.361)
2026-01-13 16:43:14,250 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:14,250 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:15,162 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.218)
2026-01-13 16:43:15,162 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:15,162 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:15,162 - INFO - integration_test -   Control dict from planner: {'a': 3.748448145476436e-08, 'w': 0.14822182027928604}
2026-01-13 16:43:15,162 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:15,162 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:15,164 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:15,164 - INFO - integration_test - Step 200 completed in 1.522s
2026-01-13 16:43:15,181 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:43:15,185 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25240084e+01  6.35783577e+00  5.21730559e-01 -1.00000043e-02
  2.42170002e+01]
2026-01-13 16:43:15,186 - DEBUG - integration_test - Step 201: Using propagated spline 24.2170 (close to path, dist=0.517m, drift=0.015m)
2026-01-13 16:43:15,186 - DEBUG - integration_test -   Set spline state to 24.2170
2026-01-13 16:43:15,187 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:15,254 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.524, 6.358), path_start=(0.000, 0.000), dist=23.404m
2026-01-13 16:43:15,254 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.404m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:43:15,254 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:15,306 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:15,316 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:15,316 - INFO - integration_test - Warmstart k=0: x0=22.524008364727354 , y0=6.357835772771445 , psi0=0.5217305585542867 , v0=-0.01000000428306516 , spline0=24.36851533840596 , a0=0.0 , w0=0.0
2026-01-13 16:43:15,316 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:15,317 - INFO - integration_test - Dyn residual k=0: pred=[22.523141406355585, 6.357337391353022, 0.5217305585542867, -0.01000000428306516, 24.367515337977654], ws=[22.523141406726907, 6.357337391566482, 0.5217305585542866, 0.17875, 24.395286237907012], res=[-3.7132252828087076e-10, -2.134594723202099e-10, 1.1102230246251565e-16, -0.18875000428306515, -0.027770899929357995], res_norm=1.908e-01
2026-01-13 16:43:15,317 - INFO - integration_test - Dyn residual k=1: pred=[22.538638280984905, 6.366245955605192, 0.5217305585542866, 0.17875, 24.413161237907012], ws=[22.538638280984905, 6.366245955605192, 0.5217305585542866, 0.34390624999999997, 24.395286237907012], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.017875000000000085], res_norm=1.661e-01
2026-01-13 16:43:15,318 - INFO - integration_test - Dyn residual k=2: pred=[22.568453508469045, 6.383385596732115, 0.5217305585542866, 0.34390624999999997, 24.429676862907012], ws=[22.568453508469045, 6.383385596732115, 0.5217305585542866, 0.48841796875, 24.193266035886808], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.23641082702020455], res_norm=2.771e-01
2026-01-13 16:43:15,334 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:15,404 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:15,419 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:15,432 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:15,447 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:15,459 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:15,474 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:15,486 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:15,501 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:15,513 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:15,528 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:15,541 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:15,556 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:15,567 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:15,582 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:15,594 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:15,610 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:15,622 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:15,638 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:15,648 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:15,661 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:15,672 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:15,834 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:15,835 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:15,835 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:15,835 - ERROR - integration_test -   Current position: (22.524, 6.358)
2026-01-13 16:43:15,835 - ERROR - integration_test -   Position 5 steps ago: (22.528, 6.360)
2026-01-13 16:43:15,835 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:15,835 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:16,756 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.217)
2026-01-13 16:43:16,756 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:16,756 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:16,756 - INFO - integration_test -   Control dict from planner: {'a': -3.809059652164934e-08, 'w': -0.1300843114964138}
2026-01-13 16:43:16,756 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:16,756 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:16,757 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:16,757 - INFO - integration_test - Step 200 completed in 1.572s
2026-01-13 16:43:16,776 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:43:16,779 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25231382e+01  6.35734304e+00  5.08722127e-01 -1.00000081e-02
  2.42160002e+01]
2026-01-13 16:43:16,780 - DEBUG - integration_test - Step 201: Using propagated spline 24.2160 (close to path, dist=0.517m, drift=0.016m)
2026-01-13 16:43:16,780 - DEBUG - integration_test -   Set spline state to 24.2160
2026-01-13 16:43:16,781 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:16,848 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.523, 6.357), path_start=(0.000, 0.000), dist=23.403m
2026-01-13 16:43:16,848 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.403m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:43:16,848 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:16,901 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:16,910 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:16,910 - INFO - integration_test - Warmstart k=0: x0=22.523138189105975 , y0=6.357343044120001 , psi0=0.5087221274046454 , v0=-0.010000008092124812 , spline0=24.367515337596746 , a0=0.0 , w0=0.0
2026-01-13 16:43:16,910 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:16,911 - INFO - integration_test - Dyn residual k=0: pred=[22.522264820776012, 6.356855982133554, 0.5087221274046454, -0.010000008092124812, 24.366515336787533], ws=[22.52226482148275, 6.356855982527691, 0.5087221274046456, 0.17875, 24.39414945493463], res=[-7.067377794101048e-10, -3.9413627916928817e-10, -2.220446049250313e-16, -0.1887500080921248, -0.027634118147098263], res_norm=1.908e-01
2026-01-13 16:43:16,912 - INFO - integration_test - Dyn residual k=1: pred=[22.537876267747876, 6.365562208490247, 0.5087221274046456, 0.17875, 24.41202445493463], ws=[22.537876267747876, 6.365562208490247, 0.5087221274046456, 0.34390624999999997, 24.139541855837862], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.27248259909676875], res_norm=3.186e-01
2026-01-13 16:43:16,913 - INFO - integration_test - Dyn residual k=2: pred=[22.56791192616531, 6.382312561063313, 0.5087221274046456, 0.34390624999999997, 24.173932480837863], ws=[22.56791192616531, 6.382312561063313, 0.5087221274046456, 0.48841796875, 24.442572158868167], res=[0.0, 0.0, 0.0, -0.14451171875000002, -0.2686396780303042], res_norm=3.050e-01
2026-01-13 16:43:16,927 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:17,007 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:17,022 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:17,034 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:17,049 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:17,061 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:17,076 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:17,087 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:17,102 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:17,113 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:17,128 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:17,140 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:17,155 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:17,167 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:17,182 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:17,193 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:17,208 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:17,219 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:17,235 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:17,245 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:17,258 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:17,269 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:17,393 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:17,394 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:17,394 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:17,394 - ERROR - integration_test -   Current position: (22.523, 6.357)
2026-01-13 16:43:17,394 - ERROR - integration_test -   Position 5 steps ago: (22.527, 6.360)
2026-01-13 16:43:17,394 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:17,394 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:18,322 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.216)
2026-01-13 16:43:18,322 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:18,322 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:18,322 - INFO - integration_test -   Control dict from planner: {'a': -5.869382803928043e-09, 'w': 0.17292265689157574}
2026-01-13 16:43:18,322 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:18,323 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:18,324 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:18,324 - INFO - integration_test - Step 200 completed in 1.545s
2026-01-13 16:43:18,343 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:43:18,346 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25222691e+01  6.35684846e+00  5.26014393e-01 -1.00000087e-02
  2.42150002e+01]
2026-01-13 16:43:18,347 - DEBUG - integration_test - Step 201: Using propagated spline 24.2150 (close to path, dist=0.517m, drift=0.017m)
2026-01-13 16:43:18,347 - DEBUG - integration_test -   Set spline state to 24.2150
2026-01-13 16:43:18,348 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:18,414 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.522, 6.357), path_start=(0.000, 0.000), dist=23.402m
2026-01-13 16:43:18,414 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.402m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:43:18,414 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:18,468 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:18,477 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:18,477 - INFO - integration_test - Warmstart k=0: x0=22.522269075373696 , y0=6.356848455321894 , psi0=0.5260143930938029 , v0=-0.010000008679063093 , spline0=24.36651533672884 , a0=0.0 , w0=0.0
2026-01-13 16:43:18,477 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:18,479 - INFO - integration_test - Dyn residual k=0: pred=[22.521404259553623, 6.356346364360846, 0.5260143930938029, -0.010000008679063093, 24.36551533586093], ws=[22.5214042603042, 6.356346364796613, 0.5260143930938028, 0.17875, 24.39301268843188], res=[-7.50578266206503e-10, -4.3576697805747244e-10, 1.1102230246251565e-16, -0.18875000867906308, -0.02749735257095054], res_norm=1.907e-01
2026-01-13 16:43:18,480 - INFO - integration_test - Dyn residual k=1: pred=[22.536862829671396, 6.365321232936013, 0.5260143930938028, 0.17875, 24.41088768843188], ws=[22.536862829671396, 6.365321232936013, 0.5260143930938028, 0.34390624999999997, 24.13825335564209], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.2726343327897922], res_norm=3.188e-01
2026-01-13 16:43:18,480 - INFO - integration_test - Dyn residual k=2: pred=[22.566604360420694, 6.3825884399070105, 0.5260143930938028, 0.34390624999999997, 24.17264398064209], ws=[22.566604360420694, 6.3825884399070105, 0.5260143930938028, 0.48841796875, 24.441283658672393], res=[0.0, 0.0, 0.0, -0.14451171875000002, -0.2686396780303042], res_norm=3.050e-01
2026-01-13 16:43:18,495 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:18,566 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:18,581 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:18,593 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:18,608 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:18,620 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:18,635 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:18,647 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:18,662 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:18,674 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:18,689 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:18,701 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:18,715 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:18,727 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:18,742 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:18,754 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:18,769 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:18,780 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:18,795 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:18,805 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:18,818 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:18,829 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:18,992 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:18,992 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:18,992 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:18,992 - ERROR - integration_test -   Current position: (22.522, 6.357)
2026-01-13 16:43:18,992 - ERROR - integration_test -   Position 5 steps ago: (22.527, 6.359)
2026-01-13 16:43:18,992 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:18,992 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:19,914 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.215)
2026-01-13 16:43:19,914 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:19,914 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:19,914 - INFO - integration_test -   Control dict from planner: {'a': -8.652910518158703e-09, 'w': -0.1453590907907891}
2026-01-13 16:43:19,914 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:19,914 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:19,915 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:19,916 - INFO - integration_test - Step 200 completed in 1.570s
2026-01-13 16:43:19,934 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:43:19,941 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25214006e+01  6.35635267e+00  5.11478484e-01 -1.00000095e-02
  2.42140002e+01]
2026-01-13 16:43:19,941 - DEBUG - integration_test - Step 201: Using propagated spline 24.2140 (close to path, dist=0.518m, drift=0.018m)
2026-01-13 16:43:19,941 - DEBUG - integration_test -   Set spline state to 24.2140
2026-01-13 16:43:19,942 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:20,008 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.521, 6.356), path_start=(0.000, 0.000), dist=23.401m
2026-01-13 16:43:20,008 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.401m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:43:20,008 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:20,061 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:20,071 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:20,071 - INFO - integration_test - Warmstart k=0: x0=22.52140064086051 , y0=6.356352667352041 , psi0=0.5114784840147241 , v0=-0.010000009544354146 , spline0=24.365515335774404 , a0=0.0 , w0=0.0
2026-01-13 16:43:20,071 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:20,072 - INFO - integration_test - Dyn residual k=0: pred=[22.52052861823644, 6.355863199833217, 0.5114784840147241, -0.010000009544354146, 24.36451533481997], ws=[22.520528619068727, 6.355863200300382, 0.5114784840147242, 0.17875, 24.391875935232942], res=[-8.322871281052358e-10, -4.671649733722916e-10, -1.1102230246251565e-16, -0.18875000954435414, -0.027360600412972502], res_norm=1.907e-01
2026-01-13 16:43:20,073 - INFO - integration_test - Dyn residual k=1: pred=[22.536116008596803, 6.364612423848794, 0.5114784840147242, 0.17875, 24.409750935232942], ws=[22.536116008596803, 6.364612423848794, 0.5114784840147242, 0.34390624999999997, 24.136964726913398], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.2727862083195447], res_norm=3.189e-01
2026-01-13 16:43:20,074 - INFO - integration_test - Dyn residual k=2: pred=[22.56610538302975, 6.381445501672269, 0.5114784840147242, 0.34390624999999997, 24.171355351913398], ws=[22.56610538302975, 6.381445501672269, 0.5114784840147242, 0.48841796875, 24.439995029943702], res=[0.0, 0.0, 0.0, -0.14451171875000002, -0.2686396780303042], res_norm=3.050e-01
2026-01-13 16:43:20,088 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:20,158 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:20,173 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:20,185 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:20,200 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:20,212 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:20,227 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:20,239 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:20,254 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:20,266 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:20,280 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:20,291 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:20,306 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:20,317 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:20,333 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:20,344 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:20,359 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:20,371 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:20,386 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:20,396 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:20,409 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:20,419 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:20,548 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:20,548 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:20,548 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:20,548 - ERROR - integration_test -   Current position: (22.521, 6.356)
2026-01-13 16:43:20,548 - ERROR - integration_test -   Position 5 steps ago: (22.526, 6.359)
2026-01-13 16:43:20,548 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:20,548 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:21,482 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.214)
2026-01-13 16:43:21,482 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:21,482 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:21,482 - INFO - integration_test -   Control dict from planner: {'a': 4.002500247503185e-08, 'w': 0.1558780607862148}
2026-01-13 16:43:21,482 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:21,482 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:21,483 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:21,484 - INFO - integration_test - Step 200 completed in 1.543s
2026-01-13 16:43:21,502 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:43:21,505 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25205325e+01  6.35585642e+00  5.27066290e-01 -1.00000055e-02
  2.42130002e+01]
2026-01-13 16:43:21,506 - DEBUG - integration_test - Step 201: Using propagated spline 24.2130 (close to path, dist=0.518m, drift=0.019m)
2026-01-13 16:43:21,506 - DEBUG - integration_test -   Set spline state to 24.2130
2026-01-13 16:43:21,506 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:21,573 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.521, 6.356), path_start=(0.000, 0.000), dist=23.400m
2026-01-13 16:43:21,573 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.400m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:43:21,573 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:21,625 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:21,636 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:21,636 - INFO - integration_test - Warmstart k=0: x0=22.520532468508584 , y0=6.355856423432343 , psi0=0.5270662900933456 , v0=-0.010000005541853898 , spline0=24.36451533522022 , a0=0.0 , w0=0.0
2026-01-13 16:43:21,636 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:21,638 - INFO - integration_test - Dyn residual k=0: pred=[22.51966818158599, 6.355353423209876, 0.5270662900933456, -0.010000005541853898, 24.363515334666033], ws=[22.519668182064965, 6.355353423488631, 0.5270662900933454, 0.17875, 24.390739189748235], res=[-4.789768581758835e-10, -2.787547970228843e-10, 2.220446049250313e-16, -0.1887500055418539, -0.02722385508220171], res_norm=1.907e-01
2026-01-13 16:43:21,639 - INFO - integration_test - Dyn residual k=1: pred=[22.53511730224468, 6.364344547482479, 0.5270662900933454, 0.17875, 24.408614189748235], ws=[22.53511730224468, 6.364344547482479, 0.5270662900933454, 0.34390624999999997, 24.135676258181878], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.27293793156635715], res_norm=3.190e-01
2026-01-13 16:43:21,639 - INFO - integration_test - Dyn residual k=2: pred=[22.56484065321981, 6.381643029921691, 0.5270662900933454, 0.34390624999999997, 24.170066883181878], ws=[22.56484065321981, 6.381643029921691, 0.5270662900933454, 0.48841796875, 24.438706561212182], res=[0.0, 0.0, 0.0, -0.14451171875000002, -0.2686396780303042], res_norm=3.050e-01
2026-01-13 16:43:21,655 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:21,724 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:21,741 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:21,752 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:21,767 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:21,779 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:21,794 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:21,805 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:21,821 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:21,832 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:21,847 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:21,858 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:21,872 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:21,884 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:21,898 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:21,909 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:21,924 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:21,936 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:21,951 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:21,961 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:21,980 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:21,991 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:22,152 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:22,152 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:22,153 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:22,153 - ERROR - integration_test -   Current position: (22.521, 6.356)
2026-01-13 16:43:22,153 - ERROR - integration_test -   Position 5 steps ago: (22.525, 6.358)
2026-01-13 16:43:22,153 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:22,153 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:23,094 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.213)
2026-01-13 16:43:23,094 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:23,094 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:23,095 - INFO - integration_test -   Control dict from planner: {'a': -2.9526072936929823e-08, 'w': -0.14340331885326896}
2026-01-13 16:43:23,095 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:23,095 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:23,096 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:23,097 - INFO - integration_test - Step 200 completed in 1.592s
2026-01-13 16:43:23,113 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:43:23,118 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25196646e+01  6.35535964e+00  5.12725958e-01 -1.00000085e-02
  2.42120002e+01]
2026-01-13 16:43:23,118 - DEBUG - integration_test - Step 201: Using propagated spline 24.2120 (close to path, dist=0.518m, drift=0.020m)
2026-01-13 16:43:23,118 - DEBUG - integration_test -   Set spline state to 24.2120
2026-01-13 16:43:23,119 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:23,186 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.520, 6.355), path_start=(0.000, 0.000), dist=23.399m
2026-01-13 16:43:23,186 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.399m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:43:23,186 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:23,241 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:23,251 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:23,251 - INFO - integration_test - Warmstart k=0: x0=22.519664604546847 , y0=6.355359637351038 , psi0=0.5127259582080187 , v0=-0.010000008494461192 , spline0=24.363515334370774 , a0=0.0 , w0=0.0
2026-01-13 16:43:23,251 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:23,252 - INFO - integration_test - Dyn residual k=0: pred=[22.518793193290723, 6.354869082439132, 0.5127259582080187, -0.010000008494461192, 24.36251533352133], ws=[22.51879319403094, 6.354869082855831, 0.5127259582080188, 0.17875, 24.38960245215181], res=[-7.402185531191208e-10, -4.1669956374335015e-10, -1.1102230246251565e-16, -0.1887500084944612, -0.027087118630479523], res_norm=1.907e-01
2026-01-13 16:43:23,253 - INFO - integration_test - Dyn residual k=1: pred=[22.534369657002774, 6.363637744457643, 0.5127259582080188, 0.17875, 24.40747745215181], ws=[22.534369657002774, 6.363637744457643, 0.5127259582080188, 0.34390624999999997, 24.134387669453083], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.27308978269872597], res_norm=3.191e-01
2026-01-13 16:43:23,254 - INFO - integration_test - Dyn residual k=2: pred=[22.56433800927638, 6.380508220144345, 0.5127259582080188, 0.34390624999999997, 24.168778294453084], ws=[22.56433800927638, 6.380508220144345, 0.5127259582080188, 0.48841796875, 24.437417972483388], res=[0.0, 0.0, 0.0, -0.14451171875000002, -0.2686396780303042], res_norm=3.050e-01
2026-01-13 16:43:23,268 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:23,337 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:23,353 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:23,365 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:23,380 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:23,391 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:23,406 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:23,417 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:23,432 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:23,444 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:23,459 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:23,471 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:23,485 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:23,497 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:23,512 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:23,523 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:23,539 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:23,551 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:23,566 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:23,576 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:23,588 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:23,598 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:23,727 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:23,727 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:23,727 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:23,727 - ERROR - integration_test -   Current position: (22.520, 6.355)
2026-01-13 16:43:23,727 - ERROR - integration_test -   Position 5 steps ago: (22.524, 6.358)
2026-01-13 16:43:23,727 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:23,727 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:25,538 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.212)
2026-01-13 16:43:25,538 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:25,538 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:25,538 - INFO - integration_test -   Control dict from planner: {'a': 2.750191387321347e-08, 'w': 0.15763287525883438}
2026-01-13 16:43:25,538 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:25,538 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:25,539 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:25,540 - INFO - integration_test - Step 200 completed in 2.422s
2026-01-13 16:43:25,558 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:43:25,561 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25187971e+01  6.35486223e+00  5.28489246e-01 -1.00000057e-02
  2.42110002e+01]
2026-01-13 16:43:25,561 - DEBUG - integration_test - Step 201: Using propagated spline 24.2110 (close to path, dist=0.518m, drift=0.021m)
2026-01-13 16:43:25,561 - DEBUG - integration_test -   Set spline state to 24.2110
2026-01-13 16:43:25,562 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:25,630 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.519, 6.355), path_start=(0.000, 0.000), dist=23.398m
2026-01-13 16:43:25,630 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.398m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:43:25,630 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:25,685 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:25,694 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:25,694 - INFO - integration_test - Warmstart k=0: x0=22.518797095796593 , y0=6.354862234812319 , psi0=0.5284892457339021 , v0=-0.010000005744269805 , spline0=24.36251533379635 , a0=0.0 , w0=0.0
2026-01-13 16:43:25,694 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:25,696 - INFO - integration_test - Dyn residual k=0: pred=[22.517933525478284, 6.354358005247347, 0.5284892457339021, -0.010000005744269805, 24.361515333221924], ws=[22.517933525974343, 6.35435800553699, 0.5284892457339021, 0.17875, 24.388465722705202], res=[-4.960583055435563e-10, -2.8964297626998814e-10, 0.0, -0.1887500057442698, -0.02695038948327877], res_norm=1.907e-01
2026-01-13 16:43:25,697 - INFO - integration_test - Dyn residual k=1: pred=[22.533369836547063, 6.3633711038334955, 0.5284892457339021, 0.17875, 24.406340722705202], ws=[22.533369836547063, 6.3633711038334955, 0.5284892457339021, 0.34390624999999997, 24.133099233024943], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.2732414896802595], res_norm=3.193e-01
2026-01-13 16:43:25,697 - INFO - integration_test - Dyn residual k=2: pred=[22.563068542465384, 6.380711863755357, 0.5284892457339021, 0.34390624999999997, 24.167489858024943], ws=[22.563068542465384, 6.380711863755357, 0.5284892457339021, 0.48841796875, 24.436129536055248], res=[0.0, 0.0, 0.0, -0.14451171875000002, -0.2686396780303042], res_norm=3.050e-01
2026-01-13 16:43:25,711 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:25,781 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:25,796 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:25,808 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:25,823 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:25,835 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:25,850 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:25,861 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:25,876 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:25,888 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:25,902 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:25,914 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:25,928 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:25,941 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:25,956 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:25,967 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:25,982 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:25,993 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:26,008 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:26,018 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:26,031 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:26,041 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:26,209 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:26,209 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:26,209 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:26,209 - ERROR - integration_test -   Current position: (22.519, 6.355)
2026-01-13 16:43:26,209 - ERROR - integration_test -   Position 5 steps ago: (22.523, 6.357)
2026-01-13 16:43:26,209 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:26,209 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:27,174 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.211)
2026-01-13 16:43:27,175 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:27,175 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:27,175 - INFO - integration_test -   Control dict from planner: {'a': -2.8217445761981333e-08, 'w': -0.1355708388151053}
2026-01-13 16:43:27,175 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:27,175 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:27,176 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:27,176 - INFO - integration_test - Step 200 completed in 1.616s
2026-01-13 16:43:27,193 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:43:27,197 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25179301e+01  6.35436387e+00  5.14932162e-01 -1.00000086e-02
  2.42100002e+01]
2026-01-13 16:43:27,198 - DEBUG - integration_test - Step 201: Using propagated spline 24.2100 (close to path, dist=0.519m, drift=0.022m)
2026-01-13 16:43:27,198 - DEBUG - integration_test -   Set spline state to 24.2100
2026-01-13 16:43:27,199 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:27,266 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.518, 6.354), path_start=(0.000, 0.000), dist=23.397m
2026-01-13 16:43:27,266 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.397m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:43:27,266 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:27,320 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:27,330 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:27,330 - INFO - integration_test - Warmstart k=0: x0=22.5179301339199 , y0=6.3543638742809 , psi0=0.5149321618523915 , v0=-0.01000000856601438 , spline0=24.361515332939746 , a0=0.0 , w0=0.0
2026-01-13 16:43:27,330 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:27,331 - INFO - integration_test - Dyn residual k=0: pred=[22.51705980704143, 6.353871398050188, 0.5149321618523915, -0.01000000856601438, 24.360515332083143], ws=[22.517059807786953, 6.353871398472044, 0.5149321618523914, 0.17875, 24.38732900339528], res=[-7.455227546415699e-10, -4.218554394697094e-10, 1.1102230246251565e-16, -0.18875000856601437, -0.02681367131213719], res_norm=1.906e-01
2026-01-13 16:43:27,332 - INFO - integration_test - Dyn residual k=1: pred=[22.532616887413386, 6.362674403555356, 0.5149321618523914, 0.17875, 24.40520400339528], ws=[22.532616887413386, 6.362674403555356, 0.5149321618523914, 0.34390624999999997, 24.131810694567083], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.27339330882819723], res_norm=3.194e-01
2026-01-13 16:43:27,333 - INFO - integration_test - Dyn residual k=2: pred=[22.562547947079278, 6.379610954419318, 0.5149321618523914, 0.34390624999999997, 24.166201319567083], ws=[22.562547947079278, 6.379610954419318, 0.5149321618523914, 0.48841796875, 24.434840997597387], res=[0.0, 0.0, 0.0, -0.14451171875000002, -0.2686396780303042], res_norm=3.050e-01
2026-01-13 16:43:27,347 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:27,418 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:27,434 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:27,446 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:27,462 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:27,474 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:27,488 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:27,500 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:27,515 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:27,526 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:27,542 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:27,553 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:27,568 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:27,579 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:27,594 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:27,605 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:27,620 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:27,632 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:27,647 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:27,657 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:27,670 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:27,680 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:27,803 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:27,803 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:27,804 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:27,804 - ERROR - integration_test -   Current position: (22.518, 6.354)
2026-01-13 16:43:27,804 - ERROR - integration_test -   Position 5 steps ago: (22.522, 6.357)
2026-01-13 16:43:27,804 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:27,804 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:28,760 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.210)
2026-01-13 16:43:28,760 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:28,761 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:28,761 - INFO - integration_test -   Control dict from planner: {'a': 3.088382589405966e-08, 'w': 0.15310958848899625}
2026-01-13 16:43:28,761 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:28,761 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:28,762 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:28,763 - INFO - integration_test - Step 200 completed in 1.566s
2026-01-13 16:43:28,780 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:43:28,785 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25170636e+01  6.35386475e+00  5.30243121e-01 -1.00000055e-02
  2.42090002e+01]
2026-01-13 16:43:28,786 - DEBUG - integration_test - Step 201: Using propagated spline 24.2090 (close to path, dist=0.519m, drift=0.023m)
2026-01-13 16:43:28,786 - DEBUG - integration_test -   Set spline state to 24.2090
2026-01-13 16:43:28,786 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:28,855 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.517, 6.354), path_start=(0.000, 0.000), dist=23.396m
2026-01-13 16:43:28,855 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.396m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:43:28,855 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:28,907 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:28,916 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:28,916 - INFO - integration_test - Warmstart k=0: x0=22.51706361124709 , y0=6.3538647547295115 , psi0=0.5302431207012912 , v0=-0.010000005477631791 , spline0=24.360515332391984 , a0=0.0 , w0=0.0
2026-01-13 16:43:28,916 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:28,917 - INFO - integration_test - Dyn residual k=0: pred=[22.516200926635147, 6.353359011359962, 0.5302431207012912, -0.010000005477631791, 24.35951533184422], ws=[22.516200927107693, 6.353359011636989, 0.5302431207012912, 0.17875, 24.38619229248082], res=[-4.725464464172546e-10, -2.7702728999656756e-10, 0.0, -0.1887500054776318, -0.026676960636599745], res_norm=1.906e-01
2026-01-13 16:43:28,918 - INFO - integration_test - Dyn residual k=1: pred=[22.5316214060994, 6.362399169415827, 0.5302431207012912, 0.17875, 24.40406729248082], ws=[22.5316214060994, 6.362399169415827, 0.5302431207012912, 0.34390624999999997, 24.130522291275813], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.273545001205008], res_norm=3.195e-01
2026-01-13 16:43:28,919 - INFO - integration_test - Dyn residual k=2: pred=[22.561289652830826, 6.379791990457105, 0.5302431207012912, 0.34390624999999997, 24.164912916275814], ws=[22.561289652830826, 6.379791990457105, 0.5302431207012912, 0.48841796875, 24.433552594306118], res=[0.0, 0.0, 0.0, -0.14451171875000002, -0.2686396780303042], res_norm=3.050e-01
2026-01-13 16:43:28,934 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:29,004 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:29,019 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:29,031 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:29,047 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:29,059 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:29,073 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:29,085 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:29,101 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:29,113 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:29,127 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:29,140 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:29,154 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:29,166 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:29,181 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:29,192 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:29,207 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:29,218 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:29,233 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:29,243 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:29,256 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:29,266 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:29,391 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:29,391 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:29,391 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:29,391 - ERROR - integration_test -   Current position: (22.517, 6.354)
2026-01-13 16:43:29,391 - ERROR - integration_test -   Position 5 steps ago: (22.521, 6.356)
2026-01-13 16:43:29,391 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:29,391 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:30,350 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.209)
2026-01-13 16:43:30,351 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:30,351 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:30,351 - INFO - integration_test -   Control dict from planner: {'a': 1.3505465968715775e-09, 'w': 0.1343034162152655}
2026-01-13 16:43:30,351 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:30,351 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:30,352 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:30,352 - INFO - integration_test - Step 200 completed in 1.568s
2026-01-13 16:43:30,370 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:43:30,373 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25162043e+01  6.35335323e+00  5.43673462e-01 -1.00000053e-02
  2.42080002e+01]
2026-01-13 16:43:30,374 - DEBUG - integration_test - Step 201: Using propagated spline 24.2080 (close to path, dist=0.519m, drift=0.024m)
2026-01-13 16:43:30,374 - DEBUG - integration_test -   Set spline state to 24.2080
2026-01-13 16:43:30,374 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:30,441 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.516, 6.353), path_start=(0.000, 0.000), dist=23.395m
2026-01-13 16:43:30,441 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.395m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:43:30,441 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:30,494 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:30,504 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:30,504 - INFO - integration_test - Warmstart k=0: x0=22.516204348677086 , y0=6.35335323357967 , psi0=0.5436734623228178 , v0=-0.010000005342577131 , spline0=24.359515331857725 , a0=0.0 , w0=0.0
2026-01-13 16:43:30,504 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:30,505 - INFO - integration_test - Dyn residual k=0: pred=[22.515348533980536, 6.3528359500271705, 0.5436734623228178, -0.010000005342577131, 24.358515331323467], ws=[22.515348534437763, 6.352835950303533, 0.5436734623228179, 0.17875, 24.385055622997452], res=[-4.5722714503426687e-10, -2.7636293253863187e-10, -1.1102230246251565e-16, -0.18875000534257713, -0.026540291673985195], res_norm=1.906e-01
2026-01-13 16:43:30,506 - INFO - integration_test - Dyn residual k=1: pred=[22.530646213965678, 6.362082388864474, 0.5436734623228179, 0.17875, 24.402930622997452], ws=[22.530646213965678, 6.362082388864474, 0.5436734623228179, 0.34390624999999997, 24.129233936236677], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.2736966867607755], res_norm=3.197e-01
2026-01-13 16:43:30,506 - INFO - integration_test - Dyn residual k=2: pred=[22.560078200539923, 6.379872084032857, 0.5436734623228179, 0.34390624999999997, 24.163624561236677], ws=[22.560078200539923, 6.379872084032857, 0.5436734623228179, 0.48841796875, 24.43226423926698], res=[0.0, 0.0, 0.0, -0.14451171875000002, -0.2686396780303042], res_norm=3.050e-01
2026-01-13 16:43:30,520 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:30,591 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:30,607 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:30,618 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:30,633 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:30,645 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:30,660 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:30,672 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:30,686 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:30,697 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:30,712 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:30,723 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:30,738 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:30,750 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:30,764 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:30,776 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:30,790 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:30,802 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:30,817 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:30,826 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:30,840 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:30,850 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:31,000 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:31,000 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:31,000 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:31,000 - ERROR - integration_test -   Current position: (22.516, 6.353)
2026-01-13 16:43:31,000 - ERROR - integration_test -   Position 5 steps ago: (22.521, 6.356)
2026-01-13 16:43:31,000 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:31,000 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:31,972 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.208)
2026-01-13 16:43:31,972 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:31,972 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:31,972 - INFO - integration_test -   Control dict from planner: {'a': -3.096729829935517e-08, 'w': -0.3093595673774687}
2026-01-13 16:43:31,972 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:31,972 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:31,973 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:31,974 - INFO - integration_test - Step 200 completed in 1.601s
2026-01-13 16:43:31,992 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:43:31,996 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25153407e+01  6.35284927e+00  5.12737506e-01 -1.00000084e-02
  2.42070002e+01]
2026-01-13 16:43:31,997 - DEBUG - integration_test - Step 201: Using propagated spline 24.2070 (close to path, dist=0.520m, drift=0.025m)
2026-01-13 16:43:31,997 - DEBUG - integration_test -   Set spline state to 24.2070
2026-01-13 16:43:31,998 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:32,065 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.515, 6.353), path_start=(0.000, 0.000), dist=23.394m
2026-01-13 16:43:32,065 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.394m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:43:32,065 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:32,127 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:32,137 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:32,137 - INFO - integration_test - Warmstart k=0: x0=22.515340669654115 , y0=6.35284926912283 , psi0=0.5127375055850709 , v0=-0.01000000843930696 , spline0=24.358515331013795 , a0=0.0 , w0=0.0
2026-01-13 16:43:32,137 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:32,138 - INFO - integration_test - Dyn residual k=0: pred=[22.51446926406748, 6.352358704151148, 0.5127375055850709, -0.01000000843930696, 24.357515330169864], ws=[22.514469264802884, 6.352358704565151, 0.5127375055850711, 0.17875, 24.383918933147182], res=[-7.354046260843461e-10, -4.1400305406114057e-10, -2.220446049250313e-16, -0.18875000843930695, -0.02640360297731803], res_norm=1.906e-01
2026-01-13 16:43:32,139 - INFO - integration_test - Dyn residual k=1: pred=[22.53004562651864, 6.361127546033669, 0.5127375055850711, 0.17875, 24.401793933147182], ws=[22.53004562651864, 6.361127546033669, 0.5127375055850711, 0.34390624999999997, 24.127945435580937], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.2738484975662452], res_norm=3.198e-01
2026-01-13 16:43:32,139 - INFO - integration_test - Dyn residual k=2: pred=[22.560013783980505, 6.37799836777511, 0.5127375055850711, 0.34390624999999997, 24.162336060580937], ws=[22.560013783980505, 6.37799836777511, 0.5127375055850711, 0.48841796875, 24.43097573861124], res=[0.0, 0.0, 0.0, -0.14451171875000002, -0.2686396780303042], res_norm=3.050e-01
2026-01-13 16:43:32,154 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:32,223 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:32,239 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:32,250 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:32,265 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:32,277 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:32,292 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:32,303 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:32,318 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:32,329 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:32,345 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:32,357 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:32,371 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:32,383 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:32,397 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:32,408 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:32,423 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:32,435 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:32,450 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:32,460 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:32,473 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:32,483 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:32,610 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:32,610 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:32,610 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:32,610 - ERROR - integration_test -   Current position: (22.515, 6.353)
2026-01-13 16:43:32,610 - ERROR - integration_test -   Position 5 steps ago: (22.520, 6.355)
2026-01-13 16:43:32,610 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:32,610 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:33,595 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.207)
2026-01-13 16:43:33,596 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:33,596 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:33,596 - INFO - integration_test -   Control dict from planner: {'a': 4.011922769858642e-09, 'w': 0.16710583846888719}
2026-01-13 16:43:33,596 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:33,596 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:33,597 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:33,598 - INFO - integration_test - Step 200 completed in 1.602s
2026-01-13 16:43:33,616 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:43:33,619 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25144734e+01  6.35235145e+00  5.29448089e-01 -1.00000080e-02
  2.42060002e+01]
2026-01-13 16:43:33,620 - DEBUG - integration_test - Step 201: Using propagated spline 24.2060 (close to path, dist=0.520m, drift=0.026m)
2026-01-13 16:43:33,620 - DEBUG - integration_test -   Set spline state to 24.2060
2026-01-13 16:43:33,621 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:33,687 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.514, 6.352), path_start=(0.000, 0.000), dist=23.393m
2026-01-13 16:43:33,687 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.393m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:43:33,687 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:33,739 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:33,748 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:33,748 - INFO - integration_test - Warmstart k=0: x0=22.514473403358167 , y0=6.352351446313405 , psi0=0.5294480894319596 , v0=-0.010000008038114683 , spline0=24.357515330209985 , a0=0.0 , w0=0.0
2026-01-13 16:43:33,748 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:33,749 - INFO - integration_test - Dyn residual k=0: pred=[22.51361031671612, 6.35184638883554, 0.5294480894319596, -0.010000008038114683, 24.356515329406175], ws=[22.51361031740988, 6.351846389241511, 0.5294480894319595, 0.17875, 24.38278222796347], res=[-6.937597163414466e-10, -4.0597125661179234e-10, 1.1102230246251565e-16, -0.18875000803811467, -0.026266898557295804], res_norm=1.906e-01
2026-01-13 16:43:33,750 - INFO - integration_test - Dyn residual k=1: pred=[22.5290379787355, 6.360874284401627, 0.5294480894319595, 0.17875, 24.40065722796347], ws=[22.5290379787355, 6.360874284401627, 0.5294480894319595, 0.34390624999999997, 24.126657056268414], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.2740001716950573], res_norm=3.199e-01
2026-01-13 16:43:33,751 - INFO - integration_test - Dyn residual k=2: pred=[22.55872004392578, 6.378243512764751, 0.5294480894319595, 0.34390624999999997, 24.161047681268414], ws=[22.55872004392578, 6.378243512764751, 0.5294480894319595, 0.48841796875, 24.42968735929872], res=[0.0, 0.0, 0.0, -0.14451171875000002, -0.2686396780303042], res_norm=3.050e-01
2026-01-13 16:43:33,764 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:33,833 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:33,849 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:33,860 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:33,875 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:33,887 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:33,902 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:33,914 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:33,929 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:33,941 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:33,956 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:33,968 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:33,982 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:33,994 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:34,009 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:34,020 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:34,035 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:34,047 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:34,062 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:34,072 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:34,085 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:34,095 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:34,224 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:34,224 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:34,224 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:34,224 - ERROR - integration_test -   Current position: (22.514, 6.352)
2026-01-13 16:43:34,224 - ERROR - integration_test -   Position 5 steps ago: (22.519, 6.355)
2026-01-13 16:43:34,224 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:34,224 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:35,206 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.206)
2026-01-13 16:43:35,206 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:35,206 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:35,206 - INFO - integration_test -   Control dict from planner: {'a': 1.7961619908436993e-08, 'w': 0.13650983512728232}
2026-01-13 16:43:35,207 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:35,207 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:35,208 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:35,208 - INFO - integration_test - Step 200 completed in 1.589s
2026-01-13 16:43:35,227 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:43:35,234 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25136138e+01  6.35184051e+00  5.43099073e-01 -1.00000062e-02
  2.42050002e+01]
2026-01-13 16:43:35,235 - DEBUG - integration_test - Step 201: Using propagated spline 24.2050 (close to path, dist=0.520m, drift=0.027m)
2026-01-13 16:43:35,236 - DEBUG - integration_test -   Set spline state to 24.2050
2026-01-13 16:43:35,236 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:35,302 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.514, 6.352), path_start=(0.000, 0.000), dist=23.392m
2026-01-13 16:43:35,302 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.392m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:43:35,302 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:35,356 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:35,365 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:35,365 - INFO - integration_test - Warmstart k=0: x0=22.513613790811018 , y0=6.3518405136683596 , psi0=0.5430990729446878 , v0=-0.010000006241952691 , spline0=24.35651532958579 , a0=0.0 , w0=0.0
2026-01-13 16:43:35,365 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:35,366 - INFO - integration_test - Dyn residual k=0: pred=[22.512757679056488, 6.351323721725557, 0.5430990729446878, -0.010000006241952691, 24.355515328961594], ws=[22.512757679590866, 6.351323722048137, 0.5430990729446878, 0.17875, 24.38164557009044], res=[-5.343778752830985e-10, -3.225792966077279e-10, 0.0, -0.18875000624195268, -0.026130241128846876], res_norm=1.906e-01
2026-01-13 16:43:35,367 - INFO - integration_test - Dyn residual k=1: pred=[22.528060667651054, 6.360561372259623, 0.5430990729446878, 0.17875, 24.39952057009044], ws=[22.528060667651054, 6.360561372259623, 0.5430990729446878, 0.34390624999999997, 24.12536872945313], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.27415184063731246], res_norm=3.201e-01
2026-01-13 16:43:35,368 - INFO - integration_test - Dyn residual k=2: pred=[22.557502867581537, 6.378334159073854, 0.5430990729446878, 0.34390624999999997, 24.15975935445313], ws=[22.557502867581537, 6.378334159073854, 0.5430990729446878, 0.48841796875, 24.428399032483433], res=[0.0, 0.0, 0.0, -0.14451171875000002, -0.2686396780303042], res_norm=3.050e-01
2026-01-13 16:43:35,381 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:35,452 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:35,467 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:35,478 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:35,493 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:35,505 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:35,520 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:35,532 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:35,547 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:35,558 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:35,573 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:35,585 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:35,600 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:35,611 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:35,626 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:35,638 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:35,653 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:35,664 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:35,679 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:35,689 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:35,701 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:35,711 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:35,876 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:35,876 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:35,876 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:35,876 - ERROR - integration_test -   Current position: (22.514, 6.352)
2026-01-13 16:43:35,876 - ERROR - integration_test -   Position 5 steps ago: (22.518, 6.354)
2026-01-13 16:43:35,876 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:35,877 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:36,865 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.205)
2026-01-13 16:43:36,865 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:36,865 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:36,865 - INFO - integration_test -   Control dict from planner: {'a': -2.4809104602892625e-08, 'w': -0.2443403691090604}
2026-01-13 16:43:36,865 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:36,865 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:36,866 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:36,867 - INFO - integration_test - Step 200 completed in 1.632s
2026-01-13 16:43:36,885 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:43:36,887 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25127515e+01  6.35133423e+00  5.18665036e-01 -1.00000087e-02
  2.42040002e+01]
2026-01-13 16:43:36,888 - DEBUG - integration_test - Step 201: Using propagated spline 24.2040 (close to path, dist=0.520m, drift=0.028m)
2026-01-13 16:43:36,888 - DEBUG - integration_test -   Set spline state to 24.2040
2026-01-13 16:43:36,889 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:36,955 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.513, 6.351), path_start=(0.000, 0.000), dist=23.392m
2026-01-13 16:43:36,955 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.392m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:43:36,955 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:37,007 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:37,017 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:37,017 - INFO - integration_test - Warmstart k=0: x0=22.5127514507903 , y0=6.351334231697055 , psi0=0.5186650360337818 , v0=-0.01000000872286315 , spline0=24.1534951266933 , a0=0.0 , w0=0.0
2026-01-13 16:43:37,017 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:37,018 - INFO - integration_test - Dyn residual k=0: pred=[22.511882968309457, 6.350838510076542, 0.5186650360337818, -0.01000000872286315, 24.152495125821016], ws=[22.511882969067024, 6.350838510508953, 0.5186650360337817, 0.17875, 24.38050890351434], res=[-7.575664540127036e-10, -4.3241055180942567e-10, 1.1102230246251565e-16, -0.18875000872286316, -0.22801377769332376], res_norm=2.960e-01
2026-01-13 16:43:37,019 - INFO - integration_test - Dyn residual k=1: pred=[22.52740707987061, 6.35969952674627, 0.5186650360337817, 0.17875, 24.39838390351434], ws=[22.52740707987061, 6.35969952674627, 0.5186650360337817, 0.34390624999999997, 24.1240803143924], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.27430358912193853], res_norm=3.202e-01
2026-01-13 16:43:37,019 - INFO - integration_test - Dyn residual k=2: pred=[22.5572747091352, 6.376747688230828, 0.5186650360337817, 0.34390624999999997, 24.1584709393924], ws=[22.5572747091352, 6.376747688230828, 0.5186650360337817, 0.48841796875, 24.427110617422706], res=[0.0, 0.0, 0.0, -0.14451171875000002, -0.2686396780303042], res_norm=3.050e-01
2026-01-13 16:43:37,033 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:37,103 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:37,123 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:37,135 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:37,150 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:37,162 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:37,176 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:37,187 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:37,202 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:37,213 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:37,227 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:37,239 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:37,254 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:37,266 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:37,281 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:37,292 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:37,306 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:37,318 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:37,333 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:37,343 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:37,355 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:37,365 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:37,491 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:37,491 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:37,491 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:37,491 - ERROR - integration_test -   Current position: (22.513, 6.351)
2026-01-13 16:43:37,491 - ERROR - integration_test -   Position 5 steps ago: (22.517, 6.354)
2026-01-13 16:43:37,491 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:37,491 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:38,512 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.204)
2026-01-13 16:43:38,512 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:38,512 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:38,512 - INFO - integration_test -   Control dict from planner: {'a': 9.943660517886833e-09, 'w': 0.15808728314150763}
2026-01-13 16:43:38,512 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:38,512 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:38,514 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:38,514 - INFO - integration_test - Step 200 completed in 1.627s
2026-01-13 16:43:38,533 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:43:38,539 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25118869e+01  6.35083167e+00  5.34473764e-01 -1.00000077e-02
  2.42030002e+01]
2026-01-13 16:43:38,540 - DEBUG - integration_test - Step 201: Using propagated spline 24.2030 (close to path, dist=0.521m, drift=0.029m)
2026-01-13 16:43:38,540 - DEBUG - integration_test -   Set spline state to 24.2030
2026-01-13 16:43:38,541 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:38,607 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.512, 6.351), path_start=(0.000, 0.000), dist=23.391m
2026-01-13 16:43:38,607 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.391m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:43:38,607 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:38,661 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:38,670 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:38,670 - INFO - integration_test - Warmstart k=0: x0=22.511886922809104 , y0=6.3508316660906665 , psi0=0.5344737643479326 , v0=-0.0100000077284971 , spline0=24.152495125920453 , a0=0.0 , w0=0.0
2026-01-13 16:43:38,670 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:38,671 - INFO - integration_test - Dyn residual k=0: pred=[22.51102638533736, 6.350322277432153, 0.5344737643479326, -0.0100000077284971, 24.1514951251476], ws=[22.511026386002424, 6.350322277825834, 0.5344737643479327, 0.17875, 24.37937223333077], res=[-6.65064447957775e-10, -3.93680643639982e-10, -1.1102230246251565e-16, -0.1887500077284971, -0.22787710818316853], res_norm=2.959e-01
2026-01-13 16:43:38,672 - INFO - integration_test - Dyn residual k=1: pred=[22.526408481421825, 6.359427593059722, 0.5344737643479327, 0.17875, 24.39724723333077], ws=[22.526408481421825, 6.359427593059722, 0.5344737643479327, 0.34390624999999997, 24.122791991901206], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.274455241429564], res_norm=3.203e-01
2026-01-13 16:43:38,673 - INFO - integration_test - Dyn residual k=2: pred=[22.556002880039046, 6.376945773854992, 0.5344737643479327, 0.34390624999999997, 24.157182616901206], ws=[22.556002880039046, 6.376945773854992, 0.5344737643479327, 0.48841796875, 24.42582229493151], res=[0.0, 0.0, 0.0, -0.14451171875000002, -0.2686396780303042], res_norm=3.050e-01
2026-01-13 16:43:38,687 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:38,757 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:38,772 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:38,784 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:38,798 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:38,810 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:38,825 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:38,837 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:38,851 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:38,863 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:38,878 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:38,889 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:38,904 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:38,915 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:38,929 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:38,941 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:38,956 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:38,967 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:38,982 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:38,992 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:39,005 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:39,015 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:39,143 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:39,143 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:39,143 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:39,143 - ERROR - integration_test -   Current position: (22.512, 6.351)
2026-01-13 16:43:39,143 - ERROR - integration_test -   Position 5 steps ago: (22.516, 6.353)
2026-01-13 16:43:39,143 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:39,143 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:40,139 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.203)
2026-01-13 16:43:40,139 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:40,139 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:40,139 - INFO - integration_test -   Control dict from planner: {'a': 1.6760957865750393e-09, 'w': 0.13774384039149473}
2026-01-13 16:43:40,139 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:40,139 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:40,140 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:40,141 - INFO - integration_test - Step 200 completed in 1.602s
2026-01-13 16:43:40,160 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:43:40,164 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25110299e+01  6.35031637e+00  5.48248148e-01 -1.00000076e-02
  2.42020002e+01]
2026-01-13 16:43:40,165 - DEBUG - integration_test - Step 201: Using propagated spline 24.2020 (close to path, dist=0.521m, drift=0.030m)
2026-01-13 16:43:40,165 - DEBUG - integration_test -   Set spline state to 24.2020
2026-01-13 16:43:40,166 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:40,233 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.511, 6.350), path_start=(0.000, 0.000), dist=23.390m
2026-01-13 16:43:40,233 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.390m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:43:40,233 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:40,286 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:40,296 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:40,296 - INFO - integration_test - Warmstart k=0: x0=22.51102992075845 , y0=6.350316366951256 , psi0=0.548248148387082 , v0=-0.01000000756088752 , spline0=24.15149512516436 , a0=0.0 , w0=0.0
2026-01-13 16:43:40,296 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:40,297 - INFO - integration_test - Dyn residual k=0: pred=[22.51017648122931, 6.349795173626012, 0.548248148387082, -0.01000000756088752, 24.15049512440827], ws=[22.510176481874584, 6.3497951740200795, 0.5482481483870822, 0.17875, 24.37823558807003], res=[-6.452758327668562e-10, -3.9406788943097126e-10, -2.220446049250313e-16, -0.1887500075608875, -0.22774046366176037], res_norm=2.958e-01
2026-01-13 16:43:40,298 - INFO - integration_test - Dyn residual k=1: pred=[22.52543170192366, 6.359111497664857, 0.5482481483870822, 0.17875, 24.39611058807003], ws=[22.52543170192366, 6.359111497664857, 0.5482481483870822, 0.34390624999999997, 24.12150368190408], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.27460690616594974], res_norm=3.204e-01
2026-01-13 16:43:40,298 - INFO - integration_test - Dyn residual k=2: pred=[22.554781998539063, 6.377035648313595, 0.5482481483870822, 0.34390624999999997, 24.15589430690408], ws=[22.554781998539063, 6.377035648313595, 0.5482481483870822, 0.48841796875, 24.424533984934385], res=[0.0, 0.0, 0.0, -0.14451171875000002, -0.2686396780303042], res_norm=3.050e-01
2026-01-13 16:43:40,312 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:40,383 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:40,399 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:40,410 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:40,426 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:40,438 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:40,452 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:40,464 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:40,478 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:40,490 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:40,505 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:40,516 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:40,531 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:40,542 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:40,557 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:40,569 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:40,584 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:40,595 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:40,610 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:40,620 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:40,633 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:40,643 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:40,770 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:40,770 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:40,770 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:40,770 - ERROR - integration_test -   Current position: (22.511, 6.350)
2026-01-13 16:43:40,770 - ERROR - integration_test -   Position 5 steps ago: (22.515, 6.353)
2026-01-13 16:43:40,770 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:40,770 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:41,787 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.202)
2026-01-13 16:43:41,788 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:41,788 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:41,788 - INFO - integration_test -   Control dict from planner: {'a': 4.61383606647253e-10, 'w': 0.1153371484345327}
2026-01-13 16:43:41,788 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:41,788 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:41,789 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:41,789 - INFO - integration_test - Step 200 completed in 1.625s
2026-01-13 16:43:41,808 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:43:41,811 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25101795e+01  6.34979026e+00  5.59781863e-01 -1.00000075e-02
  2.42010002e+01]
2026-01-13 16:43:41,813 - DEBUG - integration_test - Step 201: Using propagated spline 24.2010 (close to path, dist=0.521m, drift=0.031m)
2026-01-13 16:43:41,813 - DEBUG - integration_test -   Set spline state to 24.2010
2026-01-13 16:43:41,814 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:41,881 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.510, 6.350), path_start=(0.000, 0.000), dist=23.389m
2026-01-13 16:43:41,881 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.389m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:43:41,881 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:41,936 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:41,945 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:41,946 - INFO - integration_test - Warmstart k=0: x0=22.510179505767105 , y0=6.349790263573053 , psi0=0.5597818632305352 , v0=-0.01000000751474916 , spline0=24.150495124412885 , a0=0.0 , w0=0.0
2026-01-13 16:43:41,946 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:41,947 - INFO - integration_test - Dyn residual k=0: pred=[22.509332134168233, 6.349259261806227, 0.5597818632305352, -0.01000000751474916, 24.14949512366141], ws=[22.50933213480501, 6.349259262205261, 0.5597818632305351, 0.17875, 24.377098920455555], res=[-6.367777416471654e-10, -3.9903369497551466e-10, 1.1102230246251565e-16, -0.18875000751474916, -0.22760379679414555], res_norm=2.957e-01
2026-01-13 16:43:41,948 - INFO - integration_test - Dyn residual k=1: pred=[22.524478890752476, 6.358750911654536, 0.5597818632305351, 0.17875, 24.394973920455556], ws=[22.524478890752476, 6.358750911654536, 0.5597818632305351, 0.34390624999999997, 24.12021530134983], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.2747586191057252], res_norm=3.206e-01
2026-01-13 16:43:41,948 - INFO - integration_test - Dyn residual k=2: pred=[22.55362050774581, 6.377012380568745, 0.5597818632305351, 0.34390624999999997, 24.15460592634983], ws=[22.55362050774581, 6.377012380568745, 0.5597818632305351, 0.48841796875, 24.423245604380135], res=[0.0, 0.0, 0.0, -0.14451171875000002, -0.2686396780303042], res_norm=3.050e-01
2026-01-13 16:43:41,962 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:42,032 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:42,048 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:42,059 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:42,076 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:42,088 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:42,103 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:42,115 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:42,135 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:42,148 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:42,163 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:42,175 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:42,190 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:42,202 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:42,217 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:42,228 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:42,244 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:42,256 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:42,271 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:42,281 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:42,294 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:42,304 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:42,480 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:42,481 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:42,481 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:42,481 - ERROR - integration_test -   Current position: (22.510, 6.350)
2026-01-13 16:43:42,481 - ERROR - integration_test -   Position 5 steps ago: (22.514, 6.352)
2026-01-13 16:43:42,481 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:42,481 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:43,490 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.201)
2026-01-13 16:43:43,490 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:43,490 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:43,490 - INFO - integration_test -   Control dict from planner: {'a': -1.6556309442057914e-08, 'w': -0.46599292421356764}
2026-01-13 16:43:43,490 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:43,490 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:43,491 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:43,492 - INFO - integration_test - Step 200 completed in 1.681s
2026-01-13 16:43:43,509 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:43:43,514 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25093201e+01  6.34927919e+00  5.13182571e-01 -1.00000092e-02
  2.42000002e+01]
2026-01-13 16:43:43,514 - DEBUG - integration_test - Step 201: Using propagated spline 24.2000 (close to path, dist=0.522m, drift=0.032m)
2026-01-13 16:43:43,514 - DEBUG - integration_test -   Set spline state to 24.2000
2026-01-13 16:43:43,515 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:43,582 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.509, 6.349), path_start=(0.000, 0.000), dist=23.388m
2026-01-13 16:43:43,582 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.388m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:43:43,582 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:43,636 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:43,645 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:43,645 - INFO - integration_test - Warmstart k=0: x0=22.50932007082449 , y0=6.349279193806622 , psi0=0.5131825708091785 , v0=-0.010000009170380105 , spline0=24.149495123495846 , a0=0.0 , w0=0.0
2026-01-13 16:43:43,645 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:43,647 - INFO - integration_test - Dyn residual k=0: pred=[22.50844888359387, 6.348788241015325, 0.5131825708091785, -0.010000009170380105, 24.148495122578808], ws=[22.50844888439278, 6.348788241465547, 0.5131825708091786, 0.17875, 24.37596226116147], res=[-7.98909383092905e-10, -4.50222081838092e-10, -1.1102230246251565e-16, -0.1887500091703801, -0.22746713858266077], res_norm=2.956e-01
2026-01-13 16:43:43,648 - INFO - integration_test - Dyn residual k=1: pred=[22.524021341859562, 6.357564014562275, 0.5131825708091786, 0.17875, 24.39383726116147], ws=[22.524021341859562, 6.357564014562275, 0.5131825708091786, 0.34390624999999997, 24.118926915062445], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.27491034609902343], res_norm=3.207e-01
2026-01-13 16:43:43,648 - INFO - integration_test - Dyn residual k=2: pred=[22.553981987737526, 6.374448172417081, 0.5131825708091786, 0.34390624999999997, 24.153317540062446], ws=[22.553981987737526, 6.374448172417081, 0.5131825708091786, 0.48841796875, 24.42195721809275], res=[0.0, 0.0, 0.0, -0.14451171875000002, -0.2686396780303042], res_norm=3.050e-01
2026-01-13 16:43:43,662 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:43,732 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:43,747 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:43,758 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:43,773 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:43,785 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:43,800 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:43,811 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:43,826 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:43,838 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:43,852 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:43,864 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:43,878 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:43,890 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:43,904 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:43,916 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:43,931 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:43,943 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:43,958 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:43,968 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:43,981 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:43,990 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:44,116 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:44,116 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:44,116 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:44,116 - ERROR - integration_test -   Current position: (22.509, 6.349)
2026-01-13 16:43:44,116 - ERROR - integration_test -   Position 5 steps ago: (22.514, 6.352)
2026-01-13 16:43:44,116 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:44,117 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:45,130 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.200)
2026-01-13 16:43:45,130 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:45,131 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:45,131 - INFO - integration_test -   Control dict from planner: {'a': 1.2746263780848653e-08, 'w': 0.16600955747854307}
2026-01-13 16:43:45,131 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:45,131 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:45,132 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:45,132 - INFO - integration_test - Step 200 completed in 1.619s
2026-01-13 16:43:45,150 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:43:45,153 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25084530e+01  6.34878103e+00  5.29783527e-01 -1.00000079e-02
  2.41990002e+01]
2026-01-13 16:43:45,154 - DEBUG - integration_test - Step 201: Using propagated spline 24.1990 (close to path, dist=0.522m, drift=0.033m)
2026-01-13 16:43:45,154 - DEBUG - integration_test -   Set spline state to 24.1990
2026-01-13 16:43:45,155 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:45,221 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.508, 6.349), path_start=(0.000, 0.000), dist=23.387m
2026-01-13 16:43:45,221 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.387m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:43:45,221 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:45,275 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:45,285 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:45,285 - INFO - integration_test - Warmstart k=0: x0=22.508452998712993 , y0=6.348781032493064 , psi0=0.5297835265570328 , v0=-0.010000007895753726 , spline0=24.148495122706272 , a0=0.0 , w0=0.0
2026-01-13 16:43:45,285 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:45,286 - INFO - integration_test - Dyn residual k=0: pred=[22.507590081546816, 6.348275685539511, 0.5297835265570328, -0.010000007895753726, 24.1474951219167], ws=[22.507590082228152, 6.348275685938519, 0.5297835265570328, 0.17875, 24.374825587838046], res=[-6.813358766066813e-10, -3.9900882597976306e-10, 0.0, -0.18875000789575372, -0.22733046592134798], res_norm=2.955e-01
2026-01-13 16:43:45,287 - INFO - integration_test - Dyn residual k=1: pred=[22.523014714394684, 6.357308755600998, 0.5297835265570328, 0.17875, 24.392700587838046], ws=[22.523014714394684, 6.357308755600998, 0.5297835265570328, 0.34390624999999997, 24.1176386053478], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.2750619824902465], res_norm=3.208e-01
2026-01-13 16:43:45,287 - INFO - integration_test - Dyn residual k=2: pred=[22.552690951631167, 6.3746879394533735, 0.5297835265570328, 0.34390624999999997, 24.1520292303478], ws=[22.552690951631167, 6.3746879394533735, 0.5297835265570328, 0.48841796875, 24.420668908378104], res=[0.0, 0.0, 0.0, -0.14451171875000002, -0.2686396780303042], res_norm=3.050e-01
2026-01-13 16:43:45,301 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:45,372 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:45,387 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:45,398 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:45,413 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:45,425 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:45,440 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:45,452 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:45,466 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:45,478 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:45,493 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:45,504 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:45,519 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:45,531 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:45,546 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:45,557 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:45,572 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:45,583 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:45,598 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:45,608 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:45,621 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:45,631 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:45,757 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:45,757 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:45,757 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:45,757 - ERROR - integration_test -   Current position: (22.508, 6.349)
2026-01-13 16:43:45,757 - ERROR - integration_test -   Position 5 steps ago: (22.513, 6.351)
2026-01-13 16:43:45,757 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:45,757 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:46,780 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.199)
2026-01-13 16:43:46,780 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:46,780 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:46,780 - INFO - integration_test -   Control dict from planner: {'a': 1.817432168879789e-09, 'w': 0.1446015626837242}
2026-01-13 16:43:46,780 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:46,780 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:46,781 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:46,782 - INFO - integration_test - Step 200 completed in 1.629s
2026-01-13 16:43:46,799 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:43:46,802 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25075938e+01  6.34826946e+00  5.44243683e-01 -1.00000077e-02
  2.41980002e+01]
2026-01-13 16:43:46,803 - DEBUG - integration_test - Step 201: Using propagated spline 24.1980 (close to path, dist=0.522m, drift=0.034m)
2026-01-13 16:43:46,803 - DEBUG - integration_test -   Set spline state to 24.1980
2026-01-13 16:43:46,804 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:46,870 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.508, 6.348), path_start=(0.000, 0.000), dist=23.386m
2026-01-13 16:43:46,870 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.386m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:43:46,870 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:46,921 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:46,931 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:46,931 - INFO - integration_test - Warmstart k=0: x0=22.507593765260683 , y0=6.348269464305177 , psi0=0.5442436828254051 , v0=-0.010000007714010509 , spline0=24.147495121934874 , a0=0.0 , w0=0.0
2026-01-13 16:43:46,931 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:46,932 - INFO - integration_test - Dyn residual k=0: pred=[22.50673824546606, 6.347751692710929, 0.5442436828254051, -0.010000007714010509, 24.146495121163472], ws=[22.50673824612601, 6.347751693110339, 0.5442436828254049, 0.17875, 24.37368895764306], res=[-6.599485402603023e-10, -3.994093944470478e-10, 2.220446049250313e-16, -0.18875000771401051, -0.22719383647958935], res_norm=2.954e-01
2026-01-13 16:43:46,933 - INFO - integration_test - Dyn residual k=1: pred=[22.522030650658333, 6.357006853218069, 0.5442436828254049, 0.17875, 24.39156395764306], ws=[22.522030650658333, 6.357006853218069, 0.5442436828254049, 0.34390624999999997, 24.116350340216886], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.275213617426175], res_norm=3.210e-01
2026-01-13 16:43:46,934 - INFO - integration_test - Dyn residual k=2: pred=[22.551452488399285, 6.374813328215547, 0.5442436828254049, 0.34390624999999997, 24.150740965216887], ws=[22.551452488399285, 6.374813328215547, 0.5442436828254049, 0.48841796875, 24.41938064324719], res=[0.0, 0.0, 0.0, -0.14451171875000002, -0.2686396780303042], res_norm=3.050e-01
2026-01-13 16:43:46,948 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:47,017 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:47,033 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:47,044 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:47,060 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:47,071 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:47,086 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:47,098 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:47,112 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:47,124 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:47,144 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:47,157 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:47,172 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:47,184 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:47,199 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:47,210 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:47,225 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:47,238 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:47,255 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:47,266 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:47,280 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:47,290 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:47,420 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:47,420 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:47,420 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:47,420 - ERROR - integration_test -   Current position: (22.508, 6.348)
2026-01-13 16:43:47,420 - ERROR - integration_test -   Position 5 steps ago: (22.512, 6.351)
2026-01-13 16:43:47,420 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:47,420 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:48,450 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.198)
2026-01-13 16:43:48,450 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:48,450 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:48,450 - INFO - integration_test -   Control dict from planner: {'a': 4.096933556801431e-09, 'w': 0.11487525056794451}
2026-01-13 16:43:48,450 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:48,450 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:48,452 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:48,452 - INFO - integration_test - Step 200 completed in 1.650s
2026-01-13 16:43:48,472 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:43:48,475 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25067412e+01  6.34774679e+00  5.55731208e-01 -1.00000073e-02
  2.41970002e+01]
2026-01-13 16:43:48,476 - DEBUG - integration_test - Step 201: Using propagated spline 24.1970 (close to path, dist=0.523m, drift=0.035m)
2026-01-13 16:43:48,476 - DEBUG - integration_test -   Set spline state to 24.1970
2026-01-13 16:43:48,477 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:48,546 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.507, 6.348), path_start=(0.000, 0.000), dist=23.385m
2026-01-13 16:43:48,547 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.385m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:43:48,547 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:48,603 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:48,613 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:48,613 - INFO - integration_test - Warmstart k=0: x0=22.506741238223942 , y0=6.347746790260892 , psi0=0.5557312078821995 , v0=-0.010000007304317153 , spline0=24.14649512120444 , a0=0.0 , w0=0.0
2026-01-13 16:43:48,613 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:48,614 - INFO - integration_test - Dyn residual k=0: pred=[22.505891722695427, 6.3472192252623625, 0.5557312078821995, -0.010000007304317153, 24.145495120474006], ws=[22.505891723315937, 6.347219225647712, 0.5557312078821997, 0.17875, 24.372552317288378], res=[-6.205098657119379e-10, -3.8534953006319483e-10, -1.1102230246251565e-16, -0.18875000730431715, -0.2270571968143713], res_norm=2.953e-01
2026-01-13 16:43:48,615 - INFO - integration_test - Dyn residual k=1: pred=[22.521076802296502, 6.356649443108302, 0.5557312078821997, 0.17875, 24.390427317288378], ws=[22.521076802296502, 6.356649443108302, 0.5557312078821997, 0.34390624999999997, 24.1150620272498], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.2753652900385788], res_norm=3.211e-01
2026-01-13 16:43:48,616 - INFO - integration_test - Dyn residual k=2: pred=[22.550292150929565, 6.374792719883441, 0.5557312078821997, 0.34390624999999997, 24.1494526522498], ws=[22.550292150929565, 6.374792719883441, 0.5557312078821997, 0.48841796875, 24.418092330280103], res=[0.0, 0.0, 0.0, -0.14451171875000002, -0.2686396780303042], res_norm=3.050e-01
2026-01-13 16:43:48,630 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:48,702 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:48,718 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:48,730 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:48,746 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:48,758 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:48,773 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:48,785 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:48,799 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:48,811 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:48,825 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:48,838 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:48,853 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:48,864 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:48,879 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:48,890 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:48,904 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:48,916 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:48,931 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:48,941 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:48,954 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:48,964 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:49,124 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:49,124 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:49,125 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:49,125 - ERROR - integration_test -   Current position: (22.507, 6.348)
2026-01-13 16:43:49,125 - ERROR - integration_test -   Position 5 steps ago: (22.511, 6.350)
2026-01-13 16:43:49,125 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:49,125 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:50,166 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.197)
2026-01-13 16:43:50,167 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:50,167 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:50,167 - INFO - integration_test -   Control dict from planner: {'a': -1.7827514164158188e-08, 'w': -0.31180233676171903}
2026-01-13 16:43:50,167 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:50,167 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:50,168 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:50,168 - INFO - integration_test - Step 200 completed in 1.693s
2026-01-13 16:43:50,187 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:43:50,189 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25058836e+01  6.34723255e+00  5.24550974e-01 -1.00000091e-02
  2.41960002e+01]
2026-01-13 16:43:50,190 - DEBUG - integration_test - Step 201: Using propagated spline 24.1960 (close to path, dist=0.523m, drift=0.036m)
2026-01-13 16:43:50,190 - DEBUG - integration_test -   Set spline state to 24.1960
2026-01-13 16:43:50,191 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:50,258 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.506, 6.347), path_start=(0.000, 0.000), dist=23.384m
2026-01-13 16:43:50,258 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.384m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:43:50,258 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:50,311 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:50,321 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:50,321 - INFO - integration_test - Warmstart k=0: x0=22.505883636128953 , y0=6.34723255366971 , psi0=0.5245509742060276 , v0=-0.01000000908706857 , spline0=24.145495120295735 , a0=0.0 , w0=0.0
2026-01-13 16:43:50,321 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:50,322 - INFO - integration_test - Dyn residual k=0: pred=[22.505018086430475, 6.346731728813219, 0.5245509742060276, -0.01000000908706857, 24.144495119387027], ws=[22.505018087217007, 6.346731729268321, 0.5245509742060275, 0.17875, 24.371415686642678], res=[-7.865317286359641e-10, -4.5510262225434417e-10, 1.1102230246251565e-16, -0.18875000908706857, -0.22692056725565024], res_norm=2.952e-01
2026-01-13 16:43:50,323 - INFO - integration_test - Dyn residual k=1: pred=[22.52048977401807, 6.355683965443142, 0.5245509742060275, 0.17875, 24.389290686642678], ws=[22.52048977401807, 6.355683965443142, 0.5245509742060275, 0.34390624999999997, 24.11377374684784], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.27551693979483716], res_norm=3.212e-01
2026-01-13 16:43:50,324 - INFO - integration_test - Dyn residual k=2: pred=[22.55025654206802, 6.372907629622147, 0.5245509742060275, 0.34390624999999997, 24.14816437184784], ws=[22.55025654206802, 6.372907629622147, 0.5245509742060275, 0.48841796875, 24.416804049878145], res=[0.0, 0.0, 0.0, -0.14451171875000002, -0.2686396780303042], res_norm=3.050e-01
2026-01-13 16:43:50,338 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:50,407 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:50,423 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:50,435 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:50,450 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:50,461 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:50,476 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:50,488 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:50,502 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:50,514 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:50,529 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:50,540 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:50,555 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:50,567 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:50,581 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:50,593 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:50,607 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:50,619 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:50,634 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:50,644 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:50,658 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:50,668 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:50,795 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:50,796 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:50,796 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:50,796 - ERROR - integration_test -   Current position: (22.506, 6.347)
2026-01-13 16:43:50,796 - ERROR - integration_test -   Position 5 steps ago: (22.510, 6.350)
2026-01-13 16:43:50,796 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:50,796 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:51,842 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.196)
2026-01-13 16:43:51,842 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:51,842 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:51,842 - INFO - integration_test -   Control dict from planner: {'a': 1.4072135702069646e-08, 'w': 0.1480589180507151}
2026-01-13 16:43:51,842 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:51,842 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:51,843 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:51,844 - INFO - integration_test - Step 200 completed in 1.655s
2026-01-13 16:43:51,862 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:43:51,867 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25050218e+01  6.34672534e+00  5.39356866e-01 -1.00000077e-02
  2.41950002e+01]
2026-01-13 16:43:51,868 - DEBUG - integration_test - Step 201: Using propagated spline 24.1950 (close to path, dist=0.523m, drift=0.037m)
2026-01-13 16:43:51,868 - DEBUG - integration_test -   Set spline state to 24.1950
2026-01-13 16:43:51,869 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:51,935 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.505, 6.347), path_start=(0.000, 0.000), dist=23.383m
2026-01-13 16:43:51,935 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.383m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:43:51,936 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:51,989 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:51,998 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:51,998 - INFO - integration_test - Warmstart k=0: x0=22.50502182562575 , y0=6.346725339646312 , psi0=0.5393568660110991 , v0=-0.010000007679855 , spline0=24.144495119527747 , a0=0.0 , w0=0.0
2026-01-13 16:43:51,998 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:51,999 - INFO - integration_test - Dyn residual k=0: pred=[22.5041637858045, 6.34621175498813, 0.5393568660110991, -0.010000007679855, 24.143495118759763], ws=[22.50416378646346, 6.346211755382555, 0.539356866011099, 0.17875, 24.37027906230756], res=[-6.589608858575957e-10, -3.944249371556907e-10, 1.1102230246251565e-16, -0.188750007679855, -0.2267839435477974], res_norm=2.951e-01
2026-01-13 16:43:52,000 - INFO - integration_test - Dyn residual k=1: pred=[22.519501236489376, 6.355392074097208, 0.539356866011099, 0.17875, 24.38815406230756], ws=[22.519501236489376, 6.355392074097208, 0.539356866011099, 0.34390624999999997, 24.11248550897304], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.2756685533345191], res_norm=3.214e-01
2026-01-13 16:43:52,001 - INFO - integration_test - Dyn residual k=2: pred=[22.54900973955497, 6.3730545579179685, 0.539356866011099, 0.34390624999999997, 24.14687613397304], ws=[22.54900973955497, 6.3730545579179685, 0.539356866011099, 0.48841796875, 24.415515812003346], res=[0.0, 0.0, 0.0, -0.14451171875000002, -0.2686396780303042], res_norm=3.050e-01
2026-01-13 16:43:52,015 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:52,085 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:52,101 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:52,112 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:52,127 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:52,147 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:52,162 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:52,174 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:52,188 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:52,199 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:52,214 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:52,225 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:52,240 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:52,252 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:52,266 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:52,277 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:52,292 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:52,304 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:52,318 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:52,329 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:52,342 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:52,352 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:52,511 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:52,511 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:52,511 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:52,511 - ERROR - integration_test -   Current position: (22.505, 6.347)
2026-01-13 16:43:52,511 - ERROR - integration_test -   Position 5 steps ago: (22.509, 6.349)
2026-01-13 16:43:52,511 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:52,511 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:53,562 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.195)
2026-01-13 16:43:53,562 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:53,562 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:53,562 - INFO - integration_test -   Control dict from planner: {'a': -1.5396229606929194e-08, 'w': -0.10684400778934298}
2026-01-13 16:43:53,562 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:53,562 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:53,563 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:53,564 - INFO - integration_test - Step 200 completed in 1.697s
2026-01-13 16:43:53,582 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 16:43:53,585 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 2.25041611e+01  6.34621635e+00  5.28672465e-01 -1.00000092e-02
  2.41940002e+01]
2026-01-13 16:43:53,586 - DEBUG - integration_test - Step 201: Using propagated spline 24.1940 (close to path, dist=0.523m, drift=0.038m)
2026-01-13 16:43:53,586 - DEBUG - integration_test -   Set spline state to 24.1940
2026-01-13 16:43:53,587 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:53,653 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(22.504, 6.346), path_start=(0.000, 0.000), dist=23.382m
2026-01-13 16:43:53,653 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=23.382m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 16:43:53,653 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 16:43:53,705 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 16:43:53,714 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 16:43:53,714 - INFO - integration_test - Warmstart k=0: x0=22.504161058417136 , y0=6.346216348497566 , psi0=0.5286724652321648 , v0=-0.01000000921947796 , spline0=24.1434951186058 , a0=0.0 , w0=0.0
2026-01-13 16:43:53,714 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 16:43:53,715 - INFO - integration_test - Dyn residual k=0: pred=[22.503297580197934, 6.345711960542853, 0.5286724652321648, -0.01000000921947796, 24.14249511768385], ws=[22.503297580994015, 6.345711961007872, 0.528672465232165, 0.17875, 24.369142445881565], res=[-7.960814230045798e-10, -4.6501913431029607e-10, -2.220446049250313e-16, -0.18875000921947796, -0.22664732819771416], res_norm=2.950e-01
2026-01-13 16:43:53,716 - INFO - integration_test - Dyn residual k=1: pred=[22.518732239932305, 6.354727887386158, 0.528672465232165, 0.17875, 24.387017445881565], ws=[22.518732239932305, 6.354727887386158, 0.528672465232165, 0.34390624999999997, 24.11119724869929], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.2758201971822736], res_norm=3.215e-01
2026-01-13 16:43:53,717 - INFO - integration_test - Dyn residual k=2: pred=[22.54842776818683, 6.372074088398927, 0.528672465232165, 0.34390624999999997, 24.14558787369929], ws=[22.54842776818683, 6.372074088398927, 0.528672465232165, 0.48841796875, 24.414227551729596], res=[0.0, 0.0, 0.0, -0.14451171875000002, -0.2686396780303042], res_norm=3.050e-01
2026-01-13 16:43:53,731 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:53,800 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:53,815 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:53,827 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:53,842 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:53,854 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:53,869 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:53,880 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:53,894 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:53,906 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:53,920 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:53,932 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:53,947 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:53,958 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:53,973 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:53,984 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:53,999 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:54,011 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 16:43:54,026 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:54,036 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:54,050 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 16:43:54,060 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 16:43:54,188 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 16:43:54,188 - ERROR - integration_test - 🚨 VEHICLE STUCK DETECTED at step 201!
2026-01-13 16:43:54,188 - ERROR - integration_test -   Vehicle has moved only 0.0050m in last 5 steps
2026-01-13 16:43:54,188 - ERROR - integration_test -   Current position: (22.504, 6.346)
2026-01-13 16:43:54,188 - ERROR - integration_test -   Position 5 steps ago: (22.508, 6.349)
2026-01-13 16:43:54,188 - ERROR - integration_test -   Checking constraint violations at current position...
2026-01-13 16:43:54,188 - ERROR - integration_test -   Terminating test early due to stuck vehicle
2026-01-13 16:43:55,243 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=24.194)
2026-01-13 16:43:55,243 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 16:43:55,243 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 16:43:55,243 - INFO - integration_test -   Control dict from planner: {'a': 1.9659676862816183e-08, 'w': 0.1357283584244373}
2026-01-13 16:43:55,243 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 16:43:55,244 - INFO - integration_test -   Planner output success: True
2026-01-13 16:43:55,245 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 16:43:55,245 - INFO - integration_test - Step 200 completed in 1.660s
2026-01-13 16:43:55,264 - WARNING - integration_test - Test timeout reached (300.0s) at step 201. Terminating test early.
2026-01-13 16:43:55,268 - INFO - integration_test - Saving test results...
2026-01-13 16:43:55,269 - INFO - integration_test - Saved 180 vehicle states to test_outputs/20260113_163853_contouring_safe_horizon_contouring_unicycle/vehicle_states.csv
2026-01-13 16:43:55,269 - INFO - integration_test - Saved obstacle summary to test_outputs/20260113_163853_contouring_safe_horizon_contouring_unicycle/obstacle_summary.csv
2026-01-13 16:43:55,269 - INFO - integration_test - Saved 190 states for obstacle 0 to test_outputs/20260113_163853_contouring_safe_horizon_contouring_unicycle/obstacle_0_detailed_states.csv
2026-01-13 16:43:55,270 - INFO - integration_test - Saved 190 states for obstacle 1 to test_outputs/20260113_163853_contouring_safe_horizon_contouring_unicycle/obstacle_1_detailed_states.csv
2026-01-13 16:43:55,270 - INFO - integration_test - Saved 190 states for obstacle 2 to test_outputs/20260113_163853_contouring_safe_horizon_contouring_unicycle/obstacle_2_detailed_states.csv
2026-01-13 16:43:56,745 - INFO - integration_test - Saved Safe Horizon diagnostic output to test_outputs/20260113_163853_contouring_safe_horizon_contouring_unicycle
2026-01-13 16:43:56,745 - INFO - integration_test - Saved state history: 180 vehicle states, 3 obstacles
2026-01-13 16:43:56,745 - INFO - integration_test - Creating animation...
2026-01-13 16:43:56,789 - DEBUG - integration_test - Creating animation with 180 frames (range: 0 to 179)
2026-01-13 16:43:56,790 - DEBUG - integration_test - Frame 0: Drawing 6 contouring constraint halfspaces
2026-01-13 16:43:56,846 - INFO - integration_test - Frame 0: Safe Horizon module has 134 scenarios after update
2026-01-13 16:43:56,846 - INFO - integration_test - Frame 0: Calling Safe Horizon visualizer
2026-01-13 16:43:56,846 - DEBUG - integration_test - Frame 0: Safe Horizon scenario_cache has 50 constraints across 10 keys: [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4)]
2026-01-13 16:43:56,870 - INFO - integration_test - Frame 0: Safe Horizon visualizer completed
2026-01-13 16:43:56,870 - DEBUG - integration_test - Frame 0: Drawing 6 contouring constraint halfspaces
2026-01-13 16:43:56,925 - INFO - integration_test - Frame 0: Safe Horizon module has 139 scenarios after update
2026-01-13 16:43:56,925 - INFO - integration_test - Frame 0: Calling Safe Horizon visualizer
2026-01-13 16:43:56,925 - DEBUG - integration_test - Frame 0: Safe Horizon scenario_cache has 50 constraints across 10 keys: [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4)]
2026-01-13 16:43:56,949 - INFO - integration_test - Frame 0: Safe Horizon visualizer completed
2026-01-13 16:43:57,053 - DEBUG - integration_test - Frame 1: Drawing 6 contouring constraint halfspaces
2026-01-13 16:43:57,108 - INFO - integration_test - Frame 1: Safe Horizon module has 137 scenarios after update
2026-01-13 16:43:57,108 - INFO - integration_test - Frame 1: Calling Safe Horizon visualizer
2026-01-13 16:43:57,108 - DEBUG - integration_test - Frame 1: Safe Horizon scenario_cache has 50 constraints across 10 keys: [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4)]
2026-01-13 16:43:57,134 - INFO - integration_test - Frame 1: Safe Horizon visualizer completed
2026-01-13 16:43:57,170 - DEBUG - integration_test - Frame 2: Drawing 6 contouring constraint halfspaces
2026-01-13 16:43:57,227 - INFO - integration_test - Frame 2: Safe Horizon module has 134 scenarios after update
2026-01-13 16:43:57,227 - INFO - integration_test - Frame 2: Calling Safe Horizon visualizer
2026-01-13 16:43:57,227 - DEBUG - integration_test - Frame 2: Safe Horizon scenario_cache has 50 constraints across 10 keys: [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4)]
2026-01-13 16:43:57,256 - INFO - integration_test - Frame 2: Safe Horizon visualizer completed
2026-01-13 16:44:34,524 - INFO - integration_test - Saved animation with 180 frames at 10.00 fps to test_outputs/20260113_163853_contouring_safe_horizon_contouring_unicycle/animation.gif (duration: 18.00s, size: 3916513 bytes)
2026-01-13 16:44:34,576 - INFO - integration_test - Animation created successfully
2026-01-13 16:44:34,577 - WARNING - integration_test - Test exited early due to stuck vehicle, but files were saved
