2026-01-13 17:38:46,652 - INFO - integration_test - Contouring objective detected: automatically switching to contouring-aware dynamics model
2026-01-13 17:38:46,653 - INFO - integration_test -   Converted 'unicycle' -> 'contouring_unicycle'
2026-01-13 17:38:46,653 - INFO - integration_test - Created vehicle dynamics model: ContouringSecondOrderUnicycleModel
2026-01-13 17:38:46,653 - INFO - integration_test - ✓ Validation passed: Contouring objective with dynamics model that has 'spline' state
2026-01-13 17:38:46,653 - INFO - integration_test - Creating objective module: contouring
2026-01-13 17:38:46,658 - INFO - integration_test - Objective module 'contouring' created: contouring_objective
2026-01-13 17:38:46,658 - INFO - integration_test - Creating 2 constraint module(s): ['safe_horizon', 'contouring']
2026-01-13 17:38:46,658 - DEBUG - integration_test - Creating constraint module: safe_horizon
2026-01-13 17:38:46,674 - INFO - integration_test - Constraint module 'safe_horizon' created: safe_horizon_constraint
2026-01-13 17:38:46,674 - DEBUG - integration_test - Creating constraint module: contouring
2026-01-13 17:38:46,678 - INFO - integration_test - Constraint module 'contouring' created: contouring_constraints
2026-01-13 17:38:46,678 - INFO - integration_test - Created 2 constraint module(s)
2026-01-13 17:38:46,679 - INFO - integration_test - Safe Horizon diagnostics enabled for this test, output folder: test_outputs/20260113_173846_contouring_safe_horizon_contouring_unicycle
2026-01-13 17:38:46,693 - INFO - integration_test - Setting solver on all modules...
2026-01-13 17:38:46,693 - WARNING - integration_test -   Module safe_horizon_constraint has no solver attribute
2026-01-13 17:38:46,693 - DEBUG - integration_test -   Set solver on module: contouring_constraints
2026-01-13 17:38:46,693 - DEBUG - integration_test -   Set solver on module: control_effort_objective
2026-01-13 17:38:46,693 - DEBUG - integration_test -   Set solver on module: control_jerk_objective
2026-01-13 17:38:46,693 - DEBUG - integration_test -   Set solver on module: path_reference_velocity_objective
2026-01-13 17:38:46,693 - DEBUG - integration_test -   Set solver on module: contouring_objective
2026-01-13 17:38:46,696 - WARNING - integration_test - Error shaping obstacles: name 'get_dummy_obstacle' is not defined
2026-01-13 17:38:46,696 - WARNING - integration_test - Error in on_data_received: 'Planner' object has no attribute 'on_data_received'
2026-01-13 17:38:46,697 - INFO - integration_test - Initial vehicle state (before spline): [0. 0. 0. 1.]
2026-01-13 17:38:46,697 - INFO - integration_test - Vehicle starting position: (0.00, 0.00)
2026-01-13 17:38:46,697 - INFO - integration_test - Reference path start: (0.00, 0.00)
2026-01-13 17:38:46,697 - INFO - integration_test - Reference path starts at vehicle position (requirement satisfied)
2026-01-13 17:38:46,697 - INFO - integration_test - Contouring-aware dynamics detected: initializing spline variable
2026-01-13 17:38:46,698 - INFO - integration_test - Initialized spline to closest path point: s=0.0000 (vehicle at (0.00, 0.00), closest path point at (0.00, 0.00), distance=0.000m)
2026-01-13 17:38:46,698 - INFO - integration_test - Added spline variable: 0.0000
2026-01-13 17:38:46,698 - INFO - integration_test - Final initial state: [0. 0. 0. 1. 0.] (variables: ['x', 'y', 'psi', 'v', 'spline'])
2026-01-13 17:38:46,698 - INFO - integration_test - Step 0 (contouring until path end)
2026-01-13 17:38:46,698 - DEBUG - integration_test - Syncing planner state at step 0: vehicle_state=[0. 0. 0. 1. 0.]
2026-01-13 17:38:46,698 - DEBUG - integration_test - Step 0: Using propagated spline 0.0000 (close to path, dist=0.000m, drift=0.000m)
2026-01-13 17:38:46,698 - DEBUG - integration_test -   Set spline state to 0.0000
2026-01-13 17:38:46,699 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:46,716 - DEBUG - integration_test - Step 0: Checking path alignment: vehicle=(0.000, 0.000), path_start=(0.000, 0.000), dist=0.000m
2026-01-13 17:38:46,716 - INFO - integration_test - === Calling planner.solve_mpc() at step 0 ===
2026-01-13 17:38:46,720 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:46,733 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:38:46,733 - INFO - integration_test - Warmstart k=0: x0=0.0 , y0=0.0 , psi0=0.0 , v0=1.0 , spline0=0.0 , a0=0.0 , w0=0.0
2026-01-13 17:38:46,733 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:38:46,734 - INFO - integration_test - Dyn residual k=0: pred=[0.1, 0.0, 0.0, 1.0, 0.1], ws=[0.1, 0.0, 0.0, 1.0, 0.051515151515151514], res=[0.0, 0.0, 0.0, 0.0, 0.04848484848484849], res_norm=4.848e-02
2026-01-13 17:38:46,735 - INFO - integration_test - Dyn residual k=1: pred=[0.2, 0.0, 0.0, 1.0, 0.15151515151515152], ws=[0.2, 0.0, 0.0, 1.0, 0.10530806991582416], res=[0.0, 0.0, 0.0, 0.0, 0.04620708159932736], res_norm=4.621e-02
2026-01-13 17:38:46,737 - INFO - integration_test - Dyn residual k=2: pred=[0.30000000000000004, 0.0, 0.0, 1.0, 0.20530806991582418], ws=[0.30000000000000004, 0.0, 0.0, 1.0, 0.16177874499601194], res=[0.0, 0.0, 0.0, 0.0, 0.043529324919812235], res_norm=4.353e-02
2026-01-13 17:38:46,751 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:46,821 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:46,836 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:46,848 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:46,862 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:46,874 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:46,888 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:46,899 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:46,914 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:46,926 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:46,942 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:46,954 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:46,969 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:46,981 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:46,996 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:47,007 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:47,022 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:47,034 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:47,049 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:47,059 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:47,072 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:47,083 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:48,473 - INFO - integration_test - Step 0: MPC solve successful
2026-01-13 17:38:48,685 - INFO - integration_test - Step 0: Computed 6 numeric contouring constraints for visualization (s=0.000)
2026-01-13 17:38:48,685 - DEBUG - integration_test - Step 0: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:38:48,685 - DEBUG - integration_test - Linearized constraints module not found at step 0
2026-01-13 17:38:48,685 - INFO - integration_test - === Applying control at step 0 ===
2026-01-13 17:38:48,685 - INFO - integration_test -   Control dict from planner: {'a': 1.9999999903142502, 'w': 0.799999483713965}
2026-01-13 17:38:48,685 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:38:48,685 - INFO - integration_test -   Planner output success: True
2026-01-13 17:38:48,686 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:38:48,687 - INFO - integration_test - Step 0 completed in 1.989s
2026-01-13 17:38:48,703 - INFO - integration_test - Step 1 (contouring until path end)
2026-01-13 17:38:48,703 - DEBUG - integration_test - Syncing planner state at step 1: vehicle_state=[0.10987738 0.00453084 0.07999995 1.2        0.12      ]
2026-01-13 17:38:48,704 - DEBUG - integration_test - Step 1: Using propagated spline 0.1200 (close to path, dist=0.110m, drift=0.120m)
2026-01-13 17:38:48,704 - DEBUG - integration_test -   Set spline state to 0.1200
2026-01-13 17:38:48,705 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:48,776 - DEBUG - integration_test - Step 1: Checking path alignment: vehicle=(0.110, 0.005), path_start=(0.000, 0.000), dist=0.110m
2026-01-13 17:38:48,776 - INFO - integration_test - === Calling planner.solve_mpc() at step 1 ===
2026-01-13 17:38:48,835 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:48,844 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:38:48,845 - INFO - integration_test - Warmstart k=0: x0=0.10987737539105888 , y0=0.004530842129684655 , psi0=0.0799999483713965 , v0=1.199999999031425 , spline0=0.05171717171619336 , a0=0.0 , w0=0.0
2026-01-13 17:38:48,845 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:38:48,846 - INFO - integration_test - Dyn residual k=0: pred=[0.22949358054593139, 0.014120599222627424, 0.0799999483713965, 1.199999999031425, 0.17171717161933586], ws=[0.2294935805459314, 0.014120599222627424, 0.07999994837139646, 1.199999999031425, 0.10627058848510937], res=[-2.7755575615628914e-17, 0.0, 4.163336342344337e-17, 0.0, 0.0654465831342265], res_norm=6.545e-02
2026-01-13 17:38:48,847 - INFO - integration_test - Dyn residual k=1: pred=[0.3491097857008039, 0.02371035631557019, 0.07999994837139646, 1.199999999031425, 0.22627058838825187], ws=[0.349109785700804, 0.02371035631557019, 0.07999994837139646, 1.199999999031425, 0.21885435613169435], res=[-5.551115123125783e-17, 0.0, 0.0, 0.0, 0.00741623225655752], res_norm=7.416e-03
2026-01-13 17:38:48,848 - INFO - integration_test - Dyn residual k=2: pred=[0.4687259908556765, 0.03330011340851295, 0.07999994837139646, 1.199999999031425, 0.3388543560348368], ws=[0.4687259908556765, 0.03330011340851295, 0.07999994837139646, 1.199999999031425, 0.2822950990152304], res=[0.0, 0.0, 0.0, 0.0, 0.0565592570196064], res_norm=5.656e-02
2026-01-13 17:38:48,862 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:48,936 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:48,951 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:48,963 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:48,979 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:48,991 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:49,006 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:49,018 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:49,033 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:49,045 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:49,059 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:49,071 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:49,086 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:49,097 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:49,113 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:49,124 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:49,139 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:49,150 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:49,167 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:49,177 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:49,190 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:49,200 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:49,321 - INFO - integration_test - Step 1: MPC solve successful
2026-01-13 17:38:49,348 - INFO - integration_test - Step 1: Computed 6 numeric contouring constraints for visualization (s=0.120)
2026-01-13 17:38:49,348 - DEBUG - integration_test - Step 1: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:38:49,348 - INFO - integration_test - === Applying control at step 1 ===
2026-01-13 17:38:49,348 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000190707463, 'w': 0.7999999930829248}
2026-01-13 17:38:49,348 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:38:49,348 - INFO - integration_test -   Planner output success: True
2026-01-13 17:38:49,349 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:38:49,350 - INFO - integration_test - Step 1 completed in 0.647s
2026-01-13 17:38:49,362 - INFO - integration_test - Step 2 (contouring until path end)
2026-01-13 17:38:49,363 - DEBUG - integration_test - Syncing planner state at step 2: vehicle_state=[0.23889213 0.02022161 0.15999995 1.4        0.26      ]
2026-01-13 17:38:49,364 - DEBUG - integration_test - Step 2: Using propagated spline 0.2600 (close to path, dist=0.240m, drift=0.260m)
2026-01-13 17:38:49,364 - DEBUG - integration_test -   Set spline state to 0.2600
2026-01-13 17:38:49,365 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:49,431 - DEBUG - integration_test - Step 2: Checking path alignment: vehicle=(0.239, 0.020), path_start=(0.000, 0.000), dist=0.240m
2026-01-13 17:38:49,431 - INFO - integration_test - === Calling planner.solve_mpc() at step 2 ===
2026-01-13 17:38:49,484 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:49,494 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:38:49,494 - INFO - integration_test - Warmstart k=0: x0=0.2388921287178186 , y0=0.020221612089645135 , psi0=0.15999994767968898 , v0=1.4000000009384996 , spline0=0.15939393939384827 , a0=0.0 , w0=0.0
2026-01-13 17:38:49,494 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:38:49,496 - INFO - integration_test - Dyn residual k=0: pred=[0.37710394965003835, 0.042526153799306146, 0.15999994767968898, 1.4000000009384996, 0.2993939394876982], ws=[0.37710394965003835, 0.042526153799306146, 0.15999994767968895, 1.4000000009384996, 0.2198943950853617], res=[0.0, 0.0, 2.7755575615628914e-17, 0.0, 0.0794995444023365], res_norm=7.950e-02
2026-01-13 17:38:49,497 - INFO - integration_test - Dyn residual k=1: pred=[0.5153157705822581, 0.06483069550896715, 0.15999994767968895, 1.4000000009384996, 0.3598943951792117], ws=[0.5153157705822582, 0.06483069550896715, 0.15999994767968895, 1.4000000009384996, 0.28503090218481164], res=[-1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.07486349299440004], res_norm=7.486e-02
2026-01-13 17:38:49,498 - INFO - integration_test - Dyn residual k=2: pred=[0.6535275915144779, 0.08713523721862816, 0.15999994767968895, 1.4000000009384996, 0.4250309022786616], ws=[0.653527591514478, 0.08713523721862816, 0.15999994767968895, 1.4000000009384996, 0.41466969110134266], res=[-1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.010361211177318919], res_norm=1.036e-02
2026-01-13 17:38:49,512 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:49,581 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:49,596 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:49,608 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:49,623 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:49,634 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:49,648 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:49,660 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:49,674 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:49,686 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:49,700 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:49,712 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:49,727 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:49,738 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:49,753 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:49,764 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:49,779 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:49,790 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:49,805 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:49,815 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:49,828 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:49,837 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:50,039 - INFO - integration_test - Step 2: MPC solve successful
2026-01-13 17:38:50,068 - INFO - integration_test - Step 2: Computed 6 numeric contouring constraints for visualization (s=0.260)
2026-01-13 17:38:50,068 - DEBUG - integration_test - Step 2: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:38:50,068 - INFO - integration_test - === Applying control at step 2 ===
2026-01-13 17:38:50,069 - INFO - integration_test -   Control dict from planner: {'a': 2.000000019971183, 'w': 0.8000000095825147}
2026-01-13 17:38:50,069 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:38:50,069 - INFO - integration_test -   Planner output success: True
2026-01-13 17:38:50,070 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:38:50,070 - INFO - integration_test - Step 2 completed in 0.707s
2026-01-13 17:38:50,084 - INFO - integration_test - Step 3 (contouring until path end)
2026-01-13 17:38:50,085 - DEBUG - integration_test - Syncing planner state at step 3: vehicle_state=[0.38583644 0.0501447  0.23999995 1.6        0.42      ]
2026-01-13 17:38:50,086 - DEBUG - integration_test - Step 3: Using propagated spline 0.4200 (close to path, dist=0.389m, drift=0.420m)
2026-01-13 17:38:50,086 - DEBUG - integration_test -   Set spline state to 0.4200
2026-01-13 17:38:50,086 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:50,151 - DEBUG - integration_test - Step 3: Checking path alignment: vehicle=(0.386, 0.050), path_start=(0.000, 0.000), dist=0.389m
2026-01-13 17:38:50,151 - INFO - integration_test - === Calling planner.solve_mpc() at step 3 ===
2026-01-13 17:38:50,204 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:50,214 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:38:50,214 - INFO - integration_test - Warmstart k=0: x0=0.38583643751628366 , y0=0.05014469911825817 , psi0=0.23999994863794044 , v0=1.6000000029356178 , spline0=0.21898989900163857 , a0=0.0 , w0=0.0
2026-01-13 17:38:50,214 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:38:50,215 - INFO - integration_test - Dyn residual k=0: pred=[0.5412505157311793, 0.08817711143399301, 0.23999994863794044, 1.6000000029356178, 0.3789898992952003], ws=[0.5412505157311793, 0.08817711143399301, 0.23999994863794027, 1.6000000029356178, 0.3421640093423306], res=[0.0, 0.0, 1.6653345369377348e-16, 0.0, 0.03682588995286973], res_norm=3.683e-02
2026-01-13 17:38:50,216 - INFO - integration_test - Dyn residual k=1: pred=[0.696664593946075, 0.12620952374972783, 0.23999994863794027, 1.6000000029356178, 0.5021640096358924], ws=[0.696664593946075, 0.12620952374972783, 0.23999994863794027, 1.6000000029356178, 0.4166868340837892], res=[0.0, 0.0, 0.0, 0.0, 0.08547717555210316], res_norm=8.548e-02
2026-01-13 17:38:50,217 - INFO - integration_test - Dyn residual k=2: pred=[0.8520786721609708, 0.16424193606546264, 0.23999994863794027, 1.6000000029356178, 0.576686834377351], ws=[0.8520786721609708, 0.16424193606546264, 0.23999994863794027, 1.6000000029356178, 0.7399794738930281], res=[0.0, 0.0, 0.0, 0.0, -0.16329263951567707], res_norm=1.633e-01
2026-01-13 17:38:50,231 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:50,302 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:50,318 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:50,330 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:50,345 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:50,358 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:50,373 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:50,384 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:50,398 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:50,410 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:50,427 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:50,439 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:50,454 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:50,465 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:50,480 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:50,491 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:50,506 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:50,518 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:50,532 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:50,542 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:50,555 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:50,565 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:50,697 - INFO - integration_test - Step 3: MPC solve successful
2026-01-13 17:38:50,725 - INFO - integration_test - Step 3: Computed 6 numeric contouring constraints for visualization (s=0.420)
2026-01-13 17:38:50,725 - DEBUG - integration_test - Step 3: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:38:50,725 - INFO - integration_test - === Applying control at step 3 ===
2026-01-13 17:38:50,725 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000193341982, 'w': 0.799999992322134}
2026-01-13 17:38:50,725 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:38:50,725 - INFO - integration_test -   Planner output success: True
2026-01-13 17:38:50,726 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:38:50,727 - INFO - integration_test - Step 3 completed in 0.642s
2026-01-13 17:38:50,739 - INFO - integration_test - Step 4 (contouring until path end)
2026-01-13 17:38:50,740 - DEBUG - integration_test - Syncing planner state at step 4: vehicle_state=[0.54913547 0.09724073 0.31999995 1.8        0.6       ]
2026-01-13 17:38:50,740 - DEBUG - integration_test - Step 4: Using propagated spline 0.6000 (close to path, dist=0.455m, drift=0.006m)
2026-01-13 17:38:50,740 - DEBUG - integration_test -   Set spline state to 0.6000
2026-01-13 17:38:50,741 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:50,807 - DEBUG - integration_test - Step 4: Checking path alignment: vehicle=(0.549, 0.097), path_start=(0.000, 0.000), dist=0.558m
2026-01-13 17:38:50,808 - INFO - integration_test - === Calling planner.solve_mpc() at step 4 ===
2026-01-13 17:38:50,859 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:50,868 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:38:50,868 - INFO - integration_test - Warmstart k=0: x0=0.5491354652094962 , y0=0.09724073113673207 , psi0=0.31999994787015384 , v0=1.8000000048690377 , spline0=0.33939393944105806 , a0=0.0 , w0=0.0
2026-01-13 17:38:50,869 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:38:50,869 - INFO - integration_test - Dyn residual k=0: pred=[0.7199978438782167, 0.15386270329376747, 0.31999994787015384, 1.8000000048690377, 0.5193939399279619], ws=[0.7199978438782167, 0.15386270329376747, 0.31999994787015407, 1.8000000048690377, 0.47435686264003174], res=[0.0, 0.0, -2.220446049250313e-16, 0.0, 0.04503707728793016], res_norm=4.504e-02
2026-01-13 17:38:50,870 - INFO - integration_test - Dyn residual k=1: pred=[0.8908602225469373, 0.2104846754508029, 0.31999994787015407, 1.8000000048690377, 0.6543568631269355], ws=[0.8908602225469373, 0.2104846754508029, 0.31999994787015407, 1.8000000048690377, 0.8018290656401491], res=[0.0, 0.0, 0.0, 0.0, -0.14747220251321358], res_norm=1.475e-01
2026-01-13 17:38:50,871 - INFO - integration_test - Dyn residual k=2: pred=[1.0617226012156578, 0.26710664760783837, 0.31999994787015407, 1.8000000048690377, 0.9818290661270529], ws=[1.0617226012156578, 0.26710664760783837, 0.31999994787015407, 1.8000000048690377, 0.8999392968472335], res=[0.0, 0.0, 0.0, 0.0, 0.08188976927981939], res_norm=8.189e-02
2026-01-13 17:38:50,884 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:50,953 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:50,968 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:50,979 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:50,994 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:51,005 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:51,019 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:51,030 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:51,044 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:51,056 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:51,070 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:51,081 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:51,096 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:51,108 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:51,124 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:51,136 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:51,150 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:51,162 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:51,178 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:51,189 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:51,201 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:51,211 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:51,354 - INFO - integration_test - Step 4: MPC solve successful
2026-01-13 17:38:51,384 - INFO - integration_test - Step 4: Computed 6 numeric contouring constraints for visualization (s=0.600)
2026-01-13 17:38:51,384 - DEBUG - integration_test - Step 4: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:38:51,384 - INFO - integration_test - === Applying control at step 4 ===
2026-01-13 17:38:51,384 - INFO - integration_test -   Control dict from planner: {'a': 2.000000019916099, 'w': 0.800000007716186}
2026-01-13 17:38:51,384 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:38:51,384 - INFO - integration_test -   Planner output success: True
2026-01-13 17:38:51,385 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:38:51,385 - INFO - integration_test - Step 4 completed in 0.646s
2026-01-13 17:38:51,401 - INFO - integration_test - Step 5 (contouring until path end)
2026-01-13 17:38:51,402 - DEBUG - integration_test - Syncing planner state at step 5: vehicle_state=[0.7268615  0.16427973 0.39999995 2.00000001 0.8       ]
2026-01-13 17:38:51,402 - DEBUG - integration_test - Step 5: Using propagated spline 0.8000 (close to path, dist=0.375m, drift=0.194m)
2026-01-13 17:38:51,402 - DEBUG - integration_test -   Set spline state to 0.8000
2026-01-13 17:38:51,403 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:51,471 - DEBUG - integration_test - Step 5: Checking path alignment: vehicle=(0.727, 0.164), path_start=(0.000, 0.000), dist=0.745m
2026-01-13 17:38:51,471 - INFO - integration_test - === Calling planner.solve_mpc() at step 5 ===
2026-01-13 17:38:51,523 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:51,532 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:38:51,532 - INFO - integration_test - Warmstart k=0: x0=0.7268614959003805 , y0=0.16427973325940207 , psi0=0.39999994864177246 , v0=2.0000000068606476 , spline0=0.4686868688051332 , a0=0.0 , w0=0.0
2026-01-13 17:38:51,532 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:38:51,534 - INFO - integration_test - Dyn residual k=0: pred=[0.9110736993328319, 0.2421633925274862, 0.39999994864177246, 2.0000000068606476, 0.668686869491198], ws=[0.911073699332832, 0.2421633925274862, 0.39999994864177246, 2.0000000068606476, 0.6103245125053071], res=[-1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.058362356985890984], res_norm=5.836e-02
2026-01-13 17:38:51,534 - INFO - integration_test - Dyn residual k=1: pred=[1.0952859027652835, 0.32004705179557036, 0.39999994864177246, 2.0000000068606476, 0.8103245131913719], ws=[1.0952859027652835, 0.32004705179557036, 0.39999994864177246, 2.0000000068606476, 0.9554815266576678], res=[0.0, 0.0, 0.0, 0.0, -0.14515701346629595], res_norm=1.452e-01
2026-01-13 17:38:51,535 - INFO - integration_test - Dyn residual k=2: pred=[1.2794981061977349, 0.3979307110636545, 0.39999994864177246, 2.0000000068606476, 1.1554815273437327], ws=[1.2794981061977349, 0.3979307110636545, 0.39999994864177246, 2.0000000068606476, 1.065581052278306], res=[0.0, 0.0, 0.0, 0.0, 0.08990047506542664], res_norm=8.990e-02
2026-01-13 17:38:51,548 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:51,617 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:51,631 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:51,642 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:51,657 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:51,668 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:51,683 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:51,695 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:51,709 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:51,721 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:51,735 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:51,746 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:51,761 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:51,772 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:51,786 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:51,798 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:51,814 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:51,825 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:51,839 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:51,849 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:51,861 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:51,871 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:52,018 - INFO - integration_test - Step 5: MPC solve successful
2026-01-13 17:38:52,049 - INFO - integration_test - Step 5: Computed 6 numeric contouring constraints for visualization (s=0.800)
2026-01-13 17:38:52,049 - DEBUG - integration_test - Step 5: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:38:52,049 - INFO - integration_test - === Applying control at step 5 ===
2026-01-13 17:38:52,049 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000200000447, 'w': 0.800000009987681}
2026-01-13 17:38:52,049 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:38:52,049 - INFO - integration_test -   Planner output success: True
2026-01-13 17:38:52,050 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:38:52,050 - INFO - integration_test - Step 5 completed in 0.649s
2026-01-13 17:38:52,066 - INFO - integration_test - Step 6 (contouring until path end)
2026-01-13 17:38:52,066 - DEBUG - integration_test - Syncing planner state at step 6: vehicle_state=[0.91675191 0.25382376 0.47999995 2.20000001 1.02      ]
2026-01-13 17:38:52,067 - DEBUG - integration_test - Step 6: Using propagated spline 1.0200 (close to path, dist=0.373m, drift=0.414m)
2026-01-13 17:38:52,067 - DEBUG - integration_test -   Set spline state to 1.0200
2026-01-13 17:38:52,067 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:52,133 - DEBUG - integration_test - Step 6: Checking path alignment: vehicle=(0.917, 0.254), path_start=(0.000, 0.000), dist=0.951m
2026-01-13 17:38:52,133 - INFO - integration_test - === Calling planner.solve_mpc() at step 6 ===
2026-01-13 17:38:52,187 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:52,197 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:38:52,197 - INFO - integration_test - Warmstart k=0: x0=0.9167519143157478 , y0=0.2538237635613534 , psi0=0.47999994964054055 , v0=2.200000008860652 , spline0=0.6080808083181403 , a0=0.0 , w0=0.0
2026-01-13 17:38:52,197 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:38:52,198 - INFO - integration_test - Dyn residual k=0: pred=[1.1118908032292143, 0.35541517276255724, 0.47999994964054055, 2.200000008860652, 0.8280808092042055], ws=[1.1118908032292143, 0.35541517276255724, 0.4799999496405407, 2.200000008860652, 0.9559336015765358], res=[0.0, 0.0, -1.6653345369377348e-16, 0.0, -0.12785279237233038], res_norm=1.279e-01
2026-01-13 17:38:52,199 - INFO - integration_test - Dyn residual k=1: pred=[1.307029692142681, 0.45700658196376115, 0.4799999496405407, 2.200000008860652, 1.175933602462601], ws=[1.307029692142681, 0.45700658196376115, 0.4799999496405407, 2.200000008860652, 1.137314568997571], res=[0.0, 0.0, 0.0, 0.0, 0.03861903346503004], res_norm=3.862e-02
2026-01-13 17:38:52,200 - INFO - integration_test - Dyn residual k=2: pred=[1.5021685810561474, 0.558597991164965, 0.4799999496405407, 2.200000008860652, 1.3573145698836362], ws=[1.5021685810561474, 0.558597991164965, 0.4799999496405407, 2.200000008860652, 1.4647139039171821], res=[0.0, 0.0, 0.0, 0.0, -0.10739933403354596], res_norm=1.074e-01
2026-01-13 17:38:52,214 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:52,283 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:52,297 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:52,309 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:52,324 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:52,335 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:52,349 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:52,361 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:52,375 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:52,387 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:52,401 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:52,412 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:52,427 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:52,438 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:52,452 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:52,464 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:52,478 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:52,489 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:52,504 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:52,514 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:52,527 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:52,538 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:52,684 - INFO - integration_test - Step 6: MPC solve successful
2026-01-13 17:38:52,714 - INFO - integration_test - Step 6: Computed 6 numeric contouring constraints for visualization (s=1.020)
2026-01-13 17:38:52,715 - DEBUG - integration_test - Step 6: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:38:52,715 - INFO - integration_test - === Applying control at step 6 ===
2026-01-13 17:38:52,715 - INFO - integration_test -   Control dict from planner: {'a': 2.000000019969444, 'w': 0.8000000078167425}
2026-01-13 17:38:52,715 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:38:52,715 - INFO - integration_test -   Planner output success: True
2026-01-13 17:38:52,716 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:38:52,716 - INFO - integration_test - Step 6 completed in 0.650s
2026-01-13 17:38:52,731 - INFO - integration_test - Step 7 (contouring until path end)
2026-01-13 17:38:52,731 - DEBUG - integration_test - Syncing planner state at step 7: vehicle_state=[1.11623088 0.36819139 0.55999995 2.40000001 1.26      ]
2026-01-13 17:38:52,732 - DEBUG - integration_test - Step 7: Using propagated spline 1.2600 (close to path, dist=0.475m, drift=0.654m)
2026-01-13 17:38:52,732 - DEBUG - integration_test -   Set spline state to 1.2600
2026-01-13 17:38:52,733 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:52,797 - DEBUG - integration_test - Step 7: Checking path alignment: vehicle=(1.116, 0.368), path_start=(0.000, 0.000), dist=1.175m
2026-01-13 17:38:52,797 - INFO - integration_test - === Calling planner.solve_mpc() at step 7 ===
2026-01-13 17:38:52,849 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:52,858 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:38:52,858 - INFO - integration_test - Warmstart k=0: x0=1.116230880043242 , y0=0.36819139290783276 , psi0=0.5599999504222148 , v0=2.4000000108575965 , spline0=1.0117171722723795 , a0=0.0 , w0=0.0
2026-01-13 17:38:52,858 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:38:52,859 - INFO - integration_test - Dyn residual k=0: pred=[1.3195721139267853, 0.4956760709043775, 0.5599999504222148, 2.4000000108575965, 1.2517171733581391], ws=[1.3195721139267853, 0.4956760709043775, 0.5599999504222151, 2.4000000108575965, 1.1328713103548302], res=[0.0, 0.0, -2.220446049250313e-16, 0.0, 0.1188458630033089], res_norm=1.188e-01
2026-01-13 17:38:52,860 - INFO - integration_test - Dyn residual k=1: pred=[1.5229133478103287, 0.6231607489009222, 0.5599999504222151, 2.4000000108575965, 1.37287131144059], ws=[1.5229133478103287, 0.6231607489009222, 0.5599999504222151, 2.4000000108575965, 1.3250255394610608], res=[0.0, 0.0, 0.0, 0.0, 0.047845771979529106], res_norm=4.785e-02
2026-01-13 17:38:52,861 - INFO - integration_test - Dyn residual k=2: pred=[1.7262545816938721, 0.7506454268974669, 0.5599999504222151, 2.4000000108575965, 1.5650255405468205], ws=[1.7262545816938721, 0.7506454268974669, 0.5599999504222151, 2.4000000108575965, 1.681340577360538], res=[0.0, 0.0, 0.0, 0.0, -0.11631503681371758], res_norm=1.163e-01
2026-01-13 17:38:52,874 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:52,944 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:52,959 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:52,970 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:52,984 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:52,995 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:53,010 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:53,021 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:53,035 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:53,047 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:53,061 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:53,072 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:53,087 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:53,098 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:53,113 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:53,124 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:53,139 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:53,151 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:53,167 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:53,177 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:53,191 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:53,202 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:53,358 - INFO - integration_test - Step 7: MPC solve successful
2026-01-13 17:38:53,464 - INFO - integration_test - Step 7: Computed 6 numeric contouring constraints for visualization (s=1.260)
2026-01-13 17:38:53,464 - DEBUG - integration_test - Step 7: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:38:53,464 - INFO - integration_test - === Applying control at step 7 ===
2026-01-13 17:38:53,465 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000199996246, 'w': 0.8000000099522677}
2026-01-13 17:38:53,465 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:38:53,465 - INFO - integration_test -   Planner output success: True
2026-01-13 17:38:53,466 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:38:53,466 - INFO - integration_test - Step 7 completed in 0.735s
2026-01-13 17:38:53,481 - INFO - integration_test - Step 8 (contouring until path end)
2026-01-13 17:38:53,482 - DEBUG - integration_test - Syncing planner state at step 8: vehicle_state=[1.32243451 0.50942438 0.63999995 2.60000001 1.52      ]
2026-01-13 17:38:53,482 - DEBUG - integration_test - Step 8: Using propagated spline 1.5200 (close to path, dist=0.429m, drift=0.308m)
2026-01-13 17:38:53,482 - DEBUG - integration_test -   Set spline state to 1.5200
2026-01-13 17:38:53,483 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:53,548 - DEBUG - integration_test - Step 8: Checking path alignment: vehicle=(1.322, 0.509), path_start=(0.000, 0.000), dist=1.417m
2026-01-13 17:38:53,548 - INFO - integration_test - === Calling planner.solve_mpc() at step 8 ===
2026-01-13 17:38:53,611 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:53,620 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:38:53,620 - INFO - integration_test - Warmstart k=0: x0=1.3224345110507805 , y0=0.5094243793999172 , psi0=0.6399999514174416 , v0=2.600000012857559 , spline0=1.185454546312928 , a0=0.0 , w0=0.0
2026-01-13 17:38:53,620 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:38:53,621 - INFO - integration_test - Dyn residual k=0: pred=[1.5309794166754491, 0.6646951847903418, 0.6399999514174416, 2.600000012857559, 1.445454547598684], ws=[1.5309794166754491, 0.6646951847903418, 0.6399999514174417, 2.600000012857559, 1.3114308071263552], res=[0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.1340237404723288], res_norm=1.340e-01
2026-01-13 17:38:53,622 - INFO - integration_test - Dyn residual k=1: pred=[1.7395243223001178, 0.8199659901807665, 0.6399999514174417, 2.600000012857559, 1.5714308084121111], ws=[1.7395243223001178, 0.8199659901807665, 0.6399999514174417, 2.600000012857559, 1.738925127585941], res=[0.0, 0.0, 0.0, 0.0, -0.16749431917382984], res_norm=1.675e-01
2026-01-13 17:38:53,623 - INFO - integration_test - Dyn residual k=2: pred=[1.9480692279247864, 0.9752367955711911, 0.6399999514174417, 2.600000012857559, 1.998925128871697], ws=[1.9480692279247864, 0.9752367955711911, 0.6399999514174417, 2.600000012857559, 2.1160617162419713], res=[0.0, 0.0, 0.0, 0.0, -0.11713658737027433], res_norm=1.171e-01
2026-01-13 17:38:53,637 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:53,709 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:53,724 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:53,735 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:53,750 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:53,762 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:53,776 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:53,788 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:53,802 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:53,813 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:53,828 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:53,839 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:53,854 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:53,865 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:53,879 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:53,891 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:53,905 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:53,917 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:53,931 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:53,941 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:53,954 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:53,964 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:54,118 - INFO - integration_test - Step 8: MPC solve successful
2026-01-13 17:38:54,151 - INFO - integration_test - Step 8: Computed 6 numeric contouring constraints for visualization (s=1.520)
2026-01-13 17:38:54,152 - DEBUG - integration_test - Step 8: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:38:54,152 - INFO - integration_test - === Applying control at step 8 ===
2026-01-13 17:38:54,152 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000198890384, 'w': 0.7999999634694286}
2026-01-13 17:38:54,152 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:38:54,152 - INFO - integration_test -   Planner output success: True
2026-01-13 17:38:54,153 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:38:54,153 - INFO - integration_test - Step 8 completed in 0.672s
2026-01-13 17:38:54,172 - INFO - integration_test - Step 9 (contouring until path end)
2026-01-13 17:38:54,172 - DEBUG - integration_test - Syncing planner state at step 9: vehicle_state=[1.53223936 0.67925687 0.71999995 2.80000001 1.80000001]
2026-01-13 17:38:54,173 - DEBUG - integration_test - Step 9: Using propagated spline 1.8000 (close to path, dist=0.464m, drift=0.588m)
2026-01-13 17:38:54,173 - DEBUG - integration_test -   Set spline state to 1.8000
2026-01-13 17:38:54,173 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:54,240 - DEBUG - integration_test - Step 9: Checking path alignment: vehicle=(1.532, 0.679), path_start=(0.000, 0.000), dist=1.676m
2026-01-13 17:38:54,240 - INFO - integration_test - === Calling planner.solve_mpc() at step 9 ===
2026-01-13 17:38:54,295 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:54,304 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:38:54,304 - INFO - integration_test - Warmstart k=0: x0=1.5322393602735203 , y0=0.6792568678360831 , psi0=0.7199999477643845 , v0=2.800000014846463 , spline0=1.5797979812397196 , a0=0.0 , w0=0.0
2026-01-13 17:38:54,304 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:38:54,305 - INFO - integration_test - Dyn residual k=0: pred=[1.7427449751932782, 0.8638845659711585, 0.7199999477643845, 2.800000014846463, 1.8597979827243658], ws=[1.7427449751932782, 0.8638845659711585, 0.7199999477643844, 2.800000014846463, 1.7370868701933826], res=[0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.12271111253098321], res_norm=1.227e-01
2026-01-13 17:38:54,306 - INFO - integration_test - Dyn residual k=1: pred=[1.9532505901130361, 1.0485122641062339, 0.7199999477643844, 2.800000014846463, 2.017086871678029], ws=[1.9532505901130361, 1.0485122641062339, 0.7199999477643844, 2.800000014846463, 1.9702467884514938], res=[0.0, 0.0, 0.0, 0.0, 0.04684008322653499], res_norm=4.684e-02
2026-01-13 17:38:54,307 - INFO - integration_test - Dyn residual k=2: pred=[2.163756205032794, 1.2331399622413093, 0.7199999477643844, 2.800000014846463, 2.2502467899361402], ws=[2.163756205032794, 1.2331399622413093, 0.7199999477643844, 2.800000014846463, 2.3843881784186265], res=[0.0, 0.0, 0.0, 0.0, -0.13414138848248625], res_norm=1.341e-01
2026-01-13 17:38:54,320 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:54,389 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:54,404 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:54,416 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:54,431 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:54,442 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:54,457 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:54,468 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:54,483 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:54,494 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:54,509 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:54,520 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:54,535 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:54,547 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:54,562 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:54,574 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:54,589 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:54,600 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:54,615 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:54,625 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:54,638 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:54,648 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:54,819 - INFO - integration_test - Step 9: MPC solve successful
2026-01-13 17:38:54,854 - INFO - integration_test - Step 9: Computed 6 numeric contouring constraints for visualization (s=1.800)
2026-01-13 17:38:54,854 - DEBUG - integration_test - Step 9: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:38:54,854 - INFO - integration_test - === Applying control at step 9 ===
2026-01-13 17:38:54,854 - INFO - integration_test -   Control dict from planner: {'a': 2.000000019911234, 'w': 0.08368236421065035}
2026-01-13 17:38:54,854 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:38:54,854 - INFO - integration_test -   Planner output success: True
2026-01-13 17:38:54,855 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:38:54,856 - INFO - integration_test - Step 9 completed in 0.684s
2026-01-13 17:38:54,871 - INFO - integration_test - Step 10 (contouring until path end)
2026-01-13 17:38:54,871 - DEBUG - integration_test - Syncing planner state at step 10: vehicle_state=[1.74945116 0.87139886 0.72836818 3.00000002 2.10000001]
2026-01-13 17:38:54,872 - DEBUG - integration_test - Step 10: Using propagated spline 2.1000 (close to path, dist=0.407m, drift=0.283m)
2026-01-13 17:38:54,872 - DEBUG - integration_test -   Set spline state to 2.1000
2026-01-13 17:38:54,873 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:54,939 - DEBUG - integration_test - Step 10: Checking path alignment: vehicle=(1.749, 0.871), path_start=(0.000, 0.000), dist=1.954m
2026-01-13 17:38:54,939 - INFO - integration_test - === Calling planner.solve_mpc() at step 10 ===
2026-01-13 17:38:54,991 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:55,001 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:38:55,001 - INFO - integration_test - Warmstart k=0: x0=1.7494511591886213 , y0=0.8713988589562495 , psi0=0.7283681841854495 , v0=3.0000000168375864 , spline0=1.7929292949215931 , a0=0.0 , w0=0.0
2026-01-13 17:38:55,001 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:38:55,002 - INFO - integration_test - Dyn residual k=0: pred=[1.9733296458886662, 1.0710946881644554, 0.7283681841854495, 3.0000000168375864, 2.0929292966053517], ws=[1.9733296446321418, 1.0710946870436568, 0.7283681841854497, 3.0, 1.9749078503566195], res=[1.256524440051976e-09, 1.120798565068526e-09, -2.220446049250313e-16, 1.6837586436224683e-08, 0.11802144624873212], res_norm=1.180e-01
2026-01-13 17:38:55,003 - INFO - integration_test - Dyn residual k=1: pred=[2.197208130075662, 1.2707905151310643, 0.7283681841854497, 3.0, 2.2749078503566196], ws=[2.197208130075662, 1.2707905151310643, 0.7283681841854497, 3.0, 2.3989391699554172], res=[0.0, 0.0, 0.0, 0.0, -0.12403131959879765], res_norm=1.240e-01
2026-01-13 17:38:55,004 - INFO - integration_test - Dyn residual k=2: pred=[2.4210866155191826, 1.4704863432184718, 0.7283681841854497, 3.0, 2.698939169955417], ws=[2.4210866155191826, 1.4704863432184718, 0.7283681841854497, 3.0, 2.5949627076672477], res=[0.0, 0.0, 0.0, 0.0, 0.10397646228816937], res_norm=1.040e-01
2026-01-13 17:38:55,017 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:55,088 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:55,103 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:55,114 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:55,129 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:55,141 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:55,155 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:55,167 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:55,182 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:55,193 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:55,208 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:55,220 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:55,235 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:55,246 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:55,261 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:55,272 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:55,288 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:55,300 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:55,315 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:55,325 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:55,338 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:55,348 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:55,528 - INFO - integration_test - Step 10: MPC solve successful
2026-01-13 17:38:55,561 - INFO - integration_test - Step 10: Computed 6 numeric contouring constraints for visualization (s=2.100)
2026-01-13 17:38:55,561 - DEBUG - integration_test - Step 10: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:38:55,561 - INFO - integration_test - === Applying control at step 10 ===
2026-01-13 17:38:55,561 - INFO - integration_test -   Control dict from planner: {'a': 1.3162311339916502e-07, 'w': -0.24926538941937354}
2026-01-13 17:38:55,562 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:38:55,562 - INFO - integration_test -   Planner output success: True
2026-01-13 17:38:55,563 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:38:55,563 - INFO - integration_test - Step 10 completed in 0.692s
2026-01-13 17:38:55,575 - INFO - integration_test - Step 11 (contouring until path end)
2026-01-13 17:38:55,576 - DEBUG - integration_test - Syncing planner state at step 11: vehicle_state=[1.9757952  1.0682839  0.70344165 3.00000003 2.40000001]
2026-01-13 17:38:55,576 - DEBUG - integration_test - Step 11: Using propagated spline 2.4000 (close to path, dist=0.442m, drift=0.583m)
2026-01-13 17:38:55,576 - DEBUG - integration_test -   Set spline state to 2.4000
2026-01-13 17:38:55,577 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:55,644 - DEBUG - integration_test - Step 11: Checking path alignment: vehicle=(1.976, 1.068), path_start=(0.000, 0.000), dist=2.246m
2026-01-13 17:38:55,644 - INFO - integration_test - === Calling planner.solve_mpc() at step 11 ===
2026-01-13 17:38:55,696 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:55,706 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:38:55,706 - INFO - integration_test - Warmstart k=0: x0=1.975795197380164 , y0=1.068283896245171 , psi0=0.7034416452435122 , v0=3.0000000299998977 , spline0=2.167676770866621 , a0=0.0 , w0=0.0
2026-01-13 17:38:55,706 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:38:55,707 - INFO - integration_test - Dyn residual k=0: pred=[2.2045813476216884, 1.2623377528356974, 0.7034416452435122, 3.0000000299998977, 2.4676767738666108], ws=[2.2045813453338345, 1.2623377508951654, 0.7034416452435122, 3.0, 2.3568868817805635], res=[2.2878539063242442e-09, 1.940531957345115e-09, 0.0, 2.9999897677157605e-08, 0.11078989208604728], res_norm=1.108e-01
2026-01-13 17:38:55,708 - INFO - integration_test - Dyn residual k=1: pred=[2.433367493287505, 1.4563916055451598, 0.7034416452435122, 3.0, 2.6568868817805633], ws=[2.433367493287505, 1.4563916055451598, 0.7034416452435122, 3.0, 2.8121991944107476], res=[0.0, 0.0, 0.0, 0.0, -0.1553123126301843], res_norm=1.553e-01
2026-01-13 17:38:55,708 - INFO - integration_test - Dyn residual k=2: pred=[2.6621536412411757, 1.650445460195154, 0.7034416452435122, 3.0, 3.1121991944107474], ws=[2.6621536412411757, 1.6504454601951541, 0.7034416452435122, 3.0, 3.031700057553146], res=[0.0, -2.220446049250313e-16, 0.0, 0.0, 0.08049913685760135], res_norm=8.050e-02
2026-01-13 17:38:55,722 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:55,792 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:55,808 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:55,819 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:55,834 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:55,846 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:55,860 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:55,872 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:55,886 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:55,898 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:55,913 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:55,924 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:55,939 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:55,951 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:55,966 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:55,978 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:55,993 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:56,005 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:56,020 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:56,030 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:56,044 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:56,054 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:56,218 - INFO - integration_test - Step 11: MPC solve successful
2026-01-13 17:38:56,252 - INFO - integration_test - Step 11: Computed 6 numeric contouring constraints for visualization (s=2.400)
2026-01-13 17:38:56,252 - DEBUG - integration_test - Step 11: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:38:56,252 - INFO - integration_test - === Applying control at step 11 ===
2026-01-13 17:38:56,252 - INFO - integration_test -   Control dict from planner: {'a': -3.0614014353854754e-13, 'w': -0.15387185125911643}
2026-01-13 17:38:56,252 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:38:56,252 - INFO - integration_test -   Planner output success: True
2026-01-13 17:38:56,253 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:38:56,253 - INFO - integration_test - Step 11 completed in 0.678s
2026-01-13 17:38:56,267 - INFO - integration_test - Step 12 (contouring until path end)
2026-01-13 17:38:56,267 - DEBUG - integration_test - Syncing planner state at step 12: vehicle_state=[2.20606526 1.26056994 0.68805446 3.00000003 2.70000001]
2026-01-13 17:38:56,268 - DEBUG - integration_test - Step 12: Using propagated spline 2.7000 (close to path, dist=0.369m, drift=0.277m)
2026-01-13 17:38:56,268 - DEBUG - integration_test -   Set spline state to 2.7000
2026-01-13 17:38:56,269 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:56,334 - DEBUG - integration_test - Step 12: Checking path alignment: vehicle=(2.206, 1.261), path_start=(0.000, 0.000), dist=2.541m
2026-01-13 17:38:56,334 - INFO - integration_test - === Calling planner.solve_mpc() at step 12 ===
2026-01-13 17:38:56,386 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:56,395 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:38:56,395 - INFO - integration_test - Warmstart k=0: x0=2.2060652614742358 , y0=1.2605699426931434 , psi0=0.6880544601176005 , v0=3.000000029999867 , spline0=2.411111115460344 , a0=0.0 , w0=0.0
2026-01-13 17:38:56,396 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:38:56,397 - INFO - integration_test - Dyn residual k=0: pred=[2.437810152709525, 1.4510805911785656, 0.6880544601176005, 3.000000029999867, 2.7111111184603307], ws=[2.437810150392086, 1.4510805892734675, 0.6880544601176006, 3.0, 2.621579544781763], res=[2.3174386853952456e-09, 1.9050980792911787e-09, -1.1102230246251565e-16, 2.9999867035002126e-08, 0.08953157367856779], res_norm=8.953e-02
2026-01-13 17:38:56,398 - INFO - integration_test - Dyn residual k=1: pred=[2.6695550393099365, 1.6415912358537916, 0.6880544601176006, 3.0, 2.921579544781763], ws=[2.6695550393099365, 1.6415912358537916, 0.6880544601176006, 3.0, 3.0038644288071255], res=[0.0, 0.0, 0.0, 0.0, -0.08228488402536227], res_norm=8.228e-02
2026-01-13 17:38:56,398 - INFO - integration_test - Dyn residual k=2: pred=[2.901299928227787, 1.8321018824341158, 0.6880544601176006, 3.0, 3.3038644288071257], ws=[2.901299928227787, 1.8321018824341158, 0.6880544601176006, 3.0, 3.219975146368279], res=[0.0, 0.0, 0.0, 0.0, 0.08388928243884664], res_norm=8.389e-02
2026-01-13 17:38:56,414 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:56,494 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:56,512 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:56,523 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:56,538 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:56,550 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:56,564 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:56,575 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:56,590 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:56,602 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:56,616 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:56,628 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:56,643 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:56,655 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:56,670 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:56,682 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:56,698 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:56,710 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:56,725 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:56,736 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:56,749 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:56,759 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:56,911 - INFO - integration_test - Step 12: MPC solve successful
2026-01-13 17:38:56,946 - INFO - integration_test - Step 12: Computed 6 numeric contouring constraints for visualization (s=2.700)
2026-01-13 17:38:56,946 - DEBUG - integration_test - Step 12: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:38:56,946 - INFO - integration_test - === Applying control at step 12 ===
2026-01-13 17:38:56,946 - INFO - integration_test -   Control dict from planner: {'a': -6.118055287307379e-14, 'w': -0.18838321697280158}
2026-01-13 17:38:56,946 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:38:56,946 - INFO - integration_test -   Planner output success: True
2026-01-13 17:38:56,947 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:38:56,948 - INFO - integration_test - Step 12 completed in 0.681s
2026-01-13 17:38:56,959 - INFO - integration_test - Step 13 (contouring until path end)
2026-01-13 17:38:56,960 - DEBUG - integration_test - Syncing planner state at step 13: vehicle_state=[2.43959084 1.44888655 0.66921614 3.00000003 3.00000002]
2026-01-13 17:38:56,961 - DEBUG - integration_test - Step 13: Using propagated spline 3.0000 (close to path, dist=0.438m, drift=0.577m)
2026-01-13 17:38:56,961 - DEBUG - integration_test -   Set spline state to 3.0000
2026-01-13 17:38:56,962 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:57,029 - DEBUG - integration_test - Step 13: Checking path alignment: vehicle=(2.440, 1.449), path_start=(0.000, 0.000), dist=2.837m
2026-01-13 17:38:57,029 - INFO - integration_test - === Calling planner.solve_mpc() at step 13 ===
2026-01-13 17:38:57,086 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:57,097 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:38:57,097 - INFO - integration_test - Warmstart k=0: x0=2.4395908433076543 , y0=1.4488865453890434 , psi0=0.6692161384203204 , v0=3.000000029999861 , spline0=2.8282828342538533 , a0=0.0 , w0=0.0
2026-01-13 17:38:57,097 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:38:57,099 - INFO - integration_test - Dyn residual k=0: pred=[2.674883303285312, 1.634997963839535, 0.6692161384203204, 3.000000029999861, 3.128282837253839], ws=[2.6748833009323985, 1.6349979619784296, 0.6692161384203201, 3.0, 2.7891524665584027], res=[2.3529134196564883e-09, 1.8611054919404069e-09, 2.220446049250313e-16, 2.999986081775319e-08, 0.3391303706954365], res_norm=3.391e-01
2026-01-13 17:38:57,100 - INFO - integration_test - Dyn residual k=1: pred=[2.9101757585571426, 1.8211093785678156, 0.6692161384203201, 3.0, 3.089152466558403], ws=[2.9101757585571426, 1.8211093785678156, 0.6692161384203201, 3.0, 3.1884672417807725], res=[0.0, 0.0, 0.0, 0.0, -0.09931477522236953], res_norm=9.931e-02
2026-01-13 17:38:57,101 - INFO - integration_test - Dyn residual k=2: pred=[3.1454682161818868, 2.0072207951572016, 0.6692161384203201, 3.0, 3.4884672417807723], ws=[3.1454682161818868, 2.0072207951572016, 0.6692161384203201, 3.0, 3.417404905410115], res=[0.0, 0.0, 0.0, 0.0, 0.07106233637065706], res_norm=7.106e-02
2026-01-13 17:38:57,118 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:57,198 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:57,213 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:57,225 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:57,240 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:57,252 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:57,267 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:57,279 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:57,294 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:57,307 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:57,322 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:57,334 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:57,350 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:57,362 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:57,377 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:57,388 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:57,403 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:57,415 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:57,430 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:57,440 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:57,453 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:57,463 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:57,625 - INFO - integration_test - Step 13: MPC solve successful
2026-01-13 17:38:57,661 - INFO - integration_test - Step 13: Computed 6 numeric contouring constraints for visualization (s=3.000)
2026-01-13 17:38:57,661 - DEBUG - integration_test - Step 13: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:38:57,661 - INFO - integration_test - === Applying control at step 13 ===
2026-01-13 17:38:57,662 - INFO - integration_test -   Control dict from planner: {'a': -6.261380968564686e-14, 'w': -0.1859375168530261}
2026-01-13 17:38:57,662 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:38:57,662 - INFO - integration_test -   Planner output success: True
2026-01-13 17:38:57,663 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:38:57,663 - INFO - integration_test - Step 13 completed in 0.703s
2026-01-13 17:38:57,674 - INFO - integration_test - Step 14 (contouring until path end)
2026-01-13 17:38:57,675 - DEBUG - integration_test - Syncing planner state at step 14: vehicle_state=[2.67659995 1.63279982 0.65062239 3.00000003 3.30000002]
2026-01-13 17:38:57,676 - DEBUG - integration_test - Step 14: Using propagated spline 3.3000 (close to path, dist=0.346m, drift=0.271m)
2026-01-13 17:38:57,676 - DEBUG - integration_test -   Set spline state to 3.3000
2026-01-13 17:38:57,677 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:57,744 - DEBUG - integration_test - Step 14: Checking path alignment: vehicle=(2.677, 1.633), path_start=(0.000, 0.000), dist=3.135m
2026-01-13 17:38:57,744 - INFO - integration_test - === Calling planner.solve_mpc() at step 14 ===
2026-01-13 17:38:57,807 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:57,817 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:38:57,817 - INFO - integration_test - Warmstart k=0: x0=2.6765999505809366 , y0=1.6327998182917909 , psi0=0.6506223867350177 , v0=3.0000000299998546 , spline0=3.0181818254143478 , a0=0.0 , w0=0.0
2026-01-13 17:38:57,817 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:38:57,818 - INFO - integration_test - Dyn residual k=0: pred=[2.9153120482864368, 1.8145043482546703, 0.6506223867350177, 3.0000000299998546, 3.318181828414333], ws=[2.9153120458993276, 1.814504346437634, 0.6506223867350176, 3.0, 3.252080385006427], res=[2.3871091769933628e-09, 1.817036299200936e-09, 1.1102230246251565e-16, 2.999985460050425e-08, 0.06610144340790614], res_norm=6.610e-02
2026-01-13 17:38:57,819 - INFO - integration_test - Dyn residual k=1: pred=[3.1540241412177186, 1.9962088745834772, 0.6506223867350176, 3.0, 3.552080385006427], ws=[3.1540241412177186, 1.9962088745834772, 0.6506223867350176, 3.0, 3.6675913424631235], res=[0.0, 0.0, 0.0, 0.0, -0.1155109574566966], res_norm=1.155e-01
2026-01-13 17:38:57,819 - INFO - integration_test - Dyn residual k=2: pred=[3.3927362365361096, 2.1779134027293203, 0.6506223867350176, 3.0, 3.9675913424631233], ws=[3.3927362365361096, 2.1779134027293203, 0.6506223867350176, 3.0, 3.8339951908216516], res=[0.0, 0.0, 0.0, 0.0, 0.13359615164147165], res_norm=1.336e-01
2026-01-13 17:38:57,833 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:57,904 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:57,919 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:57,931 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:57,945 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:57,957 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:57,971 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:57,983 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:57,997 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:58,009 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:58,023 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:58,035 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:58,050 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:58,061 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:58,076 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:58,087 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:58,102 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:58,114 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:58,129 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:58,139 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:58,152 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:58,163 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:58,309 - INFO - integration_test - Step 14: MPC solve successful
2026-01-13 17:38:58,347 - INFO - integration_test - Step 14: Computed 6 numeric contouring constraints for visualization (s=3.300)
2026-01-13 17:38:58,347 - DEBUG - integration_test - Step 14: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:38:58,347 - INFO - integration_test - === Applying control at step 14 ===
2026-01-13 17:38:58,348 - INFO - integration_test -   Control dict from planner: {'a': -5.77543042920937e-12, 'w': -0.19667298752250748}
2026-01-13 17:38:58,348 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:38:58,348 - INFO - integration_test -   Planner output success: True
2026-01-13 17:38:58,349 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:38:58,349 - INFO - integration_test - Step 14 completed in 0.674s
2026-01-13 17:38:58,364 - INFO - integration_test - Step 15 (contouring until path end)
2026-01-13 17:38:58,365 - DEBUG - integration_test - Syncing planner state at step 15: vehicle_state=[2.91708342 1.8121453  0.63095509 3.00000003 3.60000002]
2026-01-13 17:38:58,365 - DEBUG - integration_test - Step 15: Using propagated spline 3.6000 (close to path, dist=0.442m, drift=0.035m)
2026-01-13 17:38:58,365 - DEBUG - integration_test -   Set spline state to 3.6000
2026-01-13 17:38:58,366 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:58,432 - DEBUG - integration_test - Step 15: Checking path alignment: vehicle=(2.917, 1.812), path_start=(0.000, 0.000), dist=3.434m
2026-01-13 17:38:58,432 - INFO - integration_test - === Calling planner.solve_mpc() at step 15 ===
2026-01-13 17:38:58,485 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:58,495 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:38:58,495 - INFO - integration_test - Warmstart k=0: x0=2.9170834205611946 , y0=1.8121452991189457 , psi0=0.630955087982767 , v0=3.000000029999277 , spline0=3.2141414226960325 , a0=0.0 , w0=0.0
2026-01-13 17:38:58,495 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:38:58,496 - INFO - integration_test - Dyn residual k=0: pred=[3.159322759417759, 1.9891201688329567, 0.630955087982767, 3.000000029999277, 3.51414142569596], ws=[3.159322756995424, 1.9891201670632508, 0.630955087982767, 3.0, 3.438130555345243], res=[2.4223347772078796e-09, 1.769705937348931e-09, 0.0, 2.9999276840442235e-08, 0.07601087035071741], res_norm=7.601e-02
2026-01-13 17:38:58,497 - INFO - integration_test - Dyn residual k=1: pred=[3.4015620934296535, 2.166095035007556, 0.630955087982767, 3.0, 3.7381305553452426], ws=[3.4015620934296535, 2.166095035007556, 0.630955087982767, 3.0, 3.8715713456772125], res=[0.0, 0.0, 0.0, 0.0, -0.13344079033196987], res_norm=1.334e-01
2026-01-13 17:38:58,497 - INFO - integration_test - Dyn residual k=2: pred=[3.643801429863883, 2.3430699029518607, 0.630955087982767, 3.0, 4.171571345677212], ws=[3.643801429863883, 2.343069902951861, 0.630955087982767, 3.0, 4.022461097216757], res=[0.0, -4.440892098500626e-16, 0.0, 0.0, 0.14911024846045517], res_norm=1.491e-01
2026-01-13 17:38:58,511 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:58,583 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:58,604 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:58,616 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:58,632 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:58,643 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:58,658 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:58,670 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:58,685 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:58,696 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:58,711 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:58,723 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:58,737 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:58,749 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:58,763 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:58,775 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:58,789 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:58,801 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:58,817 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:58,827 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:58,840 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:58,850 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:59,006 - INFO - integration_test - Step 15: MPC solve successful
2026-01-13 17:38:59,046 - INFO - integration_test - Step 15: Computed 6 numeric contouring constraints for visualization (s=3.600)
2026-01-13 17:38:59,046 - DEBUG - integration_test - Step 15: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:38:59,046 - INFO - integration_test - === Applying control at step 15 ===
2026-01-13 17:38:59,046 - INFO - integration_test -   Control dict from planner: {'a': 3.8649152805195886e-12, 'w': -0.20070692174894006}
2026-01-13 17:38:59,046 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:38:59,046 - INFO - integration_test -   Planner output success: True
2026-01-13 17:38:59,047 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:38:59,047 - INFO - integration_test - Step 15 completed in 0.683s
2026-01-13 17:38:59,063 - INFO - integration_test - Step 16 (contouring until path end)
2026-01-13 17:38:59,064 - DEBUG - integration_test - Syncing planner state at step 16: vehicle_state=[3.16108244 1.98667741 0.6108844  3.00000003 3.90000003]
2026-01-13 17:38:59,065 - DEBUG - integration_test - Step 16: Using propagated spline 3.9000 (close to path, dist=0.338m, drift=0.265m)
2026-01-13 17:38:59,065 - DEBUG - integration_test -   Set spline state to 3.9000
2026-01-13 17:38:59,066 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:59,132 - DEBUG - integration_test - Step 16: Checking path alignment: vehicle=(3.161, 1.987), path_start=(0.000, 0.000), dist=3.734m
2026-01-13 17:38:59,132 - INFO - integration_test - === Calling planner.solve_mpc() at step 16 ===
2026-01-13 17:38:59,185 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:59,194 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:38:59,194 - INFO - integration_test - Warmstart k=0: x0=3.1610824405530287 , y0=1.9866774132083296 , psi0=0.610884395807873 , v0=3.000000029999663 , spline0=3.416161626098943 , a0=0.0 , w0=0.0
2026-01-13 17:38:59,194 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:38:59,196 - INFO - integration_test - Dyn residual k=0: pred=[3.4068247597459487, 2.158755053701407, 0.610884395807873, 3.000000029999663, 3.7161616290989095], ws=[3.406824757288553, 2.15875505198065, 0.6108843958078731, 3.0, 3.848566923972874], res=[2.457395620325542e-09, 1.7207568703270226e-09, -1.1102230246251565e-16, 2.9999663198054805e-08, -0.13240529487396469], res_norm=1.324e-01
2026-01-13 17:38:59,197 - INFO - integration_test - Dyn residual k=1: pred=[3.6525670740240774, 2.330832690752971, 0.6108843958078731, 3.0, 4.148566923972874], ws=[3.6525670740240774, 2.330832690752971, 0.6108843958078731, 3.0, 4.292683778777222], res=[0.0, 0.0, 0.0, 0.0, -0.14411685480434766], res_norm=1.441e-01
2026-01-13 17:38:59,197 - INFO - integration_test - Dyn residual k=2: pred=[3.898309390759602, 2.5029103295252915, 0.6108843958078731, 3.0, 4.5926837787772214], ws=[3.898309390759602, 2.5029103295252915, 0.6108843958078731, 3.0, 4.5055765745731895], res=[0.0, 0.0, 0.0, 0.0, 0.08710720420403195], res_norm=8.711e-02
2026-01-13 17:38:59,211 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:59,282 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:59,297 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:59,309 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:59,324 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:59,335 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:59,350 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:59,362 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:59,376 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:59,388 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:59,403 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:59,414 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:59,428 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:59,440 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:59,454 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:59,466 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:59,480 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:59,492 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:59,507 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:59,517 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:59,529 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:59,539 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:38:59,702 - INFO - integration_test - Step 16: MPC solve successful
2026-01-13 17:38:59,741 - INFO - integration_test - Step 16: Computed 6 numeric contouring constraints for visualization (s=3.900)
2026-01-13 17:38:59,741 - DEBUG - integration_test - Step 16: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:38:59,741 - INFO - integration_test - === Applying control at step 16 ===
2026-01-13 17:38:59,741 - INFO - integration_test -   Control dict from planner: {'a': 1.2828574849190776e-12, 'w': -0.2101049893380801}
2026-01-13 17:38:59,741 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:38:59,741 - INFO - integration_test -   Planner output success: True
2026-01-13 17:38:59,742 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:38:59,742 - INFO - integration_test - Step 16 completed in 0.678s
2026-01-13 17:38:59,756 - INFO - integration_test - Step 17 (contouring until path end)
2026-01-13 17:38:59,758 - DEBUG - integration_test - Syncing planner state at step 17: vehicle_state=[3.40861433 2.1561609  0.5898739  3.00000003 4.20000003]
2026-01-13 17:38:59,758 - DEBUG - integration_test - Step 17: Using propagated spline 4.2000 (close to path, dist=0.421m, drift=0.041m)
2026-01-13 17:38:59,758 - DEBUG - integration_test -   Set spline state to 4.2000
2026-01-13 17:38:59,759 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:59,825 - DEBUG - integration_test - Step 17: Checking path alignment: vehicle=(3.409, 2.156), path_start=(0.000, 0.000), dist=4.033m
2026-01-13 17:38:59,825 - INFO - integration_test - === Calling planner.solve_mpc() at step 17 ===
2026-01-13 17:38:59,878 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:38:59,888 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:38:59,888 - INFO - integration_test - Warmstart k=0: x0=3.408614332078497 , y0=2.156160904235174 , psi0=0.589873896874065 , v0=3.0000000299997915 , spline0=3.810101022065278 , a0=0.0 , w0=0.0
2026-01-13 17:38:59,888 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:38:59,889 - INFO - integration_test - Dyn residual k=0: pred=[3.6579175839787044, 2.3230377761856316, 0.589873896874065, 3.0000000299997915, 4.110101025065257], ws=[3.6579175814856892, 2.3230377745168744, 0.5898738968740651, 3.0, 4.050326067402131], res=[2.493015127669196e-09, 1.6687571324780492e-09, -1.1102230246251565e-16, 2.999979153983645e-08, 0.05977495766312568], res_norm=5.977e-02
2026-01-13 17:38:59,890 - INFO - integration_test - Dyn residual k=1: pred=[3.9072208308928813, 2.4899146447985747, 0.5898738968740651, 3.0, 4.350326067402131], ws=[3.9072208308928813, 2.4899146447985747, 0.5898738968740651, 3.0, 4.513229513070436], res=[0.0, 0.0, 0.0, 0.0, -0.16290344566830495], res_norm=1.629e-01
2026-01-13 17:38:59,890 - INFO - integration_test - Dyn residual k=2: pred=[4.156524080300073, 2.656791515080275, 0.5898738968740651, 3.0, 4.813229513070436], ws=[4.156524080300073, 2.656791515080275, 0.5898738968740651, 3.0, 4.928932333396782], res=[0.0, 0.0, 0.0, 0.0, -0.11570282032634616], res_norm=1.157e-01
2026-01-13 17:38:59,905 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:38:59,974 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:38:59,990 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:00,001 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:00,016 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:00,028 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:00,043 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:00,055 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:00,069 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:00,081 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:00,096 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:00,107 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:00,122 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:00,133 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:00,148 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:00,159 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:00,174 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:00,186 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:00,201 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:00,211 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:00,224 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:00,234 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:00,402 - INFO - integration_test - Step 17: MPC solve successful
2026-01-13 17:39:00,554 - INFO - integration_test - Step 17: Computed 6 numeric contouring constraints for visualization (s=4.200)
2026-01-13 17:39:00,554 - DEBUG - integration_test - Step 17: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:00,554 - INFO - integration_test - === Applying control at step 17 ===
2026-01-13 17:39:00,554 - INFO - integration_test -   Control dict from planner: {'a': 4.608018103916107e-13, 'w': -0.2193273700697987}
2026-01-13 17:39:00,554 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:00,554 - INFO - integration_test -   Planner output success: True
2026-01-13 17:39:00,555 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:00,556 - INFO - integration_test - Step 17 completed in 0.798s
2026-01-13 17:39:00,571 - INFO - integration_test - Step 18 (contouring until path end)
2026-01-13 17:39:00,572 - DEBUG - integration_test - Syncing planner state at step 18: vehicle_state=[3.65972756 2.32029056 0.56794116 3.00000003 4.50000003]
2026-01-13 17:39:00,572 - DEBUG - integration_test - Step 18: Using propagated spline 4.5000 (close to path, dist=0.343m, drift=0.259m)
2026-01-13 17:39:00,572 - DEBUG - integration_test -   Set spline state to 4.5000
2026-01-13 17:39:00,573 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:00,638 - DEBUG - integration_test - Step 18: Checking path alignment: vehicle=(3.660, 2.320), path_start=(0.000, 0.000), dist=4.333m
2026-01-13 17:39:00,638 - INFO - integration_test - === Calling planner.solve_mpc() at step 18 ===
2026-01-13 17:39:00,690 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:00,700 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:00,700 - INFO - integration_test - Warmstart k=0: x0=3.6597275567141323 , y0=2.3202905555727007 , psi0=0.5679411598670852 , v0=3.0000000299998377 , spline0=4.030303043831831 , a0=0.0 , w0=0.0
2026-01-13 17:39:00,700 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:00,702 - INFO - integration_test - Dyn residual k=0: pred=[3.9126306210918873, 2.481659827208695, 0.5679411598670852, 3.0000000299998377, 4.330303046831815], ws=[3.9126306185628703, 2.481659825595011, 0.5679411598670852, 3.0, 4.49304157390766], res=[2.5290169958225306e-09, 1.6136838532077036e-09, 0.0, 2.9999837725114276e-08, -0.16273852707584524], res_norm=1.627e-01
2026-01-13 17:39:00,702 - INFO - integration_test - Dyn residual k=1: pred=[4.165533680411609, 2.6430290956173215, 0.5679411598670852, 3.0, 4.79304157390766], ws=[4.165533680411609, 2.6430290956173215, 0.5679411598670852, 3.0, 4.685063622011779], res=[0.0, 0.0, 0.0, 0.0, 0.10797795189588033], res_norm=1.080e-01
2026-01-13 17:39:00,703 - INFO - integration_test - Dyn residual k=2: pred=[4.418436742260347, 2.804398365639632, 0.5679411598670852, 3.0, 4.985063622011779], ws=[4.418436742260347, 2.804398365639632, 0.5679411598670852, 3.0, 5.07890915154645], res=[0.0, 0.0, 0.0, 0.0, -0.09384552953467118], res_norm=9.385e-02
2026-01-13 17:39:00,717 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:00,787 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:00,802 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:00,814 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:00,828 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:00,840 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:00,854 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:00,865 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:00,880 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:00,891 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:00,906 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:00,917 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:00,932 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:00,943 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:00,958 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:00,969 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:00,984 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:00,995 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:01,010 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:01,020 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:01,033 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:01,044 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:01,185 - INFO - integration_test - Step 18: MPC solve successful
2026-01-13 17:39:01,227 - INFO - integration_test - Step 18: Computed 6 numeric contouring constraints for visualization (s=4.500)
2026-01-13 17:39:01,227 - DEBUG - integration_test - Step 18: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:01,227 - INFO - integration_test - === Applying control at step 18 ===
2026-01-13 17:39:01,227 - INFO - integration_test -   Control dict from planner: {'a': -1.9988217804102208e-09, 'w': -0.22142385098183665}
2026-01-13 17:39:01,227 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:01,227 - INFO - integration_test -   Planner output success: True
2026-01-13 17:39:01,229 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:01,229 - INFO - integration_test - Step 18 completed in 0.658s
2026-01-13 17:39:01,242 - INFO - integration_test - Step 19 (contouring until path end)
2026-01-13 17:39:01,245 - DEBUG - integration_test - Syncing planner state at step 19: vehicle_state=[3.91439643 2.47884682 0.54579877 3.00000003 4.80000003]
2026-01-13 17:39:01,245 - DEBUG - integration_test - Step 19: Using propagated spline 4.8000 (close to path, dist=0.410m, drift=0.046m)
2026-01-13 17:39:01,246 - DEBUG - integration_test -   Set spline state to 4.8000
2026-01-13 17:39:01,246 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:01,312 - DEBUG - integration_test - Step 19: Checking path alignment: vehicle=(3.914, 2.479), path_start=(0.000, 0.000), dist=4.633m
2026-01-13 17:39:01,312 - INFO - integration_test - === Calling planner.solve_mpc() at step 19 ===
2026-01-13 17:39:01,365 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:01,375 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:01,375 - INFO - integration_test - Warmstart k=0: x0=3.914396433124621 , y0=2.478846817252029 , psi0=0.5457987747689015 , v0=3.0000000297999554 , spline0=4.454545470395141 , a0=0.0 , w0=0.0
2026-01-13 17:39:01,375 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:01,376 - INFO - integration_test - Dyn residual k=0: pred=[4.170810311290947, 2.6345771125439272, 0.5457987747689015, 3.0000000297999554, 4.754545473375137], ws=[4.170810308743906, 2.6345771109970086, 0.5457987747689015, 3.0, 4.682995920238644], res=[2.5470408004935052e-09, 1.5469185932204255e-09, 0.0, 2.9799955392206812e-08, 0.07154955313649225], res_norm=7.155e-02
2026-01-13 17:39:01,377 - INFO - integration_test - Dyn residual k=1: pred=[4.427224184363192, 2.7903074047419882, 0.5457987747689015, 3.0, 4.982995920238644], ws=[4.427224184363192, 2.7903074047419882, 0.5457987747689015, 3.0, 5.056095887322842], res=[0.0, 0.0, 0.0, 0.0, -0.07309996708419764], res_norm=7.310e-02
2026-01-13 17:39:01,378 - INFO - integration_test - Dyn residual k=2: pred=[4.683638059982478, 2.946037698486968, 0.5457987747689015, 3.0, 5.356095887322842], ws=[4.683638059982478, 2.946037698486968, 0.5457987747689015, 3.0, 5.297949774632572], res=[0.0, 0.0, 0.0, 0.0, 0.05814611269026937], res_norm=5.815e-02
2026-01-13 17:39:01,392 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:01,462 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:01,478 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:01,490 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:01,506 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:01,519 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:01,535 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:01,546 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:01,562 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:01,573 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:01,588 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:01,599 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:01,613 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:01,625 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:01,640 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:01,652 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:01,667 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:01,679 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:01,695 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:01,705 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:01,718 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:01,729 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:01,907 - INFO - integration_test - Step 19: MPC solve successful
2026-01-13 17:39:01,949 - INFO - integration_test - Step 19: Computed 6 numeric contouring constraints for visualization (s=4.800)
2026-01-13 17:39:01,950 - DEBUG - integration_test - Step 19: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:01,950 - INFO - integration_test - === Applying control at step 19 ===
2026-01-13 17:39:01,950 - INFO - integration_test -   Control dict from planner: {'a': 1.3321849671778207e-09, 'w': -0.23382586927900012}
2026-01-13 17:39:01,950 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:01,950 - INFO - integration_test -   Planner output success: True
2026-01-13 17:39:01,951 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:01,951 - INFO - integration_test - Step 19 completed in 0.707s
2026-01-13 17:39:01,965 - INFO - integration_test - Step 20 (contouring until path end)
2026-01-13 17:39:01,966 - DEBUG - integration_test - Syncing planner state at step 20: vehicle_state=[4.17260755 2.63156525 0.52241619 3.00000003 5.10000004]
2026-01-13 17:39:01,966 - DEBUG - integration_test - Step 20: Using propagated spline 5.1000 (close to path, dist=0.360m, drift=0.254m)
2026-01-13 17:39:01,966 - DEBUG - integration_test -   Set spline state to 5.1000
2026-01-13 17:39:01,967 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:02,034 - DEBUG - integration_test - Step 20: Checking path alignment: vehicle=(4.173, 2.632), path_start=(0.000, 0.000), dist=4.933m
2026-01-13 17:39:02,034 - INFO - integration_test - === Calling planner.solve_mpc() at step 20 ===
2026-01-13 17:39:02,086 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:02,096 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:02,096 - INFO - integration_test - Warmstart k=0: x0=4.172607552075968 , y0=2.631565248834252 , psi0=0.5224161878410015 , v0=3.0000000299331737 , spline0=4.645454583317171 , a0=0.0 , w0=0.0
2026-01-13 17:39:02,096 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:02,097 - INFO - integration_test - Dyn residual k=0: pred=[4.432592382255354, 2.7812579001989284, 0.5224161878410015, 3.0000000299331737, 4.945454586310489], ws=[4.432592379661297, 2.781257898705336, 0.5224161878410016, 3.0, 5.123523847491893], res=[2.594057413318751e-09, 1.49359236090163e-09, -1.1102230246251565e-16, 2.993317371746684e-08, -0.17806926118140431], res_norm=1.781e-01
2026-01-13 17:39:02,098 - INFO - integration_test - Dyn residual k=1: pred=[4.692577207246625, 2.93095054857642, 0.5224161878410016, 3.0, 5.423523847491893], ws=[4.692577207246625, 2.9309505485764205, 0.5224161878410016, 3.0, 5.268297673071906], res=[0.0, -4.440892098500626e-16, 0.0, 0.0, 0.15522617441998676], res_norm=1.552e-01
2026-01-13 17:39:02,099 - INFO - integration_test - Dyn residual k=2: pred=[4.952562034831954, 3.080643198447505, 0.5224161878410016, 3.0, 5.568297673071906], ws=[4.952562034831954, 3.080643198447505, 0.5224161878410016, 3.0, 5.755057878297585], res=[0.0, 0.0, 0.0, 0.0, -0.1867602052256787], res_norm=1.868e-01
2026-01-13 17:39:02,113 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:02,184 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:02,200 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:02,211 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:02,226 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:02,238 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:02,253 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:02,265 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:02,280 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:02,291 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:02,306 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:02,318 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:02,332 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:02,344 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:02,359 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:02,371 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:02,386 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:02,397 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:02,412 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:02,422 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:02,435 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:02,446 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:02,634 - INFO - integration_test - Step 20: MPC solve successful
2026-01-13 17:39:02,676 - INFO - integration_test - Step 20: Computed 6 numeric contouring constraints for visualization (s=5.100)
2026-01-13 17:39:02,676 - DEBUG - integration_test - Step 20: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:02,676 - INFO - integration_test - === Applying control at step 20 ===
2026-01-13 17:39:02,676 - INFO - integration_test -   Control dict from planner: {'a': 1.436261862009485e-10, 'w': -0.23960418958275953}
2026-01-13 17:39:02,676 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:02,677 - INFO - integration_test -   Planner output success: True
2026-01-13 17:39:02,678 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:02,679 - INFO - integration_test - Step 20 completed in 0.713s
2026-01-13 17:39:02,692 - INFO - integration_test - Step 21 (contouring until path end)
2026-01-13 17:39:02,694 - DEBUG - integration_test - Syncing planner state at step 21: vehicle_state=[4.43436077 2.77812905 0.49845577 3.00000003 5.40000004]
2026-01-13 17:39:02,695 - DEBUG - integration_test - Step 21: Using propagated spline 5.4000 (close to path, dist=0.411m, drift=0.052m)
2026-01-13 17:39:02,695 - DEBUG - integration_test -   Set spline state to 5.4000
2026-01-13 17:39:02,696 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:02,762 - DEBUG - integration_test - Step 21: Checking path alignment: vehicle=(4.434, 2.778), path_start=(0.000, 0.000), dist=5.233m
2026-01-13 17:39:02,762 - INFO - integration_test - === Calling planner.solve_mpc() at step 21 ===
2026-01-13 17:39:02,815 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:02,825 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:02,825 - INFO - integration_test - Warmstart k=0: x0=4.434360770237593 , y0=2.7781290537752734 , psi0=0.4984557688827256 , v0=3.0000000299475365 , spline0=5.046464687322026 , a0=0.0 , w0=0.0
2026-01-13 17:39:02,825 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:02,826 - INFO - integration_test - Dyn residual k=0: pred=[4.697857330588335, 2.92154998837054, 0.4984557688827256, 3.0000000299475365, 5.34646469031678], ws=[4.697857327957978, 2.9215499869388384, 0.49845576888272536, 3.0, 5.260685268413312], res=[2.630357265331895e-09, 1.4317014240816661e-09, 2.220446049250313e-16, 2.9947536450691814e-08, 0.08577942190346821], res_norm=8.578e-02
2026-01-13 17:39:02,827 - INFO - integration_test - Dyn residual k=1: pred=[4.961353885678363, 3.0649709201024034, 0.49845576888272536, 3.0, 5.5606852684133115], ws=[4.961353885678363, 3.0649709201024034, 0.49845576888272536, 3.0, 5.753862247796977], res=[0.0, 0.0, 0.0, 0.0, -0.19317697938366596], res_norm=1.932e-01
2026-01-13 17:39:02,829 - INFO - integration_test - Dyn residual k=2: pred=[5.224850443398749, 3.2083918532659683, 0.49845576888272536, 3.0, 6.053862247796977], ws=[5.224850443398749, 3.2083918532659683, 0.49845576888272536, 3.0, 5.9160025580505415], res=[0.0, 0.0, 0.0, 0.0, 0.1378596897464357], res_norm=1.379e-01
2026-01-13 17:39:02,843 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:02,920 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:02,935 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:02,947 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:02,963 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:02,974 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:02,990 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:03,002 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:03,017 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:03,028 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:03,043 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:03,055 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:03,069 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:03,081 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:03,096 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:03,107 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:03,122 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:03,134 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:03,149 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:03,160 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:03,173 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:03,184 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:03,372 - INFO - integration_test - Step 21: MPC solve successful
2026-01-13 17:39:03,417 - INFO - integration_test - Step 21: Computed 6 numeric contouring constraints for visualization (s=5.400)
2026-01-13 17:39:03,418 - DEBUG - integration_test - Step 21: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:03,418 - INFO - integration_test - === Applying control at step 21 ===
2026-01-13 17:39:03,418 - INFO - integration_test -   Control dict from planner: {'a': 3.48818628088541e-10, 'w': -0.24840194849496183}
2026-01-13 17:39:03,418 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:03,418 - INFO - integration_test -   Planner output success: True
2026-01-13 17:39:03,419 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:03,419 - INFO - integration_test - Step 21 completed in 0.725s
2026-01-13 17:39:03,434 - INFO - integration_test - Step 22 (contouring until path end)
2026-01-13 17:39:03,434 - DEBUG - integration_test - Syncing planner state at step 22: vehicle_state=[4.69961144 2.91826275 0.47361557 3.00000003 5.70000004]
2026-01-13 17:39:03,435 - DEBUG - integration_test - Step 22: Using propagated spline 5.7000 (close to path, dist=0.386m, drift=0.248m)
2026-01-13 17:39:03,435 - DEBUG - integration_test -   Set spline state to 5.7000
2026-01-13 17:39:03,435 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:03,505 - DEBUG - integration_test - Step 22: Checking path alignment: vehicle=(4.700, 2.918), path_start=(0.000, 0.000), dist=5.532m
2026-01-13 17:39:03,506 - INFO - integration_test - === Calling planner.solve_mpc() at step 22 ===
2026-01-13 17:39:03,567 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:03,578 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:03,578 - INFO - integration_test - Warmstart k=0: x0=4.699611444070418 , y0=2.91826275487324 , psi0=0.4736155740332294 , v0=3.0000000299824183 , spline0=5.54848489234047 , a0=0.0 , w0=0.0
2026-01-13 17:39:03,578 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:03,580 - INFO - integration_test - Dyn residual k=0: pred=[4.966588952864039, 3.055094811049039, 0.4736155740332294, 3.0000000299824183, 5.848484895338712], ws=[4.9665889501958285, 3.0550948096815205, 0.4736155740332295, 3.0, 5.716593860870792], res=[2.668210541401095e-09, 1.3675185428496661e-09, -1.1102230246251565e-16, 2.998241832585791e-08, 0.1318910344679196], res_norm=1.319e-01
2026-01-13 17:39:03,581 - INFO - integration_test - Dyn residual k=1: pred=[5.233566456321239, 3.191926864489801, 0.4736155740332295, 3.0, 6.016593860870792], ws=[5.233566456321239, 3.191926864489801, 0.4736155740332295, 3.0, 6.156093884421787], res=[0.0, 0.0, 0.0, 0.0, -0.1395000235509949], res_norm=1.395e-01
2026-01-13 17:39:03,582 - INFO - integration_test - Dyn residual k=2: pred=[5.50054396244665, 3.3287589192980818, 0.4736155740332295, 3.0, 6.4560938844217866], ws=[5.50054396244665, 3.3287589192980818, 0.4736155740332295, 3.0, 6.3325540949461825], res=[0.0, 0.0, 0.0, 0.0, 0.12353978947560407], res_norm=1.235e-01
2026-01-13 17:39:03,597 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:03,680 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:03,696 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:03,708 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:03,725 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:03,737 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:03,753 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:03,766 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:03,782 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:03,794 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:03,811 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:03,823 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:03,839 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:03,851 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:03,867 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:03,880 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:03,897 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:03,909 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:03,925 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:03,935 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:03,949 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:03,959 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:04,143 - INFO - integration_test - Step 22: MPC solve successful
2026-01-13 17:39:04,188 - INFO - integration_test - Step 22: Computed 6 numeric contouring constraints for visualization (s=5.700)
2026-01-13 17:39:04,188 - DEBUG - integration_test - Step 22: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:04,188 - INFO - integration_test - === Applying control at step 22 ===
2026-01-13 17:39:04,188 - INFO - integration_test -   Control dict from planner: {'a': 1.1625163977063514e-10, 'w': -0.2554872589621179}
2026-01-13 17:39:04,188 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:04,188 - INFO - integration_test -   Planner output success: True
2026-01-13 17:39:04,189 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:04,190 - INFO - integration_test - Step 22 completed in 0.756s
2026-01-13 17:39:04,203 - INFO - integration_test - Step 23 (contouring until path end)
2026-01-13 17:39:04,204 - DEBUG - integration_test - Syncing planner state at step 23: vehicle_state=[4.96830776 3.05166964 0.44806685 3.00000003 6.00000005]
2026-01-13 17:39:04,204 - DEBUG - integration_test - Step 23: Using propagated spline 6.0000 (close to path, dist=0.561m, drift=0.548m)
2026-01-13 17:39:04,204 - DEBUG - integration_test -   Set spline state to 6.0000
2026-01-13 17:39:04,205 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:04,271 - DEBUG - integration_test - Step 23: Checking path alignment: vehicle=(4.968, 3.052), path_start=(0.000, 0.000), dist=5.831m
2026-01-13 17:39:04,272 - INFO - integration_test - === Calling planner.solve_mpc() at step 23 ===
2026-01-13 17:39:04,325 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:04,335 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:04,335 - INFO - integration_test - Warmstart k=0: x0=4.968307756756599 , y0=3.051669643566169 , psi0=0.44806684813701764 , v0=3.0000000299940437 , spline0=5.747474794329773 , a0=0.0 , w0=0.0
2026-01-13 17:39:04,335 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:04,336 - INFO - integration_test - Dyn residual k=0: pred=[5.238693641582639, 3.181636851301359, 0.44806684813701764, 3.0000000299940437, 6.047474797329177], ws=[5.238693638879317, 3.181636850001945, 0.4480668481370178, 3.0, 6.1588007254229415], res=[2.70332201068868e-09, 1.2994139098054802e-09, -1.6653345369377348e-16, 2.999404369319336e-08, -0.1113259280937644], res_norm=1.113e-01
2026-01-13 17:39:04,337 - INFO - integration_test - Dyn residual k=1: pred=[5.509079521002035, 3.3116040564377207, 0.4480668481370178, 3.0, 6.458800725422941], ws=[5.509079521002035, 3.3116040564377207, 0.4480668481370178, 3.0, 6.343147236171959], res=[0.0, 0.0, 0.0, 0.0, 0.11565348925098196], res_norm=1.157e-01
2026-01-13 17:39:04,338 - INFO - integration_test - Dyn residual k=2: pred=[5.779465403124753, 3.4415712628734965, 0.4480668481370178, 3.0, 6.643147236171959], ws=[5.779465403124753, 3.4415712628734965, 0.4480668481370178, 3.0, 6.498450008595173], res=[0.0, 0.0, 0.0, 0.0, 0.1446972275767866], res_norm=1.447e-01
2026-01-13 17:39:04,353 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:04,424 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:04,439 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:04,451 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:04,466 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:04,477 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:04,493 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:04,505 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:04,520 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:04,532 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:04,546 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:04,558 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:04,572 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:04,583 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:04,599 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:04,611 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:04,628 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:04,640 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:04,655 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:04,665 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:04,678 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:04,688 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:04,856 - INFO - integration_test - Step 23: MPC solve successful
2026-01-13 17:39:04,901 - INFO - integration_test - Step 23: Computed 6 numeric contouring constraints for visualization (s=6.000)
2026-01-13 17:39:04,901 - DEBUG - integration_test - Step 23: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:04,901 - INFO - integration_test - === Applying control at step 23 ===
2026-01-13 17:39:04,901 - INFO - integration_test -   Control dict from planner: {'a': 3.882134377548751e-11, 'w': -0.2583514389594698}
2026-01-13 17:39:04,901 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:04,901 - INFO - integration_test -   Planner output success: True
2026-01-13 17:39:04,902 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:04,903 - INFO - integration_test - Step 23 completed in 0.699s
2026-01-13 17:39:04,917 - INFO - integration_test - Step 24 (contouring until path end)
2026-01-13 17:39:04,919 - DEBUG - integration_test - Syncing planner state at step 24: vehicle_state=[5.24034233 3.17812986 0.4222317  3.00000003 6.30000005]
2026-01-13 17:39:04,919 - DEBUG - integration_test - Step 24: Using propagated spline 6.3000 (close to path, dist=0.465m, drift=0.242m)
2026-01-13 17:39:04,919 - DEBUG - integration_test -   Set spline state to 6.3000
2026-01-13 17:39:04,920 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:04,984 - DEBUG - integration_test - Step 24: Checking path alignment: vehicle=(5.240, 3.178), path_start=(0.000, 0.000), dist=6.129m
2026-01-13 17:39:04,984 - INFO - integration_test - === Calling planner.solve_mpc() at step 24 ===
2026-01-13 17:39:05,036 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:05,046 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:05,049 - INFO - integration_test - Warmstart k=0: x0=5.2403423316207896 , y0=3.17812985907833 , psi0=0.42223170424107065 , v0=3.000000029997926 , spline0=6.1484848983396665 , a0=0.0 , w0=0.0
2026-01-13 17:39:05,049 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:05,050 - INFO - integration_test - Dyn residual k=0: pred=[5.513995334311546, 3.301069014428481, 0.42223170424107065, 3.000000029997926, 6.448484901339459], ws=[5.513995331575205, 3.3010690131991747, 0.4222317042410708, 3.0, 6.310512341532443], res=[2.736340931619452e-09, 1.2293064344248705e-09, -1.6653345369377348e-16, 2.999792592106587e-08, 0.1379725598070154], res_norm=1.380e-01
2026-01-13 17:39:05,051 - INFO - integration_test - Dyn residual k=1: pred=[5.7876483315296205, 3.4240081673200193, 0.4222317042410708, 3.0, 6.610512341532443], ws=[5.7876483315296205, 3.4240081673200193, 0.4222317042410708, 3.0, 6.514404979440357], res=[0.0, 0.0, 0.0, 0.0, 0.09610736209208603], res_norm=9.611e-02
2026-01-13 17:39:05,052 - INFO - integration_test - Dyn residual k=2: pred=[6.061301331484036, 3.546947321440864, 0.4222317042410708, 3.0, 6.814404979440357], ws=[6.061301331484036, 3.546947321440864, 0.4222317042410708, 3.0, 6.8953058230572655], res=[0.0, 0.0, 0.0, 0.0, -0.08090084361690852], res_norm=8.090e-02
2026-01-13 17:39:05,065 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:05,142 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:05,158 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:05,169 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:05,184 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:05,196 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:05,210 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:05,222 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:05,236 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:05,249 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:05,264 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:05,276 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:05,291 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:05,303 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:05,318 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:05,330 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:05,345 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:05,357 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:05,373 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:05,383 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:05,397 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:05,407 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:05,572 - INFO - integration_test - Step 24: MPC solve successful
2026-01-13 17:39:05,618 - INFO - integration_test - Step 24: Computed 6 numeric contouring constraints for visualization (s=6.300)
2026-01-13 17:39:05,619 - DEBUG - integration_test - Step 24: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:05,619 - INFO - integration_test - === Applying control at step 24 ===
2026-01-13 17:39:05,619 - INFO - integration_test -   Control dict from planner: {'a': 1.280032495493617e-11, 'w': -0.27496811707588265}
2026-01-13 17:39:05,619 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:05,619 - INFO - integration_test -   Planner output success: True
2026-01-13 17:39:05,620 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:05,620 - INFO - integration_test - Step 24 completed in 0.702s
2026-01-13 17:39:05,637 - INFO - integration_test - Step 25 (contouring until path end)
2026-01-13 17:39:05,638 - DEBUG - integration_test - Syncing planner state at step 25: vehicle_state=[5.51565096 3.29729147 0.39473489 3.00000003 6.60000005]
2026-01-13 17:39:05,639 - DEBUG - integration_test - Step 25: Using propagated spline 6.6000 (close to path, dist=0.420m, drift=0.542m)
2026-01-13 17:39:05,639 - DEBUG - integration_test -   Set spline state to 6.6000
2026-01-13 17:39:05,640 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:05,705 - DEBUG - integration_test - Step 25: Checking path alignment: vehicle=(5.516, 3.297), path_start=(0.000, 0.000), dist=6.426m
2026-01-13 17:39:05,705 - INFO - integration_test - === Calling planner.solve_mpc() at step 25 ===
2026-01-13 17:39:05,757 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:05,767 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:05,767 - INFO - integration_test - Warmstart k=0: x0=5.515650962898164 , y0=3.2972914676723333 , psi0=0.3947348925334824 , v0=3.000000029999206 , spline0=6.347474800329486 , a0=0.0 , w0=0.0
2026-01-13 17:39:05,767 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:05,768 - INFO - integration_test - Dyn residual k=0: pred=[5.792580529902669, 3.4126605134283303, 0.3947348925334824, 3.000000029999206, 6.647474803329407], ws=[5.792580527133447, 3.4126605122746705, 0.3947348925334824, 3.0, 6.7547038299103885], res=[2.7692221848951704e-09, 1.153659834329801e-09, 0.0, 2.999920578616866e-08, -0.10722902658098121], res_norm=1.072e-01
2026-01-13 17:39:05,769 - INFO - integration_test - Dyn residual k=1: pred=[6.0695100913687305, 3.5280295568770077, 0.3947348925334824, 3.0, 7.054703829910388], ws=[6.0695100913687305, 3.5280295568770077, 0.3947348925334824, 3.0, 6.934199059776595], res=[0.0, 0.0, 0.0, 0.0, 0.12050477013379357], res_norm=1.205e-01
2026-01-13 17:39:05,770 - INFO - integration_test - Dyn residual k=2: pred=[6.346439655604014, 3.643398601479345, 0.3947348925334824, 3.0, 7.234199059776595], ws=[6.346439655604014, 3.643398601479345, 0.3947348925334824, 3.0, 7.386866856079146], res=[0.0, 0.0, 0.0, 0.0, -0.15266779630255112], res_norm=1.527e-01
2026-01-13 17:39:05,785 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:05,855 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:05,870 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:05,881 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:05,896 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:05,908 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:05,922 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:05,934 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:05,948 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:05,959 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:05,974 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:05,986 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:06,000 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:06,012 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:06,026 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:06,038 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:06,054 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:06,065 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:06,080 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:06,090 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:06,103 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:06,113 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:06,291 - INFO - integration_test - Step 25: MPC solve successful
2026-01-13 17:39:06,338 - INFO - integration_test - Step 25: Computed 6 numeric contouring constraints for visualization (s=6.600)
2026-01-13 17:39:06,338 - DEBUG - integration_test - Step 25: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:06,338 - INFO - integration_test - === Applying control at step 25 ===
2026-01-13 17:39:06,338 - INFO - integration_test -   Control dict from planner: {'a': 4.357133368729038e-12, 'w': -0.27270951779624875}
2026-01-13 17:39:06,338 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:06,338 - INFO - integration_test -   Planner output success: True
2026-01-13 17:39:06,339 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:06,340 - INFO - integration_test - Step 25 completed in 0.702s
2026-01-13 17:39:06,358 - INFO - integration_test - Step 26 (contouring until path end)
2026-01-13 17:39:06,359 - DEBUG - integration_test - Syncing planner state at step 26: vehicle_state=[5.79411922 3.40887038 0.36746394 3.00000003 6.90000006]
2026-01-13 17:39:06,359 - DEBUG - integration_test - Step 26: Using propagated spline 6.9000 (close to path, dist=0.491m, drift=0.236m)
2026-01-13 17:39:06,359 - DEBUG - integration_test -   Set spline state to 6.9000
2026-01-13 17:39:06,360 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:06,426 - DEBUG - integration_test - Step 26: Checking path alignment: vehicle=(5.794, 3.409), path_start=(0.000, 0.000), dist=6.723m
2026-01-13 17:39:06,426 - INFO - integration_test - === Calling planner.solve_mpc() at step 26 ===
2026-01-13 17:39:06,480 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:06,490 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:06,490 - INFO - integration_test - Warmstart k=0: x0=5.794119219940691 , y0=3.408870381479146 , psi0=0.3674639407538575 , v0=3.0000000299996414 , spline0=6.748484904339552 , a0=0.0 , w0=0.0
2026-01-13 17:39:06,490 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:06,491 - INFO - integration_test - Dyn residual k=0: pred=[6.074091650122702, 3.5166453328266547, 0.3674639407538575, 3.0000000299996414, 7.048484907339517], ws=[6.07409164732301, 3.5166453317489177, 0.36746394075385735, 3.0, 6.905397137266167], res=[2.799691145582983e-09, 1.0777370107462048e-09, 1.6653345369377348e-16, 2.999964143768352e-08, 0.1430877700733495], res_norm=1.431e-01
2026-01-13 17:39:06,492 - INFO - integration_test - Dyn residual k=1: pred=[6.35406407470533, 3.6244202820186895, 0.36746394075385735, 3.0, 7.205397137266167], ws=[6.35406407470533, 3.6244202820186895, 0.36746394075385735, 3.0, 7.105364984534355], res=[0.0, 0.0, 0.0, 0.0, 0.10003215273181176], res_norm=1.000e-01
2026-01-13 17:39:06,493 - INFO - integration_test - Dyn residual k=2: pred=[6.63403650208765, 3.7321952322884613, 0.36746394075385735, 3.0, 7.405364984534355], ws=[6.63403650208765, 3.7321952322884613, 0.36746394075385735, 3.0, 7.582672077642377], res=[0.0, 0.0, 0.0, 0.0, -0.17730709310802162], res_norm=1.773e-01
2026-01-13 17:39:06,507 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:06,579 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:06,594 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:06,606 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:06,621 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:06,633 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:06,647 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:06,659 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:06,675 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:06,687 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:06,701 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:06,713 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:06,728 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:06,740 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:06,754 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:06,766 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:06,780 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:06,792 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:06,807 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:06,817 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:06,830 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:06,840 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:07,004 - INFO - integration_test - Step 26: MPC solve successful
2026-01-13 17:39:07,052 - INFO - integration_test - Step 26: Computed 6 numeric contouring constraints for visualization (s=6.900)
2026-01-13 17:39:07,053 - DEBUG - integration_test - Step 26: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:07,053 - INFO - integration_test - === Applying control at step 26 ===
2026-01-13 17:39:07,053 - INFO - integration_test -   Control dict from planner: {'a': 1.5890145062039655e-12, 'w': -0.2821760016060944}
2026-01-13 17:39:07,053 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:07,053 - INFO - integration_test -   Planner output success: True
2026-01-13 17:39:07,054 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:07,054 - INFO - integration_test - Step 26 completed in 0.696s
2026-01-13 17:39:07,070 - INFO - integration_test - Step 27 (contouring until path end)
2026-01-13 17:39:07,072 - DEBUG - integration_test - Syncing planner state at step 27: vehicle_state=[6.07557497 3.51268122 0.33924634 3.00000003 7.20000006]
2026-01-13 17:39:07,072 - DEBUG - integration_test - Step 27: Using propagated spline 7.2000 (close to path, dist=0.456m, drift=0.536m)
2026-01-13 17:39:07,072 - DEBUG - integration_test -   Set spline state to 7.2000
2026-01-13 17:39:07,073 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:07,139 - DEBUG - integration_test - Step 27: Checking path alignment: vehicle=(6.076, 3.513), path_start=(0.000, 0.000), dist=7.018m
2026-01-13 17:39:07,139 - INFO - integration_test - === Calling planner.solve_mpc() at step 27 ===
2026-01-13 17:39:07,196 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:07,206 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:07,206 - INFO - integration_test - Warmstart k=0: x0=6.0755749721349455 , y0=3.5126812181367693 , psi0=0.3392463405932481 , v0=3.0000000299998004 , spline0=6.947474806329431 , a0=0.0 , w0=0.0
2026-01-13 17:39:07,206 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:07,207 - INFO - integration_test - Dyn residual k=0: pred=[6.358476694997469, 3.6125141636077105, 0.3392463405932481, 3.0000000299998004, 7.247474809329411], ws=[6.358476692168471, 3.6125141626093877, 0.339246340593248, 3.0, 7.351454112285957], res=[2.828998368897828e-09, 9.983227577947673e-10, 1.1102230246251565e-16, 2.999980042162065e-08, -0.1039793029565459], res_norm=1.040e-01
2026-01-13 17:39:07,207 - INFO - integration_test - Dyn residual k=1: pred=[6.641378412201996, 3.712347107082006, 0.339246340593248, 3.0, 7.651454112285957], ws=[6.641378412201996, 3.712347107082006, 0.339246340593248, 3.0, 7.527101865551409], res=[0.0, 0.0, 0.0, 0.0, 0.12435224673454748], res_norm=1.244e-01
2026-01-13 17:39:07,208 - INFO - integration_test - Dyn residual k=2: pred=[6.924280132235521, 3.8121800515546247, 0.339246340593248, 3.0, 7.827101865551409], ws=[6.924280132235521, 3.8121800515546247, 0.339246340593248, 3.0, 7.975341696248065], res=[0.0, 0.0, 0.0, 0.0, -0.1482398306966557], res_norm=1.482e-01
2026-01-13 17:39:07,222 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:07,293 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:07,312 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:07,325 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:07,341 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:07,353 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:07,369 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:07,381 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:07,396 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:07,408 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:07,424 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:07,436 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:07,451 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:07,462 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:07,477 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:07,490 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:07,505 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:07,517 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:07,533 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:07,543 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:07,556 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:07,566 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:07,732 - INFO - integration_test - Step 27: MPC solve successful
2026-01-13 17:39:07,780 - INFO - integration_test - Step 27: Computed 6 numeric contouring constraints for visualization (s=7.200)
2026-01-13 17:39:07,780 - DEBUG - integration_test - Step 27: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:07,780 - INFO - integration_test - === Applying control at step 27 ===
2026-01-13 17:39:07,780 - INFO - integration_test -   Control dict from planner: {'a': 3.7401721704701356e-13, 'w': -0.27361755498396895}
2026-01-13 17:39:07,780 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:07,781 - INFO - integration_test -   Planner output success: True
2026-01-13 17:39:07,782 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:07,782 - INFO - integration_test - Step 27 completed in 0.710s
2026-01-13 17:39:07,798 - INFO - integration_test - Step 28 (contouring until path end)
2026-01-13 17:39:07,799 - DEBUG - integration_test - Syncing planner state at step 28: vehicle_state=[6.35980711 3.6086316  0.31188459 3.00000003 7.50000006]
2026-01-13 17:39:07,799 - DEBUG - integration_test - Step 28: Using propagated spline 7.5000 (close to path, dist=0.524m, drift=0.230m)
2026-01-13 17:39:07,799 - DEBUG - integration_test -   Set spline state to 7.5000
2026-01-13 17:39:07,800 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:08,027 - DEBUG - integration_test - Step 28: Checking path alignment: vehicle=(6.360, 3.609), path_start=(0.000, 0.000), dist=7.312m
2026-01-13 17:39:08,027 - INFO - integration_test - === Calling planner.solve_mpc() at step 28 ===
2026-01-13 17:39:08,080 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:08,089 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:08,090 - INFO - integration_test - Warmstart k=0: x0=6.359807113686804 , y0=3.608631604750865 , psi0=0.3118845850948512 , v0=3.0000000299998377 , spline0=7.348484910339517 , a0=0.0 , w0=0.0
2026-01-13 17:39:08,090 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:08,091 - INFO - integration_test - Dyn residual k=0: pred=[6.645334207567331, 3.7006874598613932, 0.3118845850948512, 3.0000000299998377, 7.648484913339501], ws=[6.645334204712076, 3.70068745894084, 0.3118845850948513, 3.0, 7.501305346724372], res=[2.855255587519423e-09, 9.205534112766145e-10, -1.1102230246251565e-16, 2.9999837725114276e-08, 0.14717956661512854], res_norm=1.472e-01
2026-01-13 17:39:08,091 - INFO - integration_test - Dyn residual k=1: pred=[6.930861295737348, 3.792743313130815, 0.3118845850948513, 3.0, 7.801305346724372], ws=[6.930861295737348, 3.792743313130815, 0.3118845850948513, 3.0, 8.001316127429028], res=[0.0, 0.0, 0.0, 0.0, -0.20001078070465628], res_norm=2.000e-01
2026-01-13 17:39:08,092 - INFO - integration_test - Dyn residual k=2: pred=[7.2163883867626195, 3.88479916732079, 0.3118845850948513, 3.0, 8.301316127429029], ws=[7.2163883867626195, 3.88479916732079, 0.3118845850948513, 3.0, 8.172103672759187], res=[0.0, 0.0, 0.0, 0.0, 0.1292124546698421], res_norm=1.292e-01
2026-01-13 17:39:08,106 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:08,175 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:08,191 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:08,203 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:08,217 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:08,229 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:08,244 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:08,255 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:08,270 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:08,282 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:08,297 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:08,308 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:08,323 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:08,334 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:08,349 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:08,361 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:08,376 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:08,387 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:08,404 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:08,414 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:08,428 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:08,438 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:08,586 - INFO - integration_test - Step 28: MPC solve successful
2026-01-13 17:39:08,635 - INFO - integration_test - Step 28: Computed 6 numeric contouring constraints for visualization (s=7.500)
2026-01-13 17:39:08,636 - DEBUG - integration_test - Step 28: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:08,636 - INFO - integration_test - === Applying control at step 28 ===
2026-01-13 17:39:08,636 - INFO - integration_test -   Control dict from planner: {'a': 2.2156259144848692e-13, 'w': -0.28509967684612836}
2026-01-13 17:39:08,636 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:08,636 - INFO - integration_test -   Planner output success: True
2026-01-13 17:39:08,637 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:08,638 - INFO - integration_test - Step 28 completed in 0.839s
2026-01-13 17:39:08,654 - INFO - integration_test - Step 29 (contouring until path end)
2026-01-13 17:39:08,656 - DEBUG - integration_test - Syncing planner state at step 29: vehicle_state=[6.64660769 3.69660508 0.28337462 3.00000003 7.80000006]
2026-01-13 17:39:08,665 - DEBUG - integration_test - Step 29: Using propagated spline 7.8000 (close to path, dist=0.494m, drift=0.530m)
2026-01-13 17:39:08,666 - DEBUG - integration_test -   Set spline state to 7.8000
2026-01-13 17:39:08,666 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:08,734 - DEBUG - integration_test - Step 29: Checking path alignment: vehicle=(6.647, 3.697), path_start=(0.000, 0.000), dist=7.605m
2026-01-13 17:39:08,734 - INFO - integration_test - === Calling planner.solve_mpc() at step 29 ===
2026-01-13 17:39:08,787 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:08,797 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:08,797 - INFO - integration_test - Warmstart k=0: x0=6.646607694776832 , y0=3.6966050811844866 , psi0=0.28337461741023834 , v0=3.00000002999986 , spline0=7.547474812329401 , a0=0.0 , w0=0.0
2026-01-13 17:39:08,797 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:08,798 - INFO - integration_test - Dyn residual k=0: pred=[6.934642909627012, 3.7804842609980867, 0.28337461741023834, 3.00000002999986, 7.847474815329387], ws=[6.9346429067466735, 3.780484260159299, 0.2833746174102383, 3.0, 7.747026205200523], res=[2.8803386342701742e-09, 8.38787705959021e-10, 5.551115123125783e-17, 2.999985992957477e-08, 0.10044861012886397], res_norm=1.004e-01
2026-01-13 17:39:08,799 - INFO - integration_test - Dyn residual k=1: pred=[7.222678118716515, 3.8643634391341113, 0.2833746174102383, 3.0, 8.047026205200524], ws=[7.222678118716515, 3.8643634391341113, 0.2833746174102383, 3.0, 8.121854113314244], res=[0.0, 0.0, 0.0, 0.0, -0.0748279081137202], res_norm=7.483e-02
2026-01-13 17:39:08,800 - INFO - integration_test - Dyn residual k=2: pred=[7.5107133306863565, 3.9482426181089236, 0.2833746174102383, 3.0, 8.421854113314245], ws=[7.5107133306863565, 3.9482426181089236, 0.2833746174102383, 3.0, 8.566892637743589], res=[0.0, 0.0, 0.0, 0.0, -0.14503852442934395], res_norm=1.450e-01
2026-01-13 17:39:08,813 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:08,885 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:08,900 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:08,911 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:08,927 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:08,938 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:08,953 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:08,964 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:08,979 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:08,991 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:09,006 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:09,017 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:09,032 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:09,044 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:09,059 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:09,070 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:09,085 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:09,097 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:09,112 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:09,122 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:09,135 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:09,145 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:09,299 - INFO - integration_test - Step 29: MPC solve successful
2026-01-13 17:39:09,350 - INFO - integration_test - Step 29: Computed 6 numeric contouring constraints for visualization (s=7.800)
2026-01-13 17:39:09,350 - DEBUG - integration_test - Step 29: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:09,350 - INFO - integration_test - === Applying control at step 29 ===
2026-01-13 17:39:09,350 - INFO - integration_test -   Control dict from planner: {'a': -5.940636364866669e-14, 'w': -0.31639476073084416}
2026-01-13 17:39:09,350 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:09,350 - INFO - integration_test -   Planner output success: True
2026-01-13 17:39:09,351 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:09,352 - INFO - integration_test - Step 29 completed in 0.696s
2026-01-13 17:39:09,366 - INFO - integration_test - Step 30 (contouring until path end)
2026-01-13 17:39:09,367 - DEBUG - integration_test - Syncing planner state at step 30: vehicle_state=[6.93592169 3.77591401 0.25173514 3.00000003 8.10000007]
2026-01-13 17:39:09,368 - DEBUG - integration_test - Step 30: Using propagated spline 8.1000 (close to path, dist=0.535m, drift=0.225m)
2026-01-13 17:39:09,368 - DEBUG - integration_test -   Set spline state to 8.1000
2026-01-13 17:39:09,369 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:09,435 - DEBUG - integration_test - Step 30: Checking path alignment: vehicle=(6.936, 3.776), path_start=(0.000, 0.000), dist=7.897m
2026-01-13 17:39:09,435 - INFO - integration_test - === Calling planner.solve_mpc() at step 30 ===
2026-01-13 17:39:09,488 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:09,498 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:09,498 - INFO - integration_test - Warmstart k=0: x0=6.935921691507591 , y0=3.7759140055582403 , psi0=0.2517351413371539 , v0=3.000000029999854 , spline0=7.746464714319285 , a0=0.0 , w0=0.0
2026-01-13 17:39:09,498 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:09,499 - INFO - integration_test - Dyn residual k=0: pred=[7.226466199172003, 3.850639442097854, 0.2517351413371539, 3.000000029999854, 8.046464717319271], ws=[7.226466196266572, 3.8506394413506033, 0.251735141337154, 3.0, 8.19924476887838], res=[2.9054305628051225e-09, 7.472507057570965e-10, -1.1102230246251565e-16, 2.999985415641504e-08, -0.1527800515591089], res_norm=1.528e-01
2026-01-13 17:39:09,500 - INFO - integration_test - Dyn residual k=1: pred=[7.517010701025553, 3.9253648771429663, 0.251735141337154, 3.0, 8.49924476887838], ws=[7.517010701025553, 3.9253648771429663, 0.251735141337154, 3.0, 8.596191288138877], res=[0.0, 0.0, 0.0, 0.0, -0.0969465192604968], res_norm=9.695e-02
2026-01-13 17:39:09,501 - INFO - integration_test - Dyn residual k=2: pred=[7.807555205784534, 4.000090312935329, 0.251735141337154, 3.0, 8.896191288138878], ws=[7.807555205784534, 4.000090312935329, 0.251735141337154, 3.0, 8.76457854934294], res=[0.0, 0.0, 0.0, 0.0, 0.1316127387959387], res_norm=1.316e-01
2026-01-13 17:39:09,515 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:09,586 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:09,601 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:09,613 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:09,628 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:09,639 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:09,654 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:09,665 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:09,680 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:09,692 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:09,707 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:09,719 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:09,733 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:09,745 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:09,760 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:09,774 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:09,790 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:09,802 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:09,818 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:09,828 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:09,841 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:09,851 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:10,047 - INFO - integration_test - Step 30: MPC solve successful
2026-01-13 17:39:10,099 - INFO - integration_test - Step 30: Computed 6 numeric contouring constraints for visualization (s=8.100)
2026-01-13 17:39:10,099 - DEBUG - integration_test - Step 30: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:10,100 - INFO - integration_test - === Applying control at step 30 ===
2026-01-13 17:39:10,100 - INFO - integration_test -   Control dict from planner: {'a': 1.359759160699528e-13, 'w': -0.25245533463396386}
2026-01-13 17:39:10,100 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:10,100 - INFO - integration_test -   Planner output success: True
2026-01-13 17:39:10,101 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:10,101 - INFO - integration_test - Step 30 completed in 0.734s
2026-01-13 17:39:10,115 - INFO - integration_test - Step 31 (contouring until path end)
2026-01-13 17:39:10,116 - DEBUG - integration_test - Syncing planner state at step 31: vehicle_state=[7.22737853 3.84696422 0.22648961 3.00000003 8.40000007]
2026-01-13 17:39:10,117 - DEBUG - integration_test - Step 31: Using propagated spline 8.4000 (close to path, dist=0.546m, drift=0.081m)
2026-01-13 17:39:10,117 - DEBUG - integration_test -   Set spline state to 8.4000
2026-01-13 17:39:10,118 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:10,183 - DEBUG - integration_test - Step 31: Checking path alignment: vehicle=(7.227, 3.847), path_start=(0.000, 0.000), dist=8.187m
2026-01-13 17:39:10,183 - INFO - integration_test - === Calling planner.solve_mpc() at step 31 ===
2026-01-13 17:39:10,236 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:10,246 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:10,246 - INFO - integration_test - Warmstart k=0: x0=7.227378529396242 , y0=3.8469642240489725 , psi0=0.22648960787375752 , v0=3.000000029999868 , spline0=8.147474818329373 , a0=0.0 , w0=0.0
2026-01-13 17:39:10,246 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:10,247 - INFO - integration_test - Dyn residual k=0: pred=[7.519716737728892, 3.914331677235571, 0.22648960787375752, 3.000000029999868, 8.44747482132936], ws=[7.519716734805523, 3.914331676561899, 0.2264896078737575, 3.0, 8.345440216365937], res=[2.923369102347806e-09, 6.736717850230889e-10, 2.7755575615628914e-17, 2.9999867923180545e-08, 0.10203460496342309], res_norm=1.020e-01
2026-01-13 17:39:10,248 - INFO - integration_test - Dyn residual k=1: pred=[7.812054940214804, 3.981699129074826, 0.2264896078737575, 3.0, 8.645440216365937], ws=[7.812054940214804, 3.981699129074826, 0.2264896078737575, 3.0, 8.718405140890736], res=[0.0, 0.0, 0.0, 0.0, -0.07296492452479875], res_norm=7.296e-02
2026-01-13 17:39:10,249 - INFO - integration_test - Dyn residual k=2: pred=[8.104393145624083, 4.049066581587753, 0.2264896078737575, 3.0, 9.018405140890737], ws=[8.104393145624083, 4.049066581587753, 0.2264896078737575, 3.0, 8.959379031260505], res=[0.0, 0.0, 0.0, 0.0, 0.05902610963023136], res_norm=5.903e-02
2026-01-13 17:39:10,263 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:10,334 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:10,349 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:10,360 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:10,375 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:10,387 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:10,402 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:10,413 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:10,428 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:10,439 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:10,454 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:10,465 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:10,480 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:10,491 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:10,506 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:10,518 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:10,532 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:10,544 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:10,559 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:10,569 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:10,582 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:10,592 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:10,755 - INFO - integration_test - Step 31: MPC solve successful
2026-01-13 17:39:10,808 - INFO - integration_test - Step 31: Computed 6 numeric contouring constraints for visualization (s=8.400)
2026-01-13 17:39:10,808 - DEBUG - integration_test - Step 31: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:10,808 - INFO - integration_test - === Applying control at step 31 ===
2026-01-13 17:39:10,808 - INFO - integration_test -   Control dict from planner: {'a': 1.0063876553543817e-14, 'w': -0.2927247382965047}
2026-01-13 17:39:10,808 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:10,808 - INFO - integration_test -   Planner output success: True
2026-01-13 17:39:10,809 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:10,810 - INFO - integration_test - Step 31 completed in 0.694s
2026-01-13 17:39:10,824 - INFO - integration_test - Step 32 (contouring until path end)
2026-01-13 17:39:10,825 - DEBUG - integration_test - Syncing planner state at step 32: vehicle_state=[7.52066093 3.91004363 0.19721713 3.00000003 8.70000007]
2026-01-13 17:39:10,826 - DEBUG - integration_test - Step 32: Using propagated spline 8.7000 (close to path, dist=0.573m, drift=0.219m)
2026-01-13 17:39:10,826 - DEBUG - integration_test -   Set spline state to 8.7000
2026-01-13 17:39:10,827 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:10,896 - DEBUG - integration_test - Step 32: Checking path alignment: vehicle=(7.521, 3.910), path_start=(0.000, 0.000), dist=8.476m
2026-01-13 17:39:10,896 - INFO - integration_test - === Calling planner.solve_mpc() at step 32 ===
2026-01-13 17:39:10,950 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:10,960 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:10,961 - INFO - integration_test - Warmstart k=0: x0=7.520660925509225 , y0=3.9100436309628366 , psi0=0.19721713404410707 , v0=3.000000029999869 , spline0=8.346464720319258 , a0=0.0 , w0=0.0
2026-01-13 17:39:10,961 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:10,962 - INFO - integration_test - Dyn residual k=0: pred=[7.81484562412948, 3.968825982886709, 0.19721713404410707, 3.000000029999869, 8.646464723319244], ws=[7.814845621187645, 3.9688259822988883, 0.19721713404410712, 3.0, 8.797134685573791], res=[2.9418343316933715e-09, 5.878209030640846e-10, -5.551115123125783e-17, 2.9999868811358965e-08, -0.15066996225454687], res_norm=1.507e-01
2026-01-13 17:39:10,963 - INFO - integration_test - Dyn residual k=1: pred=[8.109030316866066, 4.02760833363494, 0.19721713404410712, 3.0, 9.097134685573792], ws=[8.109030316866066, 4.02760833363494, 0.19721713404410712, 3.0, 9.212734665671007], res=[0.0, 0.0, 0.0, 0.0, -0.1155999800972154], res_norm=1.156e-01
2026-01-13 17:39:10,964 - INFO - integration_test - Dyn residual k=2: pred=[8.403215012544488, 4.086390684970992, 0.19721713404410712, 3.0, 9.512734665671008], ws=[8.403215012544488, 4.086390684970992, 0.19721713404410712, 3.0, 9.369390895934227], res=[0.0, 0.0, 0.0, 0.0, 0.14334376973678076], res_norm=1.433e-01
2026-01-13 17:39:10,977 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:11,048 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:11,063 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:11,075 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:11,090 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:11,102 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:11,117 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:11,129 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:11,143 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:11,155 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:11,170 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:11,182 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:11,196 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:11,208 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:11,223 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:11,235 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:11,250 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:11,261 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:11,276 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:11,287 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:11,299 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:11,309 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:11,478 - INFO - integration_test - Step 32: MPC solve successful
2026-01-13 17:39:11,531 - INFO - integration_test - Step 32: Computed 6 numeric contouring constraints for visualization (s=8.700)
2026-01-13 17:39:11,531 - DEBUG - integration_test - Step 32: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:11,531 - INFO - integration_test - === Applying control at step 32 ===
2026-01-13 17:39:11,532 - INFO - integration_test -   Control dict from planner: {'a': 1.3065493559366752e-13, 'w': -0.2782991740707355}
2026-01-13 17:39:11,532 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:11,532 - INFO - integration_test -   Planner output success: True
2026-01-13 17:39:11,533 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:11,533 - INFO - integration_test - Step 32 completed in 0.708s
2026-01-13 17:39:11,546 - INFO - integration_test - Step 33 (contouring until path end)
2026-01-13 17:39:11,548 - DEBUG - integration_test - Syncing planner state at step 33: vehicle_state=[7.81562555 3.96472509 0.16938722 3.00000003 9.00000008]
2026-01-13 17:39:11,549 - DEBUG - integration_test - Step 33: Using propagated spline 9.0000 (close to path, dist=0.582m, drift=0.087m)
2026-01-13 17:39:11,549 - DEBUG - integration_test -   Set spline state to 9.0000
2026-01-13 17:39:11,550 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:11,615 - DEBUG - integration_test - Step 33: Checking path alignment: vehicle=(7.816, 3.965), path_start=(0.000, 0.000), dist=8.764m
2026-01-13 17:39:11,615 - INFO - integration_test - === Calling planner.solve_mpc() at step 33 ===
2026-01-13 17:39:11,668 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:11,678 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:11,678 - INFO - integration_test - Warmstart k=0: x0=7.815625552317449 , y0=3.9647250915956826 , psi0=0.16938721663703352 , v0=3.0000000299998817 , spline0=8.747474824329348 , a0=0.0 , w0=0.0
2026-01-13 17:39:11,678 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:11,680 - INFO - integration_test - Dyn residual k=0: pred=[8.111332031470498, 4.015298602319184, 0.16938721663703352, 3.0000000299998817, 9.047474827329337], ws=[8.111332028513445, 4.015298601813451, 0.1693872166370336, 3.0, 8.944643978721443], res=[2.957053268914933e-09, 5.057332330693498e-10, -8.326672684688674e-17, 2.999988168994605e-08, 0.10283084860789415], res_norm=1.028e-01
2026-01-13 17:39:11,680 - INFO - integration_test - Dyn residual k=1: pred=[8.40703850470944, 4.06587211203122, 0.1693872166370336, 3.0, 9.244643978721443], ws=[8.40703850470944, 4.06587211203122, 0.1693872166370336, 3.0, 9.619720219060248], res=[0.0, 0.0, 0.0, 0.0, -0.3750762403388048], res_norm=3.751e-01
2026-01-13 17:39:11,681 - INFO - integration_test - Dyn residual k=2: pred=[8.702744980905436, 4.116445622248988, 0.1693872166370336, 3.0, 9.919720219060249], ws=[8.702744980905436, 4.116445622248988, 0.1693872166370336, 3.0, 9.556715965695933], res=[0.0, 0.0, 0.0, 0.0, 0.3630042533643163], res_norm=3.630e-01
2026-01-13 17:39:11,696 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:11,767 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:11,782 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:11,794 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:11,809 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:11,820 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:11,835 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:11,846 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:11,861 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:11,873 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:11,887 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:11,899 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:11,913 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:11,925 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:11,939 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:11,950 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:11,965 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:11,977 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:11,992 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:12,003 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:12,016 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:12,026 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:12,198 - INFO - integration_test - Step 33: MPC solve successful
2026-01-13 17:39:12,252 - INFO - integration_test - Step 33: Computed 6 numeric contouring constraints for visualization (s=9.000)
2026-01-13 17:39:12,252 - DEBUG - integration_test - Step 33: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:12,252 - INFO - integration_test - === Applying control at step 33 ===
2026-01-13 17:39:12,252 - INFO - integration_test -   Control dict from planner: {'a': -3.983858195885808e-13, 'w': -0.2750964914350168}
2026-01-13 17:39:12,252 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:12,252 - INFO - integration_test -   Planner output success: True
2026-01-13 17:39:12,253 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:12,254 - INFO - integration_test - Step 33 completed in 0.706s
2026-01-13 17:39:12,270 - INFO - integration_test - Step 34 (contouring until path end)
2026-01-13 17:39:12,271 - DEBUG - integration_test - Syncing planner state at step 34: vehicle_state=[8.11199032 4.01122509 0.14187757 3.00000003 9.30000008]
2026-01-13 17:39:12,272 - DEBUG - integration_test - Step 34: Using propagated spline 9.3000 (close to path, dist=0.606m, drift=0.213m)
2026-01-13 17:39:12,272 - DEBUG - integration_test -   Set spline state to 9.3000
2026-01-13 17:39:12,272 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:12,340 - DEBUG - integration_test - Step 34: Checking path alignment: vehicle=(8.112, 4.011), path_start=(0.000, 0.000), dist=9.050m
2026-01-13 17:39:12,340 - INFO - integration_test - === Calling planner.solve_mpc() at step 34 ===
2026-01-13 17:39:12,393 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:12,403 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:12,403 - INFO - integration_test - Warmstart k=0: x0=8.111990321342411 , y0=4.011225089484495 , psi0=0.14187756749353184 , v0=3.0000000299998417 , spline0=8.946464726319231 , a0=0.0 , w0=0.0
2026-01-13 17:39:12,403 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:12,404 - INFO - integration_test - Dyn residual k=0: pred=[8.408975999122296, 4.053645709395245, 0.14187756749353184, 3.0000000299998417, 9.246464729319216], ws=[8.408975996152456, 4.053645708971041, 0.14187756749353175, 3.0, 9.597949956466014], res=[2.969839485444936e-09, 4.242037832113965e-10, 8.326672684688674e-17, 2.9999841721917164e-08, -0.35148522714679764], res_norm=3.515e-01
2026-01-13 17:39:12,405 - INFO - integration_test - Dyn residual k=1: pred=[8.705961670962502, 4.096066328457588, 0.14187756749353175, 3.0, 9.897949956466014], ws=[8.705961670962502, 4.096066328457588, 0.14187756749353175, 3.0, 9.81024962859465], res=[0.0, 0.0, 0.0, 0.0, 0.08770032787136373], res_norm=8.770e-02
2026-01-13 17:39:12,406 - INFO - integration_test - Dyn residual k=2: pred=[9.002947345772547, 4.138486947944134, 0.14187756749353175, 3.0, 10.110249628594651], ws=[9.002947345772547, 4.138486947944134, 0.14187756749353175, 3.0, 9.966307282639203], res=[0.0, 0.0, 0.0, 0.0, 0.1439423459554483], res_norm=1.439e-01
2026-01-13 17:39:12,420 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:12,491 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:12,506 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:12,518 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:12,533 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:12,545 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:12,559 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:12,571 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:12,586 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:12,597 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:12,612 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:12,623 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:12,638 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:12,649 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:12,664 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:12,676 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:12,693 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:12,705 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:12,719 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:12,730 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:12,742 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:12,753 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:12,908 - INFO - integration_test - Step 34: MPC solve successful
2026-01-13 17:39:12,963 - INFO - integration_test - Step 34: Computed 6 numeric contouring constraints for visualization (s=9.300)
2026-01-13 17:39:12,963 - DEBUG - integration_test - Step 34: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:12,963 - INFO - integration_test - === Applying control at step 34 ===
2026-01-13 17:39:12,963 - INFO - integration_test -   Control dict from planner: {'a': 7.553591531910983e-14, 'w': -0.2662193110469344}
2026-01-13 17:39:12,964 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:12,964 - INFO - integration_test -   Planner output success: True
2026-01-13 17:39:12,965 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:12,965 - INFO - integration_test - Step 34 completed in 0.694s
2026-01-13 17:39:12,981 - INFO - integration_test - Step 35 (contouring until path end)
2026-01-13 17:39:12,982 - DEBUG - integration_test - Syncing planner state at step 35: vehicle_state=[8.40950555 4.04968777 0.11525564 3.00000003 9.60000008]
2026-01-13 17:39:12,983 - DEBUG - integration_test - Step 35: Using propagated spline 9.6000 (close to path, dist=0.616m, drift=0.093m)
2026-01-13 17:39:12,983 - DEBUG - integration_test -   Set spline state to 9.6000
2026-01-13 17:39:12,984 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:13,049 - DEBUG - integration_test - Step 35: Checking path alignment: vehicle=(8.410, 4.050), path_start=(0.000, 0.000), dist=9.334m
2026-01-13 17:39:13,050 - INFO - integration_test - === Calling planner.solve_mpc() at step 35 ===
2026-01-13 17:39:13,103 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:13,113 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:13,113 - INFO - integration_test - Warmstart k=0: x0=8.409505546173868 , y0=4.049687766149259 , psi0=0.1152556363888384 , v0=3.0000000299998493 , spline0=9.347474830329318 , a0=0.0 , w0=0.0
2026-01-13 17:39:13,113 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:13,115 - INFO - integration_test - Dyn residual k=0: pred=[8.707515174681848, 4.084187956243331, 0.1152556363888384, 3.0000000299998493, 9.647474833329303], ws=[8.707515171701766, 4.08418795589833, 0.1152556363888384, 3.0, 9.542633440427906], res=[2.980081958980918e-09, 3.4500047263463784e-10, 0.0, 2.999984927143373e-08, 0.10484139290139716], res_norm=1.048e-01
2026-01-13 17:39:13,116 - INFO - integration_test - Dyn residual k=1: pred=[9.005524797229665, 4.118688145647401, 0.1152556363888384, 3.0, 9.842633440427907], ws=[9.005524797229665, 4.118688145647401, 0.1152556363888384, 3.0, 9.980839285028773], res=[0.0, 0.0, 0.0, 0.0, -0.1382058446008667], res_norm=1.382e-01
2026-01-13 17:39:13,117 - INFO - integration_test - Dyn residual k=2: pred=[9.303534422757563, 4.1531883353964725, 0.1152556363888384, 3.0, 10.280839285028774], ws=[9.303534422757563, 4.1531883353964725, 0.1152556363888384, 3.0, 10.382806612397449], res=[0.0, 0.0, 0.0, 0.0, -0.10196732736867453], res_norm=1.020e-01
2026-01-13 17:39:13,131 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:13,208 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:13,225 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:13,237 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:13,253 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:13,265 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:13,281 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:13,295 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:13,312 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:13,324 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:13,340 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:13,352 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:13,367 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:13,378 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:13,394 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:13,406 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:13,421 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:13,433 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:13,448 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:13,458 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:13,471 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:13,481 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:13,652 - INFO - integration_test - Step 35: MPC solve successful
2026-01-13 17:39:13,709 - INFO - integration_test - Step 35: Computed 6 numeric contouring constraints for visualization (s=9.600)
2026-01-13 17:39:13,709 - DEBUG - integration_test - Step 35: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:13,709 - INFO - integration_test - === Applying control at step 35 ===
2026-01-13 17:39:13,709 - INFO - integration_test -   Control dict from planner: {'a': 3.6629200101403083e-13, 'w': -0.2634210749305461}
2026-01-13 17:39:13,709 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:13,709 - INFO - integration_test -   Planner output success: True
2026-01-13 17:39:13,711 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:13,712 - INFO - integration_test - Step 35 completed in 0.730s
2026-01-13 17:39:13,726 - INFO - integration_test - Step 36 (contouring until path end)
2026-01-13 17:39:13,728 - DEBUG - integration_test - Syncing planner state at step 36: vehicle_state=[8.70793509 4.08025909 0.08891353 3.00000003 9.90000009]
2026-01-13 17:39:13,729 - DEBUG - integration_test - Step 36: Using propagated spline 9.9000 (close to path, dist=0.634m, drift=0.207m)
2026-01-13 17:39:13,729 - DEBUG - integration_test -   Set spline state to 9.9000
2026-01-13 17:39:13,730 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:13,797 - DEBUG - integration_test - Step 36: Checking path alignment: vehicle=(8.708, 4.080), path_start=(0.000, 0.000), dist=9.616m
2026-01-13 17:39:13,797 - INFO - integration_test - === Calling planner.solve_mpc() at step 36 ===
2026-01-13 17:39:13,852 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:13,862 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:13,862 - INFO - integration_test - Warmstart k=0: x0=8.707935088367256 , y0=4.080259092533596 , psi0=0.08891352889578379 , v0=3.0000000299998857 , spline0=9.546464732319205 , a0=0.0 , w0=0.0
2026-01-13 17:39:13,862 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:13,864 - INFO - integration_test - Dyn residual k=0: pred=[9.006750030040926, 4.106898019549421, 0.08891352889578379, 3.0000000299998857, 9.846464735319193], ws=[9.006750027052787, 4.106898019283032, 0.08891352889578386, 3.0, 10.197620956953243], res=[2.9881395136044375e-09, 2.6638868888539946e-10, -6.938893903907228e-17, 2.999988568674894e-08, -0.35115622163404936], res_norm=3.512e-01
2026-01-13 17:39:13,865 - INFO - integration_test - Dyn residual k=1: pred=[9.305564965738318, 4.133536946032469, 0.08891352889578386, 3.0, 10.497620956953243], ws=[9.305564965738318, 4.133536946032469, 0.08891352889578386, 3.0, 10.409656951310726], res=[0.0, 0.0, 0.0, 0.0, 0.08796400564251705], res_norm=8.796e-02
2026-01-13 17:39:13,865 - INFO - integration_test - Dyn residual k=2: pred=[9.60437990442385, 4.160175872781905, 0.08891352889578386, 3.0, 10.709656951310727], ws=[9.60437990442385, 4.160175872781905, 0.08891352889578386, 3.0, 10.566190593121252], res=[0.0, 0.0, 0.0, 0.0, 0.14346635818947462], res_norm=1.435e-01
2026-01-13 17:39:13,881 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:13,951 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:13,966 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:13,978 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:13,993 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:14,005 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:14,020 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:14,031 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:14,046 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:14,058 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:14,072 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:14,084 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:14,099 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:14,111 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:14,126 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:14,137 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:14,153 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:14,165 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:14,181 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:14,192 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:14,205 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:14,216 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:14,408 - INFO - integration_test - Step 36: MPC solve successful
2026-01-13 17:39:14,465 - INFO - integration_test - Step 36: Computed 6 numeric contouring constraints for visualization (s=9.900)
2026-01-13 17:39:14,466 - DEBUG - integration_test - Step 36: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:14,466 - INFO - integration_test - === Applying control at step 36 ===
2026-01-13 17:39:14,466 - INFO - integration_test -   Control dict from planner: {'a': -5.4678936098742454e-14, 'w': -0.2455725435668261}
2026-01-13 17:39:14,466 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:14,466 - INFO - integration_test -   Planner output success: True
2026-01-13 17:39:14,467 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:14,467 - INFO - integration_test - Step 36 completed in 0.740s
2026-01-13 17:39:14,483 - INFO - integration_test - Step 37 (contouring until path end)
2026-01-13 17:39:14,485 - DEBUG - integration_test - Syncing planner state at step 37: vehicle_state=[ 9.00704707  4.10322649  0.06435627  3.00000003 10.20000009]
2026-01-13 17:39:14,485 - DEBUG - integration_test - Step 37: Using propagated spline 10.2000 (close to path, dist=0.645m, drift=0.099m)
2026-01-13 17:39:14,485 - DEBUG - integration_test -   Set spline state to 10.2000
2026-01-13 17:39:14,486 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:14,554 - DEBUG - integration_test - Step 37: Checking path alignment: vehicle=(9.007, 4.103), path_start=(0.000, 0.000), dist=9.898m
2026-01-13 17:39:14,554 - INFO - integration_test - === Calling planner.solve_mpc() at step 37 ===
2026-01-13 17:39:14,607 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:14,617 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:14,617 - INFO - integration_test - Warmstart k=0: x0=9.007047070172922 , y0=4.103226489279335 , psi0=0.06435627453910117 , v0=3.0000000299998804 , spline0=9.947474836329295 , a0=0.0 , w0=0.0
2026-01-13 17:39:14,617 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:14,618 - INFO - integration_test - Dyn residual k=0: pred=[9.306426028050316, 4.122520047277754, 0.06435627453910117, 3.0000000299998804, 10.247474839329284], ws=[9.306426025056538, 4.122520047084819, 0.06435627453910131, 3.0, 10.344326845145016], res=[2.993777670212694e-09, 1.929345572193597e-10, -1.3877787807814457e-16, 2.999988035767842e-08, -0.09685200581573206], res_norm=9.685e-02
2026-01-13 17:39:14,619 - INFO - integration_test - Dyn residual k=1: pred=[9.605804979940155, 4.141813604890304, 0.06435627453910131, 3.0, 10.644326845145017], ws=[9.605804979940155, 4.141813604890304, 0.06435627453910131, 3.0, 10.580845171375822], res=[0.0, 0.0, 0.0, 0.0, 0.06348167376919456], res_norm=6.348e-02
2026-01-13 17:39:14,620 - INFO - integration_test - Dyn residual k=2: pred=[9.905183934823771, 4.161107162695789, 0.06435627453910131, 3.0, 10.880845171375823], ws=[9.905183934823771, 4.161107162695789, 0.06435627453910131, 3.0, 10.983290560058016], res=[0.0, 0.0, 0.0, 0.0, -0.10244538868219344], res_norm=1.024e-01
2026-01-13 17:39:14,634 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:14,706 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:14,721 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:14,733 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:14,748 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:14,760 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:14,776 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:14,788 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:14,803 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:14,815 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:14,830 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:14,841 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:14,856 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:14,868 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:14,882 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:14,894 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:14,909 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:14,921 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:14,936 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:14,946 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:14,959 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:14,969 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:15,155 - INFO - integration_test - Step 37: MPC solve successful
2026-01-13 17:39:15,212 - INFO - integration_test - Step 37: Computed 6 numeric contouring constraints for visualization (s=10.200)
2026-01-13 17:39:15,212 - DEBUG - integration_test - Step 37: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:15,213 - INFO - integration_test - === Applying control at step 37 ===
2026-01-13 17:39:15,213 - INFO - integration_test -   Control dict from planner: {'a': 1.0374022815484723e-13, 'w': -0.24157613311593665}
2026-01-13 17:39:15,213 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:15,213 - INFO - integration_test -   Planner output success: True
2026-01-13 17:39:15,214 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:15,214 - INFO - integration_test - Step 37 completed in 0.730s
2026-01-13 17:39:15,231 - INFO - integration_test - Step 38 (contouring until path end)
2026-01-13 17:39:15,232 - DEBUG - integration_test - Syncing planner state at step 38: vehicle_state=[ 9.30662994  4.11890221  0.04019866  3.00000003 10.50000009]
2026-01-13 17:39:15,233 - DEBUG - integration_test - Step 38: Using propagated spline 10.5000 (close to path, dist=0.656m, drift=0.201m)
2026-01-13 17:39:15,233 - DEBUG - integration_test -   Set spline state to 10.5000
2026-01-13 17:39:15,234 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:15,303 - DEBUG - integration_test - Step 38: Checking path alignment: vehicle=(9.307, 4.119), path_start=(0.000, 0.000), dist=10.177m
2026-01-13 17:39:15,303 - WARNING - integration_test - Step 38: Vehicle is far from path start (dist=10.177m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:39:15,303 - INFO - integration_test - === Calling planner.solve_mpc() at step 38 ===
2026-01-13 17:39:15,544 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:15,554 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:15,554 - INFO - integration_test - Warmstart k=0: x0=9.306629941650568 , y0=4.118902206055147 , psi0=0.04019866122750751 , v0=3.0000000299998906 , spline0=10.348484940339386 , a0=0.0 , w0=0.0
2026-01-13 17:39:15,554 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:15,555 - INFO - integration_test - Dyn residual k=0: pred=[9.60638758743217, 4.130958556890488, 0.04019866122750751, 3.0000000299998906, 10.648484943339374], ws=[9.606387584434605, 4.130958556769925, 0.04019866122750759, 3.0, 10.798181727528252], res=[2.9975648629942953e-09, 1.205631150469344e-10, -8.326672684688674e-17, 2.999989057173025e-08, -0.14969678418887788], res_norm=1.497e-01
2026-01-13 17:39:15,556 - INFO - integration_test - Dyn residual k=1: pred=[9.906145227218643, 4.143014907484703, 0.04019866122750759, 3.0, 11.098181727528253], ws=[9.906145227218643, 4.143014907484703, 0.04019866122750759, 3.0, 11.010982602764974], res=[0.0, 0.0, 0.0, 0.0, 0.08719912476327885], res_norm=8.720e-02
2026-01-13 17:39:15,557 - INFO - integration_test - Dyn residual k=2: pred=[10.20590287000268, 4.155071258199482, 0.04019866122750759, 3.0, 11.310982602764975], ws=[10.20590287000268, 4.155071258199482, 0.04019866122750759, 3.0, 11.16912850857073], res=[0.0, 0.0, 0.0, 0.0, 0.14185409419424566], res_norm=1.419e-01
2026-01-13 17:39:15,570 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:15,640 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:15,655 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:15,667 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:15,682 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:15,693 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:15,708 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:15,720 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:15,734 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:15,746 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:15,760 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:15,772 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:15,786 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:15,798 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:15,813 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:15,824 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:15,839 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:15,851 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:15,866 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:15,876 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:15,890 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:15,900 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:16,058 - INFO - integration_test - Step 38: MPC solve successful
2026-01-13 17:39:16,118 - INFO - integration_test - Step 38: Computed 6 numeric contouring constraints for visualization (s=10.500)
2026-01-13 17:39:16,119 - DEBUG - integration_test - Step 38: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:16,119 - INFO - integration_test - === Applying control at step 38 ===
2026-01-13 17:39:16,119 - INFO - integration_test -   Control dict from planner: {'a': 1.6667133157064966e-14, 'w': -0.22699029981696967}
2026-01-13 17:39:16,119 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:16,119 - INFO - integration_test -   Planner output success: True
2026-01-13 17:39:16,120 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:16,120 - INFO - integration_test - Step 38 completed in 0.888s
2026-01-13 17:39:16,136 - INFO - integration_test - Step 39 (contouring until path end)
2026-01-13 17:39:16,137 - DEBUG - integration_test - Syncing planner state at step 39: vehicle_state=[ 9.60649867  4.12755556  0.01749963  3.00000003 10.80000009]
2026-01-13 17:39:16,137 - DEBUG - integration_test - Step 39: Using propagated spline 10.8000 (close to path, dist=0.670m, drift=0.104m)
2026-01-13 17:39:16,138 - DEBUG - integration_test -   Set spline state to 10.8000
2026-01-13 17:39:16,138 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:16,204 - DEBUG - integration_test - Step 39: Checking path alignment: vehicle=(9.606, 4.128), path_start=(0.000, 0.000), dist=10.456m
2026-01-13 17:39:16,204 - WARNING - integration_test - Step 39: Vehicle is far from path start (dist=10.456m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:39:16,204 - INFO - integration_test - === Calling planner.solve_mpc() at step 39 ===
2026-01-13 17:39:16,256 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:16,266 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:16,266 - INFO - integration_test - Warmstart k=0: x0=9.606498674496255 , y0=4.127555563766706 , psi0=0.017499631245810544 , v0=3.0000000299998923 , spline0=10.547474842329272 , a0=0.0 , w0=0.0
2026-01-13 17:39:16,266 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:16,268 - INFO - integration_test - Dyn residual k=0: pred=[9.906452743103976, 4.132805185245237, 0.017499631245810544, 3.0000000299998923, 10.84747484532926], ws=[9.906452740104447, 4.132805185192741, 0.017499631245810665, 3.0, 11.247931711293916], res=[2.999529513658672e-09, 5.24957854963759e-11, -1.214306433183765e-16, 2.999989234808709e-08, -0.4004568659646548], res_norm=4.005e-01
2026-01-13 17:39:16,268 - INFO - integration_test - Dyn residual k=1: pred=[10.20640680571264, 4.138054806618777, 0.017499631245810665, 3.0, 11.547931711293916], ws=[10.20640680571264, 4.138054806618777, 0.017499631245810665, 3.0, 11.384829073656284], res=[0.0, 0.0, 0.0, 0.0, 0.1631026376376319], res_norm=1.631e-01
2026-01-13 17:39:16,269 - INFO - integration_test - Dyn residual k=2: pred=[10.506360871320831, 4.143304428044812, 0.017499631245810665, 3.0, 11.684829073656285], ws=[10.506360871320831, 4.143304428044812, 0.017499631245810665, 3.0, 11.586939513426023], res=[0.0, 0.0, 0.0, 0.0, 0.09788956023026252], res_norm=9.789e-02
2026-01-13 17:39:16,284 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:16,357 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:16,374 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:16,387 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:16,404 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:16,416 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:16,432 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:16,445 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:16,461 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:16,473 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:16,489 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:16,501 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:16,516 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:16,528 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:16,544 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:16,556 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:16,572 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:16,584 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:16,599 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:16,609 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:16,623 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:16,633 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:23,099 - INFO - integration_test - Step 39: MPC solve successful
2026-01-13 17:39:23,161 - INFO - integration_test - Step 39: Computed 6 numeric contouring constraints for visualization (s=10.800)
2026-01-13 17:39:23,161 - DEBUG - integration_test - Step 39: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:23,161 - INFO - integration_test - === Applying control at step 39 ===
2026-01-13 17:39:23,161 - INFO - integration_test -   Control dict from planner: {'a': -6.942825016326448e-06, 'w': -0.11139518443188585}
2026-01-13 17:39:23,161 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:23,161 - INFO - integration_test -   Planner output success: True
2026-01-13 17:39:23,163 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:23,163 - INFO - integration_test - Step 39 completed in 7.026s
2026-01-13 17:39:23,185 - INFO - integration_test - Step 40 (contouring until path end)
2026-01-13 17:39:23,185 - DEBUG - integration_test - Syncing planner state at step 40: vehicle_state=[9.90647574e+00 4.13113442e+00 6.36011280e-03 2.99999934e+00
 1.11000000e+01]
2026-01-13 17:39:23,186 - DEBUG - integration_test - Step 40: Using propagated spline 11.1000 (close to path, dist=0.670m, drift=0.196m)
2026-01-13 17:39:23,186 - DEBUG - integration_test -   Set spline state to 11.1000
2026-01-13 17:39:23,187 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:23,252 - DEBUG - integration_test - Step 40: Checking path alignment: vehicle=(9.906, 4.131), path_start=(0.000, 0.000), dist=10.733m
2026-01-13 17:39:23,252 - WARNING - integration_test - Step 40: Vehicle is far from path start (dist=10.733m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:39:23,252 - INFO - integration_test - === Calling planner.solve_mpc() at step 40 ===
2026-01-13 17:39:23,304 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:23,314 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:23,314 - INFO - integration_test - Warmstart k=0: x0=9.906475743763483 , y0=4.131134421662547 , psi0=0.006360112802621958 , v0=2.9999993357173906 , spline0=11.251515179941416 , a0=0.0 , w0=0.0
2026-01-13 17:39:23,314 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:23,315 - INFO - integration_test - Dyn residual k=0: pred=[10.20646960970179, 4.133042442217214, 0.006360112802621958, 2.9999993357173906, 11.551515113513155], ws=[10.20646960970179, 4.133042442217214, 0.006360112802621831, 2.9999993357173906, 11.399680273732995], res=[0.0, 0.0, 1.2663481374630692e-16, 0.0, 0.15183483978015921], res_norm=1.518e-01
2026-01-13 17:39:23,316 - INFO - integration_test - Dyn residual k=1: pred=[10.506463475640096, 4.13495046277188, 0.006360112802621831, 2.9999993357173906, 11.699680207304734], ws=[10.506463475640096, 4.13495046277188, 0.006360112802621831, 2.9999993357173906, 11.816367602027421], res=[0.0, 0.0, 0.0, 0.0, -0.11668739472268719], res_norm=1.167e-01
2026-01-13 17:39:23,317 - INFO - integration_test - Dyn residual k=2: pred=[10.806457341578403, 4.136858483326547, 0.006360112802621831, 2.9999993357173906, 12.11636753559916], ws=[10.806457341578403, 4.136858483326547, 0.006360112802621831, 2.9999993357173906, 11.977427377699033], res=[0.0, 0.0, 0.0, 0.0, 0.1389401579001266], res_norm=1.389e-01
2026-01-13 17:39:23,331 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:23,402 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:23,417 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:23,429 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:23,444 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:23,456 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:23,472 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:23,484 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:23,499 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:23,511 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:23,526 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:23,538 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:23,553 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:23,565 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:23,581 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:23,593 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:23,609 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:23,621 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:23,636 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:23,646 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:23,659 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:23,670 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:34,800 - WARNING - integration_test - Step 40: MPC solve failed
2026-01-13 17:39:34,800 - WARNING - integration_test -   Consecutive MPC failures: 1/5
2026-01-13 17:39:34,873 - INFO - integration_test - Step 40: Computed 6 numeric contouring constraints for visualization (s=11.100)
2026-01-13 17:39:34,874 - DEBUG - integration_test - Step 40: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:34,874 - INFO - integration_test - === Applying control at step 40 ===
2026-01-13 17:39:34,874 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 17:39:34,874 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:34,875 - INFO - integration_test -   Planner output success: False
2026-01-13 17:39:34,875 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 17:39:34,876 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:34,877 - INFO - integration_test - Step 40 completed in 11.692s
2026-01-13 17:39:34,889 - INFO - integration_test - Step 41 (contouring until path end)
2026-01-13 17:39:34,890 - DEBUG - integration_test - Syncing planner state at step 41: vehicle_state=[1.02064696e+01 4.13304244e+00 6.36011280e-03 2.99999934e+00
 1.14000000e+01]
2026-01-13 17:39:34,891 - DEBUG - integration_test - Step 41: Using propagated spline 11.4000 (close to path, dist=0.682m, drift=0.110m)
2026-01-13 17:39:34,891 - DEBUG - integration_test -   Set spline state to 11.4000
2026-01-13 17:39:34,892 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:34,959 - DEBUG - integration_test - Step 41: Checking path alignment: vehicle=(10.206, 4.133), path_start=(0.000, 0.000), dist=11.012m
2026-01-13 17:39:34,959 - WARNING - integration_test - Step 41: Vehicle is far from path start (dist=11.012m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:39:34,959 - INFO - integration_test - === Calling planner.solve_mpc() at step 41 ===
2026-01-13 17:39:35,015 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:35,025 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:35,025 - INFO - integration_test - Warmstart k=0: x0=10.20646960970179 , y0=4.133042442217214 , psi0=0.006360112802621958 , v0=2.9999993357173906 , spline0=11.14747470947275 , a0=0.0 , w0=0.0
2026-01-13 17:39:35,025 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:35,027 - INFO - integration_test - Dyn residual k=0: pred=[10.506463475640096, 4.13495046277188, 0.006360112802621958, 2.9999993357173906, 11.447474643044488], ws=[10.506463475640096, 4.13495046277188, 0.006360112802621831, 2.9999993357173906, 11.849451950992279], res=[0.0, 0.0, 1.2663481374630692e-16, 0.0, -0.4019773079477904], res_norm=4.020e-01
2026-01-13 17:39:35,028 - INFO - integration_test - Dyn residual k=1: pred=[10.806457341578403, 4.136858483326547, 0.006360112802621831, 2.9999993357173906, 12.149451884564018], ws=[10.806457341578403, 4.136858483326547, 0.006360112802621831, 2.9999993357173906, 11.988977833470331], res=[0.0, 0.0, 0.0, 0.0, 0.1604740510936864], res_norm=1.605e-01
2026-01-13 17:39:35,029 - INFO - integration_test - Dyn residual k=2: pred=[11.10645120751671, 4.138766503881214, 0.006360112802621831, 2.9999993357173906, 12.28897776704207], ws=[11.10645120751671, 4.138766503881214, 0.006360112802621831, 2.9999993357173906, 12.396339485539094], res=[0.0, 0.0, 0.0, 0.0, -0.10736171849702458], res_norm=1.074e-01
2026-01-13 17:39:35,043 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:35,116 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:35,131 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:35,143 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:35,158 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:35,170 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:35,184 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:35,196 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:35,211 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:35,222 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:35,237 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:35,248 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:35,263 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:35,274 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:35,289 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:35,300 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:35,315 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:35,327 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:35,343 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:35,353 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:35,366 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:35,376 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:45,717 - WARNING - integration_test - Step 41: MPC solve failed
2026-01-13 17:39:45,717 - WARNING - integration_test -   Consecutive MPC failures: 2/5
2026-01-13 17:39:45,778 - INFO - integration_test - Step 41: Computed 6 numeric contouring constraints for visualization (s=11.400)
2026-01-13 17:39:45,779 - DEBUG - integration_test - Step 41: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:45,779 - INFO - integration_test - === Applying control at step 41 ===
2026-01-13 17:39:45,779 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 17:39:45,779 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:45,779 - INFO - integration_test -   Planner output success: False
2026-01-13 17:39:45,779 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 17:39:45,780 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:45,781 - INFO - integration_test - Step 41 completed in 10.891s
2026-01-13 17:39:45,797 - INFO - integration_test - Step 42 (contouring until path end)
2026-01-13 17:39:45,799 - DEBUG - integration_test - Syncing planner state at step 42: vehicle_state=[1.05064635e+01 4.13495046e+00 6.36011280e-03 2.99999934e+00
 1.16999999e+01]
2026-01-13 17:39:45,799 - DEBUG - integration_test - Step 42: Using propagated spline 11.7000 (close to path, dist=0.661m, drift=0.190m)
2026-01-13 17:39:45,799 - DEBUG - integration_test -   Set spline state to 11.7000
2026-01-13 17:39:45,800 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:45,866 - DEBUG - integration_test - Step 42: Checking path alignment: vehicle=(10.506, 4.135), path_start=(0.000, 0.000), dist=11.291m
2026-01-13 17:39:45,866 - WARNING - integration_test - Step 42: Vehicle is far from path start (dist=11.291m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:39:45,866 - INFO - integration_test - === Calling planner.solve_mpc() at step 42 ===
2026-01-13 17:39:45,920 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:45,930 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:45,930 - INFO - integration_test - Warmstart k=0: x0=10.506463475640096 , y0=4.13495046277188 , psi0=0.006360112802621958 , v0=2.9999993357173906 , spline0=11.851515047084892 , a0=0.0 , w0=0.0
2026-01-13 17:39:45,930 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:45,931 - INFO - integration_test - Dyn residual k=0: pred=[10.806457341578403, 4.136858483326547, 0.006360112802621958, 2.9999993357173906, 12.15151498065663], ws=[10.806457341578403, 4.136858483326547, 0.006360112802621831, 2.9999993357173906, 12.002323572208415], res=[0.0, 0.0, 1.2663481374630692e-16, 0.0, 0.14919140844821577], res_norm=1.492e-01
2026-01-13 17:39:45,932 - INFO - integration_test - Dyn residual k=1: pred=[11.10645120751671, 4.138766503881214, 0.006360112802621831, 2.9999993357173906, 12.302323505780153], ws=[11.10645120751671, 4.138766503881214, 0.006360112802621831, 2.9999993357173906, 12.422346380038134], res=[0.0, 0.0, 0.0, 0.0, -0.1200228742579803], res_norm=1.200e-01
2026-01-13 17:39:45,932 - INFO - integration_test - Dyn residual k=2: pred=[11.406445073455016, 4.14067452443588, 0.006360112802621831, 2.9999993357173906, 12.722346313609872], ws=[11.406445073455016, 4.14067452443588, 0.006360112802621831, 2.9999993357173906, 12.60188917261645], res=[0.0, 0.0, 0.0, 0.0, 0.12045714099342142], res_norm=1.205e-01
2026-01-13 17:39:45,947 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:46,018 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:46,033 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:46,045 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:46,060 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:46,071 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:46,086 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:46,098 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:46,112 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:46,124 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:46,138 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:46,150 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:46,164 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:46,176 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:46,191 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:46,202 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:46,217 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:46,229 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:46,244 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:46,254 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:46,267 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:46,277 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:48,112 - WARNING - integration_test - Step 42: MPC solve failed
2026-01-13 17:39:48,112 - WARNING - integration_test -   Consecutive MPC failures: 3/5
2026-01-13 17:39:48,177 - INFO - integration_test - Step 42: Computed 6 numeric contouring constraints for visualization (s=11.700)
2026-01-13 17:39:48,177 - DEBUG - integration_test - Step 42: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:48,177 - INFO - integration_test - === Applying control at step 42 ===
2026-01-13 17:39:48,177 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 17:39:48,177 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:48,177 - INFO - integration_test -   Planner output success: False
2026-01-13 17:39:48,177 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 17:39:48,179 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:48,179 - INFO - integration_test - Step 42 completed in 2.381s
2026-01-13 17:39:48,193 - INFO - integration_test - Step 43 (contouring until path end)
2026-01-13 17:39:48,196 - DEBUG - integration_test - Syncing planner state at step 43: vehicle_state=[1.08064573e+01 4.13685848e+00 6.36011280e-03 2.99999934e+00
 1.19999998e+01]
2026-01-13 17:39:48,197 - DEBUG - integration_test - Step 43: Using propagated spline 12.0000 (close to path, dist=0.671m, drift=0.116m)
2026-01-13 17:39:48,197 - DEBUG - integration_test -   Set spline state to 12.0000
2026-01-13 17:39:48,198 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:48,263 - DEBUG - integration_test - Step 43: Checking path alignment: vehicle=(10.806, 4.137), path_start=(0.000, 0.000), dist=11.571m
2026-01-13 17:39:48,263 - WARNING - integration_test - Step 43: Vehicle is far from path start (dist=11.571m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:39:48,263 - INFO - integration_test - === Calling planner.solve_mpc() at step 43 ===
2026-01-13 17:39:48,318 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:48,328 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:48,328 - INFO - integration_test - Warmstart k=0: x0=10.806457341578403 , y0=4.136858483326547 , psi0=0.006360112802621958 , v0=2.9999993357173906 , spline0=11.747474576616227 , a0=0.0 , w0=0.0
2026-01-13 17:39:48,328 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:48,329 - INFO - integration_test - Dyn residual k=0: pred=[11.10645120751671, 4.138766503881214, 0.006360112802621958, 2.9999993357173906, 12.047474510187966], ws=[11.10645120751671, 4.138766503881214, 0.006360112802621831, 2.9999993357173906, 12.149241198264512], res=[0.0, 0.0, 1.2663481374630692e-16, 0.0, -0.10176668807654643], res_norm=1.018e-01
2026-01-13 17:39:48,330 - INFO - integration_test - Dyn residual k=1: pred=[11.406445073455016, 4.14067452443588, 0.006360112802621831, 2.9999993357173906, 12.449241131836251], ws=[11.406445073455016, 4.14067452443588, 0.006360112802621831, 2.9999993357173906, 12.596159544431858], res=[0.0, 0.0, 0.0, 0.0, -0.1469184125956069], res_norm=1.469e-01
2026-01-13 17:39:48,331 - INFO - integration_test - Dyn residual k=2: pred=[11.706438939393323, 4.142582544990547, 0.006360112802621831, 2.9999993357173906, 12.896159478003597], ws=[11.706438939393323, 4.142582544990547, 0.006360112802621831, 2.9999993357173906, 13.00888442286763], res=[0.0, 0.0, 0.0, 0.0, -0.11272494486403417], res_norm=1.127e-01
2026-01-13 17:39:48,345 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:48,417 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:48,433 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:48,445 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:48,461 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:48,473 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:48,487 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:48,499 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:48,513 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:48,525 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:48,540 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:48,552 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:48,566 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:48,578 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:48,593 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:48,605 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:48,620 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:48,632 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:48,648 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:48,659 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:48,672 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:48,682 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:50,078 - WARNING - integration_test - Step 43: MPC solve failed
2026-01-13 17:39:50,078 - WARNING - integration_test -   Consecutive MPC failures: 4/5
2026-01-13 17:39:50,145 - INFO - integration_test - Step 43: Computed 6 numeric contouring constraints for visualization (s=12.000)
2026-01-13 17:39:50,145 - DEBUG - integration_test - Step 43: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:50,145 - INFO - integration_test - === Applying control at step 43 ===
2026-01-13 17:39:50,145 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 17:39:50,145 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:50,145 - INFO - integration_test -   Planner output success: False
2026-01-13 17:39:50,145 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 17:39:50,146 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:50,147 - INFO - integration_test - Step 43 completed in 1.951s
2026-01-13 17:39:50,167 - INFO - integration_test - Step 44 (contouring until path end)
2026-01-13 17:39:50,168 - DEBUG - integration_test - Syncing planner state at step 44: vehicle_state=[1.11064512e+01 4.13876650e+00 6.36011280e-03 2.99999934e+00
 1.22999998e+01]
2026-01-13 17:39:50,169 - DEBUG - integration_test - Step 44: Using propagated spline 12.3000 (close to path, dist=0.627m, drift=0.184m)
2026-01-13 17:39:50,169 - DEBUG - integration_test -   Set spline state to 12.3000
2026-01-13 17:39:50,170 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:50,237 - DEBUG - integration_test - Step 44: Checking path alignment: vehicle=(11.106, 4.139), path_start=(0.000, 0.000), dist=11.853m
2026-01-13 17:39:50,237 - WARNING - integration_test - Step 44: Vehicle is far from path start (dist=11.853m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:39:50,237 - INFO - integration_test - === Calling planner.solve_mpc() at step 44 ===
2026-01-13 17:39:50,290 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:50,300 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:50,300 - INFO - integration_test - Warmstart k=0: x0=11.10645120751671 , y0=4.138766503881214 , psi0=0.006360112802621958 , v0=2.9999993357173906 , spline0=12.148484611198068 , a0=0.0 , w0=0.0
2026-01-13 17:39:50,301 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:50,302 - INFO - integration_test - Dyn residual k=0: pred=[11.406445073455016, 4.14067452443588, 0.006360112802621958, 2.9999993357173906, 12.448484544769807], ws=[11.406445073455016, 4.14067452443588, 0.006360112802621831, 2.9999993357173906, 12.60654802572625], res=[0.0, 0.0, 1.2663481374630692e-16, 0.0, -0.15806348095644296], res_norm=1.581e-01
2026-01-13 17:39:50,303 - INFO - integration_test - Dyn residual k=1: pred=[11.706438939393323, 4.142582544990547, 0.006360112802621831, 2.9999993357173906, 12.906547959297988], ws=[11.572203773304182, 4.116029293205991, 0.006360112802621831, 2.9999993357173906, 12.930854396358118], res=[0.134235166089141, 0.026553251784555698, 0.0, 0.0, -0.024306437060129582], res_norm=1.390e-01
2026-01-13 17:39:50,303 - INFO - integration_test - Dyn residual k=2: pred=[11.872197639242488, 4.117937313760658, 0.006360112802621831, 2.9999993357173906, 13.230854329929857], ws=[12.00643280533163, 4.144490565545214, 0.006360112802621831, 2.9999993357173906, 13.21786891286933], res=[-0.134235166089141, -0.026553251784555698, 0.0, 0.0, 0.012985417060527027], res_norm=1.375e-01
2026-01-13 17:39:50,317 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:50,389 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:50,404 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:50,416 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:50,432 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:50,444 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:50,459 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:50,471 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:50,486 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:50,498 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:50,512 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:50,524 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:50,538 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:50,550 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:50,565 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:50,577 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:50,592 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:50,603 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:50,618 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:50,628 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:50,641 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:50,651 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:50,808 - INFO - integration_test - Step 44: MPC solve successful
2026-01-13 17:39:50,874 - INFO - integration_test - Step 44: Computed 6 numeric contouring constraints for visualization (s=12.300)
2026-01-13 17:39:50,875 - DEBUG - integration_test - Step 44: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:50,875 - INFO - integration_test - === Applying control at step 44 ===
2026-01-13 17:39:50,875 - INFO - integration_test -   Control dict from planner: {'a': -1.9999013609353309, 'w': 0.7999999714970852}
2026-01-13 17:39:50,875 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:50,875 - INFO - integration_test -   Planner output success: True
2026-01-13 17:39:50,876 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:50,877 - INFO - integration_test - Step 44 completed in 0.709s
2026-01-13 17:39:50,891 - INFO - integration_test - Step 45 (contouring until path end)
2026-01-13 17:39:50,891 - DEBUG - integration_test - Syncing planner state at step 45: vehicle_state=[11.39606898  4.15206941  0.08636011  2.8000092  12.58000068]
2026-01-13 17:39:50,892 - DEBUG - integration_test - Step 45: Using propagated spline 12.5800 (close to path, dist=0.637m, drift=0.142m)
2026-01-13 17:39:50,892 - DEBUG - integration_test -   Set spline state to 12.5800
2026-01-13 17:39:50,893 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:50,958 - DEBUG - integration_test - Step 45: Checking path alignment: vehicle=(11.396, 4.152), path_start=(0.000, 0.000), dist=12.129m
2026-01-13 17:39:50,958 - WARNING - integration_test - Step 45: Vehicle is far from path start (dist=12.129m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:39:50,958 - INFO - integration_test - === Calling planner.solve_mpc() at step 45 ===
2026-01-13 17:39:51,014 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:51,024 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:51,024 - INFO - integration_test - Warmstart k=0: x0=11.396068984078088 , y0=4.152069409132489 , psi0=0.08636010995233048 , v0=2.8000091996238576 , spline0=12.32747543015035 , a0=0.0 , w0=0.0
2026-01-13 17:39:51,024 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:51,025 - INFO - integration_test - Dyn residual k=0: pred=[11.675026419780508, 4.176220273425764, 0.08636010995233048, 2.8000091996238576, 12.607476350112737], ws=[11.675026419780508, 4.176220273425764, 0.08636010995233034, 2.8000091996238576, 13.010837575403205], res=[0.0, 0.0, 1.3877787807814457e-16, 0.0, -0.4033612252904675], res_norm=4.034e-01
2026-01-13 17:39:51,026 - INFO - integration_test - Dyn residual k=1: pred=[11.953983855482928, 4.2003711377190385, 0.08636010995233034, 2.8000091996238576, 13.290838495365591], ws=[11.953983855482928, 4.2003711377190385, 0.08636010995233034, 2.8000091996238576, 13.131780524719632], res=[0.0, 0.0, 0.0, 0.0, 0.15905797064595895], res_norm=1.591e-01
2026-01-13 17:39:51,027 - INFO - integration_test - Dyn residual k=2: pred=[12.232941291185348, 4.224522002012313, 0.08636010995233034, 2.8000091996238576, 13.411781444682019], ws=[12.232941291185348, 4.224522002012313, 0.08636010995233034, 2.8000091996238576, 13.316953657035814], res=[0.0, 0.0, 0.0, 0.0, 0.0948277876462047], res_norm=9.483e-02
2026-01-13 17:39:51,041 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:51,112 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:51,127 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:51,138 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:51,153 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:51,165 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:51,180 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:51,191 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:51,206 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:51,218 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:51,232 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:51,244 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:51,258 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:51,270 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:51,285 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:51,297 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:51,312 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:51,324 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:51,339 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:51,349 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:51,362 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:51,372 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:55,016 - WARNING - integration_test - Step 45: MPC solve failed
2026-01-13 17:39:55,016 - WARNING - integration_test -   Consecutive MPC failures: 1/5
2026-01-13 17:39:55,092 - INFO - integration_test - Step 45: Computed 6 numeric contouring constraints for visualization (s=12.580)
2026-01-13 17:39:55,092 - DEBUG - integration_test - Step 45: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:55,092 - INFO - integration_test - === Applying control at step 45 ===
2026-01-13 17:39:55,092 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 17:39:55,092 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:55,092 - INFO - integration_test -   Planner output success: False
2026-01-13 17:39:55,092 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 17:39:55,094 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:55,095 - INFO - integration_test - Step 45 completed in 4.203s
2026-01-13 17:39:55,109 - INFO - integration_test - Step 46 (contouring until path end)
2026-01-13 17:39:55,113 - DEBUG - integration_test - Syncing planner state at step 46: vehicle_state=[11.67502642  4.17622027  0.08636011  2.8000092  12.8600016 ]
2026-01-13 17:39:55,114 - DEBUG - integration_test - Step 46: Using propagated spline 12.8600 (close to path, dist=0.538m, drift=0.138m)
2026-01-13 17:39:55,114 - DEBUG - integration_test -   Set spline state to 12.8600
2026-01-13 17:39:55,115 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:55,184 - DEBUG - integration_test - Step 46: Checking path alignment: vehicle=(11.675, 4.176), path_start=(0.000, 0.000), dist=12.399m
2026-01-13 17:39:55,184 - WARNING - integration_test - Step 46: Vehicle is far from path start (dist=12.399m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:39:55,184 - INFO - integration_test - === Calling planner.solve_mpc() at step 46 ===
2026-01-13 17:39:55,238 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:55,248 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:55,248 - INFO - integration_test - Warmstart k=0: x0=11.675026419780508 , y0=4.176220273425764 , psi0=0.08636010995233048 , v0=2.8000091996238576 , spline0=13.011516754153144 , a0=0.0 , w0=0.0
2026-01-13 17:39:55,248 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:55,249 - INFO - integration_test - Dyn residual k=0: pred=[11.953983855482928, 4.2003711377190385, 0.08636010995233048, 2.8000091996238576, 13.29151767411553], ws=[11.953983855482928, 4.2003711377190385, 0.08636010995233034, 2.8000091996238576, 13.143501264402467], res=[0.0, 0.0, 1.3877787807814457e-16, 0.0, 0.14801640971306362], res_norm=1.480e-01
2026-01-13 17:39:55,250 - INFO - integration_test - Dyn residual k=1: pred=[12.232941291185348, 4.224522002012313, 0.08636010995233034, 2.8000091996238576, 13.423502184364853], ws=[12.232941291185348, 4.224522002012313, 0.08636010995233034, 2.8000091996238576, 13.543345563566707], res=[0.0, 0.0, 0.0, 0.0, -0.1198433792018534], res_norm=1.198e-01
2026-01-13 17:39:55,251 - INFO - integration_test - Dyn residual k=2: pred=[12.511898726887768, 4.248672866305588, 0.08636010995233034, 2.8000091996238576, 13.823346483529093], ws=[12.511898726887768, 4.248672866305588, 0.08636010995233034, 2.8000091996238576, 13.700888950779005], res=[0.0, 0.0, 0.0, 0.0, 0.1224575327500883], res_norm=1.225e-01
2026-01-13 17:39:55,266 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:55,337 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:55,352 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:55,364 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:55,379 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:55,391 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:55,406 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:55,418 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:55,433 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:55,445 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:55,461 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:55,472 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:55,488 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:55,500 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:55,515 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:55,527 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:55,542 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:55,554 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:55,569 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:55,579 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:55,592 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:55,603 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:55,736 - INFO - integration_test - Step 46: MPC solve successful
2026-01-13 17:39:55,804 - INFO - integration_test - Step 46: Computed 6 numeric contouring constraints for visualization (s=12.860)
2026-01-13 17:39:55,805 - DEBUG - integration_test - Step 46: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:55,805 - INFO - integration_test - === Applying control at step 46 ===
2026-01-13 17:39:55,805 - INFO - integration_test -   Control dict from planner: {'a': 1.999908303761174, 'w': 0.35463891619737736}
2026-01-13 17:39:55,805 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:55,805 - INFO - integration_test -   Planner output success: True
2026-01-13 17:39:55,806 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:55,806 - INFO - integration_test - Step 46 completed in 0.693s
2026-01-13 17:39:55,823 - INFO - integration_test - Step 47 (contouring until path end)
2026-01-13 17:39:55,825 - DEBUG - integration_test - Syncing planner state at step 47: vehicle_state=[11.96343594  4.20640974  0.121824    3.00000003 13.16000161]
2026-01-13 17:39:55,825 - DEBUG - integration_test - Step 47: Using propagated spline 13.1600 (close to path, dist=0.574m, drift=0.438m)
2026-01-13 17:39:55,825 - DEBUG - integration_test -   Set spline state to 13.1600
2026-01-13 17:39:55,827 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:55,893 - DEBUG - integration_test - Step 47: Checking path alignment: vehicle=(11.963, 4.206), path_start=(0.000, 0.000), dist=12.681m
2026-01-13 17:39:55,893 - WARNING - integration_test - Step 47: Vehicle is far from path start (dist=12.681m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:39:55,893 - INFO - integration_test - === Calling planner.solve_mpc() at step 47 ===
2026-01-13 17:39:55,948 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:55,958 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:55,958 - INFO - integration_test - Warmstart k=0: x0=11.96343594397432 , y0=4.206409735930706 , psi0=0.12182400157206821 , v0=3.000000029999975 , spline0=13.109496555132939 , a0=0.0 , w0=0.0
2026-01-13 17:39:55,958 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:55,959 - INFO - integration_test - Dyn residual k=0: pred=[12.261212535709987, 4.242866603792447, 0.12182400157206821, 3.000000029999975, 13.409496558132936], ws=[12.261212532732223, 4.242866603427879, 0.12182400157206841, 3.0, 13.314741013302593], res=[2.9777638133055007e-09, 3.64568819577471e-10, -1.942890293094024e-16, 2.999997494868012e-08, 0.09475554483034365], res_norm=9.476e-02
2026-01-13 17:39:55,960 - INFO - integration_test - Dyn residual k=1: pred=[12.558989121490127, 4.279323470925051, 0.12182400157206841, 3.0, 13.614741013302593], ws=[12.558989121490127, 4.279323470925051, 0.12182400157206841, 3.0, 13.68334384194922], res=[0.0, 0.0, 0.0, 0.0, -0.06860282864662715], res_norm=6.860e-02
2026-01-13 17:39:55,961 - INFO - integration_test - Dyn residual k=2: pred=[12.85676571024803, 4.315780338422223, 0.12182400157206841, 3.0, 13.983343841949221], ws=[12.85676571024803, 4.315780338422223, 0.12182400157206841, 3.0, 13.893703272416372], res=[0.0, 0.0, 0.0, 0.0, 0.0896405695328486], res_norm=8.964e-02
2026-01-13 17:39:55,975 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:56,046 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:56,061 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:56,072 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:56,087 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:56,099 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:56,115 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:56,127 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:56,142 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:56,154 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:56,169 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:56,180 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:56,195 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:56,206 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:56,221 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:56,233 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:56,248 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:56,259 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:56,275 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:56,285 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:56,298 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:56,308 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:56,429 - INFO - integration_test - Step 47: MPC solve successful
2026-01-13 17:39:56,496 - INFO - integration_test - Step 47: Computed 6 numeric contouring constraints for visualization (s=13.160)
2026-01-13 17:39:56,497 - DEBUG - integration_test - Step 47: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:56,497 - INFO - integration_test - === Applying control at step 47 ===
2026-01-13 17:39:56,497 - INFO - integration_test -   Control dict from planner: {'a': -1.6213282617017714e-09, 'w': 0.7999999875368776}
2026-01-13 17:39:56,497 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:56,497 - INFO - integration_test -   Planner output success: True
2026-01-13 17:39:56,498 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:56,498 - INFO - integration_test - Step 47 completed in 0.674s
2026-01-13 17:39:56,516 - INFO - integration_test - Step 48 (contouring until path end)
2026-01-13 17:39:56,516 - DEBUG - integration_test - Syncing planner state at step 48: vehicle_state=[12.25943752  4.25473244  0.201824    3.00000003 13.46000161]
2026-01-13 17:39:56,517 - DEBUG - integration_test - Step 48: Using propagated spline 13.4600 (close to path, dist=0.400m, drift=0.132m)
2026-01-13 17:39:56,517 - DEBUG - integration_test -   Set spline state to 13.4600
2026-01-13 17:39:56,518 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:56,587 - DEBUG - integration_test - Step 48: Checking path alignment: vehicle=(12.259, 4.255), path_start=(0.000, 0.000), dist=12.977m
2026-01-13 17:39:56,587 - WARNING - integration_test - Step 48: Vehicle is far from path start (dist=12.977m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:39:56,587 - INFO - integration_test - === Calling planner.solve_mpc() at step 48 ===
2026-01-13 17:39:56,642 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:56,652 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:56,652 - INFO - integration_test - Warmstart k=0: x0=12.259437516072396 , y0=4.254732441867893 , psi0=0.20182400032575598 , v0=3.000000029837842 , spline0=13.308486457106621 , a0=0.0 , w0=0.0
2026-01-13 17:39:56,652 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:56,653 - INFO - integration_test - Dyn residual k=0: pred=[12.553348291432307, 4.31486943478911, 0.20182400032575598, 3.000000029837842, 13.608486460090406], ws=[12.553348288509085, 4.314869434190991, 0.2018240003257561, 3.0, 13.66696904716009], res=[2.9232225529085554e-09, 5.981197759297174e-10, -1.1102230246251565e-16, 2.983784197496675e-08, -0.05848258706968501], res_norm=5.848e-02
2026-01-13 17:39:56,654 - INFO - integration_test - Dyn residual k=1: pred=[12.847259060945774, 4.375006426514088, 0.2018240003257561, 3.0, 13.966969047160092], ws=[12.760898537792373, 4.618266899015502, 0.2018240003257561, 3.0, 14.068859095630811], res=[0.08636052315340059, -0.24326047250141425, 0.0, 0.0, -0.10189004847071992], res_norm=2.775e-01
2026-01-13 17:39:56,655 - INFO - integration_test - Dyn residual k=2: pred=[13.054809310229063, 4.6784038913386, 0.2018240003257561, 3.0, 14.368859095630812], ws=[13.141169833382463, 4.435143418837185, 0.2018240003257561, 3.0, 14.230728730874214], res=[-0.08636052315340059, 0.24326047250141425, 0.0, 0.0, 0.13813036475659857], res_norm=2.928e-01
2026-01-13 17:39:56,669 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:56,745 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:56,760 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:56,772 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:56,788 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:56,799 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:56,814 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:56,826 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:56,841 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:56,853 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:56,868 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:56,879 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:56,894 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:56,906 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:56,920 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:56,933 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:56,949 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:56,971 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:56,993 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:57,009 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:57,029 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:57,045 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:57,233 - INFO - integration_test - Step 48: MPC solve successful
2026-01-13 17:39:57,303 - INFO - integration_test - Step 48: Computed 6 numeric contouring constraints for visualization (s=13.460)
2026-01-13 17:39:57,304 - DEBUG - integration_test - Step 48: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:57,304 - INFO - integration_test - === Applying control at step 48 ===
2026-01-13 17:39:57,304 - INFO - integration_test -   Control dict from planner: {'a': -6.225552738649875e-11, 'w': -0.8000000013477186}
2026-01-13 17:39:57,304 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:57,304 - INFO - integration_test -   Planner output success: True
2026-01-13 17:39:57,305 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:57,305 - INFO - integration_test - Step 48 completed in 0.789s
2026-01-13 17:39:57,322 - INFO - integration_test - Step 49 (contouring until path end)
2026-01-13 17:39:57,323 - DEBUG - integration_test - Syncing planner state at step 49: vehicle_state=[12.55543909  4.30305515  0.121824    3.00000003 13.76000161]
2026-01-13 17:39:57,323 - DEBUG - integration_test - Step 49: Using propagated spline 13.7600 (close to path, dist=0.406m, drift=0.432m)
2026-01-13 17:39:57,323 - DEBUG - integration_test -   Set spline state to 13.7600
2026-01-13 17:39:57,325 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:57,622 - DEBUG - integration_test - Step 49: Checking path alignment: vehicle=(12.555, 4.303), path_start=(0.000, 0.000), dist=13.272m
2026-01-13 17:39:57,622 - WARNING - integration_test - Step 49: Vehicle is far from path start (dist=13.272m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:39:57,622 - INFO - integration_test - === Calling planner.solve_mpc() at step 49 ===
2026-01-13 17:39:57,680 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:57,690 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:57,690 - INFO - integration_test - Warmstart k=0: x0=12.555439088192792 , y0=4.303055147598988 , psi0=0.1218240001909841 , v0=3.0000000298316163 , spline0=13.709496561099884 , a0=0.0 , w0=0.0
2026-01-13 17:39:57,690 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:57,692 - INFO - integration_test - Dyn residual k=0: pred=[12.853215679962098, 4.339512015047428, 0.1218240001909841, 3.0000000298316163, 14.009496564083046], ws=[12.853215677001046, 4.339512014684906, 0.12182400019098427, 3.0, 14.12976734557276], res=[2.961051848160423e-09, 3.625224564984819e-10, -1.6653345369377348e-16, 2.983161628833386e-08, -0.12027078148971526], res_norm=1.203e-01
2026-01-13 17:39:57,693 - INFO - integration_test - Dyn residual k=1: pred=[13.1509922658093, 4.375968881770824, 0.12182400019098427, 3.0, 14.429767345572762], ws=[13.447757960547653, 4.929369088253019, 0.12182400019098427, 3.0, 14.412859915463068], res=[-0.2967656947383528, -0.5534002064821948, 0.0, 0.0, 0.016907430109693422], res_norm=6.282e-01
2026-01-13 17:39:57,694 - INFO - integration_test - Dyn residual k=2: pred=[13.745534549355906, 4.965825955338937, 0.12182400019098427, 3.0, 14.712859915463069], ws=[13.448768854617555, 4.412425748856742, 0.12182400019098427, 3.0, 14.439762305180906], res=[0.296765694738351, 0.5534002064821948, 0.0, 0.0, 0.2730976102821625], res_norm=6.848e-01
2026-01-13 17:39:57,709 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:57,783 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:57,799 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:57,811 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:57,827 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:57,838 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:57,853 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:57,865 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:57,880 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:57,892 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:57,907 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:57,919 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:57,933 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:57,945 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:57,959 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:57,971 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:57,986 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:57,998 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:58,013 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:58,024 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:58,037 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:58,047 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:58,173 - INFO - integration_test - Step 49: MPC solve successful
2026-01-13 17:39:58,244 - INFO - integration_test - Step 49: Computed 6 numeric contouring constraints for visualization (s=13.760)
2026-01-13 17:39:58,244 - DEBUG - integration_test - Step 49: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:58,244 - INFO - integration_test - === Applying control at step 49 ===
2026-01-13 17:39:58,245 - INFO - integration_test -   Control dict from planner: {'a': 1.0392542467566937e-09, 'w': -0.7999999905920915}
2026-01-13 17:39:58,245 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:58,245 - INFO - integration_test -   Planner output success: True
2026-01-13 17:39:58,246 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:58,246 - INFO - integration_test - Step 49 completed in 0.924s
2026-01-13 17:39:58,263 - INFO - integration_test - Step 50 (contouring until path end)
2026-01-13 17:39:58,264 - DEBUG - integration_test - Syncing planner state at step 50: vehicle_state=[12.85435565  4.32756843  0.041824    3.00000003 14.06000161]
2026-01-13 17:39:58,265 - DEBUG - integration_test - Step 50: Using propagated spline 14.0600 (close to path, dist=0.272m, drift=0.127m)
2026-01-13 17:39:58,265 - DEBUG - integration_test -   Set spline state to 14.0600
2026-01-13 17:39:58,266 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:58,332 - DEBUG - integration_test - Step 50: Checking path alignment: vehicle=(12.854, 4.328), path_start=(0.000, 0.000), dist=13.563m
2026-01-13 17:39:58,332 - WARNING - integration_test - Step 50: Vehicle is far from path start (dist=13.563m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:39:58,332 - INFO - integration_test - === Calling planner.solve_mpc() at step 50 ===
2026-01-13 17:39:58,385 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:58,399 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:58,399 - INFO - integration_test - Warmstart k=0: x0=12.85435565458806 , y0=4.327568428195475 , psi0=0.041824001131774965 , v0=3.0000000299355416 , spline0=14.11050666510354 , a0=0.0 , w0=0.0
2026-01-13 17:39:58,399 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:58,400 - INFO - integration_test - Dyn residual k=0: pred=[13.154093308764482, 4.340111970954526, 0.041824001131774965, 3.0000000299355416, 14.410506668097094], ws=[13.154093305773547, 4.34011197082936, 0.04182400113177476, 3.0, 14.279077288113855], res=[2.9909354992696535e-09, 1.2516565561782045e-10, 2.0816681711721685e-16, 2.9935541601133764e-08, 0.13142937998323845], res_norm=1.314e-01
2026-01-13 17:39:58,401 - INFO - integration_test - Dyn residual k=1: pred=[13.453830956959033, 4.352655513463246, 0.04182400113177476, 3.0, 14.579077288113856], ws=[13.425941967072738, 4.855318714891294, 0.04182400113177476, 3.0, 14.390367931171589], res=[0.027888989886294624, -0.5026632014280485, 0.0, 0.0, 0.1887093569422671], res_norm=5.376e-01
2026-01-13 17:39:58,401 - INFO - integration_test - Dyn residual k=2: pred=[13.725679618258225, 4.8678622575251795, 0.04182400113177476, 3.0, 14.69036793117159], ws=[13.508237827312469, 4.495642187827607, 0.04182400113177476, 3.0, 14.463696890151637], res=[0.217441790945756, 0.3722200696975726, 0.0, 0.0, 0.22667104101995328], res_norm=4.870e-01
2026-01-13 17:39:58,416 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:58,488 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:58,504 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:58,516 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:58,531 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:58,543 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:58,558 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:58,570 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:58,585 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:58,597 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:58,612 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:58,624 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:58,639 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:58,651 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:58,666 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:58,678 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:58,693 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:58,704 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:58,719 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:58,730 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:58,743 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:58,754 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:58,893 - INFO - integration_test - Step 50: MPC solve successful
2026-01-13 17:39:58,964 - INFO - integration_test - Step 50: Computed 6 numeric contouring constraints for visualization (s=14.060)
2026-01-13 17:39:58,965 - DEBUG - integration_test - Step 50: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:39:58,965 - INFO - integration_test - === Applying control at step 50 ===
2026-01-13 17:39:58,965 - INFO - integration_test -   Control dict from planner: {'a': -2.0000000197958183, 'w': 0.8000000099993976}
2026-01-13 17:39:58,965 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:39:58,965 - INFO - integration_test -   Planner output success: True
2026-01-13 17:39:58,966 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:39:58,966 - INFO - integration_test - Step 50 completed in 0.702s
2026-01-13 17:39:58,987 - INFO - integration_test - Step 51 (contouring until path end)
2026-01-13 17:39:58,987 - DEBUG - integration_test - Syncing planner state at step 51: vehicle_state=[13.14331923  4.35113175  0.121824    2.80000003 14.34000162]
2026-01-13 17:39:58,988 - DEBUG - integration_test - Step 51: Using propagated spline 14.3400 (close to path, dist=0.271m, drift=0.407m)
2026-01-13 17:39:58,988 - DEBUG - integration_test -   Set spline state to 14.3400
2026-01-13 17:39:58,989 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:59,056 - DEBUG - integration_test - Step 51: Checking path alignment: vehicle=(13.143, 4.351), path_start=(0.000, 0.000), dist=13.845m
2026-01-13 17:39:59,056 - WARNING - integration_test - Step 51: Vehicle is far from path start (dist=13.845m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:39:59,056 - INFO - integration_test - === Calling planner.solve_mpc() at step 51 ===
2026-01-13 17:39:59,111 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:39:59,121 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:39:59,121 - INFO - integration_test - Warmstart k=0: x0=13.143319230207375 , y0=4.351131747912335 , psi0=0.12182400213171472 , v0=2.8000000279559596 , spline0=14.289496566889035 , a0=0.0 , w0=0.0
2026-01-13 17:39:59,121 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:39:59,122 - INFO - integration_test - Dyn residual k=0: pred=[13.421244049137252, 4.385158158071632, 0.12182400213171472, 2.8000000279559596, 14.569496569684631], ws=[13.421244049137252, 4.385158158071632, 0.12182400213171451, 2.8000000279559596, 14.694857999940098], res=[0.0, 0.0, 2.0816681711721685e-16, 0.0, -0.12536143025546664], res_norm=1.254e-01
2026-01-13 17:39:59,123 - INFO - integration_test - Dyn residual k=1: pred=[13.69916886806713, 4.419184568230928, 0.12182400213171451, 2.8000000279559596, 14.974858002735694], ws=[13.608064987159123, 4.50453822993657, 0.12182400213171451, 2.8000000279559596, 14.758745957317299], res=[0.09110388090800647, -0.08535366170564274, 0.0, 0.0, 0.21611204541839513], res_norm=2.496e-01
2026-01-13 17:39:59,124 - INFO - integration_test - Dyn residual k=2: pred=[13.885989806089, 4.538564640095866, 0.12182400213171451, 2.8000000279559596, 15.038745960112895], ws=[13.543614667086363, 4.456620072164917, 0.12182400213171451, 2.8000000279559596, 14.765757890010635], res=[0.3423751390026375, 0.0819445679309494, 0.0, 0.0, 0.2729880701022598], res_norm=4.455e-01
2026-01-13 17:39:59,138 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:59,208 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:59,224 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:59,236 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:59,252 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:59,263 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:59,278 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:59,290 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:59,305 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:59,317 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:59,332 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:59,344 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:59,359 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:59,371 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:59,386 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:59,398 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:59,413 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:59,424 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:39:59,440 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:59,450 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:39:59,463 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:39:59,474 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:00,018 - WARNING - integration_test - Step 51: MPC solve failed
2026-01-13 17:40:00,018 - WARNING - integration_test -   Consecutive MPC failures: 1/5
2026-01-13 17:40:00,103 - INFO - integration_test - Step 51: Computed 6 numeric contouring constraints for visualization (s=14.340)
2026-01-13 17:40:00,104 - DEBUG - integration_test - Step 51: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:00,104 - INFO - integration_test - === Applying control at step 51 ===
2026-01-13 17:40:00,104 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 17:40:00,104 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:00,104 - INFO - integration_test -   Planner output success: False
2026-01-13 17:40:00,104 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 17:40:00,105 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:00,105 - INFO - integration_test - Step 51 completed in 1.118s
2026-01-13 17:40:00,123 - INFO - integration_test - Step 52 (contouring until path end)
2026-01-13 17:40:00,124 - DEBUG - integration_test - Syncing planner state at step 52: vehicle_state=[13.42124405  4.38515816  0.121824    2.80000003 14.62000162]
2026-01-13 17:40:00,125 - DEBUG - integration_test - Step 52: Using propagated spline 14.6200 (close to path, dist=0.222m, drift=0.081m)
2026-01-13 17:40:00,125 - DEBUG - integration_test -   Set spline state to 14.6200
2026-01-13 17:40:00,126 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:00,195 - DEBUG - integration_test - Step 52: Checking path alignment: vehicle=(13.421, 4.385), path_start=(0.000, 0.000), dist=14.119m
2026-01-13 17:40:00,196 - WARNING - integration_test - Step 52: Vehicle is far from path start (dist=14.119m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:00,196 - INFO - integration_test - === Calling planner.solve_mpc() at step 52 ===
2026-01-13 17:40:00,251 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:00,261 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:00,261 - INFO - integration_test - Warmstart k=0: x0=13.421244049137252 , y0=4.385158158071632 , psi0=0.12182400213171472 , v0=2.8000000279559596 , spline0=14.670506670694731 , a0=0.0 , w0=0.0
2026-01-13 17:40:00,261 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:00,262 - INFO - integration_test - Dyn residual k=0: pred=[13.69916886806713, 4.4191845682309285, 0.12182400213171472, 2.8000000279559596, 14.950506673490327], ws=[13.760453015108292, 4.907422376764223, 0.12182400213171451, 2.8000000279559596, 14.820933314107743], res=[-0.06128414704116203, -0.48823780853329435, 2.0816681711721685e-16, 0.0, 0.12957335938258474], res_norm=5.088e-01
2026-01-13 17:40:00,263 - INFO - integration_test - Dyn residual k=1: pred=[14.038377834038169, 4.941448786923519, 0.12182400213171451, 2.8000000279559596, 15.100933316903339], ws=[13.914682479590256, 4.804839962202863, 0.12182400213171451, 2.8000000279559596, 14.912327888087447], res=[0.12369535444791246, 0.13660882472065605, 0.0, 0.0, 0.18860542881589204], res_norm=2.637e-01
2026-01-13 17:40:00,264 - INFO - integration_test - Dyn residual k=2: pred=[14.192607298520134, 4.838866372362158, 0.12182400213171451, 2.8000000279559596, 15.192327890883043], ws=[14.12663128003619, 4.694795253675324, 0.12182400213171451, 2.8000000279559596, 15.064371271563914], res=[0.06597601848394419, 0.14407111868683398, 0.0, 0.0, 0.1279566193191286], res_norm=2.037e-01
2026-01-13 17:40:00,278 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:00,352 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:00,367 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:00,379 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:00,394 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:00,406 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:00,421 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:00,432 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:00,447 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:00,459 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:00,474 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:00,486 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:00,500 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:00,512 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:00,528 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:00,539 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:00,555 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:00,567 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:00,582 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:00,592 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:00,605 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:00,615 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:00,749 - INFO - integration_test - Step 52: MPC solve successful
2026-01-13 17:40:00,822 - INFO - integration_test - Step 52: Computed 6 numeric contouring constraints for visualization (s=14.620)
2026-01-13 17:40:00,822 - DEBUG - integration_test - Step 52: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:00,822 - INFO - integration_test - === Applying control at step 52 ===
2026-01-13 17:40:00,822 - INFO - integration_test -   Control dict from planner: {'a': 1.9999999991497108, 'w': -0.7999998485327514}
2026-01-13 17:40:00,823 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:00,823 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:00,824 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:00,825 - INFO - integration_test - Step 52 completed in 0.700s
2026-01-13 17:40:00,846 - INFO - integration_test - Step 53 (contouring until path end)
2026-01-13 17:40:00,848 - DEBUG - integration_test - Syncing planner state at step 53: vehicle_state=[13.71020762  4.40872148  0.04182402  3.00000003 14.92000162]
2026-01-13 17:40:00,848 - DEBUG - integration_test - Step 53: Using propagated spline 14.9200 (close to path, dist=0.117m, drift=0.381m)
2026-01-13 17:40:00,848 - DEBUG - integration_test -   Set spline state to 14.9200
2026-01-13 17:40:00,849 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:00,917 - DEBUG - integration_test - Step 53: Checking path alignment: vehicle=(13.710, 4.409), path_start=(0.000, 0.000), dist=14.402m
2026-01-13 17:40:00,917 - WARNING - integration_test - Step 53: Vehicle is far from path start (dist=14.402m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:00,917 - INFO - integration_test - === Calling planner.solve_mpc() at step 53 ===
2026-01-13 17:40:00,969 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:00,979 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:00,979 - INFO - integration_test - Warmstart k=0: x0=13.71020762449227 , y0=4.4087214801436785 , psi0=0.04182401727843958 , v0=3.0000000278709305 , spline0=14.869496572471723 , a0=0.0 , w0=0.0
2026-01-13 17:40:00,979 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:00,981 - INFO - integration_test - Dyn residual k=0: pred=[14.009945278259876, 4.4212650277338605, 0.04182401727843958, 3.0000000278709305, 15.169496575258815], ws=[13.584769196797726, 4.872713286251779, 0.04182401727843965, 3.0, 14.497973156513666], res=[0.42517608146214947, -0.45144825851791825, -6.938893903907228e-17, 2.7870930452422726e-08, 0.6715234187451493], res_norm=9.141e-01
2026-01-13 17:40:00,981 - INFO - integration_test - Dyn residual k=1: pred=[13.884506847780676, 4.885256833725427, 0.04182401727843965, 3.0, 14.797973156513667], ws=[14.040574004662428, 4.6782228041249745, 0.04182401727843965, 3.0, 15.001244041401149], res=[-0.1560671568817522, 0.20703402960045292, 0.0, 0.0, -0.20327088488748224], res_norm=3.295e-01
2026-01-13 17:40:00,982 - INFO - integration_test - Dyn residual k=2: pred=[14.340311655645378, 4.690766351598623, 0.04182401727843965, 3.0, 15.30124404140115], ws=[14.609420577441119, 4.446352122564624, 0.04182401727843965, 3.0, 15.553433474691449], res=[-0.2691089217957412, 0.2444142290339988, 0.0, 0.0, -0.2521894332902992], res_norm=4.424e-01
2026-01-13 17:40:00,996 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:01,070 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:01,086 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:01,098 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:01,113 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:01,124 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:01,139 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:01,151 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:01,166 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:01,178 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:01,193 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:01,205 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:01,221 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:01,233 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:01,248 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:01,260 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:01,276 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:01,288 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:01,303 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:01,314 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:01,327 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:01,337 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:01,483 - INFO - integration_test - Step 53: MPC solve successful
2026-01-13 17:40:01,556 - INFO - integration_test - Step 53: Computed 6 numeric contouring constraints for visualization (s=14.920)
2026-01-13 17:40:01,556 - DEBUG - integration_test - Step 53: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:01,556 - INFO - integration_test - === Applying control at step 53 ===
2026-01-13 17:40:01,556 - INFO - integration_test -   Control dict from planner: {'a': -4.644860477681882e-07, 'w': -0.7999924813344353}
2026-01-13 17:40:01,556 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:01,556 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:01,557 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:01,558 - INFO - integration_test - Step 53 completed in 0.710s
2026-01-13 17:40:01,574 - INFO - integration_test - Step 54 (contouring until path end)
2026-01-13 17:40:01,576 - DEBUG - integration_test - Syncing planner state at step 54: vehicle_state=[14.01012714  4.40926865 -0.03817523  2.99999998 15.22000162]
2026-01-13 17:40:01,576 - DEBUG - integration_test - Step 54: Using propagated spline 15.2200 (close to path, dist=0.196m, drift=0.075m)
2026-01-13 17:40:01,576 - DEBUG - integration_test -   Set spline state to 15.2200
2026-01-13 17:40:01,579 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:01,647 - DEBUG - integration_test - Step 54: Checking path alignment: vehicle=(14.010, 4.409), path_start=(0.000, 0.000), dist=14.688m
2026-01-13 17:40:01,647 - WARNING - integration_test - Step 54: Vehicle is far from path start (dist=14.688m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:01,647 - INFO - integration_test - === Calling planner.solve_mpc() at step 54 ===
2026-01-13 17:40:01,703 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:01,713 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:01,713 - INFO - integration_test - Warmstart k=0: x0=14.01012713799784 , y0=4.409268651906208 , psi0=-0.03817523085500395 , v0=2.9999999814223255 , spline0=15.270506671624057 , a0=0.0 , w0=0.0
2026-01-13 17:40:01,713 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:01,714 - INFO - integration_test - Dyn residual k=0: pred=[14.30990856045081, 4.397818864248215, -0.03817523085500395, 2.9999999814223255, 15.570506669766289], ws=[14.30990856045081, 4.397818864248215, -0.03817523085500385, 2.9999999814223255, 15.454629885770029], res=[0.0, 0.0, -9.71445146547012e-17, 0.0, 0.11587678399626], res_norm=1.159e-01
2026-01-13 17:40:01,715 - INFO - integration_test - Dyn residual k=1: pred=[14.60968998290378, 4.386369076590222, -0.03817523085500385, 2.9999999814223255, 15.754629883912262], ws=[14.267149633192782, 4.538473478290882, -0.03817523085500385, 2.9999999814223255, 15.381593703740062], res=[0.34254034971099756, -0.15210440170065986, 0.0, 0.0, 0.37303618017219975], res_norm=5.288e-01
2026-01-13 17:40:01,716 - INFO - integration_test - Dyn residual k=2: pred=[14.566931055645751, 4.527023690632889, -0.03817523085500385, 2.9999999814223255, 15.681593701882296], ws=[14.937192543104006, 5.235628704519197, -0.03817523085500385, 2.9999999814223255, 15.97994899466051], res=[-0.3702614874582544, -0.7086050138863076, 0.0, 0.0, -0.29835529277821493], res_norm=8.534e-01
2026-01-13 17:40:01,731 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:01,802 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:01,817 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:01,829 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:01,844 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:01,856 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:01,871 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:01,883 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:01,899 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:01,910 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:01,926 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:01,938 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:01,953 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:01,965 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:01,979 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:01,991 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:02,006 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:02,018 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:02,033 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:02,044 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:02,058 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:02,068 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:02,192 - INFO - integration_test - Step 54: MPC solve successful
2026-01-13 17:40:02,266 - INFO - integration_test - Step 54: Computed 6 numeric contouring constraints for visualization (s=15.220)
2026-01-13 17:40:02,266 - DEBUG - integration_test - Step 54: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:02,266 - INFO - integration_test - === Applying control at step 54 ===
2026-01-13 17:40:02,267 - INFO - integration_test -   Control dict from planner: {'a': 3.8345603237414396e-07, 'w': -0.7999906063848262}
2026-01-13 17:40:02,267 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:02,267 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:02,268 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:02,268 - INFO - integration_test - Step 54 completed in 0.693s
2026-01-13 17:40:02,286 - INFO - integration_test - Step 55 (contouring until path end)
2026-01-13 17:40:02,287 - DEBUG - integration_test - Syncing planner state at step 55: vehicle_state=[14.30913117  4.38584635 -0.11817429  3.00000002 15.52000162]
2026-01-13 17:40:02,288 - DEBUG - integration_test - Step 55: Using propagated spline 15.5200 (close to path, dist=0.152m, drift=0.231m)
2026-01-13 17:40:02,288 - DEBUG - integration_test -   Set spline state to 15.5200
2026-01-13 17:40:02,289 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:02,358 - DEBUG - integration_test - Step 55: Checking path alignment: vehicle=(14.309, 4.386), path_start=(0.000, 0.000), dist=14.966m
2026-01-13 17:40:02,359 - WARNING - integration_test - Step 55: Vehicle is far from path start (dist=14.966m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:02,359 - INFO - integration_test - === Calling planner.solve_mpc() at step 55 ===
2026-01-13 17:40:02,415 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:02,428 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:02,428 - INFO - integration_test - Warmstart k=0: x0=14.169018580698788 , y0=4.552319629694645 , psi0=-0.11817429149348657 , v0=3.0000000197679286 , spline0=15.065456168550345 , a0=0.0 , w0=0.0
2026-01-13 17:40:02,428 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:02,429 - INFO - integration_test - Dyn residual k=0: pred=[14.466926244874038, 4.516949800578266, -0.11817429149348657, 3.0000000197679286, 15.365456170527137], ws=[14.643560036223613, 4.709105961501868, -0.11817429149348646, 3.0, 15.814779027458828], res=[-0.17663379134957502, -0.19215616092360222, -1.1102230246251565e-16, 1.9767928627345555e-08, -0.4493228569316905], res_norm=5.196e-01
2026-01-13 17:40:02,430 - INFO - integration_test - Dyn residual k=1: pred=[14.941467698435858, 4.673736132618553, -0.11817429149348646, 3.0, 16.114779027458827], ws=[14.19161019288815, 4.596844725426786, -0.11817429149348646, 3.0, 15.318440390998507], res=[0.7498575055477072, 0.07689140719176724, 0.0, 0.0, 0.7963386364603195], res_norm=1.097e+00
2026-01-13 17:40:02,431 - INFO - integration_test - Dyn residual k=2: pred=[14.489517855100395, 4.561474896543471, -0.11817429149348646, 3.0, 15.618440390998508], ws=[15.278515553408337, 4.899584069359099, -0.11817429149348646, 3.0, 16.185304003421926], res=[-0.7889976983079414, -0.3381091728156278, 0.0, 0.0, -0.5668636124234183], res_norm=1.029e+00
2026-01-13 17:40:02,446 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:02,518 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:02,533 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:02,545 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:02,561 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:02,573 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:02,588 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:02,608 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:02,624 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:02,636 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:02,650 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:02,662 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:02,676 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:02,688 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:02,703 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:02,715 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:02,730 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:02,742 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:02,757 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:02,768 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:02,781 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:02,791 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:03,357 - WARNING - integration_test - Step 55: MPC solve failed
2026-01-13 17:40:03,357 - WARNING - integration_test -   Consecutive MPC failures: 1/5
2026-01-13 17:40:03,445 - INFO - integration_test - Step 55: Computed 6 numeric contouring constraints for visualization (s=15.520)
2026-01-13 17:40:03,446 - DEBUG - integration_test - Step 55: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:03,446 - INFO - integration_test - === Applying control at step 55 ===
2026-01-13 17:40:03,446 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 17:40:03,446 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:03,446 - INFO - integration_test -   Planner output success: False
2026-01-13 17:40:03,446 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 17:40:03,447 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:03,447 - INFO - integration_test - Step 55 completed in 1.160s
2026-01-13 17:40:03,461 - INFO - integration_test - Step 56 (contouring until path end)
2026-01-13 17:40:03,464 - DEBUG - integration_test - Syncing planner state at step 56: vehicle_state=[14.60703883  4.35047652 -0.11817429  3.00000002 15.82000163]
2026-01-13 17:40:03,465 - DEBUG - integration_test - Step 56: Using propagated spline 15.8200 (close to path, dist=0.148m, drift=0.069m)
2026-01-13 17:40:03,465 - DEBUG - integration_test -   Set spline state to 15.8200
2026-01-13 17:40:03,466 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:03,539 - DEBUG - integration_test - Step 56: Checking path alignment: vehicle=(14.607, 4.350), path_start=(0.000, 0.000), dist=15.241m
2026-01-13 17:40:03,539 - WARNING - integration_test - Step 56: Vehicle is far from path start (dist=15.241m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:03,539 - INFO - integration_test - === Calling planner.solve_mpc() at step 56 ===
2026-01-13 17:40:03,599 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:03,611 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:03,611 - INFO - integration_test - Warmstart k=0: x0=14.6070388318247 , y0=4.350476521187189 , psi0=-0.11817429149348657 , v0=3.0000000197679286 , spline0=15.56747637254734 , a0=0.0 , w0=0.0
2026-01-13 17:40:03,611 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:03,613 - INFO - integration_test - Dyn residual k=0: pred=[14.904946495999951, 4.3151066920708105, -0.11817429149348657, 3.0000000197679286, 15.867476374524133], ws=[15.010917192609753, 4.6363313373611135, -0.11817429149348646, 3.0, 16.265782655302203], res=[-0.10597069660980196, -0.3212246452903029, -1.1102230246251565e-16, 1.9767928627345555e-08, -0.39830628077807084], res_norm=5.226e-01
2026-01-13 17:40:03,614 - INFO - integration_test - Dyn residual k=1: pred=[15.308824854821998, 4.600961508477798, -0.11817429149348646, 3.0, 16.565782655302204], ws=[15.582780000143178, 4.374673633092913, -0.11817429149348646, 3.0, 16.607323324032276], res=[-0.2739551453211799, 0.2262878753848856, 0.0, 0.0, -0.04154066873007167], res_norm=3.577e-01
2026-01-13 17:40:03,615 - INFO - integration_test - Dyn residual k=2: pred=[15.880687662355422, 4.339303804209598, -0.11817429149348646, 3.0, 16.907323324032276], ws=[16.26865906583442, 4.296677640138345, -0.11817429149348646, 3.0, 17.520880963973806], res=[-0.38797140347899806, 0.04262616407125286, 0.0, 0.0, -0.6135576399415292], res_norm=7.272e-01
2026-01-13 17:40:03,631 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:03,713 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:03,731 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:03,743 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:03,760 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:03,773 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:03,789 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:03,802 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:03,818 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:03,831 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:03,847 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:03,860 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:03,877 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:03,891 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:03,908 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:03,921 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:03,938 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:03,950 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:03,967 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:03,978 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:03,992 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:04,003 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:04,562 - WARNING - integration_test - Step 56: MPC solve failed
2026-01-13 17:40:04,562 - WARNING - integration_test -   Consecutive MPC failures: 2/5
2026-01-13 17:40:04,647 - INFO - integration_test - Step 56: Computed 6 numeric contouring constraints for visualization (s=15.820)
2026-01-13 17:40:04,647 - DEBUG - integration_test - Step 56: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:04,647 - INFO - integration_test - === Applying control at step 56 ===
2026-01-13 17:40:04,647 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 17:40:04,648 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:04,648 - INFO - integration_test -   Planner output success: False
2026-01-13 17:40:04,648 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 17:40:04,649 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:04,650 - INFO - integration_test - Step 56 completed in 1.186s
2026-01-13 17:40:04,667 - INFO - integration_test - Step 57 (contouring until path end)
2026-01-13 17:40:04,669 - DEBUG - integration_test - Syncing planner state at step 57: vehicle_state=[14.9049465   4.31510669 -0.11817429  3.00000002 16.12000163]
2026-01-13 17:40:04,669 - DEBUG - integration_test - Step 57: Using propagated spline 16.1200 (close to path, dist=0.200m, drift=0.236m)
2026-01-13 17:40:04,669 - DEBUG - integration_test -   Set spline state to 16.1200
2026-01-13 17:40:04,670 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:04,737 - DEBUG - integration_test - Step 57: Checking path alignment: vehicle=(14.905, 4.315), path_start=(0.000, 0.000), dist=15.517m
2026-01-13 17:40:04,737 - WARNING - integration_test - Step 57: Vehicle is far from path start (dist=15.517m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:04,737 - INFO - integration_test - === Calling planner.solve_mpc() at step 57 ===
2026-01-13 17:40:04,791 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:04,802 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:04,802 - INFO - integration_test - Warmstart k=0: x0=14.58954536049461 , y0=4.399708548803225 , psi0=-0.11817429149348657 , v0=3.0000000197679286 , spline0=15.564446071493832 , a0=0.0 , w0=0.0
2026-01-13 17:40:04,802 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:04,803 - INFO - integration_test - Dyn residual k=0: pred=[14.88745302466986, 4.364338719686846, -0.11817429149348657, 3.0000000197679286, 15.864446073470624], ws=[15.878163528741954, 4.8089538332825335, -0.11817429149348646, 3.0, 17.03006828601866], res=[-0.9907105040720943, -0.4446151135956873, -1.1102230246251565e-16, 1.9767928627345555e-08, -1.1656222125480369], res_norm=1.593e+00
2026-01-13 17:40:04,804 - INFO - integration_test - Dyn residual k=1: pred=[16.1760711909542, 4.773584004399218, -0.11817429149348646, 3.0, 17.330068286018662], ws=[15.184891480726302, 4.388789109338357, -0.11817429149348646, 3.0, 16.140527393530615], res=[0.9911797102278985, 0.3847948950608613, 0.0, 0.0, 1.189540892488047], res_norm=1.595e+00
2026-01-13 17:40:04,805 - INFO - integration_test - Dyn residual k=2: pred=[15.482799142938546, 4.353419280455042, -0.11817429149348646, 3.0, 16.440527393530616], ws=[16.144359091334206, 4.471906366002628, -0.11817429149348646, 3.0, 17.43598908396252], res=[-0.6615599483956593, -0.11848708554758591, 0.0, 0.0, -0.995461690431906], res_norm=1.201e+00
2026-01-13 17:40:04,819 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:04,889 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:04,904 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:04,916 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:04,932 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:04,943 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:04,959 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:04,971 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:04,986 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:04,997 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:05,012 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:05,023 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:05,038 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:05,050 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:05,065 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:05,077 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:05,093 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:05,105 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:05,120 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:05,131 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:05,144 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:05,154 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:05,739 - WARNING - integration_test - Step 57: MPC solve failed
2026-01-13 17:40:05,739 - WARNING - integration_test -   Consecutive MPC failures: 3/5
2026-01-13 17:40:05,821 - INFO - integration_test - Step 57: Computed 6 numeric contouring constraints for visualization (s=16.120)
2026-01-13 17:40:05,822 - DEBUG - integration_test - Step 57: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:05,822 - INFO - integration_test - === Applying control at step 57 ===
2026-01-13 17:40:05,822 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 17:40:05,822 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:05,822 - INFO - integration_test -   Planner output success: False
2026-01-13 17:40:05,822 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 17:40:05,823 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:05,823 - INFO - integration_test - Step 57 completed in 1.155s
2026-01-13 17:40:05,838 - INFO - integration_test - Step 58 (contouring until path end)
2026-01-13 17:40:05,839 - DEBUG - integration_test - Syncing planner state at step 58: vehicle_state=[15.20285416  4.27973686 -0.11817429  3.00000002 16.42000163]
2026-01-13 17:40:05,840 - DEBUG - integration_test - Step 58: Using propagated spline 16.4200 (close to path, dist=0.102m, drift=0.064m)
2026-01-13 17:40:05,840 - DEBUG - integration_test -   Set spline state to 16.4200
2026-01-13 17:40:05,841 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:05,908 - DEBUG - integration_test - Step 58: Checking path alignment: vehicle=(15.203, 4.280), path_start=(0.000, 0.000), dist=15.794m
2026-01-13 17:40:05,908 - WARNING - integration_test - Step 58: Vehicle is far from path start (dist=15.794m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:05,908 - INFO - integration_test - === Calling planner.solve_mpc() at step 58 ===
2026-01-13 17:40:05,964 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:05,974 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:05,974 - INFO - integration_test - Warmstart k=0: x0=14.829692190362497 , y0=4.949193476996156 , psi0=-0.11817429149348657 , v0=3.0000000197679286 , spline0=15.662425871450424 , a0=0.0 , w0=0.0
2026-01-13 17:40:05,974 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:05,975 - INFO - integration_test - Dyn residual k=0: pred=[15.127599854537747, 4.913823647879777, -0.11817429149348657, 3.0000000197679286, 15.962425873427216], ws=[15.494657822590442, 4.918626074456422, -0.11817429149348646, 3.0, 16.572080326145294], res=[-0.36705796805269486, -0.004802426576644869, -1.1102230246251565e-16, 1.9767928627345555e-08, -0.6096544527180772], res_norm=7.116e-01
2026-01-13 17:40:05,976 - INFO - integration_test - Dyn residual k=1: pred=[15.792565484802687, 4.883256245573107, -0.11817429149348646, 3.0, 16.872080326145294], ws=[16.43363534437502, 4.61264940053011, -0.11817429149348646, 3.0, 17.328813814340563], res=[-0.6410698595723332, 0.27060684504299726, 0.0, 0.0, -0.45673348819526893], res_norm=8.323e-01
2026-01-13 17:40:05,977 - INFO - integration_test - Dyn residual k=2: pred=[16.731543006587266, 4.577279571646795, -0.11817429149348646, 3.0, 17.628813814340564], ws=[15.825262495338073, 3.6297509425344687, -0.11817429149348646, 3.0, 17.04337089603699], res=[0.906280511249193, 0.9475286291123259, 0.0, 0.0, 0.5854429183035741], res_norm=1.436e+00
2026-01-13 17:40:05,991 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:06,066 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:06,081 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:06,092 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:06,107 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:06,119 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:06,134 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:06,145 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:06,160 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:06,173 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:06,187 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:06,199 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:06,214 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:06,225 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:06,241 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:06,253 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:06,267 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:06,279 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:06,295 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:06,305 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:06,318 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:06,328 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:06,466 - INFO - integration_test - Step 58: MPC solve successful
2026-01-13 17:40:06,543 - INFO - integration_test - Step 58: Computed 6 numeric contouring constraints for visualization (s=16.420)
2026-01-13 17:40:06,544 - DEBUG - integration_test - Step 58: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:06,544 - INFO - integration_test - === Applying control at step 58 ===
2026-01-13 17:40:06,544 - INFO - integration_test -   Control dict from planner: {'a': 6.366421264841019e-08, 'w': -0.7999997783410707}
2026-01-13 17:40:06,544 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:06,544 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:06,545 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:06,546 - INFO - integration_test - Step 58 completed in 0.707s
2026-01-13 17:40:06,564 - INFO - integration_test - Step 59 (contouring until path end)
2026-01-13 17:40:06,566 - DEBUG - integration_test - Syncing planner state at step 59: vehicle_state=[15.49903012  4.2324948  -0.19817427  3.00000003 16.72000163]
2026-01-13 17:40:06,567 - DEBUG - integration_test - Step 59: Using propagated spline 16.7200 (close to path, dist=0.252m, drift=0.242m)
2026-01-13 17:40:06,567 - DEBUG - integration_test -   Set spline state to 16.7200
2026-01-13 17:40:06,568 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:06,635 - DEBUG - integration_test - Step 59: Checking path alignment: vehicle=(15.499, 4.232), path_start=(0.000, 0.000), dist=16.067m
2026-01-13 17:40:06,635 - WARNING - integration_test - Step 59: Vehicle is far from path start (dist=16.067m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:06,635 - INFO - integration_test - === Calling planner.solve_mpc() at step 59 ===
2026-01-13 17:40:06,691 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:06,701 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:06,701 - INFO - integration_test - Warmstart k=0: x0=15.810170820973218 , y0=4.754149489805599 , psi0=-0.19817426932759363 , v0=3.00000002613435 , spline0=16.972526884164868 , a0=0.0 , w0=0.0
2026-01-13 17:40:06,701 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:06,702 - INFO - integration_test - Dyn residual k=0: pred=[16.104299121807543, 4.695085590371399, -0.19817426932759363, 3.00000002613435, 17.2725268867783], ws=[15.180362855879144, 3.522403862462258, -0.19817426932759385, 3.0, 16.42790427534667], res=[0.9239362659283987, 1.1726817279091408, 2.220446049250313e-16, 2.6134349795370326e-08, 0.8446226114316318], res_norm=1.715e+00
2026-01-13 17:40:06,703 - INFO - integration_test - Dyn residual k=1: pred=[15.474491154151186, 3.46333996354259, -0.19817426932759385, 3.0, 16.72790427534667], ws=[15.609630419353108, 4.830402767603165, -0.19817426932759385, 3.0, 16.863789486451964], res=[-0.13513926520192143, -1.3670628040605752, 0.0, 0.0, -0.13588521110529328], res_norm=1.380e+00
2026-01-13 17:40:06,703 - INFO - integration_test - Dyn residual k=2: pred=[15.90375871762515, 4.771338868683498, -0.19817426932759385, 3.0, 17.163789486451964], ws=[15.98636617322742, 4.688364485656186, -0.19817426932759385, 3.0, 17.063021721241306], res=[-0.08260745560227001, 0.0829743830273113, 0.0, 0.0, 0.10076776521065867], res_norm=1.545e-01
2026-01-13 17:40:06,718 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:06,789 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:06,805 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:06,817 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:06,833 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:06,847 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:06,863 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:06,875 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:06,890 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:06,903 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:06,919 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:06,931 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:06,946 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:06,957 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:06,974 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:06,986 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:07,002 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:07,014 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:07,030 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:07,040 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:07,054 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:07,064 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:07,221 - INFO - integration_test - Step 59: MPC solve successful
2026-01-13 17:40:07,305 - INFO - integration_test - Step 59: Computed 6 numeric contouring constraints for visualization (s=16.720)
2026-01-13 17:40:07,305 - DEBUG - integration_test - Step 59: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:07,305 - INFO - integration_test - === Applying control at step 59 ===
2026-01-13 17:40:07,305 - INFO - integration_test -   Control dict from planner: {'a': 2.198303075257042e-08, 'w': 0.07816766096866931}
2026-01-13 17:40:07,305 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:07,305 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:07,306 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:07,307 - INFO - integration_test - Step 59 completed in 0.741s
2026-01-13 17:40:07,324 - INFO - integration_test - Step 60 (contouring until path end)
2026-01-13 17:40:07,326 - DEBUG - integration_test - Syncing planner state at step 60: vehicle_state=[15.79338627  4.17458106 -0.1903575   3.00000003 17.02000163]
2026-01-13 17:40:07,327 - DEBUG - integration_test - Step 60: Using propagated spline 17.0200 (close to path, dist=0.087m, drift=0.058m)
2026-01-13 17:40:07,327 - DEBUG - integration_test -   Set spline state to 17.0200
2026-01-13 17:40:07,329 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:07,398 - DEBUG - integration_test - Step 60: Checking path alignment: vehicle=(15.793, 4.175), path_start=(0.000, 0.000), dist=16.336m
2026-01-13 17:40:07,398 - WARNING - integration_test - Step 60: Vehicle is far from path start (dist=16.336m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:07,398 - INFO - integration_test - === Calling planner.solve_mpc() at step 60 ===
2026-01-13 17:40:07,451 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:07,462 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:07,462 - INFO - integration_test - Warmstart k=0: x0=15.890572735094253 , y0=4.553098371198991 , psi0=-0.1903575032307267 , v0=3.0000000283326527 , spline0=16.767476381947628 , a0=0.0 , w0=0.0
2026-01-13 17:40:07,462 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:07,463 - INFO - integration_test - Dyn residual k=0: pred=[16.18515373428614, 4.496335384886877, -0.1903575032307267, 3.0000000283326527, 17.067476384780893], ws=[16.483432296717684, 4.132848512314005, -0.19035750323072653, 3.0, 17.88981502349388], res=[-0.2982785624315447, 0.3634868725728726, -1.6653345369377348e-16, 2.8332652668439096e-08, -0.8223386387129885], res_norm=9.473e-01
2026-01-13 17:40:07,464 - INFO - integration_test - Dyn residual k=1: pred=[16.778013293127483, 4.076085526537973, -0.19035750323072653, 3.0, 18.189815023493882], ws=[16.850536577588183, 4.562258386012507, -0.19035750323072653, 3.0, 18.05424948610021], res=[-0.07252328446070067, -0.48617285947453404, 0.0, 0.0, 0.1355655373936706], res_norm=5.099e-01
2026-01-13 17:40:07,465 - INFO - integration_test - Dyn residual k=2: pred=[17.145117573997982, 4.505495400236476, -0.19035750323072653, 3.0, 18.354249486100212], ws=[16.32754364921383, 4.190206732282062, -0.19035750323072653, 3.0, 17.280597340047272], res=[0.8175739247841527, 0.31528866795441335, 0.0, 0.0, 1.0736521460529396], res_norm=1.386e+00
2026-01-13 17:40:07,479 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:07,553 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:07,569 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:07,581 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:07,596 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:07,608 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:07,623 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:07,635 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:07,649 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:07,661 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:07,676 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:07,688 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:07,702 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:07,714 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:07,729 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:07,740 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:07,755 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:07,767 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:07,782 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:07,792 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:07,806 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:07,816 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:08,383 - WARNING - integration_test - Step 60: MPC solve failed
2026-01-13 17:40:08,384 - WARNING - integration_test -   Consecutive MPC failures: 1/5
2026-01-13 17:40:08,468 - INFO - integration_test - Step 60: Computed 6 numeric contouring constraints for visualization (s=17.020)
2026-01-13 17:40:08,469 - DEBUG - integration_test - Step 60: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:08,469 - INFO - integration_test - === Applying control at step 60 ===
2026-01-13 17:40:08,469 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 17:40:08,469 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:08,469 - INFO - integration_test -   Planner output success: False
2026-01-13 17:40:08,469 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 17:40:08,470 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:08,470 - INFO - integration_test - Step 60 completed in 1.144s
2026-01-13 17:40:08,487 - INFO - integration_test - Step 61 (contouring until path end)
2026-01-13 17:40:08,488 - DEBUG - integration_test - Syncing planner state at step 61: vehicle_state=[16.08796727  4.11781808 -0.1903575   3.00000003 17.32000164]
2026-01-13 17:40:08,489 - DEBUG - integration_test - Step 61: Using propagated spline 17.3200 (close to path, dist=0.327m, drift=0.248m)
2026-01-13 17:40:08,489 - DEBUG - integration_test -   Set spline state to 17.3200
2026-01-13 17:40:08,490 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:08,556 - DEBUG - integration_test - Step 61: Checking path alignment: vehicle=(16.088, 4.118), path_start=(0.000, 0.000), dist=16.607m
2026-01-13 17:40:08,556 - WARNING - integration_test - Step 61: Vehicle is far from path start (dist=16.607m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:08,556 - INFO - integration_test - === Calling planner.solve_mpc() at step 61 ===
2026-01-13 17:40:08,612 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:08,622 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:08,622 - INFO - integration_test - Warmstart k=0: x0=16.171356354549843 , y0=4.464404761326895 , psi0=-0.1903575032307267 , v0=3.0000000283326527 , spline0=17.168486485790993 , a0=0.0 , w0=0.0
2026-01-13 17:40:08,622 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:08,623 - INFO - integration_test - Dyn residual k=0: pred=[16.46593735374173, 4.407641775014781, -0.1903575032307267, 3.0000000283326527, 17.468486488624258], ws=[16.280441401798843, 4.590712936544875, -0.19035750323072653, 3.0, 17.242022801976255], res=[0.1854959519428867, -0.18307116153009417, -1.6653345369377348e-16, 2.8332652668439096e-08, 0.2264636866480032], res_norm=3.453e-01
2026-01-13 17:40:08,624 - INFO - integration_test - Dyn residual k=1: pred=[16.57502239820864, 4.533949950768844, -0.19035750323072653, 3.0, 17.542022801976255], ws=[16.207511865847994, 4.374404668174002, -0.19035750323072653, 3.0, 17.187562091883734], res=[0.36751053236064735, 0.15954528259484224, 0.0, 0.0, 0.3544607100925212], res_norm=5.349e-01
2026-01-13 17:40:08,624 - INFO - integration_test - Dyn residual k=2: pred=[16.502092862257793, 4.31764168239797, -0.19035750323072653, 3.0, 17.487562091883735], ws=[17.06357142840302, 4.492792693587429, -0.19035750323072653, 3.0, 18.2124523713989], res=[-0.561478566145226, -0.17515101118945875, 0.0, 0.0, -0.724890279515165], res_norm=9.335e-01
2026-01-13 17:40:08,639 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:08,712 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:08,728 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:08,740 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:08,756 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:08,768 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:08,784 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:08,796 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:08,811 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:08,823 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:08,838 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:08,851 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:08,866 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:08,878 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:08,892 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:08,905 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:08,920 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:08,932 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:08,947 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:08,957 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:08,971 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:08,982 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:09,563 - WARNING - integration_test - Step 61: MPC solve failed
2026-01-13 17:40:09,563 - WARNING - integration_test -   Consecutive MPC failures: 2/5
2026-01-13 17:40:09,906 - INFO - integration_test - Step 61: Computed 6 numeric contouring constraints for visualization (s=17.320)
2026-01-13 17:40:09,907 - DEBUG - integration_test - Step 61: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:09,907 - INFO - integration_test - === Applying control at step 61 ===
2026-01-13 17:40:09,907 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 17:40:09,907 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:09,907 - INFO - integration_test -   Planner output success: False
2026-01-13 17:40:09,907 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 17:40:09,908 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:09,908 - INFO - integration_test - Step 61 completed in 1.420s
2026-01-13 17:40:09,923 - INFO - integration_test - Step 62 (contouring until path end)
2026-01-13 17:40:09,924 - DEBUG - integration_test - Syncing planner state at step 62: vehicle_state=[16.38254827  4.06105509 -0.1903575   3.00000003 17.62000164]
2026-01-13 17:40:09,925 - DEBUG - integration_test - Step 62: Using propagated spline 17.6200 (close to path, dist=0.157m, drift=0.052m)
2026-01-13 17:40:09,925 - DEBUG - integration_test -   Set spline state to 17.6200
2026-01-13 17:40:09,926 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:09,993 - DEBUG - integration_test - Step 62: Checking path alignment: vehicle=(16.383, 4.061), path_start=(0.000, 0.000), dist=16.878m
2026-01-13 17:40:09,993 - WARNING - integration_test - Step 62: Vehicle is far from path start (dist=16.878m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:09,993 - INFO - integration_test - === Calling planner.solve_mpc() at step 62 ===
2026-01-13 17:40:10,047 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:10,056 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:10,056 - INFO - integration_test - Warmstart k=0: x0=16.327147378843996 , y0=4.521722288279361 , psi0=-0.1903575032307267 , v0=3.0000000283326527 , spline0=17.266466286604057 , a0=0.0 , w0=0.0
2026-01-13 17:40:10,056 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:10,057 - INFO - integration_test - Dyn residual k=0: pred=[16.621728378035883, 4.464959301967247, -0.1903575032307267, 3.0000000283326527, 17.566466289437322], ws=[17.424758656901247, 4.156193235183638, -0.19035750323072653, 3.0, 18.60344527839062], res=[-0.8030302788653643, 0.3087660667836092, -1.6653345369377348e-16, 2.8332652668439096e-08, -1.0369789889532974], res_norm=1.347e+00
2026-01-13 17:40:10,058 - INFO - integration_test - Dyn residual k=1: pred=[17.719339653311046, 4.0994302494076065, -0.19035750323072653, 3.0, 18.90344527839062], ws=[17.211896182879645, 4.691958179949916, -0.19035750323072653, 3.0, 18.289002577594573], res=[0.5074434704314008, -0.5925279305423095, 0.0, 0.0, 0.6144427007960473], res_norm=9.930e-01
2026-01-13 17:40:10,059 - INFO - integration_test - Dyn residual k=2: pred=[17.506477179289444, 4.6351951941738845, -0.19035750323072653, 3.0, 18.589002577594574], ws=[18.071507907829282, 3.6531490235743407, -0.19035750323072653, 3.0, 18.933448404012356], res=[-0.5650307285398384, 0.9820461705995438, 0.0, 0.0, -0.34444582641778254], res_norm=1.184e+00
2026-01-13 17:40:10,073 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:10,145 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:10,161 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:10,172 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:10,188 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:10,199 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:10,214 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:10,226 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:10,241 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:10,254 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:10,268 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:10,280 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:10,295 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:10,306 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:10,321 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:10,333 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:10,349 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:10,361 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:10,376 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:10,386 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:10,399 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:10,410 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:10,980 - WARNING - integration_test - Step 62: MPC solve failed
2026-01-13 17:40:10,980 - WARNING - integration_test -   Consecutive MPC failures: 3/5
2026-01-13 17:40:11,063 - INFO - integration_test - Step 62: Computed 6 numeric contouring constraints for visualization (s=17.620)
2026-01-13 17:40:11,063 - DEBUG - integration_test - Step 62: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:11,063 - INFO - integration_test - === Applying control at step 62 ===
2026-01-13 17:40:11,063 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 17:40:11,063 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:11,063 - INFO - integration_test -   Planner output success: False
2026-01-13 17:40:11,064 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 17:40:11,065 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:11,065 - INFO - integration_test - Step 62 completed in 1.141s
2026-01-13 17:40:11,079 - INFO - integration_test - Step 63 (contouring until path end)
2026-01-13 17:40:11,083 - DEBUG - integration_test - Syncing planner state at step 63: vehicle_state=[16.67712927  4.0042921  -0.1903575   3.00000003 17.92000164]
2026-01-13 17:40:11,083 - DEBUG - integration_test - Step 63: Using propagated spline 17.9200 (close to path, dist=0.350m, drift=0.352m)
2026-01-13 17:40:11,083 - DEBUG - integration_test -   Set spline state to 17.9200
2026-01-13 17:40:11,085 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:11,152 - DEBUG - integration_test - Step 63: Checking path alignment: vehicle=(16.677, 4.004), path_start=(0.000, 0.000), dist=17.151m
2026-01-13 17:40:11,152 - WARNING - integration_test - Step 63: Vehicle is far from path start (dist=17.151m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:11,152 - INFO - integration_test - === Calling planner.solve_mpc() at step 63 ===
2026-01-13 17:40:11,205 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:11,215 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:11,215 - INFO - integration_test - Warmstart k=0: x0=16.038250747849567 , y0=4.409519036706841 , psi0=-0.1903575032307267 , v0=3.0000000283326527 , spline0=17.36444608741712 , a0=0.0 , w0=0.0
2026-01-13 17:40:11,215 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:11,216 - INFO - integration_test - Dyn residual k=0: pred=[16.332831747041453, 4.352756050394727, -0.1903575032307267, 3.0000000283326527, 17.664446090250387], ws=[16.468948673508855, 4.3445715916223895, -0.19035750323072653, 3.0, 17.64159179706546], res=[-0.1361169264674018, 0.008184458772337422, -1.6653345369377348e-16, 2.8332652668439096e-08, 0.0228542931849276], res_norm=1.383e-01
2026-01-13 17:40:11,217 - INFO - integration_test - Dyn residual k=1: pred=[16.763529669918654, 4.287808605846358, -0.19035750323072653, 3.0, 17.94159179706546], ws=[17.91374607591139, 3.3938561767610533, -0.19035750323072653, 3.0, 18.875906044530318], res=[-1.1502164059927367, 0.8939524290853047, 0.0, 0.0, -0.934314247464858], res_norm=1.731e+00
2026-01-13 17:40:11,218 - INFO - integration_test - Dyn residual k=2: pred=[18.20832707232119, 3.3370931909850214, -0.19035750323072653, 3.0, 19.17590604453032], ws=[17.574085971086113, 4.295844559623563, -0.19035750323072653, 3.0, 18.761712107356722], res=[0.6342411012350766, -0.9587513686385418, 0.0, 0.0, 0.41419393717359654], res_norm=1.222e+00
2026-01-13 17:40:11,232 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:11,308 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:11,324 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:11,337 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:11,352 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:11,365 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:11,380 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:11,392 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:11,407 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:11,419 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:11,434 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:11,445 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:11,460 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:11,472 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:11,487 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:11,499 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:11,514 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:11,526 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:11,541 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:11,552 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:11,565 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:11,576 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:12,170 - WARNING - integration_test - Step 63: MPC solve failed
2026-01-13 17:40:12,170 - WARNING - integration_test -   Consecutive MPC failures: 4/5
2026-01-13 17:40:12,257 - INFO - integration_test - Step 63: Computed 6 numeric contouring constraints for visualization (s=17.920)
2026-01-13 17:40:12,258 - DEBUG - integration_test - Step 63: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:12,258 - INFO - integration_test - === Applying control at step 63 ===
2026-01-13 17:40:12,258 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 17:40:12,258 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:12,258 - INFO - integration_test -   Planner output success: False
2026-01-13 17:40:12,258 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 17:40:12,259 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:12,259 - INFO - integration_test - Step 63 completed in 1.177s
2026-01-13 17:40:12,273 - INFO - integration_test - Step 64 (contouring until path end)
2026-01-13 17:40:12,275 - DEBUG - integration_test - Syncing planner state at step 64: vehicle_state=[16.97171027  3.94752912 -0.1903575   3.00000003 18.22000165]
2026-01-13 17:40:12,275 - DEBUG - integration_test - Step 64: Using propagated spline 18.2200 (close to path, dist=0.276m, drift=0.046m)
2026-01-13 17:40:12,275 - DEBUG - integration_test -   Set spline state to 18.2200
2026-01-13 17:40:12,277 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:12,346 - DEBUG - integration_test - Step 64: Checking path alignment: vehicle=(16.972, 3.948), path_start=(0.000, 0.000), dist=17.425m
2026-01-13 17:40:12,346 - WARNING - integration_test - Step 64: Vehicle is far from path start (dist=17.425m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:12,346 - INFO - integration_test - === Calling planner.solve_mpc() at step 64 ===
2026-01-13 17:40:12,402 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:12,413 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:12,413 - INFO - integration_test - Warmstart k=0: x0=17.16623766705917 , y0=4.194965401757024 , psi0=-0.1903575032307267 , v0=3.0000000283326527 , spline0=18.472526898331193 , a0=0.0 , w0=0.0
2026-01-13 17:40:12,413 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:12,415 - INFO - integration_test - Dyn residual k=0: pred=[17.460818666251058, 4.13820241544491, -0.1903575032307267, 3.0000000283326527, 18.772526901164458], ws=[17.98992033244048, 4.330983782169315, -0.19035750323072653, 3.0, 19.21868711888251], res=[-0.5291016661894226, -0.1927813667244047, -1.6653345369377348e-16, 2.8332652668439096e-08, -0.44616021771805237], res_norm=7.185e-01
2026-01-13 17:40:12,415 - INFO - integration_test - Dyn residual k=1: pred=[18.28450132885028, 4.2742207963932835, -0.19035750323072653, 3.0, 19.51868711888251], ws=[16.99652703435921, 3.5374337154508106, -0.19035750323072653, 3.0, 18.114889930543715], res=[1.2879742944910682, 0.7367870809424728, 0.0, 0.0, 1.403797188338796], res_norm=2.043e+00
2026-01-13 17:40:12,416 - INFO - integration_test - Dyn residual k=2: pred=[17.29110803076901, 3.4806707296747788, -0.19035750323072653, 3.0, 18.414889930543715], ws=[17.65100732474434, 4.286427800250827, -0.19035750323072653, 3.0, 18.78280242973821], res=[-0.3598992939753316, -0.8057570705760484, 0.0, 0.0, -0.367912499194496], res_norm=9.561e-01
2026-01-13 17:40:12,431 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:12,503 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:12,518 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:12,530 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:12,545 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:12,557 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:12,572 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:12,583 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:12,598 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:12,610 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:12,625 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:12,637 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:12,651 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:12,663 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:12,678 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:12,690 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:12,705 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:12,717 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:12,732 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:12,742 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:12,755 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:12,765 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:13,401 - WARNING - integration_test - Step 64: MPC solve failed
2026-01-13 17:40:13,401 - WARNING - integration_test -   Consecutive MPC failures: 5/5
2026-01-13 17:40:13,401 - WARNING - integration_test - Step 64: Checking if vehicle should continue despite 5 consecutive failures...
2026-01-13 17:40:13,401 - ERROR - integration_test - Max consecutive MPC failures (5) reached. No successful solve in last 5 attempts. Terminating test early at step 64.
2026-01-13 17:40:13,492 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=18.220)
2026-01-13 17:40:13,493 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:13,493 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 17:40:13,493 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 17:40:13,493 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:13,493 - INFO - integration_test -   Planner output success: False
2026-01-13 17:40:13,493 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 17:40:13,495 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:13,495 - INFO - integration_test - Step 200 completed in 1.221s
2026-01-13 17:40:13,508 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 17:40:13,510 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[17.26629127  3.89076613 -0.1903575   3.00000003 18.52000165]
2026-01-13 17:40:13,510 - DEBUG - integration_test - Step 201: Using propagated spline 18.5200 (close to path, dist=0.388m, drift=0.346m)
2026-01-13 17:40:13,511 - DEBUG - integration_test -   Set spline state to 18.5200
2026-01-13 17:40:13,513 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:13,583 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(17.266, 3.891), path_start=(0.000, 0.000), dist=17.699m
2026-01-13 17:40:13,583 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=17.699m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:13,583 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 17:40:13,637 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:13,647 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:13,647 - INFO - integration_test - Warmstart k=0: x0=17.23913693042647 , y0=4.3500213762611795 , psi0=-0.1903575032307267 , v0=3.0000000283326527 , spline0=18.267476396113953 , a0=0.0 , w0=0.0
2026-01-13 17:40:13,647 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:13,649 - INFO - integration_test - Dyn residual k=0: pred=[17.533717929618355, 4.293258389949066, -0.1903575032307267, 3.0000000283326527, 18.567476398947218], ws=[17.223629524926537, 3.6302227036759938, -0.19035750323072653, 3.0, 18.257763537227788], res=[0.3100884046918182, 0.663035686273072, -1.6653345369377348e-16, 2.8332652668439096e-08, 0.30971286171942936], res_norm=7.948e-01
2026-01-13 17:40:13,649 - INFO - integration_test - Dyn residual k=1: pred=[17.518210521336336, 3.573459717899962, -0.19035750323072653, 3.0, 18.55776353722779], ws=[18.383848282025504, 4.2801423503189415, -0.19035750323072653, 3.0, 19.412001279076392], res=[-0.8656377606891681, -0.7066826324189797, 0.0, 0.0, -0.8542377418486033], res_norm=1.407e+00
2026-01-13 17:40:13,650 - INFO - integration_test - Dyn residual k=2: pred=[18.678429278435303, 4.22337936454291, -0.19035750323072653, 3.0, 19.712001279076393], ws=[18.52121312171301, 4.2297764554365616, -0.19035750323072653, 3.0, 19.72713658139793], res=[0.15721615672229206, -0.00639709089365148, 0.0, 0.0, -0.015135302321535704], res_norm=1.581e-01
2026-01-13 17:40:13,664 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:13,736 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:13,752 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:13,764 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:13,780 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:13,791 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:13,806 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:13,818 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:13,833 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:13,844 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:13,859 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:13,871 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:13,885 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:13,897 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:13,911 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:13,923 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:13,938 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:13,949 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:13,964 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:13,982 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:13,996 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:14,005 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:14,588 - WARNING - integration_test - Step 201: MPC solve failed
2026-01-13 17:40:14,588 - WARNING - integration_test -   Consecutive MPC failures: 6/5
2026-01-13 17:40:14,588 - WARNING - integration_test - Step 201: Checking if vehicle should continue despite 6 consecutive failures...
2026-01-13 17:40:14,588 - ERROR - integration_test - Max consecutive MPC failures (5) reached. No successful solve in last 5 attempts. Terminating test early at step 201.
2026-01-13 17:40:14,678 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=18.520)
2026-01-13 17:40:14,678 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:14,678 - INFO - integration_test - === Applying control at step 200 ===
2026-01-13 17:40:14,678 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 17:40:14,678 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:14,678 - INFO - integration_test -   Planner output success: False
2026-01-13 17:40:14,678 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 17:40:14,680 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:14,680 - INFO - integration_test - Step 200 completed in 1.171s
2026-01-13 17:40:14,696 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-13 17:40:14,699 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[17.56087227  3.83400314 -0.1903575   3.00000003 18.82000165]
2026-01-13 17:40:14,699 - DEBUG - integration_test - Step 201: Using propagated spline 18.8200 (close to path, dist=0.431m, drift=0.040m)
2026-01-13 17:40:14,699 - DEBUG - integration_test -   Set spline state to 18.8200
2026-01-13 17:40:14,701 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:14,769 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(17.561, 3.834), path_start=(0.000, 0.000), dist=17.975m
2026-01-13 17:40:14,769 - WARNING - integration_test - Step 201: Vehicle is far from path start (dist=17.975m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:14,769 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-13 17:40:14,825 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:14,835 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:14,835 - INFO - integration_test - Warmstart k=0: x0=17.883240387267662 , y0=3.904707381931926 , psi0=-0.1903575032307267 , v0=3.0000000283326527 , spline0=18.87050670197752 , a0=0.0 , w0=0.0
2026-01-13 17:40:14,836 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:14,837 - INFO - integration_test - Dyn residual k=0: pred=[18.17782138645955, 3.847944395619812, -0.1903575032307267, 3.0000000283326527, 19.170506704810784], ws=[18.141535294029026, 3.91614883872258, -0.19035750323072653, 3.0, 19.23134066345831], res=[0.03628609243052239, -0.06820444310276796, -1.6653345369377348e-16, 2.8332652668439096e-08, -0.060833958647528164], res_norm=9.833e-02
2026-01-13 17:40:14,837 - INFO - integration_test - Dyn residual k=1: pred=[18.436116290438825, 3.859385852946548, -0.19035750323072653, 3.0, 19.531340663458312], ws=[18.27767167944103, 3.631530009309793, -0.19035750323072653, 3.0, 19.56487451869573], res=[0.15844461099779394, 0.22785584363675504, 0.0, 0.0, -0.03353385523741892], res_norm=2.795e-01
2026-01-13 17:40:14,838 - INFO - integration_test - Dyn residual k=2: pred=[18.57225267585083, 3.574767023533761, -0.19035750323072653, 3.0, 19.864874518695732], ws=[18.722400675055475, 3.675723139623925, -0.19035750323072653, 3.0, 19.75683915377162], res=[-0.15014799920464483, -0.10095611609016375, 0.0, 0.0, 0.10803536492411325], res_norm=2.107e-01
2026-01-13 17:40:14,852 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:14,923 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:14,938 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:14,950 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:14,966 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:14,978 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:14,993 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:15,005 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:15,020 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:15,032 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:15,047 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:15,058 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:15,074 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:15,087 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:15,102 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:15,114 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:15,129 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:15,141 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:15,156 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:15,167 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:15,180 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:15,190 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:15,344 - INFO - integration_test - Step 201: MPC solve successful
2026-01-13 17:40:15,428 - INFO - integration_test - Step 201: Computed 6 numeric contouring constraints for visualization (s=18.820)
2026-01-13 17:40:15,429 - DEBUG - integration_test - Step 201: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:15,429 - INFO - integration_test - === Applying control at step 201 ===
2026-01-13 17:40:15,429 - INFO - integration_test -   Control dict from planner: {'a': 1.0903807487313107e-08, 'w': 0.8000000092119691}
2026-01-13 17:40:15,429 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:15,429 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:15,430 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:15,430 - INFO - integration_test - Step 201 completed in 0.732s
2026-01-13 17:40:15,444 - INFO - integration_test - Step 202 (contouring until path end)
2026-01-13 17:40:15,448 - DEBUG - integration_test - Syncing planner state at step 202: vehicle_state=[17.85740846  3.78907764 -0.1103575   3.00000003 19.12000165]
2026-01-13 17:40:15,448 - DEBUG - integration_test - Step 202: Using propagated spline 19.1200 (close to path, dist=0.480m, drift=0.340m)
2026-01-13 17:40:15,448 - DEBUG - integration_test -   Set spline state to 19.1200
2026-01-13 17:40:15,450 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:15,517 - DEBUG - integration_test - Step 202: Checking path alignment: vehicle=(17.857, 3.789), path_start=(0.000, 0.000), dist=18.255m
2026-01-13 17:40:15,517 - WARNING - integration_test - Step 202: Vehicle is far from path start (dist=18.255m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:15,517 - INFO - integration_test - === Calling planner.solve_mpc() at step 202 ===
2026-01-13 17:40:15,570 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:15,580 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:15,580 - INFO - integration_test - Warmstart k=0: x0=17.841032391771098 , y0=4.027510210220102 , psi0=-0.11035750230952979 , v0=3.0000000294230333 , spline0=18.867476401889522 , a0=0.0 , w0=0.0
2026-01-13 17:40:15,580 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:15,581 - INFO - integration_test - Dyn residual k=0: pred=[18.13920743122862, 3.994470119271577, -0.11035750230952979, 3.0000000294230333, 19.167476404831827], ws=[17.57651420450921, 3.0635294971434632, -0.11035750230952956, 3.0, 18.67491544256549], res=[0.5626932267194107, 0.9309406221281136, -2.220446049250313e-16, 2.942303334307894e-08, 0.4925609622663387], res_norm=1.194e+00
2026-01-13 17:40:15,582 - INFO - integration_test - Dyn residual k=1: pred=[17.874689241042326, 3.0304894065189845, -0.11035750230952956, 3.0, 18.97491544256549], ws=[18.586478014017395, 3.84958639044148, -0.11035750230952956, 3.0, 19.751668086220725], res=[-0.7117887729750692, -0.8190969839224955, 0.0, 0.0, -0.7767526436552359], res_norm=1.335e+00
2026-01-13 17:40:15,583 - INFO - integration_test - Dyn residual k=2: pred=[18.88465305055051, 3.816546299817001, -0.11035750230952956, 3.0, 20.051668086220726], ws=[18.865583262823566, 3.780882974776238, -0.11035750230952956, 3.0, 19.892139514400373], res=[0.01906978772694501, 0.035663325040763194, 0.0, 0.0, 0.15952857182035274], res_norm=1.646e-01
2026-01-13 17:40:15,597 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:15,669 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:15,684 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:15,695 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:15,712 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:15,723 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:15,739 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:15,751 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:15,766 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:15,778 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:15,793 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:15,805 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:15,820 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:15,832 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:15,847 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:15,858 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:15,874 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:15,886 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:15,901 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:15,912 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:15,925 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:15,935 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:16,091 - INFO - integration_test - Step 202: MPC solve successful
2026-01-13 17:40:16,180 - INFO - integration_test - Step 202: Computed 6 numeric contouring constraints for visualization (s=19.120)
2026-01-13 17:40:16,180 - DEBUG - integration_test - Step 202: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:16,180 - INFO - integration_test - === Applying control at step 202 ===
2026-01-13 17:40:16,180 - INFO - integration_test -   Control dict from planner: {'a': 4.274987876149673e-09, 'w': 0.8000000099405653}
2026-01-13 17:40:16,180 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:16,180 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:16,182 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:16,182 - INFO - integration_test - Step 202 completed in 0.734s
2026-01-13 17:40:16,197 - INFO - integration_test - Step 203 (contouring until path end)
2026-01-13 17:40:16,199 - DEBUG - integration_test - Syncing planner state at step 203: vehicle_state=[18.15658645  3.76799342 -0.0303575   3.00000003 19.42000166]
2026-01-13 17:40:16,200 - DEBUG - integration_test - Step 203: Using propagated spline 19.4200 (close to path, dist=0.571m, drift=0.035m)
2026-01-13 17:40:16,200 - DEBUG - integration_test -   Set spline state to 19.4200
2026-01-13 17:40:16,201 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:16,267 - DEBUG - integration_test - Step 203: Checking path alignment: vehicle=(18.157, 3.768), path_start=(0.000, 0.000), dist=18.543m
2026-01-13 17:40:16,267 - WARNING - integration_test - Step 203: Vehicle is far from path start (dist=18.543m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:16,267 - INFO - integration_test - === Calling planner.solve_mpc() at step 203 ===
2026-01-13 17:40:16,319 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:16,329 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:16,329 - INFO - integration_test - Warmstart k=0: x0=18.48156362625393 , y0=4.100962999548124 , psi0=-0.030357501315473254 , v0=3.0000000298505323 , spline0=19.672526909925082 , a0=0.0 , w0=0.0
2026-01-13 17:40:16,329 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:16,330 - INFO - integration_test - Dyn residual k=0: pred=[18.781425403170687, 4.091857147838517, -0.030357501315473254, 3.0000000298505323, 19.972526912910137], ws=[18.911770330267903, 4.039888181820283, -0.0303575013154731, 3.0, 20.15404965803356], res=[-0.1303449270972159, 0.051968966018233864, -1.5265566588595902e-16, 2.9850532268227425e-08, -0.1815227451234236], res_norm=2.294e-01
2026-01-13 17:40:16,331 - INFO - integration_test - Dyn residual k=1: pred=[19.21163210420098, 4.03078233020128, -0.0303575013154731, 3.0, 20.45404965803356], ws=[18.75631000012607, 3.749781720863535, -0.0303575013154731, 3.0, 19.802423616951625], res=[0.45532210407490936, 0.28100060933774484, 0.0, 0.0, 0.6516260410819363], res_norm=8.431e-01
2026-01-13 17:40:16,332 - INFO - integration_test - Dyn residual k=2: pred=[19.05617177405915, 3.7406758692445323, -0.0303575013154731, 3.0, 20.102423616951626], ws=[19.05617177405915, 3.7406758692445323, -0.0303575013154731, 3.0, 20.228955697329685], res=[0.0, 0.0, 0.0, 0.0, -0.12653208037805896], res_norm=1.265e-01
2026-01-13 17:40:16,346 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:16,422 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:16,438 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:16,450 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:16,467 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:16,479 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:16,495 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:16,506 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:16,522 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:16,534 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:16,550 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:16,561 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:16,577 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:16,589 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:16,604 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:16,615 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:16,630 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:16,642 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:16,658 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:16,670 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:16,685 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:16,696 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:16,860 - INFO - integration_test - Step 203: MPC solve successful
2026-01-13 17:40:16,951 - INFO - integration_test - Step 203: Computed 6 numeric contouring constraints for visualization (s=19.420)
2026-01-13 17:40:16,952 - DEBUG - integration_test - Step 203: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:16,952 - INFO - integration_test - === Applying control at step 203 ===
2026-01-13 17:40:16,952 - INFO - integration_test -   Control dict from planner: {'a': 1.0358667200165653e-09, 'w': 0.8000000099948521}
2026-01-13 17:40:16,952 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:16,952 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:16,953 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:16,953 - INFO - integration_test - Step 203 completed in 0.754s
2026-01-13 17:40:16,970 - INFO - integration_test - Step 204 (contouring until path end)
2026-01-13 17:40:16,971 - DEBUG - integration_test - Syncing planner state at step 204: vehicle_state=[18.45649252  3.77088536  0.0496425   3.00000003 19.72000166]
2026-01-13 17:40:16,972 - DEBUG - integration_test - Step 204: Using propagated spline 19.7200 (close to path, dist=0.549m, drift=0.335m)
2026-01-13 17:40:16,972 - DEBUG - integration_test -   Set spline state to 19.7200
2026-01-13 17:40:16,973 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:17,039 - DEBUG - integration_test - Step 204: Checking path alignment: vehicle=(18.456, 3.771), path_start=(0.000, 0.000), dist=18.838m
2026-01-13 17:40:17,039 - WARNING - integration_test - Step 204: Vehicle is far from path start (dist=18.838m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:17,039 - INFO - integration_test - === Calling planner.solve_mpc() at step 204 ===
2026-01-13 17:40:17,094 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:17,104 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:17,104 - INFO - integration_test - Warmstart k=0: x0=18.45649252307138 , y0=3.770885357773857 , psi0=0.049642499684011965 , v0=3.0000000299541187 , spline0=19.66949660989019 , a0=0.0 , w0=0.0
2026-01-13 17:40:17,104 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:17,105 - INFO - integration_test - Dyn residual k=0: pred=[18.756122945305105, 3.785771991687726, 0.049642499684011965, 3.0000000299541187, 19.9694966128856], ws=[18.756122942313386, 3.7857719915390877, 0.04964249968401191, 3.0, 19.79822965875745], res=[2.991718872635829e-09, 1.4863843489365536e-10, 5.551115123125783e-17, 2.995411874096021e-08, 0.17126695412814996], res_norm=1.713e-01
2026-01-13 17:40:17,106 - INFO - integration_test - Dyn residual k=1: pred=[19.055753361555393, 3.8006586253043184, 0.04964249968401191, 3.0, 20.09822965875745], ws=[19.317109940809452, 4.307846863118149, 0.04964249968401191, 3.0, 20.390653289567297], res=[-0.2613565792540591, -0.5071882378138306, 0.0, 0.0, -0.29242363080984646], res_norm=6.411e-01
2026-01-13 17:40:17,106 - INFO - integration_test - Dyn residual k=2: pred=[19.61674036005146, 4.322733496883379, 0.04964249968401191, 3.0, 20.690653289567297], ws=[19.3553837807974, 3.815545259069549, 0.04964249968401191, 3.0, 20.35200545369588], res=[0.2613565792540591, 0.5071882378138302, 0.0, 0.0, 0.33864783587141645], res_norm=6.635e-01
2026-01-13 17:40:17,121 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:17,192 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:17,208 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:17,219 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:17,235 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:17,246 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:17,261 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:17,273 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:17,288 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:17,300 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:17,315 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:17,328 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:17,344 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:17,356 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:17,371 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:17,383 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:17,398 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:17,410 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:17,425 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:17,436 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:17,450 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:17,460 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:17,613 - INFO - integration_test - Step 204: MPC solve successful
2026-01-13 17:40:17,705 - INFO - integration_test - Step 204: Computed 6 numeric contouring constraints for visualization (s=19.720)
2026-01-13 17:40:17,706 - DEBUG - integration_test - Step 204: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:17,706 - INFO - integration_test - === Applying control at step 204 ===
2026-01-13 17:40:17,706 - INFO - integration_test -   Control dict from planner: {'a': -1.082596137578661e-06, 'w': 0.7999991420247435}
2026-01-13 17:40:17,706 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:17,706 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:17,707 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:17,707 - INFO - integration_test - Step 204 completed in 0.736s
2026-01-13 17:40:17,723 - INFO - integration_test - Step 205 (contouring until path end)
2026-01-13 17:40:17,724 - DEBUG - integration_test - Syncing planner state at step 205: vehicle_state=[18.75520829  3.79773493  0.12964241  2.99999992 20.02000165]
2026-01-13 17:40:17,725 - DEBUG - integration_test - Step 205: Using propagated spline 20.0200 (close to path, dist=0.654m, drift=0.029m)
2026-01-13 17:40:17,725 - DEBUG - integration_test -   Set spline state to 20.0200
2026-01-13 17:40:17,727 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:17,793 - DEBUG - integration_test - Step 205: Checking path alignment: vehicle=(18.755, 3.798), path_start=(0.000, 0.000), dist=19.136m
2026-01-13 17:40:17,793 - WARNING - integration_test - Step 205: Vehicle is far from path start (dist=19.136m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:17,793 - INFO - integration_test - === Calling planner.solve_mpc() at step 205 ===
2026-01-13 17:40:17,847 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:17,857 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:17,857 - INFO - integration_test - Warmstart k=0: x0=18.86015946044782 , y0=3.9665020976064915 , psi0=0.1296424138864863 , v0=2.999999921694505 , spline0=19.86848650104954 , a0=0.0 , w0=0.0
2026-01-13 17:40:17,857 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:17,858 - INFO - integration_test - Dyn residual k=0: pred=[19.157641908389568, 4.005285966266767, 0.1296424138864863, 2.999999921694505, 20.16848649321899], ws=[19.066684948225483, 3.943123729312239, 0.12964241388648645, 2.999999921694505, 19.963496342303877], res=[0.09095696016408539, 0.06216223695452783, -1.3877787807814457e-16, 0.0, 0.20499015091511197], res_norm=2.327e-01
2026-01-13 17:40:17,858 - INFO - integration_test - Dyn residual k=1: pred=[19.36416739616723, 3.9819075979725143, 0.12964241388648645, 2.999999921694505, 20.263496334473327], ws=[19.51914463546745, 3.9472886267327985, 0.12964241388648645, 2.999999921694505, 20.742374726277504], res=[-0.15497723930021934, 0.0346189712397158, 0.0, 0.0, -0.4788783918041766], res_norm=5.045e-01
2026-01-13 17:40:17,860 - INFO - integration_test - Dyn residual k=2: pred=[19.816627083409195, 3.9860724953930737, 0.12964241388648645, 2.999999921694505, 21.042374718446954], ws=[19.64765563795066, 3.9140865368365136, 0.12964241388648645, 2.999999921694505, 20.78653534001373], res=[0.16897144545853493, 0.07198595855656009, 0.0, 0.0, 0.25583937843322246], res_norm=3.149e-01
2026-01-13 17:40:17,874 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:17,947 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:17,964 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:17,975 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:17,991 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:18,003 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:18,019 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:18,031 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:18,047 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:18,058 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:18,073 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:18,085 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:18,100 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:18,112 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:18,127 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:18,139 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:18,154 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:18,166 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:18,181 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:18,191 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:18,204 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:18,214 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:18,804 - WARNING - integration_test - Step 205: MPC solve failed
2026-01-13 17:40:18,804 - WARNING - integration_test -   Consecutive MPC failures: 1/5
2026-01-13 17:40:18,903 - INFO - integration_test - Step 205: Computed 6 numeric contouring constraints for visualization (s=20.020)
2026-01-13 17:40:18,903 - DEBUG - integration_test - Step 205: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:18,903 - INFO - integration_test - === Applying control at step 205 ===
2026-01-13 17:40:18,903 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 17:40:18,903 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:18,903 - INFO - integration_test -   Planner output success: False
2026-01-13 17:40:18,903 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 17:40:18,904 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:18,904 - INFO - integration_test - Step 205 completed in 1.180s
2026-01-13 17:40:18,921 - INFO - integration_test - Step 206 (contouring until path end)
2026-01-13 17:40:18,923 - DEBUG - integration_test - Syncing planner state at step 206: vehicle_state=[19.05269074  3.8365188   0.12964241  2.99999992 20.32000164]
2026-01-13 17:40:18,923 - DEBUG - integration_test - Step 206: Using propagated spline 20.3200 (close to path, dist=0.581m, drift=0.329m)
2026-01-13 17:40:18,923 - DEBUG - integration_test -   Set spline state to 20.3200
2026-01-13 17:40:18,924 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:19,003 - DEBUG - integration_test - Step 206: Checking path alignment: vehicle=(19.053, 3.837), path_start=(0.000, 0.000), dist=19.435m
2026-01-13 17:40:19,003 - WARNING - integration_test - Step 206: Vehicle is far from path start (dist=19.435m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:19,003 - INFO - integration_test - === Calling planner.solve_mpc() at step 206 ===
2026-01-13 17:40:19,059 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:19,069 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:19,069 - INFO - integration_test - Warmstart k=0: x0=19.052690742067167 , y0=3.836518799515963 , psi0=0.1296424138864863 , v0=2.999999921694505 , spline0=19.96646629119879 , a0=0.0 , w0=0.0
2026-01-13 17:40:19,069 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:19,070 - INFO - integration_test - Dyn residual k=0: pred=[19.350173190008913, 3.8753026681762384, 0.1296424138864863, 2.999999921694505, 20.26646628336824], ws=[19.350173190008913, 3.8753026681762384, 0.12964241388648645, 2.999999921694505, 20.414948628091505], res=[0.0, 0.0, -1.3877787807814457e-16, 0.0, -0.14848234472326638], res_norm=1.485e-01
2026-01-13 17:40:19,071 - INFO - integration_test - Dyn residual k=1: pred=[19.64765563795066, 3.9140865368365136, 0.12964241388648645, 2.999999921694505, 20.714948620260955], ws=[19.61709689580267, 4.1694237010040425, 0.12964241388648645, 2.999999921694505, 20.529258395764558], res=[0.030558742147988482, -0.25533716416752883, 0.0, 0.0, 0.1856902244963976], res_norm=3.172e-01
2026-01-13 17:40:19,071 - INFO - integration_test - Dyn residual k=2: pred=[19.914579343744418, 4.208207569664318, 0.12964241388648645, 2.999999921694505, 20.829258387934008], ws=[19.945138085892406, 3.952870405496789, 0.12964241388648645, 2.999999921694505, 20.898838260067357], res=[-0.030558742147988482, 0.2553371641675293, 0.0, 0.0, -0.0695798721333496], res_norm=2.664e-01
2026-01-13 17:40:19,086 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:19,157 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:19,173 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:19,185 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:19,200 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:19,212 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:19,226 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:19,238 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:19,253 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:19,265 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:19,280 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:19,291 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:19,306 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:19,318 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:19,333 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:19,344 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:19,359 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:19,371 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:19,386 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:19,396 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:19,409 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:19,419 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:19,560 - INFO - integration_test - Step 206: MPC solve successful
2026-01-13 17:40:19,652 - INFO - integration_test - Step 206: Computed 6 numeric contouring constraints for visualization (s=20.320)
2026-01-13 17:40:19,652 - DEBUG - integration_test - Step 206: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:19,653 - INFO - integration_test - === Applying control at step 206 ===
2026-01-13 17:40:19,653 - INFO - integration_test -   Control dict from planner: {'a': 7.368307520175186e-07, 'w': 0.7999999566152202}
2026-01-13 17:40:19,653 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:19,653 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:19,654 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:19,654 - INFO - integration_test - Step 206 completed in 0.732s
2026-01-13 17:40:19,671 - INFO - integration_test - Step 207 (contouring until path end)
2026-01-13 17:40:19,672 - DEBUG - integration_test - Syncing planner state at step 207: vehicle_state=[19.34830546  3.88715427  0.20964241  3.         20.62000164]
2026-01-13 17:40:19,673 - DEBUG - integration_test - Step 207: Using propagated spline 20.6200 (close to path, dist=0.643m, drift=0.629m)
2026-01-13 17:40:19,673 - DEBUG - integration_test -   Set spline state to 20.6200
2026-01-13 17:40:19,674 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:19,741 - DEBUG - integration_test - Step 207: Checking path alignment: vehicle=(19.348, 3.887), path_start=(0.000, 0.000), dist=19.735m
2026-01-13 17:40:19,741 - WARNING - integration_test - Step 207: Vehicle is far from path start (dist=19.735m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:19,741 - INFO - integration_test - === Calling planner.solve_mpc() at step 207 ===
2026-01-13 17:40:19,795 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:19,805 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:19,805 - INFO - integration_test - Warmstart k=0: x0=19.348305457334774 , y0=3.887154265682437 , psi0=0.20964240954800833 , v0=2.99999999537758 , spline0=20.367476391746646 , a0=0.0 , w0=0.0
2026-01-13 17:40:19,805 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:19,806 - INFO - integration_test - Dyn residual k=0: pred=[19.641737075521107, 3.9495873111888544, 0.20964240954800833, 2.99999999537758, 20.667476391284403], ws=[19.641737075521107, 3.9495873111888544, 0.2096424095480085, 2.99999999537758, 20.781187731400305], res=[0.0, 0.0, -1.6653345369377348e-16, 0.0, -0.113711340115902], res_norm=1.137e-01
2026-01-13 17:40:19,807 - INFO - integration_test - Dyn residual k=1: pred=[19.935168693707435, 4.012020356695271, 0.2096424095480085, 2.99999999537758, 21.081187730938062], ws=[19.935168693707435, 4.012020356695271, 0.2096424095480085, 2.99999999537758, 20.971446729488576], res=[0.0, 0.0, 0.0, 0.0, 0.10974100144948551], res_norm=1.097e-01
2026-01-13 17:40:19,807 - INFO - integration_test - Dyn residual k=2: pred=[20.228600311893764, 4.074453402201688, 0.2096424095480085, 2.99999999537758, 21.271446729026334], ws=[20.228600311893764, 4.074453402201688, 0.2096424095480085, 2.99999999537758, 21.338152558216954], res=[0.0, 0.0, 0.0, 0.0, -0.06670582919062085], res_norm=6.671e-02
2026-01-13 17:40:19,822 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:19,892 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:19,908 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:19,920 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:19,935 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:19,947 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:19,962 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:19,974 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:19,989 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:20,001 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:20,016 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:20,028 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:20,043 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:20,055 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:20,070 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:20,082 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:20,099 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:20,112 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:20,128 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:20,138 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:20,152 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:20,163 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:20,330 - INFO - integration_test - Step 207: MPC solve successful
2026-01-13 17:40:20,420 - INFO - integration_test - Step 207: Computed 6 numeric contouring constraints for visualization (s=20.620)
2026-01-13 17:40:20,420 - DEBUG - integration_test - Step 207: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:20,420 - INFO - integration_test - === Applying control at step 207 ===
2026-01-13 17:40:20,420 - INFO - integration_test -   Control dict from planner: {'a': 2.3074049887551577e-07, 'w': 0.8000000099426195}
2026-01-13 17:40:20,420 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:20,420 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:20,421 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:20,422 - INFO - integration_test - Step 207 completed in 0.750s
2026-01-13 17:40:20,438 - INFO - integration_test - Step 208 (contouring until path end)
2026-01-13 17:40:20,439 - DEBUG - integration_test - Syncing planner state at step 208: vehicle_state=[19.6389282   3.96125174  0.28964241  3.00000002 20.92000165]
2026-01-13 17:40:20,440 - DEBUG - integration_test - Step 208: Using propagated spline 20.9200 (close to path, dist=0.596m, drift=0.323m)
2026-01-13 17:40:20,440 - DEBUG - integration_test -   Set spline state to 20.9200
2026-01-13 17:40:20,441 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:20,507 - DEBUG - integration_test - Step 208: Checking path alignment: vehicle=(19.639, 3.961), path_start=(0.000, 0.000), dist=20.034m
2026-01-13 17:40:20,507 - WARNING - integration_test - Step 208: Vehicle is far from path start (dist=20.034m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:20,507 - INFO - integration_test - === Calling planner.solve_mpc() at step 208 ===
2026-01-13 17:40:20,563 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:20,573 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:20,573 - INFO - integration_test - Warmstart k=0: x0=19.638928196947546 , y0=3.9612517449336404 , psi0=0.2896424105422703 , v0=3.00000001845163 , spline0=20.76848649460191 , a0=0.0 , w0=0.0
2026-01-13 17:40:20,573 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:20,574 - INFO - integration_test - Dyn residual k=0: pred=[19.926432019039712, 4.046934610137217, 0.2896424105422703, 3.00000001845163, 21.068486496447072], ws=[19.926432017271406, 4.04693460961022, 0.28964241054227013, 3.0, 20.928931754530836], res=[1.7683063902040885e-09, 5.269962244369708e-10, 1.6653345369377348e-16, 1.8451630001692365e-08, 0.13955474191623551], res_norm=1.396e-01
2026-01-13 17:40:20,575 - INFO - integration_test - Dyn residual k=1: pred=[20.213935837595265, 4.132617474286801, 0.28964241054227013, 3.0, 21.228931754530837], ws=[20.213935837595265, 4.132617474286801, 0.28964241054227013, 3.0, 21.36311187092915], res=[0.0, 0.0, 0.0, 0.0, -0.13418011639831207], res_norm=1.342e-01
2026-01-13 17:40:20,576 - INFO - integration_test - Dyn residual k=2: pred=[20.501439657919125, 4.218300338963381, 0.28964241054227013, 3.0, 21.66311187092915], ws=[20.501439657919125, 4.218300338963381, 0.28964241054227013, 3.0, 21.547706303157675], res=[0.0, 0.0, 0.0, 0.0, 0.11540556777147515], res_norm=1.154e-01
2026-01-13 17:40:20,590 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:20,662 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:20,678 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:20,690 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:20,706 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:20,718 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:20,734 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:20,746 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:20,761 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:20,773 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:20,788 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:20,800 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:20,815 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:20,827 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:20,842 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:20,854 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:20,869 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:20,881 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:20,896 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:20,907 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:20,920 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:20,930 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:21,660 - WARNING - integration_test - Step 208: MPC solve failed
2026-01-13 17:40:21,660 - WARNING - integration_test -   Consecutive MPC failures: 1/5
2026-01-13 17:40:21,765 - INFO - integration_test - Step 208: Computed 6 numeric contouring constraints for visualization (s=20.920)
2026-01-13 17:40:21,765 - DEBUG - integration_test - Step 208: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:21,765 - INFO - integration_test - === Applying control at step 208 ===
2026-01-13 17:40:21,765 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 17:40:21,765 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:21,765 - INFO - integration_test -   Planner output success: False
2026-01-13 17:40:21,765 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 17:40:21,766 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:21,767 - INFO - integration_test - Step 208 completed in 1.328s
2026-01-13 17:40:21,782 - INFO - integration_test - Step 209 (contouring until path end)
2026-01-13 17:40:21,784 - DEBUG - integration_test - Syncing planner state at step 209: vehicle_state=[19.92643202  4.04693461  0.28964241  3.00000002 21.22000165]
2026-01-13 17:40:21,785 - DEBUG - integration_test - Step 209: Using propagated spline 21.2200 (close to path, dist=0.606m, drift=0.623m)
2026-01-13 17:40:21,785 - DEBUG - integration_test -   Set spline state to 21.2200
2026-01-13 17:40:21,786 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:21,853 - DEBUG - integration_test - Step 209: Checking path alignment: vehicle=(19.926, 4.047), path_start=(0.000, 0.000), dist=20.333m
2026-01-13 17:40:21,853 - WARNING - integration_test - Step 209: Vehicle is far from path start (dist=20.333m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:21,853 - INFO - integration_test - === Calling planner.solve_mpc() at step 209 ===
2026-01-13 17:40:21,907 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:21,917 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:21,917 - INFO - integration_test - Warmstart k=0: x0=19.926432019039712 , y0=4.046934610137217 , psi0=0.2896424105422703 , v0=3.00000001845163 , spline0=20.96747639543697 , a0=0.0 , w0=0.0
2026-01-13 17:40:21,917 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:21,918 - INFO - integration_test - Dyn residual k=0: pred=[20.213935841131878, 4.132617475340793, 0.2896424105422703, 3.00000001845163, 21.267476397282135], ws=[20.21393583936357, 4.132617474813797, 0.28964241054227013, 3.0, 21.090906511872134], res=[1.7683063902040885e-09, 5.269962244369708e-10, 1.6653345369377348e-16, 1.8451630001692365e-08, 0.17656988541000018], res_norm=1.766e-01
2026-01-13 17:40:21,919 - INFO - integration_test - Dyn residual k=1: pred=[20.50143965968743, 4.218300339490377, 0.28964241054227013, 3.0, 21.390906511872135], ws=[20.50143965968743, 4.218300339490377, 0.28964241054227013, 3.0, 21.49667095473726], res=[0.0, 0.0, 0.0, 0.0, -0.10576444286512654], res_norm=1.058e-01
2026-01-13 17:40:21,920 - INFO - integration_test - Dyn residual k=2: pred=[20.78894348001129, 4.303983204166958, 0.28964241054227013, 3.0, 21.796670954737262], ws=[20.78894348001129, 4.303983204166958, 0.28964241054227013, 3.0, 21.67588517909168], res=[0.0, 0.0, 0.0, 0.0, 0.12078577564558302], res_norm=1.208e-01
2026-01-13 17:40:21,934 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:22,005 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:22,021 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:22,032 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:22,047 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:22,059 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:22,075 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:22,087 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:22,103 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:22,115 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:22,130 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:22,141 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:22,156 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:22,168 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:22,183 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:22,195 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:22,209 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:22,221 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:22,236 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:22,247 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:22,260 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:22,270 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:23,661 - WARNING - integration_test - Step 209: MPC solve failed
2026-01-13 17:40:23,661 - WARNING - integration_test -   Consecutive MPC failures: 2/5
2026-01-13 17:40:23,758 - INFO - integration_test - Step 209: Computed 6 numeric contouring constraints for visualization (s=21.220)
2026-01-13 17:40:23,758 - DEBUG - integration_test - Step 209: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:23,758 - INFO - integration_test - === Applying control at step 209 ===
2026-01-13 17:40:23,758 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 17:40:23,758 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:23,758 - INFO - integration_test -   Planner output success: False
2026-01-13 17:40:23,758 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 17:40:23,759 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:23,760 - INFO - integration_test - Step 209 completed in 1.976s
2026-01-13 17:40:23,774 - INFO - integration_test - Step 210 (contouring until path end)
2026-01-13 17:40:23,775 - DEBUG - integration_test - Syncing planner state at step 210: vehicle_state=[20.21393584  4.13261748  0.28964241  3.00000002 21.52000165]
2026-01-13 17:40:23,776 - DEBUG - integration_test - Step 210: Using propagated spline 21.5200 (close to path, dist=0.601m, drift=0.317m)
2026-01-13 17:40:23,776 - DEBUG - integration_test -   Set spline state to 21.5200
2026-01-13 17:40:23,779 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:23,845 - DEBUG - integration_test - Step 210: Checking path alignment: vehicle=(20.214, 4.133), path_start=(0.000, 0.000), dist=20.632m
2026-01-13 17:40:23,845 - WARNING - integration_test - Step 210: Vehicle is far from path start (dist=20.632m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:23,845 - INFO - integration_test - === Calling planner.solve_mpc() at step 210 ===
2026-01-13 17:40:23,898 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:23,908 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:23,908 - INFO - integration_test - Warmstart k=0: x0=20.213935841131878 , y0=4.132617475340793 , psi0=0.2896424105422703 , v0=3.00000001845163 , spline0=21.368486498292235 , a0=0.0 , w0=0.0
2026-01-13 17:40:23,908 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:23,909 - INFO - integration_test - Dyn residual k=0: pred=[20.501439663224044, 4.21830034054437, 0.2896424105422703, 3.00000001845163, 21.668486500137398], ws=[20.501439661455738, 4.2183003400173735, 0.28964241054227013, 3.0, 21.541160272887925], res=[1.7683063902040885e-09, 5.269962244369708e-10, 1.6653345369377348e-16, 1.8451630001692365e-08, 0.12732622724947262], res_norm=1.273e-01
2026-01-13 17:40:23,910 - INFO - integration_test - Dyn residual k=1: pred=[20.788943481779597, 4.303983204693954, 0.28964241054227013, 3.0, 21.841160272887926], ws=[20.788943481779597, 4.303983204693954, 0.28964241054227013, 3.0, 21.686024469105114], res=[0.0, 0.0, 0.0, 0.0, 0.15513580378281233], res_norm=1.551e-01
2026-01-13 17:40:23,911 - INFO - integration_test - Dyn residual k=2: pred=[21.076447302103457, 4.389666069370534, 0.28964241054227013, 3.0, 21.986024469105114], ws=[21.076447302103457, 4.389666069370534, 0.28964241054227013, 3.0, 22.086050906553567], res=[0.0, 0.0, 0.0, 0.0, -0.1000264374484523], res_norm=1.000e-01
2026-01-13 17:40:23,925 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:24,005 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:24,020 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:24,031 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:24,046 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:24,058 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:24,074 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:24,086 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:24,101 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:24,113 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:24,128 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:24,140 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:24,155 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:24,166 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:24,181 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:24,194 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:24,210 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:24,222 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:24,237 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:24,247 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:24,260 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:24,271 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:24,420 - INFO - integration_test - Step 210: MPC solve successful
2026-01-13 17:40:24,816 - INFO - integration_test - Step 210: Computed 6 numeric contouring constraints for visualization (s=21.520)
2026-01-13 17:40:24,816 - DEBUG - integration_test - Step 210: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:24,816 - INFO - integration_test - === Applying control at step 210 ===
2026-01-13 17:40:24,816 - INFO - integration_test -   Control dict from planner: {'a': 2.4174423910717743e-08, 'w': 0.7999999916897568}
2026-01-13 17:40:24,816 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:24,816 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:24,817 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:24,817 - INFO - integration_test - Step 210 completed in 1.042s
2026-01-13 17:40:24,833 - INFO - integration_test - Step 211 (contouring until path end)
2026-01-13 17:40:24,835 - DEBUG - integration_test - Syncing planner state at step 211: vehicle_state=[20.49770761  4.229703    0.36964241  3.00000002 21.82000165]
2026-01-13 17:40:24,835 - DEBUG - integration_test - Step 211: Using propagated spline 21.8200 (close to path, dist=0.585m, drift=0.617m)
2026-01-13 17:40:24,835 - DEBUG - integration_test -   Set spline state to 21.8200
2026-01-13 17:40:24,836 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:24,902 - DEBUG - integration_test - Step 211: Checking path alignment: vehicle=(20.498, 4.230), path_start=(0.000, 0.000), dist=20.930m
2026-01-13 17:40:24,902 - WARNING - integration_test - Step 211: Vehicle is far from path start (dist=20.930m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:24,902 - INFO - integration_test - === Calling planner.solve_mpc() at step 211 ===
2026-01-13 17:40:24,954 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:24,964 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:24,964 - INFO - integration_test - Warmstart k=0: x0=20.497707607695595 , y0=4.229702996811545 , psi0=0.36964240971124596 , v0=3.0000000208690722 , spline0=21.567476399369042 , a0=0.0 , w0=0.0
2026-01-13 17:40:24,964 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:24,965 - INFO - integration_test - Dyn residual k=0: pred=[20.77744458848993, 4.3380876028597, 0.36964240971124596, 3.0000000208690722, 21.86747640145595], ws=[20.777444586543982, 4.3380876021057375, 0.36964240971124607, 3.0, 21.690625502279957], res=[1.945949179571471e-09, 7.539622259855605e-10, -1.1102230246251565e-16, 2.0869072248075327e-08, 0.17685089917599228], res_norm=1.769e-01
2026-01-13 17:40:24,966 - INFO - integration_test - Dyn residual k=1: pred=[21.05718156539237, 4.44647220739993, 0.36964240971124607, 3.0, 21.990625502279958], ws=[21.05718156539237, 4.44647220739993, 0.36964240971124607, 3.0, 22.066678332216917], res=[0.0, 0.0, 0.0, 0.0, -0.07605282993695894], res_norm=7.605e-02
2026-01-13 17:40:24,967 - INFO - integration_test - Dyn residual k=2: pred=[21.336918544240756, 4.554856812694123, 0.36964240971124607, 3.0, 22.366678332216917], ws=[21.336918544240756, 4.554856812694123, 0.36964240971124607, 3.0, 22.514846626245944], res=[0.0, 0.0, 0.0, 0.0, -0.14816829402902698], res_norm=1.482e-01
2026-01-13 17:40:24,981 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:25,051 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:25,066 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:25,078 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:25,093 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:25,104 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:25,119 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:25,131 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:25,145 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:25,157 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:25,172 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:25,185 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:25,201 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:25,214 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:25,230 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:25,242 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:25,257 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:25,269 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:25,284 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:25,294 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:25,307 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:25,317 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:26,468 - WARNING - integration_test - Step 211: MPC solve failed
2026-01-13 17:40:26,468 - WARNING - integration_test -   Consecutive MPC failures: 1/5
2026-01-13 17:40:26,582 - INFO - integration_test - Step 211: Computed 6 numeric contouring constraints for visualization (s=21.820)
2026-01-13 17:40:26,582 - DEBUG - integration_test - Step 211: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:26,582 - INFO - integration_test - === Applying control at step 211 ===
2026-01-13 17:40:26,582 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 17:40:26,583 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:26,583 - INFO - integration_test -   Planner output success: False
2026-01-13 17:40:26,583 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 17:40:26,584 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:26,584 - INFO - integration_test - Step 211 completed in 1.750s
2026-01-13 17:40:26,602 - INFO - integration_test - Step 212 (contouring until path end)
2026-01-13 17:40:26,603 - DEBUG - integration_test - Syncing planner state at step 212: vehicle_state=[20.77744459  4.3380876   0.36964241  3.00000002 22.12000165]
2026-01-13 17:40:26,604 - DEBUG - integration_test - Step 212: Using propagated spline 22.1200 (close to path, dist=0.604m, drift=0.311m)
2026-01-13 17:40:26,604 - DEBUG - integration_test -   Set spline state to 22.1200
2026-01-13 17:40:26,605 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:26,673 - DEBUG - integration_test - Step 212: Checking path alignment: vehicle=(20.777, 4.338), path_start=(0.000, 0.000), dist=21.225m
2026-01-13 17:40:26,673 - WARNING - integration_test - Step 212: Vehicle is far from path start (dist=21.225m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:26,673 - INFO - integration_test - === Calling planner.solve_mpc() at step 212 ===
2026-01-13 17:40:26,730 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:26,739 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:26,739 - INFO - integration_test - Warmstart k=0: x0=20.77744458848993 , y0=4.3380876028597 , psi0=0.36964240971124596 , v0=3.0000000208690722 , spline0=21.665456199435745 , a0=0.0 , w0=0.0
2026-01-13 17:40:26,739 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:26,741 - INFO - integration_test - Dyn residual k=0: pred=[21.057181569284268, 4.4464722089078546, 0.36964240971124596, 3.0000000208690722, 21.965456201522652], ws=[21.05718156733832, 4.446472208153892, 0.36964240971124607, 3.0, 22.15033979711255], res=[1.945949179571471e-09, 7.539622259855605e-10, -1.1102230246251565e-16, 2.0869072248075327e-08, -0.18488359558989842], res_norm=1.849e-01
2026-01-13 17:40:26,741 - INFO - integration_test - Dyn residual k=1: pred=[21.336918546186705, 4.554856813448085, 0.36964240971124607, 3.0, 22.45033979711255], ws=[21.336918546186705, 4.554856813448085, 0.36964240971124607, 3.0, 22.50711363072424], res=[0.0, 0.0, 0.0, 0.0, -0.05677383361168964], res_norm=5.677e-02
2026-01-13 17:40:26,742 - INFO - integration_test - Dyn residual k=2: pred=[21.616655525035092, 4.6632414187422775, 0.36964240971124607, 3.0, 22.807113630724242], ws=[21.616655525035092, 4.6632414187422775, 0.36964240971124607, 3.0, 22.71331696984796], res=[0.0, 0.0, 0.0, 0.0, 0.0937966608762828], res_norm=9.380e-02
2026-01-13 17:40:26,756 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:26,828 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:26,843 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:26,855 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:26,870 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:26,881 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:26,896 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:26,907 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:26,922 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:26,934 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:26,949 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:26,960 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:26,975 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:26,986 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:27,001 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:27,012 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:27,028 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:27,040 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:27,055 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:27,065 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:27,078 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:27,088 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:27,255 - INFO - integration_test - Step 212: MPC solve successful
2026-01-13 17:40:27,355 - INFO - integration_test - Step 212: Computed 6 numeric contouring constraints for visualization (s=22.120)
2026-01-13 17:40:27,356 - DEBUG - integration_test - Step 212: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:27,356 - INFO - integration_test - === Applying control at step 212 ===
2026-01-13 17:40:27,356 - INFO - integration_test -   Control dict from planner: {'a': -2.0000000195252605, 'w': 0.8000000098104681}
2026-01-13 17:40:27,356 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:27,356 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:27,357 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:27,357 - INFO - integration_test - Step 212 completed in 0.754s
2026-01-13 17:40:27,373 - INFO - integration_test - Step 213 (contouring until path end)
2026-01-13 17:40:27,375 - DEBUG - integration_test - Syncing planner state at step 213: vehicle_state=[21.04343311  4.45343613  0.44964241  2.80000002 22.40000166]
2026-01-13 17:40:27,375 - DEBUG - integration_test - Step 213: Using propagated spline 22.4000 (close to path, dist=0.555m, drift=0.591m)
2026-01-13 17:40:27,375 - DEBUG - integration_test -   Set spline state to 22.4000
2026-01-13 17:40:27,377 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:27,444 - DEBUG - integration_test - Step 213: Checking path alignment: vehicle=(21.043, 4.453), path_start=(0.000, 0.000), dist=21.510m
2026-01-13 17:40:27,444 - WARNING - integration_test - Step 213: Vehicle is far from path start (dist=21.510m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:27,444 - INFO - integration_test - === Calling planner.solve_mpc() at step 213 ===
2026-01-13 17:40:27,497 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:27,507 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:27,507 - INFO - integration_test - Warmstart k=0: x0=21.04343311257612 , y0=4.4534361295102824 , psi0=0.44964241069229277 , v0=2.8000000189165464 , spline0=22.046466302337503 , a0=0.0 , w0=0.0
2026-01-13 17:40:27,507 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:27,508 - INFO - integration_test - Dyn residual k=0: pred=[21.295601837744716, 4.575136314827203, 0.44964241069229277, 2.8000000189165464, 22.326466304229157], ws=[21.295601837744716, 4.575136314827203, 0.44964241069229294, 2.8000000189165464, 22.25372489222986], res=[0.0, 0.0, -1.6653345369377348e-16, 0.0, 0.07274141199929574], res_norm=7.274e-02
2026-01-13 17:40:27,509 - INFO - integration_test - Dyn residual k=1: pred=[21.54777056291331, 4.696836500144124, 0.44964241069229294, 2.8000000189165464, 22.533724894121516], ws=[21.54777056291331, 4.696836500144124, 0.44964241069229294, 2.8000000189165464, 22.607459169807292], res=[0.0, 0.0, 0.0, 0.0, -0.0737342756857764], res_norm=7.373e-02
2026-01-13 17:40:27,510 - INFO - integration_test - Dyn residual k=2: pred=[21.799939288081905, 4.818536685461044, 0.44964241069229294, 2.8000000189165464, 22.887459171698946], ws=[21.799939288081905, 4.818536685461044, 0.44964241069229294, 2.8000000189165464, 22.828200958161702], res=[0.0, 0.0, 0.0, 0.0, 0.059258213537244586], res_norm=5.926e-02
2026-01-13 17:40:27,524 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:27,597 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:27,612 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:27,623 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:27,638 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:27,650 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:27,665 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:27,677 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:27,692 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:27,705 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:27,720 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:27,731 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:27,746 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:27,758 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:27,773 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:27,785 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:27,801 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:27,813 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:27,829 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:27,839 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:27,852 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:27,862 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:28,029 - INFO - integration_test - Step 213: MPC solve successful
2026-01-13 17:40:28,124 - INFO - integration_test - Step 213: Computed 6 numeric contouring constraints for visualization (s=22.400)
2026-01-13 17:40:28,125 - DEBUG - integration_test - Step 213: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:28,125 - INFO - integration_test - === Applying control at step 213 ===
2026-01-13 17:40:28,125 - INFO - integration_test -   Control dict from planner: {'a': -2.000000014679814, 'w': 0.7999999992224884}
2026-01-13 17:40:28,125 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:28,125 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:28,126 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:28,127 - INFO - integration_test - Step 213 completed in 0.752s
2026-01-13 17:40:28,141 - INFO - integration_test - Step 214 (contouring until path end)
2026-01-13 17:40:28,143 - DEBUG - integration_test - Syncing planner state at step 214: vehicle_state=[21.28170757  4.58026843  0.52964241  2.60000002 22.66000166]
2026-01-13 17:40:28,145 - DEBUG - integration_test - Step 214: Using propagated spline 22.6600 (close to path, dist=0.539m, drift=0.246m)
2026-01-13 17:40:28,145 - DEBUG - integration_test -   Set spline state to 22.6600
2026-01-13 17:40:28,146 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:28,213 - DEBUG - integration_test - Step 214: Checking path alignment: vehicle=(21.282, 4.580), path_start=(0.000, 0.000), dist=21.769m
2026-01-13 17:40:28,213 - WARNING - integration_test - Step 214: Vehicle is far from path start (dist=21.769m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:28,213 - INFO - integration_test - === Calling planner.solve_mpc() at step 214 ===
2026-01-13 17:40:28,267 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:28,277 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:28,277 - INFO - integration_test - Warmstart k=0: x0=21.281707569008475 , y0=4.580268430316964 , psi0=0.5296424106145416 , v0=2.600000017448565 , spline0=22.50848650610256 , a0=0.0 , w0=0.0
2026-01-13 17:40:28,277 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:28,278 - INFO - integration_test - Dyn residual k=0: pred=[21.506084395577325, 4.711626873540906, 0.5296424106145416, 2.600000017448565, 22.768486507847417], ws=[21.506084395577325, 4.711626873540906, 0.5296424106145414, 2.600000017448565, 22.640364702689943], res=[0.0, 0.0, 2.220446049250313e-16, 0.0, 0.1281218051574733], res_norm=1.281e-01
2026-01-13 17:40:28,279 - INFO - integration_test - Dyn residual k=1: pred=[21.730461222146175, 4.842985316764849, 0.5296424106145414, 2.600000017448565, 22.9003647044348], ws=[21.730461222146175, 4.842985316764849, 0.5296424106145414, 2.600000017448565, 23.022967924936143], res=[0.0, 0.0, 0.0, 0.0, -0.1226032205013432], res_norm=1.226e-01
2026-01-13 17:40:28,280 - INFO - integration_test - Dyn residual k=2: pred=[21.954838048715025, 4.974343759988791, 0.5296424106145414, 2.600000017448565, 23.282967926681], ws=[21.954838048715025, 4.974343759988791, 0.5296424106145414, 2.600000017448565, 23.17323190271091], res=[0.0, 0.0, 0.0, 0.0, 0.10973602397008975], res_norm=1.097e-01
2026-01-13 17:40:28,296 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:28,367 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:28,383 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:28,395 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:28,410 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:28,421 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:28,436 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:28,448 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:28,463 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:28,474 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:28,490 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:28,501 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:28,516 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:28,528 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:28,543 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:28,555 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:28,570 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:28,581 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:28,597 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:28,607 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:28,620 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:28,630 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:28,809 - INFO - integration_test - Step 214: MPC solve successful
2026-01-13 17:40:28,909 - INFO - integration_test - Step 214: Computed 6 numeric contouring constraints for visualization (s=22.660)
2026-01-13 17:40:28,909 - DEBUG - integration_test - Step 214: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:28,909 - INFO - integration_test - === Applying control at step 214 ===
2026-01-13 17:40:28,910 - INFO - integration_test -   Control dict from planner: {'a': -2.0000000199882453, 'w': 0.8000000099402895}
2026-01-13 17:40:28,910 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:28,910 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:28,912 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:28,912 - INFO - integration_test - Step 214 completed in 0.769s
2026-01-13 17:40:28,928 - INFO - integration_test - Step 215 (contouring until path end)
2026-01-13 17:40:28,932 - DEBUG - integration_test - Syncing planner state at step 215: vehicle_state=[21.4922468   4.71495297  0.60964241  2.40000002 22.90000166]
2026-01-13 17:40:28,932 - DEBUG - integration_test - Step 215: Using propagated spline 22.9000 (close to path, dist=0.545m, drift=0.120m)
2026-01-13 17:40:28,933 - DEBUG - integration_test -   Set spline state to 22.9000
2026-01-13 17:40:28,934 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:29,012 - DEBUG - integration_test - Step 215: Checking path alignment: vehicle=(21.492, 4.715), path_start=(0.000, 0.000), dist=22.003m
2026-01-13 17:40:29,012 - WARNING - integration_test - Step 215: Vehicle is far from path start (dist=22.003m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:29,012 - INFO - integration_test - === Calling planner.solve_mpc() at step 215 ===
2026-01-13 17:40:29,068 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:29,078 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:29,078 - INFO - integration_test - Warmstart k=0: x0=21.492246801844765 , y0=4.714952971301929 , psi0=0.6096424116085706 , v0=2.4000000154497405 , spline0=22.647476406637434 , a0=0.0 , w0=0.0
2026-01-13 17:40:29,078 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:29,079 - INFO - integration_test - Dyn residual k=0: pred=[21.689011478997184, 4.852370810633988, 0.6096424116085706, 2.4000000154497405, 22.88747640818241], ws=[21.689011478997184, 4.852370810633988, 0.6096424116085704, 2.4000000154497405, 23.00305025974695], res=[0.0, 0.0, 2.220446049250313e-16, 0.0, -0.11557385156454103], res_norm=1.156e-01
2026-01-13 17:40:29,080 - INFO - integration_test - Dyn residual k=1: pred=[21.885776156149603, 4.989788649966047, 0.6096424116085704, 2.4000000154497405, 23.243050261291923], ws=[21.885776156149603, 4.989788649966047, 0.6096424116085704, 2.4000000154497405, 22.921918236548933], res=[0.0, 0.0, 0.0, 0.0, 0.3211320247429903], res_norm=3.211e-01
2026-01-13 17:40:29,081 - INFO - integration_test - Dyn residual k=2: pred=[22.082540833302023, 5.127206489298106, 0.6096424116085704, 2.4000000154497405, 23.161918238093907], ws=[22.082540833302023, 5.127206489298106, 0.6096424116085704, 2.4000000154497405, 23.28819490902412], res=[0.0, 0.0, 0.0, 0.0, -0.12627667093021344], res_norm=1.263e-01
2026-01-13 17:40:29,095 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:29,167 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:29,182 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:29,194 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:29,209 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:29,221 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:29,236 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:29,247 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:29,262 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:29,273 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:29,288 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:29,300 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:29,314 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:29,326 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:29,341 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:29,352 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:29,367 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:29,379 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:29,393 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:29,404 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:29,416 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:29,427 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:29,605 - INFO - integration_test - Step 215: MPC solve successful
2026-01-13 17:40:29,709 - INFO - integration_test - Step 215: Computed 6 numeric contouring constraints for visualization (s=22.900)
2026-01-13 17:40:29,709 - DEBUG - integration_test - Step 215: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:29,709 - INFO - integration_test - === Applying control at step 215 ===
2026-01-13 17:40:29,709 - INFO - integration_test -   Control dict from planner: {'a': -2.000000014103972, 'w': 0.7999999429146678}
2026-01-13 17:40:29,709 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:29,709 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:29,711 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:29,712 - INFO - integration_test - Step 215 completed in 0.780s
2026-01-13 17:40:29,725 - INFO - integration_test - Step 216 (contouring until path end)
2026-01-13 17:40:29,729 - DEBUG - integration_test - Syncing planner state at step 216: vehicle_state=[21.67542764  4.85393712  0.68964241  2.20000001 23.12000166]
2026-01-13 17:40:29,730 - DEBUG - integration_test - Step 216: Using propagated spline 23.1200 (close to path, dist=0.435m, drift=0.100m)
2026-01-13 17:40:29,730 - DEBUG - integration_test -   Set spline state to 23.1200
2026-01-13 17:40:29,731 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:29,799 - DEBUG - integration_test - Step 216: Checking path alignment: vehicle=(21.675, 4.854), path_start=(0.000, 0.000), dist=22.212m
2026-01-13 17:40:29,799 - WARNING - integration_test - Step 216: Vehicle is far from path start (dist=22.212m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:29,799 - INFO - integration_test - === Calling planner.solve_mpc() at step 216 ===
2026-01-13 17:40:29,851 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:29,861 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:29,862 - INFO - integration_test - Warmstart k=0: x0=21.675427637953963 , y0=4.853937121195224 , psi0=0.6896424059000373 , v0=2.200000014039343 , spline0=22.76646630703127 , a0=0.0 , w0=0.0
2026-01-13 17:40:29,862 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:29,863 - INFO - integration_test - Dyn residual k=0: pred=[21.84515182831391, 4.993914618759622, 0.6896424059000373, 2.200000014039343, 22.986466308435205], ws=[21.84515182831391, 4.993914618759622, 0.6896424059000372, 2.200000014039343, 23.137077342999348], res=[0.0, 0.0, 1.1102230246251565e-16, 0.0, -0.15061103456414315], res_norm=1.506e-01
2026-01-13 17:40:29,863 - INFO - integration_test - Dyn residual k=1: pred=[22.014876018673856, 5.13389211632402, 0.6896424059000372, 2.200000014039343, 23.357077344403283], ws=[22.014876018673856, 5.13389211632402, 0.6896424059000372, 2.200000014039343, 23.24211122634361], res=[0.0, 0.0, 0.0, 0.0, 0.11496611805967305], res_norm=1.150e-01
2026-01-13 17:40:29,864 - INFO - integration_test - Dyn residual k=2: pred=[22.184600209033803, 5.273869613888419, 0.6896424059000372, 2.200000014039343, 23.462111227747545], ws=[22.184600209033803, 5.273869613888419, 0.6896424059000372, 2.200000014039343, 23.41048810404245], res=[0.0, 0.0, 0.0, 0.0, 0.05162312370509525], res_norm=5.162e-02
2026-01-13 17:40:29,878 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:29,950 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:29,965 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:29,977 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:29,992 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:30,004 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:30,020 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:30,032 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:30,047 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:30,059 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:30,074 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:30,086 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:30,101 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:30,113 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:30,128 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:30,139 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:30,154 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:30,166 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:30,181 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:30,191 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:30,204 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:30,215 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:30,404 - INFO - integration_test - Step 216: MPC solve successful
2026-01-13 17:40:30,516 - INFO - integration_test - Step 216: Computed 6 numeric contouring constraints for visualization (s=23.120)
2026-01-13 17:40:30,516 - DEBUG - integration_test - Step 216: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:30,516 - INFO - integration_test - === Applying control at step 216 ===
2026-01-13 17:40:30,516 - INFO - integration_test -   Control dict from planner: {'a': -2.0000000199996673, 'w': 0.8000000099913632}
2026-01-13 17:40:30,516 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:30,517 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:30,518 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:30,518 - INFO - integration_test - Step 216 completed in 0.789s
2026-01-13 17:40:30,534 - INFO - integration_test - Step 217 (contouring until path end)
2026-01-13 17:40:30,535 - DEBUG - integration_test - Syncing planner state at step 217: vehicle_state=[21.83201145  4.99378709  0.76964241  2.00000001 23.32000166]
2026-01-13 17:40:30,536 - DEBUG - integration_test - Step 217: Using propagated spline 23.3200 (close to path, dist=0.411m, drift=0.300m)
2026-01-13 17:40:30,536 - DEBUG - integration_test -   Set spline state to 23.3200
2026-01-13 17:40:30,537 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:30,603 - DEBUG - integration_test - Step 217: Checking path alignment: vehicle=(21.832, 4.994), path_start=(0.000, 0.000), dist=22.396m
2026-01-13 17:40:30,603 - WARNING - integration_test - Step 217: Vehicle is far from path start (dist=22.396m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:30,603 - INFO - integration_test - === Calling planner.solve_mpc() at step 217 ===
2026-01-13 17:40:30,655 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:30,665 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:30,665 - INFO - integration_test - Warmstart k=0: x0=21.832011450922842 , y0=4.993787091170897 , psi0=0.7696424068991736 , v0=2.0000000120393766 , spline0=22.865456207225108 , a0=0.0 , w0=0.0
2026-01-13 17:40:30,665 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:30,666 - INFO - integration_test - Dyn residual k=0: pred=[21.975643363160177, 5.132962786853087, 0.7696424068991736, 2.0000000120393766, 23.065456208429048], ws=[21.975643363160177, 5.132962786853087, 0.7696424068991736, 2.0000000120393766, 23.249167260155787], res=[0.0, 0.0, 0.0, 0.0, -0.18371105172673907], res_norm=1.837e-01
2026-01-13 17:40:30,667 - INFO - integration_test - Dyn residual k=1: pred=[22.119275275397513, 5.272138482535277, 0.7696424068991736, 2.0000000120393766, 23.449167261359726], ws=[22.119275275397513, 5.272138482535277, 0.7696424068991736, 2.0000000120393766, 23.368946773051604], res=[0.0, 0.0, 0.0, 0.0, 0.08022048830812167], res_norm=8.022e-02
2026-01-13 17:40:30,667 - INFO - integration_test - Dyn residual k=2: pred=[22.26290718763485, 5.4113141782174665, 0.7696424068991736, 2.0000000120393766, 23.568946774255544], ws=[22.26290718763485, 5.4113141782174665, 0.7696424068991736, 2.0000000120393766, 23.451562260463398], res=[0.0, 0.0, 0.0, 0.0, 0.1173845137921461], res_norm=1.174e-01
2026-01-13 17:40:30,681 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:30,754 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:30,769 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:30,781 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:30,796 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:30,808 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:30,823 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:30,835 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:30,849 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:30,861 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:30,876 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:30,887 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:30,902 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:30,914 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:30,929 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:30,941 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:30,956 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:30,968 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:30,983 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:30,993 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:31,006 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:31,016 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:31,318 - INFO - integration_test - Step 217: MPC solve successful
2026-01-13 17:40:31,434 - INFO - integration_test - Step 217: Computed 6 numeric contouring constraints for visualization (s=23.320)
2026-01-13 17:40:31,435 - DEBUG - integration_test - Step 217: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:31,435 - INFO - integration_test - === Applying control at step 217 ===
2026-01-13 17:40:31,435 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000199695536, 'w': 0.8000000098935375}
2026-01-13 17:40:31,435 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:31,435 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:31,436 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:31,436 - INFO - integration_test - Step 217 completed in 0.901s
2026-01-13 17:40:31,453 - INFO - integration_test - Step 218 (contouring until path end)
2026-01-13 17:40:31,455 - DEBUG - integration_test - Syncing planner state at step 218: vehicle_state=[21.97672537  5.14588701  0.84964241  2.20000001 23.54000166]
2026-01-13 17:40:31,455 - DEBUG - integration_test - Step 218: Using propagated spline 23.5400 (close to path, dist=0.389m, drift=0.086m)
2026-01-13 17:40:31,456 - DEBUG - integration_test -   Set spline state to 23.5400
2026-01-13 17:40:31,457 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:31,523 - DEBUG - integration_test - Step 218: Checking path alignment: vehicle=(21.977, 5.146), path_start=(0.000, 0.000), dist=22.571m
2026-01-13 17:40:31,523 - WARNING - integration_test - Step 218: Vehicle is far from path start (dist=22.571m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:31,523 - INFO - integration_test - === Calling planner.solve_mpc() at step 218 ===
2026-01-13 17:40:31,577 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:31,587 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:31,587 - INFO - integration_test - Warmstart k=0: x0=21.976725369160196 , y0=5.145887013769184 , psi0=0.8496424078885274 , v0=2.200000014036332 , spline0=22.984446107618638 , a0=0.0 , w0=0.0
2026-01-13 17:40:31,587 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:31,588 - INFO - integration_test - Dyn residual k=0: pred=[22.12198075632531, 5.311116772339218, 0.8496424078885274, 2.200000014036332, 23.20444610902227], ws=[22.12198075632531, 5.311116772339218, 0.8496424078885276, 2.200000014036332, 23.631937232261816], res=[0.0, 0.0, -2.220446049250313e-16, 0.0, -0.42749112323954463], res_norm=4.275e-01
2026-01-13 17:40:31,589 - INFO - integration_test - Dyn residual k=1: pred=[22.267236143490425, 5.476346530909251, 0.8496424078885276, 2.200000014036332, 23.85193723366545], ws=[22.267236143490425, 5.476346530909251, 0.8496424078885276, 2.200000014036332, 23.741707011547163], res=[0.0, 0.0, 0.0, 0.0, 0.11023022211828604], res_norm=1.102e-01
2026-01-13 17:40:31,590 - INFO - integration_test - Dyn residual k=2: pred=[22.41249153065554, 5.641576289479285, 0.8496424078885276, 2.200000014036332, 23.961707012950797], ws=[22.41249153065554, 5.641576289479285, 0.8496424078885276, 2.200000014036332, 23.588412312957097], res=[0.0, 0.0, 0.0, 0.0, 0.3732946999936999], res_norm=3.733e-01
2026-01-13 17:40:31,603 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:31,674 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:31,691 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:31,703 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:31,719 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:31,731 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:31,746 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:31,758 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:31,773 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:31,784 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:31,799 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:31,811 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:31,825 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:31,837 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:31,852 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:31,864 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:31,879 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:31,890 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:31,905 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:31,915 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:31,928 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:31,938 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:32,277 - INFO - integration_test - Step 218: MPC solve successful
2026-01-13 17:40:32,396 - INFO - integration_test - Step 218: Computed 6 numeric contouring constraints for visualization (s=23.540)
2026-01-13 17:40:32,396 - DEBUG - integration_test - Step 218: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:32,396 - INFO - integration_test - === Applying control at step 218 ===
2026-01-13 17:40:32,396 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000198095345, 'w': -0.13997056325949012}
2026-01-13 17:40:32,396 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:32,396 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:32,397 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:32,397 - INFO - integration_test - Step 218 completed in 0.943s
2026-01-13 17:40:32,413 - INFO - integration_test - Step 219 (contouring until path end)
2026-01-13 17:40:32,416 - DEBUG - integration_test - Syncing planner state at step 219: vehicle_state=[22.12980464  5.31754329  0.83564535  2.40000002 23.78000166]
2026-01-13 17:40:32,417 - DEBUG - integration_test - Step 219: Using propagated spline 23.7800 (close to path, dist=0.221m, drift=0.154m)
2026-01-13 17:40:32,417 - DEBUG - integration_test -   Set spline state to 23.7800
2026-01-13 17:40:32,418 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:32,485 - DEBUG - integration_test - Step 219: Checking path alignment: vehicle=(22.130, 5.318), path_start=(0.000, 0.000), dist=22.760m
2026-01-13 17:40:32,485 - WARNING - integration_test - Step 219: Vehicle is far from path start (dist=22.760m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:32,485 - INFO - integration_test - === Calling planner.solve_mpc() at step 219 ===
2026-01-13 17:40:32,538 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:32,547 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:32,548 - INFO - integration_test - Warmstart k=0: x0=22.129804635141863 , y0=5.3175432862994025 , psi0=0.8356453515625784 , v0=2.400000016017285 , spline0=23.62848651326077 , a0=0.0 , w0=0.0
2026-01-13 17:40:32,548 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:32,549 - INFO - integration_test - Dyn residual k=0: pred=[22.29077243127181, 5.495558368182643, 0.8356453515625784, 2.400000016017285, 23.8684865148625], ws=[22.29077243127181, 5.495558368182644, 0.8356453515625786, 2.400000016017285, 23.736582256118613], res=[0.0, -8.881784197001252e-16, -2.220446049250313e-16, 0.0, 0.13190425874388723], res_norm=1.319e-01
2026-01-13 17:40:32,550 - INFO - integration_test - Dyn residual k=1: pred=[22.45174022740176, 5.673573450065886, 0.8356453515625786, 2.400000016017285, 23.97658225772034], ws=[22.45174022740176, 5.673573450065886, 0.8356453515625786, 2.400000016017285, 23.884872616489695], res=[0.0, 0.0, 0.0, 0.0, 0.09170964123064707], res_norm=9.171e-02
2026-01-13 17:40:32,550 - INFO - integration_test - Dyn residual k=2: pred=[22.61270802353171, 5.851588531949128, 0.8356453515625786, 2.400000016017285, 24.124872618091423], ws=[22.61270802353171, 5.851588531949128, 0.8356453515625786, 2.400000016017285, 24.270254546818542], res=[0.0, 0.0, 0.0, 0.0, -0.14538192872711875], res_norm=1.454e-01
2026-01-13 17:40:32,564 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:32,636 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:32,652 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:32,663 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:32,679 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:32,691 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:32,707 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:32,719 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:32,734 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:32,746 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:32,760 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:32,772 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:32,787 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:32,798 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:32,813 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:32,825 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:32,840 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:32,852 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:32,867 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:32,878 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:32,891 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:32,901 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:33,186 - INFO - integration_test - Step 219: MPC solve successful
2026-01-13 17:40:33,297 - INFO - integration_test - Step 219: Computed 6 numeric contouring constraints for visualization (s=23.780)
2026-01-13 17:40:33,298 - DEBUG - integration_test - Step 219: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:33,298 - INFO - integration_test - === Applying control at step 219 ===
2026-01-13 17:40:33,298 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000199972714, 'w': -0.1446712466638907}
2026-01-13 17:40:33,298 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:33,298 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:33,299 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:33,299 - INFO - integration_test - Step 219 completed in 0.884s
2026-01-13 17:40:33,316 - INFO - integration_test - Step 220 (contouring until path end)
2026-01-13 17:40:33,318 - DEBUG - integration_test - Syncing planner state at step 220: vehicle_state=[22.29883265  5.50174003  0.82117823  2.60000002 24.04000167]
2026-01-13 17:40:33,318 - DEBUG - integration_test - Step 220: Using propagated spline 24.0400 (close to path, dist=0.244m, drift=0.414m)
2026-01-13 17:40:33,318 - DEBUG - integration_test -   Set spline state to 24.0400
2026-01-13 17:40:33,319 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:33,387 - DEBUG - integration_test - Step 220: Checking path alignment: vehicle=(22.299, 5.502), path_start=(0.000, 0.000), dist=22.968m
2026-01-13 17:40:33,387 - WARNING - integration_test - Step 220: Vehicle is far from path start (dist=22.968m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:33,387 - INFO - integration_test - === Calling planner.solve_mpc() at step 220 ===
2026-01-13 17:40:33,441 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:33,451 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:33,451 - INFO - integration_test - Warmstart k=0: x0=22.29883265402216 , y0=5.501740029438243 , psi0=0.8211782268961892 , v0=2.6000000180170124 , spline0=23.484446111022066 , a0=0.0 , w0=0.0
2026-01-13 17:40:33,451 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:33,452 - INFO - integration_test - Dyn residual k=0: pred=[22.475986067599777, 5.692046805446568, 0.8211782268961892, 2.6000000180170124, 23.744446112823766], ws=[22.475986067599777, 5.692046805446568, 0.8211782268961891, 2.6000000180170124, 23.859726811375637], res=[0.0, 0.0, 1.1102230246251565e-16, 0.0, -0.11528069855187084], res_norm=1.153e-01
2026-01-13 17:40:33,453 - INFO - integration_test - Dyn residual k=1: pred=[22.653139481177394, 5.882353581454892, 0.8211782268961891, 2.6000000180170124, 24.119726813177337], ws=[22.653139481177394, 5.882353581454892, 0.8211782268961891, 2.6000000180170124, 24.071474156444882], res=[0.0, 0.0, 0.0, 0.0, 0.048252656732454824], res_norm=4.825e-02
2026-01-13 17:40:33,454 - INFO - integration_test - Dyn residual k=2: pred=[22.83029289475501, 6.072660357463217, 0.8211782268961891, 2.6000000180170124, 24.331474158246582], ws=[22.83029289475501, 6.072660357463217, 0.8211782268961891, 2.6000000180170124, 24.48301249155952], res=[0.0, 0.0, 0.0, 0.0, -0.15153833331293853], res_norm=1.515e-01
2026-01-13 17:40:33,468 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:33,539 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:33,554 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:33,566 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:33,581 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:33,593 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:33,608 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:33,620 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:33,635 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:33,647 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:33,661 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:33,673 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:33,688 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:33,700 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:33,715 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:33,728 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:33,744 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:33,756 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:33,771 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:33,782 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:33,795 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:33,805 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:34,139 - INFO - integration_test - Step 220: MPC solve successful
2026-01-13 17:40:34,256 - INFO - integration_test - Step 220: Computed 6 numeric contouring constraints for visualization (s=24.040)
2026-01-13 17:40:34,257 - DEBUG - integration_test - Step 220: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:34,257 - INFO - integration_test - === Applying control at step 220 ===
2026-01-13 17:40:34,257 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000199979158, 'w': -0.1437950130742446}
2026-01-13 17:40:34,257 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:34,257 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:34,258 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:34,258 - INFO - integration_test - Step 220 completed in 0.941s
2026-01-13 17:40:34,273 - INFO - integration_test - Step 221 (contouring until path end)
2026-01-13 17:40:34,276 - DEBUG - integration_test - Syncing planner state at step 221: vehicle_state=[22.4842316   5.69802038  0.80679873  2.80000002 24.32000167]
2026-01-13 17:40:34,276 - DEBUG - integration_test - Step 221: Using propagated spline 24.3200 (close to path, dist=0.461m, drift=0.694m)
2026-01-13 17:40:34,276 - DEBUG - integration_test -   Set spline state to 24.3200
2026-01-13 17:40:34,278 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:34,345 - DEBUG - integration_test - Step 221: Checking path alignment: vehicle=(22.484, 5.698), path_start=(0.000, 0.000), dist=23.195m
2026-01-13 17:40:34,345 - WARNING - integration_test - Step 221: Vehicle is far from path start (dist=23.195m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:34,345 - INFO - integration_test - === Calling planner.solve_mpc() at step 221 ===
2026-01-13 17:40:34,398 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:34,407 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:34,407 - INFO - integration_test - Warmstart k=0: x0=22.48423160357627 , y0=5.6980203773801605 , psi0=0.8067987255887648 , v0=2.800000020016804 , spline0=23.86545621403385 , a0=0.0 , w0=0.0
2026-01-13 17:40:34,407 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:34,409 - INFO - integration_test - Dyn residual k=0: pred=[22.677939395586435, 5.900201712907176, 0.8067987255887648, 2.800000020016804, 24.14545621603553], ws=[22.677939395586435, 5.900201712907176, 0.8067987255887648, 2.800000020016804, 24.31494620550296], res=[0.0, 0.0, 0.0, 0.0, -0.16948998946742933], res_norm=1.695e-01
2026-01-13 17:40:34,410 - INFO - integration_test - Dyn residual k=1: pred=[22.8716471875966, 6.102383048434191, 0.8067987255887648, 2.800000020016804, 24.59494620750464], ws=[22.8716471875966, 6.102383048434191, 0.8067987255887648, 2.800000020016804, 24.238850107652304], res=[0.0, 0.0, 0.0, 0.0, 0.35609609985233703], res_norm=3.561e-01
2026-01-13 17:40:34,411 - INFO - integration_test - Dyn residual k=2: pred=[23.065354979606767, 6.304564383961207, 0.8067987255887648, 2.800000020016804, 24.518850109653986], ws=[23.065354979606767, 6.304564383961207, 0.8067987255887648, 2.800000020016804, 24.911213671144107], res=[0.0, 0.0, 0.0, 0.0, -0.3923635614901215], res_norm=3.924e-01
2026-01-13 17:40:34,424 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:34,495 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:34,511 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:34,523 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:34,539 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:34,551 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:34,566 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:34,578 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:34,593 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:34,606 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:34,621 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:34,632 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:34,648 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:34,660 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:34,675 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:34,687 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:34,702 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:34,714 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:34,729 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:34,739 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:34,752 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:34,763 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:34,994 - INFO - integration_test - Step 221: MPC solve successful
2026-01-13 17:40:35,108 - INFO - integration_test - Step 221: Computed 6 numeric contouring constraints for visualization (s=24.320)
2026-01-13 17:40:35,108 - DEBUG - integration_test - Step 221: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:35,108 - INFO - integration_test - === Applying control at step 221 ===
2026-01-13 17:40:35,109 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000199969117, 'w': -0.1412734996274165}
2026-01-13 17:40:35,109 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:35,109 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:35,110 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:35,111 - INFO - integration_test - Step 221 completed in 0.835s
2026-01-13 17:40:35,125 - INFO - integration_test - Step 222 (contouring until path end)
2026-01-13 17:40:35,129 - DEBUG - integration_test - Syncing planner state at step 222: vehicle_state=[22.68634687  5.90598197  0.79267138  3.00000002 24.62000167]
2026-01-13 17:40:35,129 - DEBUG - integration_test - Step 222: Using propagated spline 24.6200 (close to path, dist=0.230m, drift=0.388m)
2026-01-13 17:40:35,129 - DEBUG - integration_test -   Set spline state to 24.6200
2026-01-13 17:40:35,130 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:35,197 - DEBUG - integration_test - Step 222: Checking path alignment: vehicle=(22.686, 5.906), path_start=(0.000, 0.000), dist=23.443m
2026-01-13 17:40:35,197 - WARNING - integration_test - Step 222: Vehicle is far from path start (dist=23.443m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:35,197 - INFO - integration_test - === Calling planner.solve_mpc() at step 222 ===
2026-01-13 17:40:35,250 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:35,261 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:35,261 - INFO - integration_test - Warmstart k=0: x0=22.686346867386916 , y0=5.905981968022309 , psi0=0.7926713756260231 , v0=3.0000000220164953 , spline0=24.0644461152254 , a0=0.0 , w0=0.0
2026-01-13 17:40:35,261 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:35,262 - INFO - integration_test - Dyn residual k=0: pred=[22.896930424758047, 6.119651260822913, 0.7926713756260231, 3.0000000220164953, 24.36444611742705], ws=[22.89693042321261, 6.11965125925483, 0.7926713756260231, 3.0, 24.51848463419774], res=[1.5454375557055755e-09, 1.56808255269425e-09, 0.0, 2.2016495293541993e-08, -0.15403851677069014], res_norm=1.540e-01
2026-01-13 17:40:35,263 - INFO - integration_test - Dyn residual k=1: pred=[23.107513979038302, 6.333320550487351, 0.7926713756260231, 3.0, 24.81848463419774], ws=[23.107513979038302, 6.333320550487351, 0.7926713756260231, 3.0, 24.91448722178597], res=[0.0, 0.0, 0.0, 0.0, -0.09600258758822733], res_norm=9.600e-02
2026-01-13 17:40:35,264 - INFO - integration_test - Dyn residual k=2: pred=[23.318097534863995, 6.546989841719872, 0.7926713756260231, 3.0, 25.21448722178597], ws=[23.318097534863995, 6.546989841719872, 0.7926713756260231, 3.0, 25.136972706470708], res=[0.0, 0.0, 0.0, 0.0, 0.07751451531526143], res_norm=7.751e-02
2026-01-13 17:40:35,278 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:35,352 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:35,368 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:35,380 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:35,396 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:35,408 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:35,423 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:35,435 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:35,449 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:35,461 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:35,476 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:35,488 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:35,502 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:35,514 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:35,529 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:35,540 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:35,555 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:35,567 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:35,582 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:35,592 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:35,607 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:35,618 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:35,974 - INFO - integration_test - Step 222: MPC solve successful
2026-01-13 17:40:36,091 - INFO - integration_test - Step 222: Computed 6 numeric contouring constraints for visualization (s=24.620)
2026-01-13 17:40:36,091 - DEBUG - integration_test - Step 222: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:36,091 - INFO - integration_test - === Applying control at step 222 ===
2026-01-13 17:40:36,091 - INFO - integration_test -   Control dict from planner: {'a': 7.983241333000885e-08, 'w': -0.13552479353765795}
2026-01-13 17:40:36,091 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:36,091 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:36,092 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:36,093 - INFO - integration_test - Step 222 completed in 0.964s
2026-01-13 17:40:36,108 - INFO - integration_test - Step 223 (contouring until path end)
2026-01-13 17:40:36,111 - DEBUG - integration_test - Syncing planner state at step 223: vehicle_state=[22.89837183  6.11821778  0.7791189   3.00000003 24.92000167]
2026-01-13 17:40:36,112 - DEBUG - integration_test - Step 223: Using propagated spline 24.9200 (close to path, dist=0.119m, drift=0.688m)
2026-01-13 17:40:36,112 - DEBUG - integration_test -   Set spline state to 24.9200
2026-01-13 17:40:36,113 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:36,180 - DEBUG - integration_test - Step 223: Checking path alignment: vehicle=(22.898, 6.118), path_start=(0.000, 0.000), dist=23.702m
2026-01-13 17:40:36,180 - WARNING - integration_test - Step 223: Vehicle is far from path start (dist=23.702m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:36,180 - INFO - integration_test - === Calling planner.solve_mpc() at step 223 ===
2026-01-13 17:40:36,234 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:36,244 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:36,244 - INFO - integration_test - Warmstart k=0: x0=22.898371830978313 , y0=6.118217777588808 , psi0=0.7791188962722573 , v0=3.0000000299997365 , spline0=24.555443077093617 , a0=0.0 , w0=0.0
2026-01-13 17:40:36,244 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:36,246 - INFO - integration_test - Dyn residual k=0: pred=[23.111831710340905, 6.329013607012667, 0.7791188962722573, 3.0000000299997365, 24.85544308009359], ws=[23.111831708206324, 6.329013604904727, 0.7791188962722573, 3.0, 24.939122051779254], res=[2.1345805123473838e-09, 2.1079396006484785e-09, 0.0, 2.999973647277443e-08, -0.0836789716856643], res_norm=8.368e-02
2026-01-13 17:40:36,247 - INFO - integration_test - Dyn residual k=1: pred=[23.325291585434336, 6.539809432220646, 0.7791188962722573, 3.0, 25.239122051779255], ws=[23.325291585434336, 6.539809432220646, 0.7791188962722573, 3.0, 24.873048622112314], res=[0.0, 0.0, 0.0, 0.0, 0.36607342966694034], res_norm=3.661e-01
2026-01-13 17:40:36,248 - INFO - integration_test - Dyn residual k=2: pred=[23.538751462662347, 6.750605259536565, 0.7791188962722573, 3.0, 25.173048622112315], ws=[23.538751462662347, 6.750605259536565, 0.7791188962722573, 3.0, 25.338338875925018], res=[0.0, 0.0, 0.0, 0.0, -0.16529025381270301], res_norm=1.653e-01
2026-01-13 17:40:36,264 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:36,339 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:36,354 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:36,366 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:36,381 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:36,393 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:36,408 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:36,420 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:36,435 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:36,447 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:36,462 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:36,473 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:36,488 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:36,500 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:36,515 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:36,526 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:36,541 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:36,553 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:36,568 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:36,579 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:36,591 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:36,602 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:36,975 - INFO - integration_test - Step 223: MPC solve successful
2026-01-13 17:40:37,095 - INFO - integration_test - Step 223: Computed 6 numeric contouring constraints for visualization (s=24.920)
2026-01-13 17:40:37,095 - DEBUG - integration_test - Step 223: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:37,095 - INFO - integration_test - === Applying control at step 223 ===
2026-01-13 17:40:37,095 - INFO - integration_test -   Control dict from planner: {'a': -3.955921205207387e-13, 'w': -0.12635587708946197}
2026-01-13 17:40:37,095 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:37,095 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:37,096 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:37,097 - INFO - integration_test - Step 223 completed in 0.986s
2026-01-13 17:40:37,113 - INFO - integration_test - Step 224 (contouring until path end)
2026-01-13 17:40:37,116 - DEBUG - integration_test - Syncing planner state at step 224: vehicle_state=[23.11315778  6.32765942  0.76648331  3.00000003 25.22000168]
2026-01-13 17:40:37,117 - DEBUG - integration_test - Step 224: Using propagated spline 25.2200 (close to path, dist=0.270m, drift=0.382m)
2026-01-13 17:40:37,117 - DEBUG - integration_test -   Set spline state to 25.2200
2026-01-13 17:40:37,117 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:37,184 - DEBUG - integration_test - Step 224: Checking path alignment: vehicle=(23.113, 6.328), path_start=(0.000, 0.000), dist=23.964m
2026-01-13 17:40:37,184 - WARNING - integration_test - Step 224: Vehicle is far from path start (dist=23.964m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:37,185 - INFO - integration_test - === Calling planner.solve_mpc() at step 224 ===
2026-01-13 17:40:37,237 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:37,247 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:37,248 - INFO - integration_test - Warmstart k=0: x0=23.11315777716604 , y0=6.327659420278583 , psi0=0.766483308563311 , v0=3.000000029999697 , spline0=24.713018836245116 , a0=0.0 , w0=0.0
2026-01-13 17:40:37,248 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:37,249 - INFO - integration_test - Dyn residual k=0: pred=[23.329264074774716, 6.535741303040759, 0.766483308563311, 3.000000029999697, 25.013018839245085], ws=[23.329264072613675, 6.535741300959962, 0.7664833085633109, 3.0, 25.11089096714384], res=[2.16104112382709e-09, 2.0807977563208624e-09, 1.1102230246251565e-16, 2.999969694883475e-08, -0.09787212789875355], res_norm=9.787e-02
2026-01-13 17:40:37,250 - INFO - integration_test - Dyn residual k=1: pred=[23.54537036806131, 6.74382318164134, 0.7664833085633109, 3.0, 25.41089096714384], ws=[23.54537036806131, 6.74382318164134, 0.7664833085633109, 3.0, 25.30448267801031], res=[0.0, 0.0, 0.0, 0.0, 0.10640828913352962], res_norm=1.064e-01
2026-01-13 17:40:37,251 - INFO - integration_test - Dyn residual k=2: pred=[23.761476663508944, 6.9519050623227185, 0.7664833085633109, 3.0, 25.60448267801031], ws=[23.761476663508944, 6.9519050623227185, 0.7664833085633109, 3.0, 25.51714928466661], res=[0.0, 0.0, 0.0, 0.0, 0.08733339334370172], res_norm=8.733e-02
2026-01-13 17:40:37,265 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:37,339 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:37,356 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:37,367 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:37,383 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:37,395 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:37,410 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:37,421 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:37,436 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:37,448 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:37,462 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:37,474 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:37,491 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:37,503 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:37,518 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:37,530 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:37,547 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:37,559 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:37,574 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:37,585 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:37,598 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:37,608 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:38,196 - INFO - integration_test - Step 224: MPC solve successful
2026-01-13 17:40:38,308 - INFO - integration_test - Step 224: Computed 6 numeric contouring constraints for visualization (s=25.220)
2026-01-13 17:40:38,308 - DEBUG - integration_test - Step 224: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:38,308 - INFO - integration_test - === Applying control at step 224 ===
2026-01-13 17:40:38,308 - INFO - integration_test -   Control dict from planner: {'a': -9.164190012166872e-15, 'w': -0.11616180948431899}
2026-01-13 17:40:38,309 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:38,309 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:38,310 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:38,311 - INFO - integration_test - Step 224 completed in 1.195s
2026-01-13 17:40:38,325 - INFO - integration_test - Step 225 (contouring until path end)
2026-01-13 17:40:38,329 - DEBUG - integration_test - Syncing planner state at step 225: vehicle_state=[23.33046776  6.53448147  0.75486713  3.00000003 25.52000168]
2026-01-13 17:40:38,330 - DEBUG - integration_test - Step 225: Using propagated spline 25.5200 (close to path, dist=0.238m, drift=0.682m)
2026-01-13 17:40:38,330 - DEBUG - integration_test -   Set spline state to 25.5200
2026-01-13 17:40:38,331 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:38,398 - DEBUG - integration_test - Step 225: Checking path alignment: vehicle=(23.330, 6.534), path_start=(0.000, 0.000), dist=24.228m
2026-01-13 17:40:38,398 - WARNING - integration_test - Step 225: Vehicle is far from path start (dist=24.228m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:38,398 - INFO - integration_test - === Calling planner.solve_mpc() at step 225 ===
2026-01-13 17:40:38,451 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:38,461 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:38,461 - INFO - integration_test - Warmstart k=0: x0=23.330467759545957 , y0=6.534481472647867 , psi0=0.7548671276148792 , v0=3.000000029999696 , spline0=24.870594595396614 , a0=0.0 , w0=0.0
2026-01-13 17:40:38,461 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:38,462 - INFO - integration_test - Dyn residual k=0: pred=[23.548976539539066, 6.740039043332834, 0.7548671276148792, 3.000000029999696, 25.170594598396583], ws=[23.548976537354, 6.740039041277279, 0.7548671276148791, 3.0, 25.546421623842164], res=[2.185064573723139e-09, 2.055554837454565e-09, 1.1102230246251565e-16, 2.9999696060656333e-08, -0.3758270254455809], res_norm=3.758e-01
2026-01-13 17:40:38,463 - INFO - integration_test - Dyn residual k=1: pred=[23.767485315162045, 6.945596609906691, 0.7548671276148791, 3.0, 25.846421623842165], ws=[23.767485315162045, 6.945596609906691, 0.7548671276148791, 3.0, 25.74793339731465], res=[0.0, 0.0, 0.0, 0.0, 0.09848822652751466], res_norm=9.849e-02
2026-01-13 17:40:38,464 - INFO - integration_test - Dyn residual k=2: pred=[23.98599409297009, 7.151154178536102, 0.7548671276148791, 3.0, 26.04793339731465], ws=[23.98599409297009, 7.151154178536102, 0.7548671276148791, 3.0, 25.937511770658062], res=[0.0, 0.0, 0.0, 0.0, 0.1104216266565885], res_norm=1.104e-01
2026-01-13 17:40:38,478 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:38,550 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:38,566 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:38,579 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:38,594 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:38,606 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:38,621 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:38,632 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:38,647 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:38,659 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:38,674 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:38,686 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:38,701 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:38,713 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:38,728 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:38,740 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:38,755 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:38,767 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:38,782 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:38,792 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:38,805 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:38,815 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:39,003 - INFO - integration_test - Step 225: MPC solve successful
2026-01-13 17:40:39,116 - INFO - integration_test - Step 225: Computed 6 numeric contouring constraints for visualization (s=25.520)
2026-01-13 17:40:39,116 - DEBUG - integration_test - Step 225: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:39,116 - INFO - integration_test - === Applying control at step 225 ===
2026-01-13 17:40:39,116 - INFO - integration_test -   Control dict from planner: {'a': 4.503771587979951e-14, 'w': -0.104243727516351}
2026-01-13 17:40:39,117 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:39,117 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:39,118 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:39,118 - INFO - integration_test - Step 225 completed in 0.789s
2026-01-13 17:40:39,136 - INFO - integration_test - Step 226 (contouring until path end)
2026-01-13 17:40:39,138 - DEBUG - integration_test - Syncing planner state at step 226: vehicle_state=[23.55004398  6.73889642  0.74444275  3.00000003 25.82000168]
2026-01-13 17:40:39,139 - DEBUG - integration_test - Step 226: Using propagated spline 25.8200 (close to path, dist=0.329m, drift=0.377m)
2026-01-13 17:40:39,139 - DEBUG - integration_test -   Set spline state to 25.8200
2026-01-13 17:40:39,140 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:39,208 - DEBUG - integration_test - Step 226: Checking path alignment: vehicle=(23.550, 6.739), path_start=(0.000, 0.000), dist=24.495m
2026-01-13 17:40:39,208 - WARNING - integration_test - Step 226: Vehicle is far from path start (dist=24.495m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:39,208 - INFO - integration_test - === Calling planner.solve_mpc() at step 226 ===
2026-01-13 17:40:39,262 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:39,271 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:39,272 - INFO - integration_test - Warmstart k=0: x0=23.55004397675977 , y0=6.738896422275147 , psi0=0.7444427548632441 , v0=3.0000000299997005 , spline0=25.56538337647585 , a0=0.0 , w0=0.0
2026-01-13 17:40:39,272 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:39,273 - INFO - integration_test - Dyn residual k=0: pred=[23.77068365438379, 6.942165048624492, 0.7444427548632441, 3.0000000299997005, 25.86538337947582], ws=[23.770683652177418, 6.9421650465918265, 0.7444427548632442, 3.0, 25.751480935700656], res=[2.2063737503685843e-09, 2.032665591400473e-09, -1.1102230246251565e-16, 2.999970050154843e-08, 0.11390244377516368], res_norm=1.139e-01
2026-01-13 17:40:39,273 - INFO - integration_test - Dyn residual k=1: pred=[23.991323327595065, 7.145433670908506, 0.7444427548632442, 3.0, 26.051480935700656], ws=[23.991323327595065, 7.145433670908506, 0.7444427548632442, 3.0, 25.925185617450573], res=[0.0, 0.0, 0.0, 0.0, 0.126295318250083], res_norm=1.263e-01
2026-01-13 17:40:39,274 - INFO - integration_test - Dyn residual k=2: pred=[24.211963003012713, 7.348702295225186, 0.7444427548632442, 3.0, 26.225185617450574], ws=[24.211963003012713, 7.348702295225186, 0.7444427548632442, 3.0, 26.347719137549557], res=[0.0, 0.0, 0.0, 0.0, -0.12253352009898322], res_norm=1.225e-01
2026-01-13 17:40:39,289 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:39,360 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:39,376 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:39,388 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:39,403 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:39,415 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:39,430 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:39,441 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:39,456 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:39,468 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:39,483 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:39,494 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:39,509 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:39,521 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:39,536 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:39,548 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:39,564 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:39,575 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:39,590 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:39,601 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:39,614 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:39,624 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:40,305 - INFO - integration_test - Step 226: MPC solve successful
2026-01-13 17:40:40,429 - INFO - integration_test - Step 226: Computed 6 numeric contouring constraints for visualization (s=25.820)
2026-01-13 17:40:40,429 - DEBUG - integration_test - Step 226: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:40,429 - INFO - integration_test - === Applying control at step 226 ===
2026-01-13 17:40:40,429 - INFO - integration_test -   Control dict from planner: {'a': 2.853842852124041e-13, 'w': -0.09088371763000772}
2026-01-13 17:40:40,429 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:40,429 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:40,430 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:40,431 - INFO - integration_test - Step 226 completed in 1.293s
2026-01-13 17:40:40,446 - INFO - integration_test - Step 227 (contouring until path end)
2026-01-13 17:40:40,449 - DEBUG - integration_test - Syncing planner state at step 227: vehicle_state=[23.7716043   6.94115963  0.73535438  3.00000003 26.12000169]
2026-01-13 17:40:40,450 - DEBUG - integration_test - Step 227: Using propagated spline 26.1200 (close to path, dist=0.337m, drift=0.677m)
2026-01-13 17:40:40,450 - DEBUG - integration_test -   Set spline state to 26.1200
2026-01-13 17:40:40,451 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:40,517 - DEBUG - integration_test - Step 227: Checking path alignment: vehicle=(23.772, 6.941), path_start=(0.000, 0.000), dist=24.764m
2026-01-13 17:40:40,517 - WARNING - integration_test - Step 227: Vehicle is far from path start (dist=24.764m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:40,517 - INFO - integration_test - === Calling planner.solve_mpc() at step 227 ===
2026-01-13 17:40:40,570 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:40,580 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:40,580 - INFO - integration_test - Warmstart k=0: x0=23.77160430104315 , y0=6.9411596295491975 , psi0=0.7353543831002433 , v0=3.000000029999729 , spline0=25.531766916075682 , a0=0.0 , w0=0.0
2026-01-13 17:40:40,581 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:40,582 - INFO - integration_test - Dyn residual k=0: pred=[23.994082221888853, 7.142414633303531, 0.7353543831002433, 3.000000029999729, 25.831766919075655], ws=[23.994082219664094, 7.1424146312909995, 0.7353543831002431, 3.0, 25.98995629306596], res=[2.224759043656377e-09, 2.012531474804291e-09, 1.1102230246251565e-16, 2.999972892325786e-08, -0.15818937399030375], res_norm=1.582e-01
2026-01-13 17:40:40,582 - INFO - integration_test - Dyn residual k=1: pred=[24.216560138285036, 7.3436696330328015, 0.7353543831002431, 3.0, 26.28995629306596], ws=[24.216560138285036, 7.3436696330328015, 0.7353543831002431, 3.0, 26.17727089609339], res=[0.0, 0.0, 0.0, 0.0, 0.11268539697256941], res_norm=1.127e-01
2026-01-13 17:40:40,583 - INFO - integration_test - Dyn residual k=2: pred=[24.43903805690598, 7.5449246347746035, 0.7353543831002431, 3.0, 26.47727089609339], ws=[24.43903805690598, 7.5449246347746035, 0.7353543831002431, 3.0, 26.57493955094013], res=[0.0, 0.0, 0.0, 0.0, -0.09766865484673914], res_norm=9.767e-02
2026-01-13 17:40:40,597 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:40,668 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:40,684 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:40,695 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:40,710 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:40,722 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:40,736 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:40,748 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:40,763 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:40,774 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:40,790 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:40,801 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:40,816 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:40,827 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:40,842 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:40,854 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:40,868 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:40,880 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:40,895 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:40,905 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:40,918 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:40,928 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:41,155 - INFO - integration_test - Step 227: MPC solve successful
2026-01-13 17:40:41,270 - INFO - integration_test - Step 227: Computed 6 numeric contouring constraints for visualization (s=26.120)
2026-01-13 17:40:41,270 - DEBUG - integration_test - Step 227: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:41,270 - INFO - integration_test - === Applying control at step 227 ===
2026-01-13 17:40:41,270 - INFO - integration_test -   Control dict from planner: {'a': 1.5279785444668905e-13, 'w': -0.08264778716944747}
2026-01-13 17:40:41,270 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:41,270 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:41,271 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:41,272 - INFO - integration_test - Step 227 completed in 0.823s
2026-01-13 17:40:41,288 - INFO - integration_test - Step 228 (contouring until path end)
2026-01-13 17:40:41,290 - DEBUG - integration_test - Syncing planner state at step 228: vehicle_state=[23.99491135  7.14149298  0.7270896   3.00000003 26.42000169]
2026-01-13 17:40:41,291 - DEBUG - integration_test - Step 228: Using propagated spline 26.4200 (close to path, dist=0.382m, drift=0.371m)
2026-01-13 17:40:41,291 - DEBUG - integration_test -   Set spline state to 26.4200
2026-01-13 17:40:41,291 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:41,362 - DEBUG - integration_test - Step 228: Checking path alignment: vehicle=(23.995, 7.141), path_start=(0.000, 0.000), dist=25.035m
2026-01-13 17:40:41,362 - WARNING - integration_test - Step 228: Vehicle is far from path start (dist=25.035m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:41,362 - INFO - integration_test - === Calling planner.solve_mpc() at step 228 ===
2026-01-13 17:40:41,418 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:41,428 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:41,428 - INFO - integration_test - Warmstart k=0: x0=23.99491134841588 , y0=7.141492981979222 , psi0=0.7270896043832985 , v0=3.000000029999744 , spline0=25.927646155584995 , a0=0.0 , w0=0.0
2026-01-13 17:40:41,428 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:41,430 - INFO - integration_test - Dyn residual k=0: pred=[24.219044980089038, 7.340902402401089, 0.7270896043832985, 3.000000029999744, 26.22764615858497], ws=[24.219044977847723, 7.340902400407012, 0.7270896043832984, 3.0, 26.184559276376756], res=[2.2413146893995872e-09, 1.994076903599762e-09, 1.1102230246251565e-16, 2.9999744022291e-08, 0.04308688220821466], res_norm=4.309e-02
2026-01-13 17:40:41,430 - INFO - integration_test - Dyn residual k=1: pred=[24.443178607279567, 7.540311818834803, 0.7270896043832984, 3.0, 26.484559276376757], ws=[24.443178607279567, 7.540311818834803, 0.7270896043832984, 3.0, 26.5995850048793], res=[0.0, 0.0, 0.0, 0.0, -0.11502572850254467], res_norm=1.150e-01
2026-01-13 17:40:41,431 - INFO - integration_test - Dyn residual k=2: pred=[24.66731223671141, 7.739721237262593, 0.7270896043832984, 3.0, 26.899585004879302], ws=[24.66731223671141, 7.739721237262593, 0.7270896043832984, 3.0, 26.76539092154362], res=[0.0, 0.0, 0.0, 0.0, 0.13419408333568228], res_norm=1.342e-01
2026-01-13 17:40:41,445 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:41,517 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:41,532 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:41,544 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:41,560 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:41,572 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:41,587 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:41,598 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:41,613 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:41,624 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:41,639 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:41,651 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:41,666 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:41,679 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:41,695 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:41,707 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:41,723 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:41,735 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:41,750 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:41,761 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:41,774 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:41,784 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:42,206 - INFO - integration_test - Step 228: MPC solve successful
2026-01-13 17:40:42,328 - INFO - integration_test - Step 228: Computed 6 numeric contouring constraints for visualization (s=26.420)
2026-01-13 17:40:42,329 - DEBUG - integration_test - Step 228: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:42,329 - INFO - integration_test - === Applying control at step 228 ===
2026-01-13 17:40:42,329 - INFO - integration_test -   Control dict from planner: {'a': 3.575530827248389e-13, 'w': -0.07129263186803607}
2026-01-13 17:40:42,329 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:42,329 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:42,330 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:42,330 - INFO - integration_test - Step 228 completed in 1.040s
2026-01-13 17:40:42,346 - INFO - integration_test - Step 229 (contouring until path end)
2026-01-13 17:40:42,350 - DEBUG - integration_test - Syncing planner state at step 229: vehicle_state=[24.2197539   7.34010176  0.71996034  3.00000003 26.72000169]
2026-01-13 17:40:42,350 - DEBUG - integration_test - Step 229: Using propagated spline 26.7200 (close to path, dist=0.414m, drift=0.671m)
2026-01-13 17:40:42,350 - DEBUG - integration_test -   Set spline state to 26.7200
2026-01-13 17:40:42,351 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:42,778 - DEBUG - integration_test - Step 229: Checking path alignment: vehicle=(24.220, 7.340), path_start=(0.000, 0.000), dist=25.308m
2026-01-13 17:40:42,778 - WARNING - integration_test - Step 229: Vehicle is far from path start (dist=25.308m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:42,778 - INFO - integration_test - === Calling planner.solve_mpc() at step 229 ===
2026-01-13 17:40:42,831 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:42,841 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:42,841 - INFO - integration_test - Warmstart k=0: x0=24.219753899552728 , y0=7.340101762754664 , psi0=0.7199603411964949 , v0=3.00000002999978 , spline0=26.144454387785068 , a0=0.0 , w0=0.0
2026-01-13 17:40:42,841 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:42,842 - INFO - integration_test - Dyn residual k=0: pred=[24.445303465495247, 7.537908221453888, 0.7199603411964949, 3.00000002999978, 26.444454390785047], ws=[24.445303463239767, 7.537908219475838, 0.719960341196495, 3.0, 26.561651616054128], res=[2.255479358836965e-09, 1.978049724016273e-09, -1.1102230246251565e-16, 2.9999779993516995e-08, -0.11719722526908072], res_norm=1.172e-01
2026-01-13 17:40:42,843 - INFO - integration_test - Dyn residual k=1: pred=[24.670853026926807, 7.735714676197013, 0.719960341196495, 3.0, 26.86165161605413], ws=[24.670853026926807, 7.735714676197013, 0.719960341196495, 3.0, 27.015449454890344], res=[0.0, 0.0, 0.0, 0.0, -0.15379783883621556], res_norm=1.538e-01
2026-01-13 17:40:42,844 - INFO - integration_test - Dyn residual k=2: pred=[24.896402590613846, 7.933521132918187, 0.719960341196495, 3.0, 27.315449454890345], ws=[24.896402590613846, 7.933521132918187, 0.719960341196495, 3.0, 27.245518377388855], res=[0.0, 0.0, 0.0, 0.0, 0.06993107750149008], res_norm=6.993e-02
2026-01-13 17:40:42,858 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:42,928 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:42,944 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:42,955 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:42,971 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:42,982 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:42,997 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:43,009 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:43,024 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:43,037 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:43,052 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:43,063 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:43,078 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:43,090 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:43,104 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:43,116 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:43,131 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:43,143 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:43,160 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:43,170 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:43,183 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:43,193 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:43,413 - INFO - integration_test - Step 229: MPC solve successful
2026-01-13 17:40:43,539 - INFO - integration_test - Step 229: Computed 6 numeric contouring constraints for visualization (s=26.720)
2026-01-13 17:40:43,539 - DEBUG - integration_test - Step 229: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:43,539 - INFO - integration_test - === Applying control at step 229 ===
2026-01-13 17:40:43,539 - INFO - integration_test -   Control dict from planner: {'a': 2.0168254196405245e-12, 'w': -0.06302056600351856}
2026-01-13 17:40:43,539 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:43,539 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:43,540 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:43,541 - INFO - integration_test - Step 229 completed in 1.191s
2026-01-13 17:40:43,557 - INFO - integration_test - Step 230 (contouring until path end)
2026-01-13 17:40:43,562 - DEBUG - integration_test - Syncing planner state at step 230: vehicle_state=[24.44592526  7.5371962   0.71365828  3.00000003 27.02000169]
2026-01-13 17:40:43,562 - DEBUG - integration_test - Step 230: Using propagated spline 27.0200 (close to path, dist=0.425m, drift=0.365m)
2026-01-13 17:40:43,562 - DEBUG - integration_test -   Set spline state to 27.0200
2026-01-13 17:40:43,563 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:43,634 - DEBUG - integration_test - Step 230: Checking path alignment: vehicle=(24.446, 7.537), path_start=(0.000, 0.000), dist=25.581m
2026-01-13 17:40:43,634 - WARNING - integration_test - Step 230: Vehicle is far from path start (dist=25.581m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:43,634 - INFO - integration_test - === Calling planner.solve_mpc() at step 230 ===
2026-01-13 17:40:43,687 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:43,697 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:43,697 - INFO - integration_test - Warmstart k=0: x0=24.44592526420012 , y0=7.537196201399278 , psi0=0.713658284596143 , v0=3.0000000299999816 , spline0=26.587444888100528 , a0=0.0 , w0=0.0
2026-01-13 17:40:43,697 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:43,698 - INFO - integration_test - Dyn residual k=0: pred=[24.67271693045061, 7.73357731535713, 0.713658284596143, 3.0000000299999816, 26.887444891100525], ws=[24.67271692818269, 7.7335773133933206, 0.7136582845961428, 3.0, 26.814236949211313], res=[2.2679174094264454e-09, 1.963809559413221e-09, 2.220446049250313e-16, 2.999998161001827e-08, 0.07320794188921198], res_norm=7.321e-02
2026-01-13 17:40:43,699 - INFO - integration_test - Dyn residual k=1: pred=[24.89950859216526, 7.929958425387363, 0.7136582845961428, 3.0, 27.114236949211314], ws=[24.89950859216526, 7.929958425387363, 0.7136582845961428, 3.0, 27.184953041722217], res=[0.0, 0.0, 0.0, 0.0, -0.07071609251090294], res_norm=7.072e-02
2026-01-13 17:40:43,700 - INFO - integration_test - Dyn residual k=2: pred=[25.126300256147832, 8.126339537381405, 0.7136582845961428, 3.0, 27.484953041722218], ws=[25.126300256147832, 8.126339537381405, 0.7136582845961428, 3.0, 27.653039186780035], res=[0.0, 0.0, 0.0, 0.0, -0.16808614505781705], res_norm=1.681e-01
2026-01-13 17:40:43,714 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:43,785 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:43,800 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:43,812 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:43,827 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:43,839 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:43,854 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:43,866 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:43,880 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:43,892 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:43,907 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:43,919 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:43,934 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:43,946 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:43,961 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:43,973 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:43,987 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:43,999 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:44,015 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:44,025 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:44,038 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:44,048 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:44,301 - INFO - integration_test - Step 230: MPC solve successful
2026-01-13 17:40:44,428 - INFO - integration_test - Step 230: Computed 6 numeric contouring constraints for visualization (s=27.020)
2026-01-13 17:40:44,429 - DEBUG - integration_test - Step 230: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:44,429 - INFO - integration_test - === Applying control at step 230 ===
2026-01-13 17:40:44,429 - INFO - integration_test -   Control dict from planner: {'a': -7.542513627543793e-13, 'w': -0.048692111146814855}
2026-01-13 17:40:44,429 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:44,429 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:44,430 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:44,430 - INFO - integration_test - Step 230 completed in 0.869s
2026-01-13 17:40:44,447 - INFO - integration_test - Step 231 (contouring until path end)
2026-01-13 17:40:44,451 - DEBUG - integration_test - Syncing planner state at step 231: vehicle_state=[24.67319414  7.73302439  0.70878907  3.00000003 27.3200017 ]
2026-01-13 17:40:44,451 - DEBUG - integration_test - Step 231: Using propagated spline 27.3200 (close to path, dist=0.476m, drift=0.665m)
2026-01-13 17:40:44,451 - DEBUG - integration_test -   Set spline state to 27.3200
2026-01-13 17:40:44,452 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:44,519 - DEBUG - integration_test - Step 231: Checking path alignment: vehicle=(24.673, 7.733), path_start=(0.000, 0.000), dist=25.857m
2026-01-13 17:40:44,519 - WARNING - integration_test - Step 231: Vehicle is far from path start (dist=25.857m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:44,519 - INFO - integration_test - === Calling planner.solve_mpc() at step 231 ===
2026-01-13 17:40:44,573 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:44,583 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:44,583 - INFO - integration_test - Warmstart k=0: x0=24.67319414388301 , y0=7.733024392190919 , psi0=0.7087890734814615 , v0=3.000000029999906 , spline0=27.00619296393114 , a0=0.0 , w0=0.0
2026-01-13 17:40:44,583 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:44,584 - INFO - integration_test - Dyn residual k=0: pred=[24.90093933893666, 7.928298885993793, 0.7087890734814615, 3.000000029999906, 27.306192966931132], ws=[24.900939336659217, 7.928298884041054, 0.7087890734814613, 3.0, 27.226246171211486], res=[2.2774422347993095e-09, 1.952738415411659e-09, 2.220446049250313e-16, 2.999990611485259e-08, 0.07994679571964625], res_norm=7.995e-02
2026-01-13 17:40:44,585 - INFO - integration_test - Dyn residual k=1: pred=[25.128684529435425, 8.123573375891189, 0.7087890734814613, 3.0, 27.526246171211486], ws=[25.128684529435425, 8.123573375891189, 0.7087890734814613, 3.0, 27.42909120188673], res=[0.0, 0.0, 0.0, 0.0, 0.09715496932475531], res_norm=9.715e-02
2026-01-13 17:40:44,586 - INFO - integration_test - Dyn residual k=2: pred=[25.356429722211633, 8.318847867741324, 0.7087890734814613, 3.0, 27.72909120188673], ws=[25.356429722211633, 8.318847867741324, 0.7087890734814613, 3.0, 27.821386017705354], res=[0.0, 0.0, 0.0, 0.0, -0.09229481581862231], res_norm=9.229e-02
2026-01-13 17:40:44,599 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:44,673 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:44,690 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:44,702 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:44,718 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:44,730 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:44,745 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:44,757 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:44,772 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:44,784 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:44,799 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:44,811 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:44,826 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:44,838 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:44,853 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:44,865 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:44,880 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:44,892 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:44,907 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:44,918 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:44,931 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:44,941 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:45,178 - INFO - integration_test - Step 231: MPC solve successful
2026-01-13 17:40:45,302 - INFO - integration_test - Step 231: Computed 6 numeric contouring constraints for visualization (s=27.320)
2026-01-13 17:40:45,302 - DEBUG - integration_test - Step 231: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:45,302 - INFO - integration_test - === Applying control at step 231 ===
2026-01-13 17:40:45,302 - INFO - integration_test -   Control dict from planner: {'a': -5.154866427107287e-13, 'w': -0.0125476030547636}
2026-01-13 17:40:45,302 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:45,302 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:45,303 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:45,304 - INFO - integration_test - Step 231 completed in 0.853s
2026-01-13 17:40:45,321 - INFO - integration_test - Step 232 (contouring until path end)
2026-01-13 17:40:45,333 - DEBUG - integration_test - Syncing planner state at step 232: vehicle_state=[24.90106179  7.92815595  0.70753431  3.00000003 27.6200017 ]
2026-01-13 17:40:45,334 - DEBUG - integration_test - Step 232: Using propagated spline 27.6200 (close to path, dist=0.457m, drift=0.359m)
2026-01-13 17:40:45,334 - DEBUG - integration_test -   Set spline state to 27.6200
2026-01-13 17:40:45,336 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:45,447 - DEBUG - integration_test - Step 232: Checking path alignment: vehicle=(24.901, 7.928), path_start=(0.000, 0.000), dist=26.133m
2026-01-13 17:40:45,447 - WARNING - integration_test - Step 232: Vehicle is far from path start (dist=26.133m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:45,448 - INFO - integration_test - === Calling planner.solve_mpc() at step 232 ===
2026-01-13 17:40:45,522 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:45,534 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:45,534 - INFO - integration_test - Warmstart k=0: x0=24.90106179050111 , y0=7.928155951956494 , psi0=0.7075343131759851 , v0=3.0000000299998546 , spline0=27.18663755940394 , a0=0.0 , w0=0.0
2026-01-13 17:40:45,534 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:45,536 - INFO - integration_test - Dyn residual k=0: pred=[25.129051828890297, 8.123144526481486, 0.7075343131759851, 3.0000000299998546, 27.486637562403928], ws=[25.129051826610407, 8.12314452453161, 0.707534313175985, 3.0, 27.654881594499493], res=[2.279890054524003e-09, 1.949876704543385e-09, 1.1102230246251565e-16, 2.999985460050425e-08, -0.16824403209556493], res_norm=1.682e-01
2026-01-13 17:40:45,537 - INFO - integration_test - Dyn residual k=1: pred=[25.357041862719704, 8.318133097106724, 0.707534313175985, 3.0, 27.954881594499494], ws=[25.357041862719704, 8.318133097106724, 0.707534313175985, 3.0, 27.839422705570566], res=[0.0, 0.0, 0.0, 0.0, 0.1154588889289272], res_norm=1.155e-01
2026-01-13 17:40:45,537 - INFO - integration_test - Dyn residual k=2: pred=[25.585031898829, 8.513121669681839, 0.707534313175985, 3.0, 28.139422705570567], ws=[25.585031898829, 8.513121669681839, 0.707534313175985, 3.0, 28.06828164211948], res=[0.0, 0.0, 0.0, 0.0, 0.07114106345108695], res_norm=7.114e-02
2026-01-13 17:40:45,553 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:45,626 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:45,642 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:45,653 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:45,668 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:45,680 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:45,695 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:45,707 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:45,722 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:45,734 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:45,749 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:45,760 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:45,775 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:45,787 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:45,802 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:45,814 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:45,829 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:45,841 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:45,857 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:45,868 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:45,881 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:45,894 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:46,646 - INFO - integration_test - Step 232: MPC solve successful
2026-01-13 17:40:46,781 - INFO - integration_test - Step 232: Computed 6 numeric contouring constraints for visualization (s=27.620)
2026-01-13 17:40:46,781 - DEBUG - integration_test - Step 232: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:46,781 - INFO - integration_test - === Applying control at step 232 ===
2026-01-13 17:40:46,781 - INFO - integration_test -   Control dict from planner: {'a': -5.505902978516319e-13, 'w': -0.024204430682889563}
2026-01-13 17:40:46,782 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:46,782 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:46,783 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:46,783 - INFO - integration_test - Step 232 completed in 1.450s
2026-01-13 17:40:46,799 - INFO - integration_test - Step 233 (contouring until path end)
2026-01-13 17:40:46,801 - DEBUG - integration_test - Syncing planner state at step 233: vehicle_state=[25.12928759  8.12286842  0.70511387  3.00000003 27.9200017 ]
2026-01-13 17:40:46,802 - DEBUG - integration_test - Step 233: Using propagated spline 27.9200 (close to path, dist=0.526m, drift=0.659m)
2026-01-13 17:40:46,802 - DEBUG - integration_test -   Set spline state to 27.9200
2026-01-13 17:40:46,803 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:46,870 - DEBUG - integration_test - Step 233: Checking path alignment: vehicle=(25.129, 8.123), path_start=(0.000, 0.000), dist=26.410m
2026-01-13 17:40:46,870 - WARNING - integration_test - Step 233: Vehicle is far from path start (dist=26.410m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:46,871 - INFO - integration_test - === Calling planner.solve_mpc() at step 233 ===
2026-01-13 17:40:46,924 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:46,934 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:46,934 - INFO - integration_test - Warmstart k=0: x0=25.129287585531987 , y0=8.122868417770675 , psi0=0.7051138701076962 , v0=3.0000000299997995 , spline0=27.429344930985913 , a0=0.0 , w0=0.0
2026-01-13 17:40:46,934 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:46,935 - INFO - integration_test - Dyn residual k=0: pred=[25.35774891435936, 8.317304584752076, 0.7051138701076962, 3.0000000299997995, 27.729344933985892], ws=[25.35774891207476, 8.317304582807727, 0.705113870107696, 3.0, 27.819716476941338], res=[2.2845974001484137e-09, 1.9443486820591716e-09, 2.220446049250313e-16, 2.999979953344223e-08, -0.09037154295544525], res_norm=9.037e-02
2026-01-13 17:40:46,936 - INFO - integration_test - Dyn residual k=1: pred=[25.586210238617536, 8.51174074784478, 0.705113870107696, 3.0, 28.11971647694134], ws=[25.586210238617536, 8.51174074784478, 0.705113870107696, 3.0, 28.0501334274354], res=[0.0, 0.0, 0.0, 0.0, 0.06958304950593686], res_norm=6.958e-02
2026-01-13 17:40:46,937 - INFO - integration_test - Dyn residual k=2: pred=[25.81467156516031, 8.706176912881832, 0.705113870107696, 3.0, 28.350133427435402], ws=[25.81467156516031, 8.706176912881832, 0.705113870107696, 3.0, 28.27335649761427], res=[0.0, 0.0, 0.0, 0.0, 0.07677692982113271], res_norm=7.678e-02
2026-01-13 17:40:46,950 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:47,020 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:47,035 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:47,047 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:47,062 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:47,073 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:47,088 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:47,100 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:47,114 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:47,126 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:47,141 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:47,153 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:47,169 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:47,180 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:47,196 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:47,207 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:47,222 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:47,234 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:47,250 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:47,260 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:47,273 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:47,284 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:58,580 - WARNING - integration_test - Step 233: MPC solve failed
2026-01-13 17:40:58,580 - WARNING - integration_test -   Consecutive MPC failures: 1/5
2026-01-13 17:40:58,711 - INFO - integration_test - Step 233: Computed 6 numeric contouring constraints for visualization (s=27.920)
2026-01-13 17:40:58,711 - DEBUG - integration_test - Step 233: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:58,711 - INFO - integration_test - === Applying control at step 233 ===
2026-01-13 17:40:58,711 - INFO - integration_test -   Control dict from planner: {'a': 0.0, 'w': 0.0}
2026-01-13 17:40:58,711 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:58,711 - INFO - integration_test -   Planner output success: False
2026-01-13 17:40:58,711 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': 0.0, 'w': 0.0}
2026-01-13 17:40:58,712 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:58,713 - INFO - integration_test - Step 233 completed in 11.912s
2026-01-13 17:40:58,729 - INFO - integration_test - Step 234 (contouring until path end)
2026-01-13 17:40:58,734 - DEBUG - integration_test - Syncing planner state at step 234: vehicle_state=[25.35774891  8.31730458  0.70511387  3.00000003 28.22000171]
2026-01-13 17:40:58,734 - DEBUG - integration_test - Step 234: Using propagated spline 28.2200 (close to path, dist=0.484m, drift=0.353m)
2026-01-13 17:40:58,734 - DEBUG - integration_test -   Set spline state to 28.2200
2026-01-13 17:40:58,735 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:58,801 - DEBUG - integration_test - Step 234: Checking path alignment: vehicle=(25.358, 8.317), path_start=(0.000, 0.000), dist=26.687m
2026-01-13 17:40:58,801 - WARNING - integration_test - Step 234: Vehicle is far from path start (dist=26.687m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:58,802 - INFO - integration_test - === Calling planner.solve_mpc() at step 234 ===
2026-01-13 17:40:58,856 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:58,866 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:58,866 - INFO - integration_test - Warmstart k=0: x0=25.35774891435936 , y0=8.317304584752076 , psi0=0.7051138701076962 , v0=3.0000000299997995 , spline0=27.855810327834785 , a0=0.0 , w0=0.0
2026-01-13 17:40:58,866 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:58,868 - INFO - integration_test - Dyn residual k=0: pred=[25.58621024318673, 8.511740751733477, 0.7051138701076962, 3.0000000299997995, 28.155810330834765], ws=[25.586210240902133, 8.511740749789128, 0.705113870107696, 3.0, 28.28255923286408], res=[2.2845974001484137e-09, 1.9443486820591716e-09, 2.220446049250313e-16, 2.999979953344223e-08, -0.1267489020293162], res_norm=1.267e-01
2026-01-13 17:40:58,868 - INFO - integration_test - Dyn residual k=1: pred=[25.814671567444908, 8.70617691482618, 0.705113870107696, 3.0, 28.58255923286408], ws=[25.814671567444908, 8.70617691482618, 0.705113870107696, 3.0, 28.49087282667635], res=[0.0, 0.0, 0.0, 0.0, 0.09168640618773338], res_norm=9.169e-02
2026-01-13 17:40:58,869 - INFO - integration_test - Dyn residual k=2: pred=[26.043132893987682, 8.900613079863232, 0.705113870107696, 3.0, 28.79087282667635], ws=[26.043132893987682, 8.900613079863232, 0.705113870107696, 3.0, 28.677878164221756], res=[0.0, 0.0, 0.0, 0.0, 0.112994662454593], res_norm=1.130e-01
2026-01-13 17:40:58,885 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:58,955 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:58,970 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:58,982 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:58,997 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:59,008 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:59,023 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:59,034 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:59,049 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:59,060 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:59,075 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:59,087 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:59,102 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:59,113 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:59,129 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:59,140 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:59,155 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:59,166 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:59,181 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:59,191 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:59,204 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:59,214 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:40:59,452 - INFO - integration_test - Step 234: MPC solve successful
2026-01-13 17:40:59,576 - INFO - integration_test - Step 234: Computed 6 numeric contouring constraints for visualization (s=28.220)
2026-01-13 17:40:59,577 - DEBUG - integration_test - Step 234: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:40:59,577 - INFO - integration_test - === Applying control at step 234 ===
2026-01-13 17:40:59,577 - INFO - integration_test -   Control dict from planner: {'a': -3.0721364657445475e-12, 'w': 0.0409839925690807}
2026-01-13 17:40:59,577 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:40:59,577 - INFO - integration_test -   Planner output success: True
2026-01-13 17:40:59,579 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:40:59,579 - INFO - integration_test - Step 234 completed in 0.846s
2026-01-13 17:40:59,601 - INFO - integration_test - Step 235 (contouring until path end)
2026-01-13 17:40:59,603 - DEBUG - integration_test - Syncing planner state at step 235: vehicle_state=[25.58581117  8.51220837  0.70921227  3.00000003 28.52000171]
2026-01-13 17:40:59,604 - DEBUG - integration_test - Step 235: Using propagated spline 28.5200 (close to path, dist=0.569m, drift=0.653m)
2026-01-13 17:40:59,604 - DEBUG - integration_test -   Set spline state to 28.5200
2026-01-13 17:40:59,605 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:59,672 - DEBUG - integration_test - Step 235: Checking path alignment: vehicle=(25.586, 8.512), path_start=(0.000, 0.000), dist=26.965m
2026-01-13 17:40:59,672 - WARNING - integration_test - Step 235: Vehicle is far from path start (dist=26.965m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:40:59,672 - INFO - integration_test - === Calling planner.solve_mpc() at step 235 ===
2026-01-13 17:40:59,728 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:40:59,738 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:40:59,738 - INFO - integration_test - Warmstart k=0: x0=25.585811165651066 , y0=8.512208369628741 , psi0=0.7092122693646042 , v0=3.0000000299994922 , spline0=28.06518436575008 , a0=0.0 , w0=0.0
2026-01-13 17:40:59,738 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:40:59,739 - INFO - integration_test - Dyn residual k=0: pred=[25.813473700951306, 8.707579226771346, 0.7092122693646042, 3.0000000299994922, 28.36518436875003], ws=[25.81347369867472, 8.70757922481767, 0.7092122693646044, 3.0, 28.45875231479938], res=[2.2765860308027186e-09, 1.9536763318228623e-09, -1.1102230246251565e-16, 2.999949222370901e-08, -0.09356794604935104], res_norm=9.357e-02
2026-01-13 17:40:59,740 - INFO - integration_test - Dyn residual k=1: pred=[26.041136231698374, 8.902950080006597, 0.7092122693646044, 3.0, 28.75875231479938], ws=[26.041136231698374, 8.902950080006597, 0.7092122693646044, 3.0, 28.71020749983839], res=[0.0, 0.0, 0.0, 0.0, 0.048544814960990834], res_norm=4.854e-02
2026-01-13 17:40:59,741 - INFO - integration_test - Dyn residual k=2: pred=[26.26879876472203, 9.098320935195526, 0.7092122693646044, 3.0, 29.01020749983839], ws=[26.26879876472203, 9.098320935195526, 0.7092122693646044, 3.0, 29.128460989032952], res=[0.0, 0.0, 0.0, 0.0, -0.11825348919456147], res_norm=1.183e-01
2026-01-13 17:40:59,755 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:59,826 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:59,841 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:59,853 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:59,868 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:59,880 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:59,894 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:59,906 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:59,921 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:59,933 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:59,949 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:59,961 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:40:59,977 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:40:59,989 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:41:00,004 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:41:00,015 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:41:00,030 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:41:00,041 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:41:00,057 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:41:00,067 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:41:00,080 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:41:00,090 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:41:00,344 - INFO - integration_test - Step 235: MPC solve successful
2026-01-13 17:41:00,472 - INFO - integration_test - Step 235: Computed 6 numeric contouring constraints for visualization (s=28.520)
2026-01-13 17:41:00,472 - DEBUG - integration_test - Step 235: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:41:00,472 - INFO - integration_test - === Applying control at step 235 ===
2026-01-13 17:41:00,472 - INFO - integration_test -   Control dict from planner: {'a': -1.9470980223567151, 'w': 0.013440045542538056}
2026-01-13 17:41:00,472 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:41:00,472 - INFO - integration_test -   Planner output success: True
2026-01-13 17:41:00,473 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:41:00,474 - INFO - integration_test - Step 235 completed in 0.871s
2026-01-13 17:41:00,490 - INFO - integration_test - Step 236 (contouring until path end)
2026-01-13 17:41:00,494 - DEBUG - integration_test - Syncing planner state at step 236: vehicle_state=[25.80596001  8.70138544  0.71055627  2.80529023 28.80053073]
2026-01-13 17:41:00,495 - DEBUG - integration_test - Step 236: Using propagated spline 28.8005 (close to path, dist=0.510m, drift=0.328m)
2026-01-13 17:41:00,495 - DEBUG - integration_test -   Set spline state to 28.8005
2026-01-13 17:41:00,495 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:41:00,564 - DEBUG - integration_test - Step 236: Checking path alignment: vehicle=(25.806, 8.701), path_start=(0.000, 0.000), dist=27.233m
2026-01-13 17:41:00,564 - WARNING - integration_test - Step 236: Vehicle is far from path start (dist=27.233m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:41:00,564 - INFO - integration_test - === Calling planner.solve_mpc() at step 236 ===
2026-01-13 17:41:00,618 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:41:00,629 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:41:00,630 - INFO - integration_test - Warmstart k=0: x0=25.805960005727492 , y0=8.701385437418073 , psi0=0.710556273918858 , v0=2.8052902277638205 , spline0=28.257716953792997 , a0=0.0 , w0=0.0
2026-01-13 17:41:00,630 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:41:00,631 - INFO - integration_test - Dyn residual k=0: pred=[26.01860076950161, 8.884362043030464, 0.710556273918858, 2.8052902277638205, 28.538245976569378], ws=[26.01860076950161, 8.884362043030464, 0.7105562739188578, 2.8052902277638205, 28.68615700678378], res=[0.0, 0.0, 2.220446049250313e-16, 0.0, -0.14791103021440222], res_norm=1.479e-01
2026-01-13 17:41:00,632 - INFO - integration_test - Dyn residual k=1: pred=[26.23124153327573, 9.067338648642854, 0.7105562739188578, 2.8052902277638205, 28.96668602956016], ws=[26.23124153327573, 9.067338648642854, 0.7105562739188578, 2.8052902277638205, 28.856650325637133], res=[0.0, 0.0, 0.0, 0.0, 0.1100357039230282], res_norm=1.100e-01
2026-01-13 17:41:00,633 - INFO - integration_test - Dyn residual k=2: pred=[26.443882297049846, 9.250315254255245, 0.7105562739188578, 2.8052902277638205, 29.137179348413515], ws=[26.443882297049846, 9.250315254255245, 0.7105562739188578, 2.8052902277638205, 29.279976140548104], res=[0.0, 0.0, 0.0, 0.0, -0.14279679213458962], res_norm=1.428e-01
2026-01-13 17:41:00,646 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:41:00,718 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:41:00,733 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:41:00,745 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:41:00,760 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:41:00,772 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:41:00,787 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:41:00,799 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:41:00,814 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:41:00,827 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:41:00,841 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:41:00,853 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:41:00,869 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:41:00,881 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:41:00,896 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:41:00,907 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:41:00,922 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:41:00,934 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:41:00,949 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:41:00,960 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:41:00,973 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:41:00,983 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:41:01,164 - INFO - integration_test - Step 236: MPC solve successful
2026-01-13 17:41:01,293 - INFO - integration_test - Step 236: Computed 6 numeric contouring constraints for visualization (s=28.801)
2026-01-13 17:41:01,293 - DEBUG - integration_test - Step 236: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:41:01,293 - INFO - integration_test - === Applying control at step 236 ===
2026-01-13 17:41:01,293 - INFO - integration_test -   Control dict from planner: {'a': -2.0000000199783687, 'w': 0.8000000055046095}
2026-01-13 17:41:01,293 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:41:01,293 - INFO - integration_test -   Planner output success: True
2026-01-13 17:41:01,295 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:41:01,295 - INFO - integration_test - Step 236 completed in 0.802s
2026-01-13 17:41:01,312 - INFO - integration_test - Step 237 (contouring until path end)
2026-01-13 17:41:01,316 - DEBUG - integration_test - Syncing planner state at step 237: vehicle_state=[26.00383864  8.88575191  0.79055627  2.60529023 29.06105976]
2026-01-13 17:41:01,316 - DEBUG - integration_test - Step 237: Using propagated spline 29.0611 (close to path, dist=0.599m, drift=0.589m)
2026-01-13 17:41:01,316 - DEBUG - integration_test -   Set spline state to 29.0611
2026-01-13 17:41:01,317 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:41:01,384 - DEBUG - integration_test - Step 237: Checking path alignment: vehicle=(26.004, 8.886), path_start=(0.000, 0.000), dist=27.480m
2026-01-13 17:41:01,384 - WARNING - integration_test - Step 237: Vehicle is far from path start (dist=27.480m), but path remains FIXED per C++ reference. Spline parameter tracks position along fixed path.
2026-01-13 17:41:01,384 - INFO - integration_test - === Calling planner.solve_mpc() at step 237 ===
2026-01-13 17:41:01,437 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-13 17:41:01,447 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-13 17:41:01,447 - INFO - integration_test - Warmstart k=0: x0=26.00383863579083 , y0=8.885751908180863 , psi0=0.790556274469319 , v0=2.605290225765984 , spline0=28.66166076468762 , a0=0.0 , w0=0.0
2026-01-13 17:41:01,447 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-13 17:41:01,448 - INFO - integration_test - Dyn residual k=0: pred=[26.18710779115137, 9.070921528524355, 0.790556274469319, 2.605290225765984, 28.92218978726422], ws=[26.18710779115137, 9.070921528524355, 0.7905562744693189, 2.605290225765984, 29.041959603062224], res=[0.0, 0.0, 1.1102230246251565e-16, 0.0, -0.11976981579800494], res_norm=1.198e-01
2026-01-13 17:41:01,449 - INFO - integration_test - Dyn residual k=1: pred=[26.370376946511907, 9.256091148867847, 0.7905562744693189, 2.605290225765984, 29.302488625638823], ws=[26.370376946511907, 9.256091148867847, 0.7905562744693189, 2.605290225765984, 29.229471090043056], res=[0.0, 0.0, 0.0, 0.0, 0.07301753559576696], res_norm=7.302e-02
2026-01-13 17:41:01,449 - INFO - integration_test - Dyn residual k=2: pred=[26.553646101872445, 9.44126076921134, 0.7905562744693189, 2.605290225765984, 29.490000112619654], ws=[26.553646101872445, 9.44126076921134, 0.7905562744693189, 2.605290225765984, 29.431491292063257], res=[0.0, 0.0, 0.0, 0.0, 0.05850882055639772], res_norm=5.851e-02
2026-01-13 17:41:01,463 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:41:01,537 - INFO - integration_test - Stage 0: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:41:01,552 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:41:01,564 - INFO - integration_test - Stage 1: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:41:01,580 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:41:01,591 - INFO - integration_test - Stage 2: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:41:01,606 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:41:01,618 - INFO - integration_test - Stage 3: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:41:01,633 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:41:01,644 - INFO - integration_test - Stage 4: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:41:01,659 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:41:01,672 - INFO - integration_test - Stage 5: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:41:01,688 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:41:01,700 - INFO - integration_test - Stage 6: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:41:01,715 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:41:01,727 - INFO - integration_test - Stage 7: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:41:01,742 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:41:01,753 - INFO - integration_test - Stage 8: constraints count=5 (linearized=0, contouring=0, other=5)
2026-01-13 17:41:01,768 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:41:01,779 - INFO - integration_test - Stage 9: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:41:01,791 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-13 17:41:01,802 - INFO - integration_test - Stage 10: constraints count=0 (linearized=0, contouring=0, other=0)
2026-01-13 17:41:01,974 - INFO - integration_test - Step 237: MPC solve successful
2026-01-13 17:41:02,111 - INFO - integration_test - Step 237: Computed 6 numeric contouring constraints for visualization (s=29.061)
2026-01-13 17:41:02,111 - DEBUG - integration_test - Step 237: Captured 6 contouring constraint halfspaces for visualization
2026-01-13 17:41:02,111 - INFO - integration_test - === Applying control at step 237 ===
2026-01-13 17:41:02,111 - INFO - integration_test -   Control dict from planner: {'a': -2.0000000199983554, 'w': 0.07194036488080466}
2026-01-13 17:41:02,111 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-13 17:41:02,111 - INFO - integration_test -   Planner output success: True
2026-01-13 17:41:02,112 - WARNING - integration_test -   Error using dynamics model discrete_dynamics: .../casadi/core/matrix_impl.hpp:1386: Dimension mismatch for (x+y), x is 5x1, while y is 4x1, attempting symbolic_dynamics fallback
2026-01-13 17:41:02,113 - INFO - integration_test - Goal reached at step 237!
2026-01-13 17:41:02,113 - INFO - integration_test - Step 237 completed in 0.797s
2026-01-13 17:41:02,130 - INFO - integration_test - Goal reached at step 237, added 3 extra frames for visualization
2026-01-13 17:41:02,133 - INFO - integration_test - Saving test results...
2026-01-13 17:41:02,133 - INFO - integration_test - Saved 107 vehicle states to test_outputs/20260113_173846_contouring_safe_horizon_contouring_unicycle/vehicle_states.csv
2026-01-13 17:41:02,133 - INFO - integration_test - Saved obstacle summary to test_outputs/20260113_173846_contouring_safe_horizon_contouring_unicycle/obstacle_summary.csv
2026-01-13 17:41:02,134 - INFO - integration_test - Saved 114 states for obstacle 0 to test_outputs/20260113_173846_contouring_safe_horizon_contouring_unicycle/obstacle_0_detailed_states.csv
2026-01-13 17:41:02,134 - INFO - integration_test - Saved 114 states for obstacle 1 to test_outputs/20260113_173846_contouring_safe_horizon_contouring_unicycle/obstacle_1_detailed_states.csv
2026-01-13 17:41:02,135 - INFO - integration_test - Saved 114 states for obstacle 2 to test_outputs/20260113_173846_contouring_safe_horizon_contouring_unicycle/obstacle_2_detailed_states.csv
2026-01-13 17:41:03,059 - INFO - integration_test - Saved Safe Horizon diagnostic output to test_outputs/20260113_173846_contouring_safe_horizon_contouring_unicycle
2026-01-13 17:41:03,059 - INFO - integration_test - Saved state history: 107 vehicle states, 3 obstacles
2026-01-13 17:41:03,059 - INFO - integration_test - Creating animation...
2026-01-13 17:41:03,104 - DEBUG - integration_test - Creating animation with 107 frames (range: 0 to 106)
2026-01-13 17:41:03,104 - DEBUG - integration_test - Frame 0: Drawing 6 contouring constraint halfspaces
2026-01-13 17:41:03,163 - INFO - integration_test - Frame 0: Safe Horizon module has 138 scenarios after update
2026-01-13 17:41:03,163 - INFO - integration_test - Frame 0: Calling Safe Horizon visualizer
2026-01-13 17:41:03,163 - DEBUG - integration_test - Frame 0: Safe Horizon scenario_cache has 50 constraints across 10 keys: [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4)]
2026-01-13 17:41:03,181 - INFO - integration_test - Frame 0: Safe Horizon visualizer completed
2026-01-13 17:41:03,181 - DEBUG - integration_test - Frame 0: Drawing 6 contouring constraint halfspaces
2026-01-13 17:41:03,246 - INFO - integration_test - Frame 0: Safe Horizon module has 138 scenarios after update
2026-01-13 17:41:03,246 - INFO - integration_test - Frame 0: Calling Safe Horizon visualizer
2026-01-13 17:41:03,247 - DEBUG - integration_test - Frame 0: Safe Horizon scenario_cache has 50 constraints across 10 keys: [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4)]
2026-01-13 17:41:03,263 - INFO - integration_test - Frame 0: Safe Horizon visualizer completed
2026-01-13 17:41:03,366 - DEBUG - integration_test - Frame 1: Drawing 6 contouring constraint halfspaces
2026-01-13 17:41:03,423 - INFO - integration_test - Frame 1: Safe Horizon module has 137 scenarios after update
2026-01-13 17:41:03,423 - INFO - integration_test - Frame 1: Calling Safe Horizon visualizer
2026-01-13 17:41:03,423 - DEBUG - integration_test - Frame 1: Safe Horizon scenario_cache has 50 constraints across 10 keys: [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4)]
2026-01-13 17:41:03,441 - INFO - integration_test - Frame 1: Safe Horizon visualizer completed
2026-01-13 17:41:03,474 - DEBUG - integration_test - Frame 2: Drawing 6 contouring constraint halfspaces
2026-01-13 17:41:03,531 - INFO - integration_test - Frame 2: Safe Horizon module has 137 scenarios after update
2026-01-13 17:41:03,531 - INFO - integration_test - Frame 2: Calling Safe Horizon visualizer
2026-01-13 17:41:03,531 - DEBUG - integration_test - Frame 2: Safe Horizon scenario_cache has 50 constraints across 10 keys: [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4)]
2026-01-13 17:41:03,546 - INFO - integration_test - Frame 2: Safe Horizon visualizer completed
2026-01-13 17:41:23,214 - INFO - integration_test - Saved animation with 107 frames at 10.00 fps to test_outputs/20260113_173846_contouring_safe_horizon_contouring_unicycle/animation.gif (duration: 10.70s, size: 2208375 bytes)
2026-01-13 17:41:23,251 - INFO - integration_test - Animation created successfully
2026-01-13 17:41:23,251 - WARNING - integration_test - Test exited early due to solver failures, but files were saved
