2026-01-23 19:18:21,153 - INFO - integration_test - Contouring objective detected: automatically switching to contouring-aware dynamics model
2026-01-23 19:18:21,154 - INFO - integration_test -   Converted 'unicycle' -> 'contouring_unicycle'
2026-01-23 19:18:21,154 - INFO - integration_test - Created vehicle dynamics model: ContouringSecondOrderUnicycleModel
2026-01-23 19:18:21,154 - INFO - integration_test - ✓ Validation passed: Contouring objective with dynamics model that has 'spline' state
2026-01-23 19:18:21,154 - INFO - integration_test - Creating objective module: contouring
2026-01-23 19:18:21,161 - INFO - integration_test - Objective module 'contouring' created: contouring_objective
2026-01-23 19:18:21,161 - INFO - integration_test - Creating 2 constraint module(s): ['safe_horizon', 'contouring']
2026-01-23 19:18:21,161 - DEBUG - integration_test - Creating constraint module: safe_horizon
2026-01-23 19:18:21,172 - INFO - integration_test - Constraint module 'safe_horizon' created: safe_horizon_constraint
2026-01-23 19:18:21,172 - DEBUG - integration_test - Creating constraint module: contouring
2026-01-23 19:18:21,179 - INFO - integration_test - Constraint module 'contouring' created: contouring_constraints
2026-01-23 19:18:21,179 - INFO - integration_test - Created 2 constraint module(s)
2026-01-23 19:18:21,199 - INFO - integration_test - Setting solver on all modules...
2026-01-23 19:18:21,199 - DEBUG - integration_test -   Set solver on module: safe_horizon_constraint
2026-01-23 19:18:21,199 - DEBUG - integration_test -   Set solver on module: contouring_constraints
2026-01-23 19:18:21,199 - DEBUG - integration_test -   Set solver on module: control_effort_objective
2026-01-23 19:18:21,199 - DEBUG - integration_test -   Set solver on module: control_jerk_objective
2026-01-23 19:18:21,199 - DEBUG - integration_test -   Set solver on module: path_reference_velocity_objective
2026-01-23 19:18:21,199 - DEBUG - integration_test -   Set solver on module: contouring_objective
2026-01-23 19:18:21,200 - INFO - integration_test - Placing obstacles within reference path boundaries
2026-01-23 19:18:21,200 - INFO - integration_test - Obstacle 0: s=5.76, pos=(5.40, 2.83), lateral_offset=0.00m, vel=(0.55, 0.23)
2026-01-23 19:18:21,200 - INFO - integration_test - Obstacle 1: s=12.25, pos=(11.48, 4.32), lateral_offset=0.00m, vel=(-0.80, -0.09)
2026-01-23 19:18:21,201 - WARNING - integration_test - Error shaping obstacles: name 'get_dummy_obstacle' is not defined
2026-01-23 19:18:21,201 - WARNING - integration_test - Error in on_data_received: 'Planner' object has no attribute 'on_data_received'
2026-01-23 19:18:21,201 - INFO - integration_test - Initial vehicle state (before spline): [0. 0. 0. 1.]
2026-01-23 19:18:21,201 - INFO - integration_test - Vehicle starting position: (0.00, 0.00)
2026-01-23 19:18:21,201 - INFO - integration_test - Reference path start: (0.00, 0.00)
2026-01-23 19:18:21,201 - INFO - integration_test - Reference path starts at vehicle position (requirement satisfied)
2026-01-23 19:18:21,201 - INFO - integration_test - Contouring-aware dynamics detected: initializing spline variable
2026-01-23 19:18:21,202 - INFO - integration_test - Initialized spline to closest path point: s=0.0000 (vehicle at (0.00, 0.00), closest path point at (0.00, 0.00), distance=0.000m)
2026-01-23 19:18:21,202 - INFO - integration_test - Added spline variable: 0.0000
2026-01-23 19:18:21,202 - INFO - integration_test - Final initial state: [0. 0. 0. 1. 0.] (variables: ['x', 'y', 'psi', 'v', 'spline'])
2026-01-23 19:18:21,202 - INFO - integration_test - Step 0 (contouring until path end)
2026-01-23 19:18:21,202 - DEBUG - integration_test - Syncing planner state at step 0: vehicle_state=[0. 0. 0. 1. 0.]
2026-01-23 19:18:21,203 - DEBUG - integration_test - Step 0: Using propagated spline 0.0000 (close to path, dist=0.000m, drift=0.000m)
2026-01-23 19:18:21,203 - DEBUG - integration_test -   Set spline state to 0.0000
2026-01-23 19:18:21,204 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:18:22,423 - DEBUG - integration_test - Step 0: Checking path alignment: vehicle=(0.000, 0.000), path_start=(0.000, 0.000), dist=0.000m
2026-01-23 19:18:22,424 - INFO - integration_test - === Calling planner.solve_mpc() at step 0 ===
2026-01-23 19:18:23,501 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:18:23,530 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:18:23,530 - INFO - integration_test - Warmstart k=0: x0=0.0 , y0=0.0 , psi0=0.0 , v0=1.0 , spline0=0.0 , a0=0.0 , w0=0.0
2026-01-23 19:18:23,530 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:18:23,531 - INFO - integration_test - Dyn residual k=0: pred=[0.1, 0.0, 0.0, 1.0, 0.1], ws=[0.1, 0.0, 0.0, 1.0, 0.051515151515151514], res=[0.0, 0.0, 0.0, 0.0, 0.04848484848484849], res_norm=4.848e-02
2026-01-23 19:18:23,532 - INFO - integration_test - Dyn residual k=1: pred=[0.2, 0.0, 0.0, 1.0, 0.15151515151515152], ws=[0.2, 0.0, 0.0, 1.0, 0.05298386941791642], res=[0.0, 0.0, 0.0, 0.0, 0.0985312820972351], res_norm=9.853e-02
2026-01-23 19:18:23,533 - INFO - integration_test - Dyn residual k=2: pred=[0.30000000000000004, 0.0, 0.0, 1.0, 0.15298386941791642], ws=[0.30000000000000004, 0.0, 0.0, 1.0, 0.11020534538505213], res=[0.0, 0.0, 0.0, 0.0, 0.04277852403286429], res_norm=4.278e-02
2026-01-23 19:18:23,550 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:24,672 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:18:24,693 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:24,743 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:24,768 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:24,819 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:24,842 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:24,891 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:24,911 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:24,977 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:25,013 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:25,076 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:25,099 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:25,144 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:25,168 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:25,216 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:25,237 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:25,284 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:25,305 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:25,353 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:18:25,375 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:25,423 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:18:26,463 - INFO - integration_test - Step 0: MPC solve successful
2026-01-23 19:18:26,643 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:18:26,643 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1853 scenarios available
2026-01-23 19:18:26,703 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1853 trajectory groups with 18530 total points
2026-01-23 19:18:26,703 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:18:26,769 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:18:26,782 - INFO - integration_test - Step 0: Computed 6 numeric contouring constraints for visualization (s=0.000)
2026-01-23 19:18:26,782 - DEBUG - integration_test - Step 0: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:18:26,782 - DEBUG - integration_test - Linearized constraints module not found at step 0
2026-01-23 19:18:26,782 - INFO - integration_test - === Applying control at step 0 ===
2026-01-23 19:18:26,783 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000197281955, 'w': 0.8000000053521503}
2026-01-23 19:18:26,783 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:18:26,783 - INFO - integration_test -   Planner output success: True
2026-01-23 19:18:26,784 - INFO - integration_test - Step 0 completed in 5.582s
2026-01-23 19:18:26,838 - INFO - integration_test - Step 1 (contouring until path end)
2026-01-23 19:18:26,838 - DEBUG - integration_test - Syncing planner state at step 1: vehicle_state=[0.10987738 0.00453085 0.08       1.2        0.12      ]
2026-01-23 19:18:26,839 - DEBUG - integration_test - Step 1: Using propagated spline 0.1200 (close to path, dist=0.110m, drift=0.120m)
2026-01-23 19:18:26,839 - DEBUG - integration_test -   Set spline state to 0.1200
2026-01-23 19:18:26,840 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:18:27,804 - DEBUG - integration_test - Step 1: Checking path alignment: vehicle=(0.110, 0.005), path_start=(0.000, 0.000), dist=0.110m
2026-01-23 19:18:27,804 - INFO - integration_test - === Calling planner.solve_mpc() at step 1 ===
2026-01-23 19:18:28,783 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:18:28,811 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:18:28,811 - INFO - integration_test - Warmstart k=0: x0=0.10987737537803377 , y0=0.004530845088606224 , psi0=0.08000000053521504 , v0=1.2000000019728196 , spline0=0.12000000019728196 , a0=0.0 , w0=0.0
2026-01-23 19:18:28,811 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:18:28,812 - INFO - integration_test - Dyn residual k=0: pred=[0.2294935803258665, 0.014120608444693063, 0.08000000053521504, 1.2000000019728196, 0.24000000039456393], ws=[0.22949358032586653, 0.014120608444693067, 0.08000000053521505, 1.2000000019728196, 0.05363349793862262], res=[-2.7755575615628914e-17, -3.469446951953614e-18, -1.3877787807814457e-17, 0.0, 0.1863665024559413], res_norm=1.864e-01
2026-01-23 19:18:28,813 - INFO - integration_test - Dyn residual k=1: pred=[0.3491097852736993, 0.02371037180077991, 0.08000000053521505, 1.2000000019728196, 0.1736334981359046], ws=[0.3491097852736993, 0.02371037180077991, 0.08000000053521505, 1.2000000019728196, 0.11278182146334666], res=[0.0, 0.0, 0.0, 0.0, 0.06085167667255793], res_norm=6.085e-02
2026-01-23 19:18:28,814 - INFO - integration_test - Dyn residual k=2: pred=[0.46872599022153205, 0.03330013515686675, 0.08000000053521505, 1.2000000019728196, 0.2327818216606286], ws=[0.46872599022153205, 0.03330013515686675, 0.08000000053521505, 1.2000000019728196, 0.35381950929433215], res=[0.0, 0.0, 0.0, 0.0, -0.12103768763370354], res_norm=1.210e-01
2026-01-23 19:18:28,832 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:29,807 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:18:29,830 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:29,878 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:29,899 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:29,945 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:29,967 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:30,015 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:30,037 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:30,084 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:30,104 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:30,151 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:30,174 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:30,221 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:30,243 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:30,291 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:30,313 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:30,361 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:30,384 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:30,432 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:18:30,452 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:30,501 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:18:31,189 - INFO - integration_test - Step 1: MPC solve successful
2026-01-23 19:18:31,191 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:18:31,191 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1860 scenarios available
2026-01-23 19:18:31,264 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1860 trajectory groups with 18600 total points
2026-01-23 19:18:31,265 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:18:31,345 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:18:31,359 - INFO - integration_test - Step 1: Computed 6 numeric contouring constraints for visualization (s=0.120)
2026-01-23 19:18:31,359 - DEBUG - integration_test - Step 1: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:18:31,359 - INFO - integration_test - === Applying control at step 1 ===
2026-01-23 19:18:31,360 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000184956486, 'w': 0.7999999755324887}
2026-01-23 19:18:31,360 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:18:31,360 - INFO - integration_test -   Planner output success: True
2026-01-23 19:18:31,361 - INFO - integration_test - Step 1 completed in 4.523s
2026-01-23 19:18:31,425 - INFO - integration_test - Step 2 (contouring until path end)
2026-01-23 19:18:31,426 - DEBUG - integration_test - Syncing planner state at step 2: vehicle_state=[0.23889213 0.02022162 0.16       1.4        0.26      ]
2026-01-23 19:18:31,426 - DEBUG - integration_test - Step 2: Using propagated spline 0.2600 (close to path, dist=0.240m, drift=0.260m)
2026-01-23 19:18:31,426 - DEBUG - integration_test -   Set spline state to 0.2600
2026-01-23 19:18:31,427 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:18:32,430 - DEBUG - integration_test - Step 2: Checking path alignment: vehicle=(0.239, 0.020), path_start=(0.000, 0.000), dist=0.240m
2026-01-23 19:18:32,430 - INFO - integration_test - === Calling planner.solve_mpc() at step 2 ===
2026-01-23 19:18:33,352 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:18:33,379 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:18:33,379 - INFO - integration_test - Warmstart k=0: x0=0.23889212819102829 , y0=0.02022162169735643 , psi0=0.1599999980884639 , v0=1.4000000038223845 , spline0=0.26000000057952044 , a0=0.0 , w0=0.0
2026-01-23 19:18:33,379 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:18:33,380 - INFO - integration_test - Dyn residual k=0: pred=[0.3771039482836082, 0.04252617042005153, 0.1599999980884639, 1.4000000038223845, 0.4000000009617589], ws=[0.37710394828360827, 0.04252617042005153, 0.15999999808846388, 1.4000000038223845, 0.11211133994307657], res=[-5.551115123125783e-17, 0.0, 2.7755575615628914e-17, 0.0, 0.2878886610186824], res_norm=2.879e-01
2026-01-23 19:18:33,381 - INFO - integration_test - Dyn residual k=1: pred=[0.5153157683761882, 0.06483071914274663, 0.15999999808846388, 1.4000000038223845, 0.252111340325315], ws=[0.5153157683761882, 0.06483071914274663, 0.15999999808846388, 1.4000000038223845, 0.3532281158635538], res=[0.0, 0.0, 0.0, 0.0, -0.10111677553823878], res_norm=1.011e-01
2026-01-23 19:18:33,382 - INFO - integration_test - Dyn residual k=2: pred=[0.6535275884687681, 0.08713526786544172, 0.15999999808846388, 1.4000000038223845, 0.4932281162457922], ws=[0.6535275884687681, 0.08713526786544172, 0.15999999808846388, 1.4000000038223845, 0.18458894047016675], res=[0.0, 0.0, 0.0, 0.0, 0.3086391757756255], res_norm=3.086e-01
2026-01-23 19:18:33,399 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:34,399 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:18:34,420 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:34,465 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:34,487 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:34,534 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:34,556 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:34,602 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:34,623 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:34,667 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:34,685 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:34,728 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:34,747 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:34,793 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:34,812 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:34,855 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:34,874 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:34,918 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:34,938 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:34,982 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:18:35,001 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:35,044 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:18:35,614 - INFO - integration_test - Step 2: MPC solve successful
2026-01-23 19:18:35,617 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:18:35,617 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1846 scenarios available
2026-01-23 19:18:35,687 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1846 trajectory groups with 18460 total points
2026-01-23 19:18:35,688 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:18:35,772 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:18:35,785 - INFO - integration_test - Step 2: Computed 6 numeric contouring constraints for visualization (s=0.260)
2026-01-23 19:18:35,785 - DEBUG - integration_test - Step 2: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:18:35,785 - INFO - integration_test - === Applying control at step 2 ===
2026-01-23 19:18:35,785 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000193311536, 'w': 0.7999999912039141}
2026-01-23 19:18:35,785 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:18:35,785 - INFO - integration_test -   Planner output success: True
2026-01-23 19:18:35,786 - INFO - integration_test - Step 2 completed in 4.361s
2026-01-23 19:18:35,836 - INFO - integration_test - Step 3 (contouring until path end)
2026-01-23 19:18:35,837 - DEBUG - integration_test - Syncing planner state at step 3: vehicle_state=[0.38583644 0.05014472 0.24       1.60000001 0.42      ]
2026-01-23 19:18:35,838 - DEBUG - integration_test - Step 3: Using propagated spline 0.4200 (close to path, dist=0.389m, drift=0.420m)
2026-01-23 19:18:35,838 - DEBUG - integration_test -   Set spline state to 0.4200
2026-01-23 19:18:35,838 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:18:36,752 - DEBUG - integration_test - Step 3: Checking path alignment: vehicle=(0.386, 0.050), path_start=(0.000, 0.000), dist=0.389m
2026-01-23 19:18:36,752 - INFO - integration_test - === Calling planner.solve_mpc() at step 3 ===
2026-01-23 19:18:37,743 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:18:37,771 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:18:37,771 - INFO - integration_test - Warmstart k=0: x0=0.38583643579045057 , y0=0.050144716052187135 , psi0=0.23999999720885531 , v0=1.6000000057555 , spline0=0.4200000011550704 , a0=0.0 , w0=0.0
2026-01-23 19:18:37,771 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:18:37,773 - INFO - integration_test - Dyn residual k=0: pred=[0.5412505124319829, 0.08817713598355524, 0.23999999720885531, 1.6000000057555, 0.5800000017306204], ws=[0.5412505124319829, 0.08817713598355524, 0.23999999720885512, 1.6000000057555, 0.17118755525468415], res=[0.0, 0.0, 1.942890293094024e-16, 0.0, 0.40881244647593623], res_norm=4.088e-01
2026-01-23 19:18:37,773 - INFO - integration_test - Dyn residual k=1: pred=[0.6966645890735151, 0.12620955591492333, 0.23999999720885512, 1.6000000057555, 0.3311875558302342], ws=[0.6966645890735151, 0.12620955591492333, 0.23999999720885512, 1.6000000057555, 0.6490390861253515], res=[0.0, 0.0, 0.0, 0.0, -0.31785153029511737], res_norm=3.179e-01
2026-01-23 19:18:37,774 - INFO - integration_test - Dyn residual k=2: pred=[0.8520786657150474, 0.1642419758462914, 0.23999999720885512, 1.6000000057555, 0.8090390867009015], ws=[0.8520786657150474, 0.1642419758462914, 0.23999999720885512, 1.6000000057555, 0.24713426992116505], res=[0.0, 0.0, 0.0, 0.0, 0.5619048167797365], res_norm=5.619e-01
2026-01-23 19:18:37,792 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:38,878 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:18:38,900 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:38,946 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:38,968 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:39,017 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:39,039 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:39,086 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:39,107 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:39,152 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:39,175 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:39,223 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:39,245 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:39,292 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:39,314 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:39,370 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:39,408 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:39,472 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:39,495 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:39,543 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:18:39,565 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:39,615 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:18:40,274 - INFO - integration_test - Step 3: MPC solve successful
2026-01-23 19:18:40,278 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:18:40,278 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1850 scenarios available
2026-01-23 19:18:40,291 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1850 trajectory groups with 18500 total points
2026-01-23 19:18:40,292 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:18:40,399 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:18:40,422 - INFO - integration_test - Step 3: Computed 6 numeric contouring constraints for visualization (s=0.420)
2026-01-23 19:18:40,423 - DEBUG - integration_test - Step 3: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:18:40,423 - INFO - integration_test - === Applying control at step 3 ===
2026-01-23 19:18:40,423 - INFO - integration_test -   Control dict from planner: {'a': 2.000000019990224, 'w': 0.8000000095979538}
2026-01-23 19:18:40,423 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:18:40,423 - INFO - integration_test -   Planner output success: True
2026-01-23 19:18:40,426 - INFO - integration_test - Step 3 completed in 4.589s
2026-01-23 19:18:40,512 - INFO - integration_test - Step 4 (contouring until path end)
2026-01-23 19:18:40,514 - DEBUG - integration_test - Syncing planner state at step 4: vehicle_state=[0.54913546 0.09724076 0.32       1.80000001 0.6       ]
2026-01-23 19:18:40,515 - DEBUG - integration_test - Step 4: Using propagated spline 0.6000 (close to path, dist=0.442m, drift=0.306m)
2026-01-23 19:18:40,515 - DEBUG - integration_test -   Set spline state to 0.6000
2026-01-23 19:18:40,516 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:18:41,436 - DEBUG - integration_test - Step 4: Checking path alignment: vehicle=(0.549, 0.097), path_start=(0.000, 0.000), dist=0.558m
2026-01-23 19:18:41,436 - INFO - integration_test - === Calling planner.solve_mpc() at step 4 ===
2026-01-23 19:18:42,394 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:18:42,418 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:18:42,418 - INFO - integration_test - Warmstart k=0: x0=0.5491354614268817 , y0=0.09724075622438091 , psi0=0.31999999816865066 , v0=1.8000000077545224 , spline0=0.6000000019305227 , a0=0.0 , w0=0.0
2026-01-23 19:18:42,418 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:18:42,419 - INFO - integration_test - Dyn residual k=0: pred=[0.7199978375215025, 0.15386273706630474, 0.31999999816865066, 1.8000000077545224, 0.780000002705975], ws=[0.7199978375215025, 0.15386273706630477, 0.31999999816865055, 1.8000000077545224, 0.6609860723687471], res=[0.0, -2.7755575615628914e-17, 1.1102230246251565e-16, 0.0, 0.11901393033722796], res_norm=1.190e-01
2026-01-23 19:18:42,419 - INFO - integration_test - Dyn residual k=1: pred=[0.8908602136161232, 0.2104847179082286, 0.31999999816865055, 1.8000000077545224, 0.8409860731441994], ws=[0.8908602136161232, 0.2104847179082286, 0.31999999816865055, 1.8000000077545224, 0.7012477968212095], res=[0.0, 0.0, 0.0, 0.0, 0.13973827632298985], res_norm=1.397e-01
2026-01-23 19:18:42,420 - INFO - integration_test - Dyn residual k=2: pred=[1.0617225897107438, 0.2671066987501524, 0.31999999816865055, 1.8000000077545224, 0.8812477975966617], ws=[1.0617225897107438, 0.2671066987501524, 0.31999999816865055, 1.8000000077545224, 0.9934724292015471], res=[0.0, 0.0, 0.0, 0.0, -0.11222463160488538], res_norm=1.122e-01
2026-01-23 19:18:42,436 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:43,346 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:18:43,365 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:43,410 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:43,431 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:43,475 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:43,494 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:43,541 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:43,563 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:43,636 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:43,670 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:43,720 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:43,742 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:43,792 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:43,815 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:43,863 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:43,885 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:43,934 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:43,957 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:44,005 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:18:44,028 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:44,076 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:18:44,724 - INFO - integration_test - Step 4: MPC solve successful
2026-01-23 19:18:44,727 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:18:44,727 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1854 scenarios available
2026-01-23 19:18:44,740 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1854 trajectory groups with 18540 total points
2026-01-23 19:18:44,741 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:18:44,909 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:18:44,924 - INFO - integration_test - Step 4: Computed 6 numeric contouring constraints for visualization (s=0.600)
2026-01-23 19:18:44,924 - DEBUG - integration_test - Step 4: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:18:44,925 - INFO - integration_test - === Applying control at step 4 ===
2026-01-23 19:18:44,925 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000183834237, 'w': 0.7999998983897025}
2026-01-23 19:18:44,925 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:18:44,925 - INFO - integration_test -   Planner output success: True
2026-01-23 19:18:44,926 - INFO - integration_test - Step 4 completed in 4.412s
2026-01-23 19:18:44,993 - INFO - integration_test - Step 5 (contouring until path end)
2026-01-23 19:18:44,994 - DEBUG - integration_test - Syncing planner state at step 5: vehicle_state=[0.72686149 0.16427977 0.39999999 2.00000001 0.8       ]
2026-01-23 19:18:44,994 - DEBUG - integration_test - Step 5: Using propagated spline 0.8000 (close to path, dist=0.308m, drift=0.506m)
2026-01-23 19:18:44,994 - DEBUG - integration_test -   Set spline state to 0.8000
2026-01-23 19:18:44,995 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:18:46,044 - DEBUG - integration_test - Step 5: Checking path alignment: vehicle=(0.727, 0.164), path_start=(0.000, 0.000), dist=0.745m
2026-01-23 19:18:46,044 - INFO - integration_test - === Calling planner.solve_mpc() at step 5 ===
2026-01-23 19:18:46,986 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:18:47,030 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:18:47,030 - INFO - integration_test - Warmstart k=0: x0=0.7268614893944777 , y0=0.1642797664015591 , psi0=0.39999998800762093 , v0=2.0000000095928647 , spline0=0.8000000028898092 , a0=0.0 , w0=0.0
2026-01-23 19:18:47,030 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:18:47,032 - INFO - integration_test - Dyn residual k=0: pred=[0.9110736900126266, 0.24216343302771043, 0.39999998800762093, 2.0000000095928647, 1.0000000038490957], ws=[0.9110736900126266, 0.24216343302771043, 0.3999999880076208, 2.0000000095928647, 0.4936284338503613], res=[0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.5063715699987343], res_norm=5.064e-01
2026-01-23 19:18:47,034 - INFO - integration_test - Dyn residual k=1: pred=[1.0952858906307754, 0.32004709965386174, 0.3999999880076208, 2.0000000095928647, 0.6936284348096478], ws=[1.0952858906307754, 0.32004709965386174, 0.3999999880076208, 2.0000000095928647, 0.7773703947560753], res=[0.0, 0.0, 0.0, 0.0, -0.08374195994642752], res_norm=8.374e-02
2026-01-23 19:18:47,036 - INFO - integration_test - Dyn residual k=2: pred=[1.2794980912489242, 0.39793076628001306, 0.3999999880076208, 2.0000000095928647, 0.9773703957153618], ws=[1.2794980912489242, 0.39793076628001306, 0.3999999880076208, 2.0000000095928647, 1.2882288968201416], res=[0.0, 0.0, 0.0, 0.0, -0.31085850110477986], res_norm=3.109e-01
2026-01-23 19:18:47,067 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:48,169 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:18:48,192 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:48,239 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:48,261 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:48,308 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:48,330 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:48,376 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:48,400 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:48,446 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:48,466 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:48,512 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:48,532 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:48,579 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:48,602 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:48,649 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:48,670 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:48,716 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:48,736 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:48,782 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:18:48,803 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:48,850 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:18:49,430 - INFO - integration_test - Step 5: MPC solve successful
2026-01-23 19:18:49,434 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:18:49,434 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1847 scenarios available
2026-01-23 19:18:49,445 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1847 trajectory groups with 18470 total points
2026-01-23 19:18:49,446 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:18:49,647 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:18:49,661 - INFO - integration_test - Step 5: Computed 6 numeric contouring constraints for visualization (s=0.800)
2026-01-23 19:18:49,661 - DEBUG - integration_test - Step 5: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:18:49,661 - INFO - integration_test - === Applying control at step 5 ===
2026-01-23 19:18:49,661 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000196428256, 'w': 0.7999999674346117}
2026-01-23 19:18:49,661 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:18:49,661 - INFO - integration_test -   Planner output success: True
2026-01-23 19:18:49,662 - INFO - integration_test - Step 5 completed in 4.669s
2026-01-23 19:18:49,713 - INFO - integration_test - Step 6 (contouring until path end)
2026-01-23 19:18:49,714 - DEBUG - integration_test - Syncing planner state at step 6: vehicle_state=[0.9167519  0.2538238  0.47999998 2.20000001 1.02      ]
2026-01-23 19:18:49,715 - DEBUG - integration_test - Step 6: Using propagated spline 1.0200 (close to path, dist=0.243m, drift=0.726m)
2026-01-23 19:18:49,715 - DEBUG - integration_test -   Set spline state to 1.0200
2026-01-23 19:18:49,715 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:18:50,626 - DEBUG - integration_test - Step 6: Checking path alignment: vehicle=(0.917, 0.254), path_start=(0.000, 0.000), dist=0.951m
2026-01-23 19:18:50,626 - INFO - integration_test - === Calling planner.solve_mpc() at step 6 ===
2026-01-23 19:18:51,562 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:18:51,594 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:18:51,594 - INFO - integration_test - Warmstart k=0: x0=0.9167519047293202 , y0=0.2538238038863749 , psi0=0.4799999847510821 , v0=2.2000000115571474 , spline0=1.020000004045524 , a0=0.0 , w0=0.0
2026-01-23 19:18:51,594 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:18:51,596 - INFO - integration_test - Dyn residual k=0: pred=[1.111890790315035, 0.35541522006352927, 0.4799999847510821, 2.2000000115571474, 1.2400000052012388], ws=[1.111890790315035, 0.35541522006352927, 0.47999998475108185, 2.2000000115571474, 1.0179658592502272], res=[0.0, 0.0, 2.220446049250313e-16, 0.0, 0.22203414595101156], res_norm=2.220e-01
2026-01-23 19:18:51,597 - INFO - integration_test - Dyn residual k=1: pred=[1.3070296759007498, 0.4570066362406836, 0.47999998475108185, 2.2000000115571474, 1.237965860405942], ws=[1.3070296759007498, 0.4570066362406836, 0.47999998475108185, 2.2000000115571474, 0.8614585310764333], res=[0.0, 0.0, 0.0, 0.0, 0.3765073293295087], res_norm=3.765e-01
2026-01-23 19:18:51,598 - INFO - integration_test - Dyn residual k=2: pred=[1.5021685614864646, 0.558598052417838, 0.47999998475108185, 2.2000000115571474, 1.0814585322321482], ws=[1.5021685614864646, 0.558598052417838, 0.47999998475108185, 2.2000000115571474, 1.6109212036179237], res=[0.0, 0.0, 0.0, 0.0, -0.5294626713857755], res_norm=5.295e-01
2026-01-23 19:18:51,618 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:52,691 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:18:52,713 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:52,761 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:52,786 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:52,837 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:52,860 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:52,909 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:52,932 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:52,987 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:53,012 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:53,067 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:53,091 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:53,141 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:53,164 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:53,230 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:53,270 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:53,331 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:53,355 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:53,404 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:18:53,427 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:53,476 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:18:54,163 - INFO - integration_test - Step 6: MPC solve successful
2026-01-23 19:18:54,168 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:18:54,168 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1852 scenarios available
2026-01-23 19:18:54,283 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1852 trajectory groups with 18520 total points
2026-01-23 19:18:54,284 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:18:54,407 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:18:54,423 - INFO - integration_test - Step 6: Computed 6 numeric contouring constraints for visualization (s=1.020)
2026-01-23 19:18:54,423 - DEBUG - integration_test - Step 6: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:18:54,423 - INFO - integration_test - === Applying control at step 6 ===
2026-01-23 19:18:54,423 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000199782115, 'w': 0.8000000043487903}
2026-01-23 19:18:54,423 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:18:54,423 - INFO - integration_test -   Planner output success: True
2026-01-23 19:18:54,425 - INFO - integration_test - Step 6 completed in 4.711s
2026-01-23 19:18:54,483 - INFO - integration_test - Step 7 (contouring until path end)
2026-01-23 19:18:54,484 - DEBUG - integration_test - Syncing planner state at step 7: vehicle_state=[1.11623087 0.36819144 0.55999999 2.40000001 1.26000001]
2026-01-23 19:18:54,485 - DEBUG - integration_test - Step 7: Using propagated spline 1.2600 (close to path, dist=0.244m, drift=0.672m)
2026-01-23 19:18:54,485 - DEBUG - integration_test -   Set spline state to 1.2600
2026-01-23 19:18:54,485 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:18:55,400 - DEBUG - integration_test - Step 7: Checking path alignment: vehicle=(1.116, 0.368), path_start=(0.000, 0.000), dist=1.175m
2026-01-23 19:18:55,400 - INFO - integration_test - === Calling planner.solve_mpc() at step 7 ===
2026-01-23 19:18:56,367 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:18:56,408 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:18:56,408 - INFO - integration_test - Warmstart k=0: x0=1.1162308666958665 , y0=0.3681914403358125 , psi0=0.5599999851859611 , v0=2.4000000135549686 , spline0=1.2600000054010208 , a0=0.0 , w0=0.0
2026-01-23 19:18:56,408 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:18:56,409 - INFO - integration_test - Dyn residual k=0: pred=[1.319572096376101, 0.4956761255445409, 0.5599999851859611, 2.4000000135549686, 1.5000000067565176], ws=[1.319572096376101, 0.4956761255445409, 0.5599999851859612, 2.4000000135549686, 0.8783754778639267], res=[0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.6216245288925909], res_norm=6.216e-01
2026-01-23 19:18:56,411 - INFO - integration_test - Dyn residual k=1: pred=[1.5229133260563357, 0.6231608107532693, 0.5599999851859612, 2.4000000135549686, 1.1183754792194236], ws=[1.5229133260563357, 0.6231608107532693, 0.5599999851859612, 2.4000000135549686, 1.6332404755394352], res=[0.0, 0.0, 0.0, 0.0, -0.5148649963200116], res_norm=5.149e-01
2026-01-23 19:18:56,413 - INFO - integration_test - Dyn residual k=2: pred=[1.7262545557365703, 0.7506454959619977, 0.5599999851859612, 2.4000000135549686, 1.873240476894932], ws=[1.7262545557365703, 0.7506454959619977, 0.5599999851859612, 2.4000000135549686, 1.2674814851942424], res=[0.0, 0.0, 0.0, 0.0, 0.6057589917006896], res_norm=6.058e-01
2026-01-23 19:18:56,438 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:57,494 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:18:57,517 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:57,566 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:57,591 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:57,649 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:57,672 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:57,721 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:57,743 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:57,792 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:57,815 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:57,864 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:57,886 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:57,934 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:57,957 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:58,007 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:58,031 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:58,079 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:18:58,102 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:58,148 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:18:58,169 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:18:58,217 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:18:58,966 - INFO - integration_test - Step 7: MPC solve successful
2026-01-23 19:18:58,970 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:18:58,971 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1850 scenarios available
2026-01-23 19:18:59,091 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1850 trajectory groups with 18500 total points
2026-01-23 19:18:59,092 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:18:59,233 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:18:59,249 - INFO - integration_test - Step 7: Computed 6 numeric contouring constraints for visualization (s=1.260)
2026-01-23 19:18:59,249 - DEBUG - integration_test - Step 7: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:18:59,249 - INFO - integration_test - === Applying control at step 7 ===
2026-01-23 19:18:59,249 - INFO - integration_test -   Control dict from planner: {'a': 2.000000019936486, 'w': 0.09367516588981223}
2026-01-23 19:18:59,249 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:18:59,249 - INFO - integration_test -   Planner output success: True
2026-01-23 19:18:59,251 - INFO - integration_test - Step 7 completed in 4.767s
2026-01-23 19:18:59,307 - INFO - integration_test - Step 8 (contouring until path end)
2026-01-23 19:18:59,309 - DEBUG - integration_test - Syncing planner state at step 8: vehicle_state=[1.32741121 0.50199131 0.5693675  2.60000002 1.52000001]
2026-01-23 19:18:59,309 - DEBUG - integration_test - Step 8: Using propagated spline 1.5200 (close to path, dist=0.233m, drift=0.638m)
2026-01-23 19:18:59,309 - DEBUG - integration_test -   Set spline state to 1.5200
2026-01-23 19:18:59,310 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:19:00,334 - DEBUG - integration_test - Step 8: Checking path alignment: vehicle=(1.327, 0.502), path_start=(0.000, 0.000), dist=1.419m
2026-01-23 19:19:00,334 - INFO - integration_test - === Calling planner.solve_mpc() at step 8 ===
2026-01-23 19:19:01,263 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:19:01,291 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:19:01,291 - INFO - integration_test - Warmstart k=0: x0=1.3274112125001498 , y0=0.5019913113590171 , psi0=0.5693675017749423 , v0=2.600000015548617 , spline0=1.5200000069558826 , a0=0.0 , w0=0.0
2026-01-23 19:19:01,291 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:19:01,292 - INFO - integration_test - Dyn residual k=0: pred=[1.546394165802615, 0.6421571665858106, 0.5693675017749423, 2.600000015548617, 1.7800000085107444], ws=[1.546394165802615, 0.6421571665858106, 0.5693675017749422, 2.600000015548617, 1.6125002222727296], res=[0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.16749978623801476], res_norm=1.675e-01
2026-01-23 19:19:01,293 - INFO - integration_test - Dyn residual k=1: pred=[1.7653771191050802, 0.782323021812604, 0.5693675017749422, 2.600000015548617, 1.8725002238275914], ws=[1.7653771191050802, 0.782323021812604, 0.5693675017749422, 2.600000015548617, 1.688950198849415], res=[0.0, 0.0, 0.0, 0.0, 0.1835500249781763], res_norm=1.836e-01
2026-01-23 19:19:01,294 - INFO - integration_test - Dyn residual k=2: pred=[1.9843600724075454, 0.9224888770393975, 0.5693675017749422, 2.600000015548617, 1.948950200404277], ws=[1.9843600724075454, 0.9224888770393975, 0.5693675017749422, 2.600000015548617, 1.9971269452086082], res=[0.0, 0.0, 0.0, 0.0, -0.04817674480433132], res_norm=4.818e-02
2026-01-23 19:19:01,311 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:02,295 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:19:02,317 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:02,361 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:02,383 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:02,432 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:02,453 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:02,498 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:02,519 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:02,563 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:02,583 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:02,632 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:02,655 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:02,702 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:02,722 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:02,771 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:02,796 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:02,868 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:02,895 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:02,943 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:19:02,963 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:03,011 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:19:03,595 - INFO - integration_test - Step 8: MPC solve successful
2026-01-23 19:19:03,600 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:19:03,601 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1852 scenarios available
2026-01-23 19:19:03,721 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1852 trajectory groups with 18520 total points
2026-01-23 19:19:03,722 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:19:03,850 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:19:03,865 - INFO - integration_test - Step 8: Computed 6 numeric contouring constraints for visualization (s=1.520)
2026-01-23 19:19:03,865 - DEBUG - integration_test - Step 8: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:19:03,865 - INFO - integration_test - === Applying control at step 8 ===
2026-01-23 19:19:03,865 - INFO - integration_test -   Control dict from planner: {'a': 2.000000019643656, 'w': -0.16872489465434903}
2026-01-23 19:19:03,865 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:19:03,865 - INFO - integration_test -   Planner output success: True
2026-01-23 19:19:03,866 - INFO - integration_test - Step 8 completed in 4.558s
2026-01-23 19:19:03,916 - INFO - integration_test - Step 9 (contouring until path end)
2026-01-23 19:19:03,918 - DEBUG - integration_test - Syncing planner state at step 9: vehicle_state=[1.55604868 0.64559904 0.55249501 2.80000002 1.80000001]
2026-01-23 19:19:03,918 - DEBUG - integration_test - Step 9: Using propagated spline 1.8000 (close to path, dist=0.224m, drift=0.624m)
2026-01-23 19:19:03,918 - DEBUG - integration_test -   Set spline state to 1.8000
2026-01-23 19:19:03,919 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:19:04,773 - DEBUG - integration_test - Step 9: Checking path alignment: vehicle=(1.556, 0.646), path_start=(0.000, 0.000), dist=1.685m
2026-01-23 19:19:04,773 - INFO - integration_test - === Calling planner.solve_mpc() at step 9 ===
2026-01-23 19:19:05,746 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:19:05,780 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:19:05,780 - INFO - integration_test - Warmstart k=0: x0=1.556048681083264 , y0=0.6455990417475682 , psi0=0.5524950123095074 , v0=2.800000017512983 , spline0=1.8000000087071808 , a0=0.0 , w0=0.0
2026-01-23 19:19:05,780 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:19:05,781 - INFO - integration_test - Dyn residual k=0: pred=[1.7943896550448035, 0.792546587190804, 0.5524950123095074, 2.800000017512983, 2.080000010458479], ws=[1.7943896550448035, 0.792546587190804, 0.5524950123095076, 2.800000017512983, 1.6781336381189789], res=[0.0, 0.0, -2.220446049250313e-16, 0.0, 0.4018663723395002], res_norm=4.019e-01
2026-01-23 19:19:05,782 - INFO - integration_test - Dyn residual k=1: pred=[2.032730629006343, 0.9394941326340398, 0.5524950123095076, 2.800000017512983, 1.958133639870277], ws=[2.032730629006343, 0.9394941326340398, 0.5524950123095076, 2.800000017512983, 2.020211297607788], res=[0.0, 0.0, 0.0, 0.0, -0.06207765773751084], res_norm=6.208e-02
2026-01-23 19:19:05,783 - INFO - integration_test - Dyn residual k=2: pred=[2.2710716029678824, 1.0864416780772757, 0.5524950123095076, 2.800000017512983, 2.3002112993590864], ws=[2.2710716029678824, 1.0864416780772757, 0.5524950123095076, 2.800000017512983, 1.8799124175323296], res=[0.0, 0.0, 0.0, 0.0, 0.4202988818267568], res_norm=4.203e-01
2026-01-23 19:19:05,803 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:06,920 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:19:06,943 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:06,997 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:07,022 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:07,071 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:07,093 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:07,141 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:07,164 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:07,213 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:07,235 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:07,282 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:07,304 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:07,353 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:07,375 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:07,426 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:07,448 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:07,495 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:07,519 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:07,565 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:19:07,587 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:07,635 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:19:08,318 - INFO - integration_test - Step 9: MPC solve successful
2026-01-23 19:19:08,324 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:19:08,324 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1862 scenarios available
2026-01-23 19:19:08,339 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1862 trajectory groups with 18620 total points
2026-01-23 19:19:08,340 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:19:08,504 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:19:08,521 - INFO - integration_test - Step 9: Computed 6 numeric contouring constraints for visualization (s=1.800)
2026-01-23 19:19:08,521 - DEBUG - integration_test - Step 9: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:19:08,521 - INFO - integration_test - === Applying control at step 9 ===
2026-01-23 19:19:08,521 - INFO - integration_test -   Control dict from planner: {'a': 2.000000016315891, 'w': -0.08456412245565076}
2026-01-23 19:19:08,521 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:19:08,521 - INFO - integration_test -   Planner output success: True
2026-01-23 19:19:08,523 - INFO - integration_test - Step 9 completed in 4.605s
2026-01-23 19:19:08,585 - INFO - integration_test - Step 10 (contouring until path end)
2026-01-23 19:19:08,586 - DEBUG - integration_test - Syncing planner state at step 10: vehicle_state=[1.80354975 0.79673713 0.5440386  3.00000002 2.10000001]
2026-01-23 19:19:08,587 - DEBUG - integration_test - Step 10: Using propagated spline 2.1000 (close to path, dist=0.225m, drift=0.629m)
2026-01-23 19:19:08,587 - DEBUG - integration_test -   Set spline state to 2.1000
2026-01-23 19:19:08,587 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:19:09,586 - DEBUG - integration_test - Step 10: Checking path alignment: vehicle=(1.804, 0.797), path_start=(0.000, 0.000), dist=1.972m
2026-01-23 19:19:09,586 - INFO - integration_test - === Calling planner.solve_mpc() at step 10 ===
2026-01-23 19:19:10,611 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:19:10,637 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:19:10,637 - INFO - integration_test - Warmstart k=0: x0=1.803549747342028 , y0=0.7967371318893011 , psi0=0.5440386000639423 , v0=3.000000019144572 , spline0=2.100000010621638 , a0=0.0 , w0=0.0
2026-01-23 19:19:10,637 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:19:10,638 - INFO - integration_test - Dyn residual k=0: pred=[2.06023733976912, 0.9520158523974813, 0.5440386000639423, 3.000000019144572, 2.400000012536095], ws=[2.0602373381310617, 0.9520158514065664, 0.5440386000639421, 3.0, 1.8271020643112403], res=[1.6380581335795341e-09, 9.909149056852584e-10, 2.220446049250313e-16, 1.9144572149798478e-08, 0.5728979482248548], res_norm=5.729e-01
2026-01-23 19:19:10,639 - INFO - integration_test - Dyn residual k=1: pred=[2.3169249289200957, 1.1072945709238318, 0.5440386000639421, 3.0, 2.1271020643112406], ws=[2.3169249289200953, 1.1072945709238318, 0.5440386000639421, 3.0, 2.107775704903308], res=[4.440892098500626e-16, 0.0, 0.0, 0.0, 0.019326359407932703], res_norm=1.933e-02
2026-01-23 19:19:10,640 - INFO - integration_test - Dyn residual k=2: pred=[2.573612519709129, 1.2625732904410971, 0.5440386000639421, 3.0, 2.407775704903308], ws=[2.573612519709129, 1.2625732904410971, 0.5440386000639421, 3.0, 2.6473394857622026], res=[0.0, 0.0, 0.0, 0.0, -0.2395637808588944], res_norm=2.396e-01
2026-01-23 19:19:10,656 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:11,560 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:19:11,580 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:11,625 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:11,646 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:11,691 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:11,712 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:11,753 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:11,773 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:11,817 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:11,838 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:11,881 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:11,900 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:11,944 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:11,966 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:12,015 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:12,037 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:12,081 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:12,102 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:12,145 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:19:12,163 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:12,206 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:19:12,855 - INFO - integration_test - Step 10: MPC solve successful
2026-01-23 19:19:12,860 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:19:12,860 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1872 scenarios available
2026-01-23 19:19:12,875 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1872 trajectory groups with 18720 total points
2026-01-23 19:19:12,876 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:19:13,075 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:19:13,095 - INFO - integration_test - Step 10: Computed 6 numeric contouring constraints for visualization (s=2.100)
2026-01-23 19:19:13,095 - DEBUG - integration_test - Step 10: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:19:13,095 - INFO - integration_test - === Applying control at step 10 ===
2026-01-23 19:19:13,095 - INFO - integration_test -   Control dict from planner: {'a': 1.0207663676892216e-07, 'w': -0.6491962390404482}
2026-01-23 19:19:13,095 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:19:13,095 - INFO - integration_test -   Planner output success: True
2026-01-23 19:19:13,097 - INFO - integration_test - Step 10 completed in 4.511s
2026-01-23 19:19:13,162 - INFO - integration_test - Step 11 (contouring until path end)
2026-01-23 19:19:13,163 - DEBUG - integration_test - Syncing planner state at step 11: vehicle_state=[2.06509562 0.9435777  0.47911898 3.00000003 2.40000001]
2026-01-23 19:19:13,164 - DEBUG - integration_test - Step 11: Using propagated spline 2.4000 (close to path, dist=0.243m, drift=0.341m)
2026-01-23 19:19:13,164 - DEBUG - integration_test -   Set spline state to 2.4000
2026-01-23 19:19:13,165 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:19:14,329 - DEBUG - integration_test - Step 11: Checking path alignment: vehicle=(2.065, 0.944), path_start=(0.000, 0.000), dist=2.270m
2026-01-23 19:19:14,329 - INFO - integration_test - === Calling planner.solve_mpc() at step 11 ===
2026-01-23 19:19:15,262 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:19:15,289 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:19:15,289 - INFO - integration_test - Warmstart k=0: x0=2.065095623806127 , y0=0.9435776996063183 , psi0=0.4791189761598975 , v0=3.0000000293522358 , spline0=2.4000000135568613 , a0=0.0 , w0=0.0
2026-01-23 19:19:15,289 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:19:15,290 - INFO - integration_test - Dyn residual k=0: pred=[2.3313160514943867, 1.081876960785163, 0.4791189761598975, 3.0000000293522358, 2.7000000164920848], ws=[2.331316048889665, 1.081876959432032, 0.4791189761598975, 3.0, 1.897741100636934], res=[2.6047217716040905e-09, 1.3531309406289438e-09, 0.0, 2.9352235753066225e-08, 0.8022589158551507], res_norm=8.023e-01
2026-01-23 19:19:15,291 - INFO - integration_test - Dyn residual k=1: pred=[2.5975364739732028, 1.2201762192577459, 0.4791189761598975, 3.0, 2.197741100636934], ws=[2.5975364739732028, 1.2201762192577459, 0.4791189761598975, 3.0, 2.4328741060696792], res=[0.0, 0.0, 0.0, 0.0, -0.23513300543274518], res_norm=2.351e-01
2026-01-23 19:19:15,292 - INFO - integration_test - Dyn residual k=2: pred=[2.8637568990567406, 1.3584754790834597, 0.4791189761598975, 3.0, 2.732874106069679], ws=[2.8637568990567406, 1.3584754790834597, 0.4791189761598975, 3.0, 3.1699912811292745], res=[0.0, 0.0, 0.0, 0.0, -0.43711717505959546], res_norm=4.371e-01
2026-01-23 19:19:15,309 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:16,486 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:19:16,525 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:16,598 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:16,625 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:16,685 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:16,711 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:16,763 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:16,787 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:16,838 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:16,859 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:16,906 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:16,929 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:16,983 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:17,010 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:17,062 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:17,084 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:17,129 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:17,151 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:17,198 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:19:17,221 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:17,269 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:19:18,357 - INFO - integration_test - Step 11: MPC solve successful
2026-01-23 19:19:18,364 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:19:18,364 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1865 scenarios available
2026-01-23 19:19:18,378 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1865 trajectory groups with 18650 total points
2026-01-23 19:19:18,379 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:19:18,539 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:19:18,557 - INFO - integration_test - Step 11: Computed 6 numeric contouring constraints for visualization (s=2.400)
2026-01-23 19:19:18,557 - DEBUG - integration_test - Step 11: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:19:18,557 - INFO - integration_test - === Applying control at step 11 ===
2026-01-23 19:19:18,557 - INFO - integration_test -   Control dict from planner: {'a': -8.576259178062669e-07, 'w': 0.7999996579500657}
2026-01-23 19:19:18,558 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:19:18,558 - INFO - integration_test -   Planner output success: True
2026-01-23 19:19:18,559 - INFO - integration_test - Step 11 completed in 5.396s
2026-01-23 19:19:18,611 - INFO - integration_test - Step 12 (contouring until path end)
2026-01-23 19:19:18,613 - DEBUG - integration_test - Syncing planner state at step 12: vehicle_state=[2.32550316 1.09237262 0.55911894 2.99999994 2.70000001]
2026-01-23 19:19:18,613 - DEBUG - integration_test - Step 12: Using propagated spline 2.7000 (close to path, dist=0.219m, drift=0.347m)
2026-01-23 19:19:18,613 - DEBUG - integration_test -   Set spline state to 2.7000
2026-01-23 19:19:18,614 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:19:19,643 - DEBUG - integration_test - Step 12: Checking path alignment: vehicle=(2.326, 1.092), path_start=(0.000, 0.000), dist=2.569m
2026-01-23 19:19:19,644 - INFO - integration_test - === Calling planner.solve_mpc() at step 12 ===
2026-01-23 19:19:20,611 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:19:20,640 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:19:20,640 - INFO - integration_test - Warmstart k=0: x0=2.325503155816567 , y0=1.0923726232425004 , psi0=0.5591189419549041 , v0=2.999999943589644 , spline0=2.7000000079158255 , a0=0.0 , w0=0.0
2026-01-23 19:19:20,640 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:19:20,641 - INFO - integration_test - Dyn residual k=0: pred=[2.5798199874283814, 1.2515044735249214, 0.5591189419549041, 2.999999943589644, 3.00000000227479], ws=[2.5798199874283814, 1.2515044735249214, 0.5591189419549041, 2.999999943589644, 2.2145578612920946], res=[0.0, 0.0, 0.0, 0.0, 0.7854421409826955], res_norm=7.854e-01
2026-01-23 19:19:20,642 - INFO - integration_test - Dyn residual k=1: pred=[2.8341368190401957, 1.4106363238073425, 0.5591189419549041, 2.999999943589644, 2.5145578556510593], ws=[2.8341368190401957, 1.4106363238073425, 0.5591189419549041, 2.999999943589644, 2.9488632491560236], res=[0.0, 0.0, 0.0, 0.0, -0.43430539350496433], res_norm=4.343e-01
2026-01-23 19:19:20,643 - INFO - integration_test - Dyn residual k=2: pred=[3.08845365065201, 1.5697681740897635, 0.5591189419549041, 2.999999943589644, 3.248863243514988], ws=[3.08845365065201, 1.5697681740897635, 0.5591189419549041, 2.999999943589644, 3.266855102950141], res=[0.0, 0.0, 0.0, 0.0, -0.017991859435153135], res_norm=1.799e-02
2026-01-23 19:19:20,660 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:21,694 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:19:21,717 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:21,767 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:21,790 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:21,843 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:21,867 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:21,916 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:21,940 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:21,995 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:22,021 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:22,073 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:22,097 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:22,151 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:22,173 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:22,233 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:22,269 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:22,341 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:22,366 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:22,417 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:19:22,441 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:22,489 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:19:23,138 - INFO - integration_test - Step 12: MPC solve successful
2026-01-23 19:19:23,144 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:19:23,144 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1855 scenarios available
2026-01-23 19:19:23,160 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1855 trajectory groups with 18550 total points
2026-01-23 19:19:23,161 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:19:23,498 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:19:23,513 - INFO - integration_test - Step 12: Computed 6 numeric contouring constraints for visualization (s=2.700)
2026-01-23 19:19:23,513 - DEBUG - integration_test - Step 12: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:19:23,513 - INFO - integration_test - === Applying control at step 12 ===
2026-01-23 19:19:23,513 - INFO - integration_test -   Control dict from planner: {'a': -0.9241690399649373, 'w': -0.8000000093901704}
2026-01-23 19:19:23,514 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:19:23,514 - INFO - integration_test -   Planner output success: True
2026-01-23 19:19:23,515 - INFO - integration_test - Step 12 completed in 4.902s
2026-01-23 19:19:23,568 - INFO - integration_test - Step 13 (contouring until path end)
2026-01-23 19:19:23,570 - DEBUG - integration_test - Syncing planner state at step 13: vehicle_state=[2.58186912 1.23892916 0.47911894 2.90758304 2.99075831]
2026-01-23 19:19:23,570 - DEBUG - integration_test - Step 13: Using propagated spline 2.9908 (close to path, dist=0.205m, drift=0.344m)
2026-01-23 19:19:23,570 - DEBUG - integration_test -   Set spline state to 2.9908
2026-01-23 19:19:23,571 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:19:24,478 - DEBUG - integration_test - Step 13: Checking path alignment: vehicle=(2.582, 1.239), path_start=(0.000, 0.000), dist=2.864m
2026-01-23 19:19:24,478 - INFO - integration_test - === Calling planner.solve_mpc() at step 13 ===
2026-01-23 19:19:25,450 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:19:25,477 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:19:25,478 - INFO - integration_test - Warmstart k=0: x0=2.5818691187792693 , y0=1.2389291593510998 , psi0=0.47911894101588703 , v0=2.9075830395931503 , spline0=2.9907583118751404 , a0=0.0 , w0=0.0
2026-01-23 19:19:25,478 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:19:25,479 - INFO - integration_test - Dyn residual k=0: pred=[2.8398884544119904, 1.3729680110357763, 0.47911894101588703, 2.9075830395931503, 3.2815166158344553], ws=[2.8398884544119904, 1.3729680110357763, 0.47911894101588715, 2.9075830395931503, 2.9653705248228674], res=[0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.31614609101158786], res_norm=3.161e-01
2026-01-23 19:19:25,479 - INFO - integration_test - Dyn residual k=1: pred=[3.0979077900447116, 1.5070068627204527, 0.47911894101588715, 2.9075830395931503, 3.2561288287821823], ws=[3.0979077900447116, 1.5070068627204527, 0.47911894101588715, 2.9075830395931503, 3.0296111720603167], res=[0.0, 0.0, 0.0, 0.0, 0.22651765672186563], res_norm=2.265e-01
2026-01-23 19:19:25,480 - INFO - integration_test - Dyn residual k=2: pred=[3.355927125677433, 1.6410457144051291, 0.47911894101588715, 2.9075830395931503, 3.3203694760196316], ws=[3.355927125677433, 1.6410457144051291, 0.47911894101588715, 2.9075830395931503, 3.335351918087051], res=[0.0, 0.0, 0.0, 0.0, -0.014982442067419388], res_norm=1.498e-02
2026-01-23 19:19:25,498 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:26,524 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:19:26,546 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:26,595 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:26,620 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:26,669 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:26,692 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:26,742 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:26,765 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:26,815 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:26,837 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:26,886 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:26,907 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:26,956 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:26,980 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:27,033 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:27,055 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:27,104 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:27,125 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:27,169 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:19:27,190 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:27,239 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:19:27,879 - INFO - integration_test - Step 13: MPC solve successful
2026-01-23 19:19:27,886 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:19:27,887 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1851 scenarios available
2026-01-23 19:19:27,899 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1851 trajectory groups with 18510 total points
2026-01-23 19:19:27,900 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:19:28,112 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:19:28,130 - INFO - integration_test - Step 13: Computed 6 numeric contouring constraints for visualization (s=2.991)
2026-01-23 19:19:28,130 - DEBUG - integration_test - Step 13: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:19:28,130 - INFO - integration_test - === Applying control at step 13 ===
2026-01-23 19:19:28,130 - INFO - integration_test -   Control dict from planner: {'a': -1.461648015576229, 'w': -0.7999997517077703}
2026-01-23 19:19:28,130 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:19:28,130 - INFO - integration_test -   Planner output success: True
2026-01-23 19:19:28,132 - INFO - integration_test - Step 13 completed in 4.563s
2026-01-23 19:19:28,195 - INFO - integration_test - Step 14 (contouring until path end)
2026-01-23 19:19:28,196 - DEBUG - integration_test - Syncing planner state at step 14: vehicle_state=[2.83831748 1.35949178 0.39911897 2.76141824 3.26690014]
2026-01-23 19:19:28,197 - DEBUG - integration_test - Step 14: Using propagated spline 3.2669 (close to path, dist=0.220m, drift=0.326m)
2026-01-23 19:19:28,197 - DEBUG - integration_test -   Set spline state to 3.2669
2026-01-23 19:19:28,198 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:19:29,329 - DEBUG - integration_test - Step 14: Checking path alignment: vehicle=(2.838, 1.359), path_start=(0.000, 0.000), dist=3.147m
2026-01-23 19:19:29,329 - INFO - integration_test - === Calling planner.solve_mpc() at step 14 ===
2026-01-23 19:19:30,320 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:19:30,347 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:19:30,347 - INFO - integration_test - Warmstart k=0: x0=2.8383174844752306 , y0=1.3594917791267584 , psi0=0.39911896584511003 , v0=2.761418238035527 , spline0=3.2669001356786933 , a0=0.0 , w0=0.0
2026-01-23 19:19:30,347 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:19:30,348 - INFO - integration_test - Dyn residual k=0: pred=[3.0927555902037005, 1.4668023434103377, 0.39911896584511003, 2.761418238035527, 3.543041959482246], ws=[3.0927555902037005, 1.4668023434103377, 0.3991189658451102, 2.761418238035527, 3.0500764361485464], res=[0.0, 0.0, -1.6653345369377348e-16, 0.0, 0.4929655233336998], res_norm=4.930e-01
2026-01-23 19:19:30,349 - INFO - integration_test - Dyn residual k=1: pred=[3.3471936959321704, 1.5741129076939169, 0.3991189658451102, 2.761418238035527, 3.3262182599520993], ws=[3.3471936959321704, 1.5741129076939169, 0.3991189658451102, 2.761418238035527, 3.5491009924583916], res=[0.0, 0.0, 0.0, 0.0, -0.2228827325062923], res_norm=2.229e-01
2026-01-23 19:19:30,350 - INFO - integration_test - Dyn residual k=2: pred=[3.6016318016606403, 1.681423471977496, 0.3991189658451102, 2.761418238035527, 3.8252428162619445], ws=[3.6016318016606403, 1.681423471977496, 0.3991189658451102, 2.761418238035527, 3.4265032851844577], res=[0.0, 0.0, 0.0, 0.0, 0.39873953107748683], res_norm=3.987e-01
2026-01-23 19:19:30,367 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:31,338 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:19:31,358 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:31,403 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:31,426 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:31,470 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:31,491 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:31,536 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:31,557 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:31,602 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:31,624 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:31,670 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:31,692 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:31,739 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:31,761 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:31,806 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:31,829 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:31,873 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:31,902 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:31,962 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:19:31,985 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:32,033 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:19:37,595 - WARNING - integration_test - Step 14: MPC solve failed
2026-01-23 19:19:37,595 - WARNING - integration_test -   Consecutive MPC failures: 1/20
2026-01-23 19:19:37,605 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:19:37,605 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1852 scenarios available
2026-01-23 19:19:37,622 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1852 trajectory groups with 18520 total points
2026-01-23 19:19:37,623 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:19:38,044 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:19:38,062 - INFO - integration_test - Step 14: Computed 6 numeric contouring constraints for visualization (s=3.267)
2026-01-23 19:19:38,062 - DEBUG - integration_test - Step 14: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:19:38,062 - INFO - integration_test - === Applying control at step 14 ===
2026-01-23 19:19:38,062 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': 0.8}
2026-01-23 19:19:38,062 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:19:38,062 - INFO - integration_test -   Planner output success: False
2026-01-23 19:19:38,062 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': 0.8}
2026-01-23 19:19:38,064 - INFO - integration_test - Step 14 completed in 9.868s
2026-01-23 19:19:38,126 - INFO - integration_test - Step 15 (contouring until path end)
2026-01-23 19:19:38,132 - DEBUG - integration_test - Syncing planner state at step 15: vehicle_state=[3.07920196 1.47248907 0.47911897 2.56141824 3.52304196]
2026-01-23 19:19:38,133 - DEBUG - integration_test - Step 15: Using propagated spline 3.5230 (close to path, dist=0.235m, drift=0.288m)
2026-01-23 19:19:38,133 - DEBUG - integration_test -   Set spline state to 3.5230
2026-01-23 19:19:38,133 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:19:39,052 - DEBUG - integration_test - Step 15: Checking path alignment: vehicle=(3.079, 1.472), path_start=(0.000, 0.000), dist=3.413m
2026-01-23 19:19:39,052 - INFO - integration_test - === Calling planner.solve_mpc() at step 15 ===
2026-01-23 19:19:39,996 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:19:40,022 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:19:40,022 - INFO - integration_test - Warmstart k=0: x0=3.079201964245448 , y0=1.4724890748448753 , psi0=0.47911896584511005 , v0=2.561418238035527 , spline0=3.523041959482246 , a0=0.0 , w0=0.0
2026-01-23 19:19:40,022 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:19:40,023 - INFO - integration_test - Dyn residual k=0: pred=[3.3065025828456074, 1.5905698213084503, 0.47911896584511005, 2.561418238035527, 3.779183783285799], ws=[3.3065025828456074, 1.5905698213084503, 0.47911896584511027, 2.561418238035527, 3.121828801745713], res=[0.0, 0.0, -2.220446049250313e-16, 0.0, 0.6573549815400859], res_norm=6.574e-01
2026-01-23 19:19:40,024 - INFO - integration_test - Dyn residual k=1: pred=[3.533803201445767, 1.7086505677720252, 0.47911896584511027, 2.561418238035527, 3.377970625549266], ws=[3.533803201445767, 1.7086505677720252, 0.47911896584511027, 2.561418238035527, 3.414425134747402], res=[0.0, 0.0, 0.0, 0.0, -0.03645450919813609], res_norm=3.645e-02
2026-01-23 19:19:40,025 - INFO - integration_test - Dyn residual k=2: pred=[3.7611038200459266, 1.8267313142356, 0.47911896584511027, 2.561418238035527, 3.670566958550955], ws=[3.7611038200459266, 1.8267313142356, 0.47911896584511027, 2.561418238035527, 3.9093717495956635], res=[0.0, 0.0, 0.0, 0.0, -0.23880479104470842], res_norm=2.388e-01
2026-01-23 19:19:40,040 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:40,948 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:19:40,970 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:41,016 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:41,040 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:41,088 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:41,109 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:41,157 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:41,179 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:41,228 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:41,253 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:41,302 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:41,324 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:41,375 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:41,398 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:41,449 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:41,473 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:41,524 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:41,548 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:41,596 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:19:41,620 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:41,673 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:19:47,145 - WARNING - integration_test - Step 15: MPC solve failed
2026-01-23 19:19:47,145 - WARNING - integration_test -   Consecutive MPC failures: 2/20
2026-01-23 19:19:47,155 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:19:47,155 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1862 scenarios available
2026-01-23 19:19:47,168 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1862 trajectory groups with 18620 total points
2026-01-23 19:19:47,169 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:19:47,531 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:19:47,548 - INFO - integration_test - Step 15: Computed 6 numeric contouring constraints for visualization (s=3.523)
2026-01-23 19:19:47,548 - DEBUG - integration_test - Step 15: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:19:47,548 - INFO - integration_test - === Applying control at step 15 ===
2026-01-23 19:19:47,548 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': 0.8}
2026-01-23 19:19:47,549 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:19:47,549 - INFO - integration_test -   Planner output success: False
2026-01-23 19:19:47,549 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': 0.8}
2026-01-23 19:19:47,550 - INFO - integration_test - Step 15 completed in 9.418s
2026-01-23 19:19:47,602 - INFO - integration_test - Step 16 (contouring until path end)
2026-01-23 19:19:47,603 - DEBUG - integration_test - Syncing planner state at step 16: vehicle_state=[3.29292538 1.59445552 0.55911897 2.36141824 3.75918378]
2026-01-23 19:19:47,604 - DEBUG - integration_test - Step 16: Using propagated spline 3.7592 (close to path, dist=0.225m, drift=0.230m)
2026-01-23 19:19:47,604 - DEBUG - integration_test -   Set spline state to 3.7592
2026-01-23 19:19:47,604 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:19:48,510 - DEBUG - integration_test - Step 16: Checking path alignment: vehicle=(3.293, 1.594), path_start=(0.000, 0.000), dist=3.659m
2026-01-23 19:19:48,510 - INFO - integration_test - === Calling planner.solve_mpc() at step 16 ===
2026-01-23 19:19:49,530 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:19:49,558 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:19:49,558 - INFO - integration_test - Warmstart k=0: x0=3.292925378256423 , y0=1.5944555197676715 , psi0=0.55911896584511 , v0=2.361418238035527 , spline0=3.759183783285799 , a0=0.0 , w0=0.0
2026-01-23 19:19:49,558 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:19:49,559 - INFO - integration_test - Dyn residual k=0: pred=[3.4931081804972712, 1.71971447807513, 0.55911896584511, 2.361418238035527, 3.995325607089352], ws=[3.4931081804972712, 1.71971447807513, 0.5591189658451099, 2.361418238035527, 3.6139401157577686], res=[0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.3813854913315833], res_norm=3.814e-01
2026-01-23 19:19:49,560 - INFO - integration_test - Dyn residual k=1: pred=[3.6932909827381195, 1.8449734363825883, 0.5591189658451099, 2.361418238035527, 3.8500819395613215], ws=[3.6932909827381195, 1.8449734363825883, 0.5591189658451099, 2.361418238035527, 3.4539165280881545], res=[0.0, 0.0, 0.0, 0.0, 0.396165411473167], res_norm=3.962e-01
2026-01-23 19:19:49,561 - INFO - integration_test - Dyn residual k=2: pred=[3.893473784978968, 1.9702323946900466, 0.5591189658451099, 2.361418238035527, 3.6900583518917074], ws=[3.893473784978968, 1.9702323946900466, 0.5591189658451099, 2.361418238035527, 3.9718949128814796], res=[0.0, 0.0, 0.0, 0.0, -0.28183656098977217], res_norm=2.818e-01
2026-01-23 19:19:49,578 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:50,615 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:19:50,638 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:50,688 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:50,713 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:50,764 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:50,788 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:50,840 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:50,864 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:50,915 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:50,939 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:50,990 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:51,013 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:51,065 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:51,090 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:51,145 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:51,170 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:51,218 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:19:51,242 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:51,291 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:19:51,314 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:19:51,361 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:19:56,828 - WARNING - integration_test - Step 16: MPC solve failed
2026-01-23 19:19:56,828 - WARNING - integration_test -   Consecutive MPC failures: 3/20
2026-01-23 19:19:56,837 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:19:56,837 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1875 scenarios available
2026-01-23 19:19:56,852 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1875 trajectory groups with 18750 total points
2026-01-23 19:19:56,853 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:19:57,331 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:19:57,348 - INFO - integration_test - Step 16: Computed 6 numeric contouring constraints for visualization (s=3.759)
2026-01-23 19:19:57,349 - DEBUG - integration_test - Step 16: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:19:57,349 - INFO - integration_test - === Applying control at step 16 ===
2026-01-23 19:19:57,349 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': 0.42324731649385416}
2026-01-23 19:19:57,349 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:19:57,349 - INFO - integration_test -   Planner output success: False
2026-01-23 19:19:57,349 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': 0.42324731649385416}
2026-01-23 19:19:57,350 - INFO - integration_test - Step 16 completed in 9.747s
2026-01-23 19:19:57,415 - INFO - integration_test - Step 17 (contouring until path end)
2026-01-23 19:19:57,425 - DEBUG - integration_test - Syncing planner state at step 17: vehicle_state=[3.48207425 1.71837162 0.6014437  2.16141824 3.97532561]
2026-01-23 19:19:57,426 - DEBUG - integration_test - Step 17: Using propagated spline 3.9753 (close to path, dist=0.201m, drift=0.152m)
2026-01-23 19:19:57,426 - DEBUG - integration_test -   Set spline state to 3.9753
2026-01-23 19:19:57,426 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:19:58,385 - DEBUG - integration_test - Step 17: Checking path alignment: vehicle=(3.482, 1.718), path_start=(0.000, 0.000), dist=3.883m
2026-01-23 19:19:58,385 - INFO - integration_test - === Calling planner.solve_mpc() at step 17 ===
2026-01-23 19:19:59,403 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:19:59,429 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:19:59,429 - INFO - integration_test - Warmstart k=0: x0=3.4820742503099837 , y0=1.718371620108895 , psi0=0.6014436974944954 , v0=2.1614182380355267 , spline0=3.975325607089352 , a0=0.0 , w0=0.0
2026-01-23 19:19:59,429 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:19:59,430 - INFO - integration_test - Dyn residual k=0: pred=[3.6602874165599744, 1.8406718873705785, 0.6014436974944954, 2.1614182380355267, 4.191467430892905], ws=[3.6602874165599744, 1.8406718873705785, 0.6014436974944957, 2.1614182380355267, 3.6700253484874064], res=[0.0, 0.0, -2.220446049250313e-16, 0.0, 0.5214420824054984], res_norm=5.214e-01
2026-01-23 19:19:59,431 - INFO - integration_test - Dyn residual k=1: pred=[3.838500582809965, 1.962972154632262, 0.6014436974944957, 2.1614182380355267, 3.886167172290959], ws=[3.838500582809965, 1.962972154632262, 0.6014436974944957, 2.1614182380355267, 3.7124759275994275], res=[0.0, 0.0, 0.0, 0.0, 0.17369124469153174], res_norm=1.737e-01
2026-01-23 19:19:59,432 - INFO - integration_test - Dyn residual k=2: pred=[4.016713749059956, 2.0852724218939453, 0.6014436974944957, 2.1614182380355267, 3.9286177514029803], ws=[3.901437088822054, 1.9735974449156455, 0.6014436974944957, 2.1614182380355267, 4.191790420751406], res=[0.1152766602379014, 0.11167497697829987, 0.0, 0.0, -0.263172669348426], res_norm=3.083e-01
2026-01-23 19:19:59,450 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:00,406 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:20:00,427 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:00,473 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:00,495 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:00,540 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:00,560 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:00,605 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:00,626 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:00,672 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:00,694 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:00,738 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:00,759 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:00,804 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:00,825 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:00,871 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:00,890 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:00,933 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:00,953 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:00,995 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:20:01,014 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:01,057 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:20:06,550 - WARNING - integration_test - Step 17: MPC solve failed
2026-01-23 19:20:06,551 - WARNING - integration_test -   Consecutive MPC failures: 4/20
2026-01-23 19:20:06,559 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:20:06,559 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1859 scenarios available
2026-01-23 19:20:06,574 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1859 trajectory groups with 18590 total points
2026-01-23 19:20:06,575 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:20:07,052 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:20:07,070 - INFO - integration_test - Step 17: Computed 6 numeric contouring constraints for visualization (s=3.975)
2026-01-23 19:20:07,070 - DEBUG - integration_test - Step 17: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:20:07,070 - INFO - integration_test - === Applying control at step 17 ===
2026-01-23 19:20:07,070 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': 0.48702451735080476}
2026-01-23 19:20:07,070 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:20:07,070 - INFO - integration_test -   Planner output success: False
2026-01-23 19:20:07,070 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': 0.48702451735080476}
2026-01-23 19:20:07,072 - INFO - integration_test - Step 17 completed in 9.647s
2026-01-23 19:20:07,136 - INFO - integration_test - Step 18 (contouring until path end)
2026-01-23 19:20:07,139 - DEBUG - integration_test - Syncing planner state at step 18: vehicle_state=[3.64918276 1.83903978 0.65014615 1.96141824 4.17146743]
2026-01-23 19:20:07,140 - DEBUG - integration_test - Step 18: Using propagated spline 4.1715 (close to path, dist=0.181m, drift=0.054m)
2026-01-23 19:20:07,140 - DEBUG - integration_test -   Set spline state to 4.1715
2026-01-23 19:20:07,141 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:20:08,070 - DEBUG - integration_test - Step 18: Checking path alignment: vehicle=(3.649, 1.839), path_start=(0.000, 0.000), dist=4.086m
2026-01-23 19:20:08,070 - INFO - integration_test - === Calling planner.solve_mpc() at step 18 ===
2026-01-23 19:20:08,968 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:20:08,993 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:20:08,993 - INFO - integration_test - Warmstart k=0: x0=3.649182764773226 , y0=1.839039776007372 , psi0=0.6501461492295759 , v0=1.9614182380355267 , spline0=4.171467430892904 , a0=0.0 , w0=0.0
2026-01-23 19:20:08,993 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:20:08,994 - INFO - integration_test - Dyn residual k=0: pred=[3.8053107429943123, 1.9577649606211678, 0.6501461492295759, 1.9614182380355267, 4.367609254696457], ws=[3.8053107429943123, 1.9577649606211678, 0.6501461492295757, 1.9614182380355267, 3.7140014936754655], res=[0.0, 0.0, 2.220446049250313e-16, 0.0, 0.6536077610209912], res_norm=6.536e-01
2026-01-23 19:20:08,995 - INFO - integration_test - Dyn residual k=1: pred=[3.9614387212153988, 2.0764901452349633, 0.6501461492295757, 1.9614182380355267, 3.9101433174790183], ws=[3.9614387212153988, 2.0764901452349633, 0.6501461492295757, 1.9614182380355267, 4.0013726004169845], res=[0.0, 0.0, 0.0, 0.0, -0.09122928293796617], res_norm=9.123e-02
2026-01-23 19:20:08,995 - INFO - integration_test - Dyn residual k=2: pred=[4.117566699436485, 2.195215329848759, 0.6501461492295757, 1.9614182380355267, 4.197514424220537], ws=[4.117566699436485, 2.195215329848759, 0.6501461492295757, 1.9614182380355267, 4.042633248816434], res=[0.0, 0.0, 0.0, 0.0, 0.1548811754041033], res_norm=1.549e-01
2026-01-23 19:20:09,010 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:09,955 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:20:09,976 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:10,022 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:10,046 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:10,096 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:10,119 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:10,168 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:10,191 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:10,241 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:10,264 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:10,314 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:10,337 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:10,389 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:10,413 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:10,465 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:10,490 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:10,541 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:10,565 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:10,617 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:20:10,640 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:10,690 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:20:16,465 - WARNING - integration_test - Step 18: MPC solve failed
2026-01-23 19:20:16,465 - WARNING - integration_test -   Consecutive MPC failures: 5/20
2026-01-23 19:20:16,473 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:20:16,473 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1859 scenarios available
2026-01-23 19:20:16,488 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1859 trajectory groups with 18590 total points
2026-01-23 19:20:16,489 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:20:16,737 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:20:16,753 - INFO - integration_test - Step 18: Computed 6 numeric contouring constraints for visualization (s=4.171)
2026-01-23 19:20:16,753 - DEBUG - integration_test - Step 18: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:20:16,753 - INFO - integration_test - === Applying control at step 18 ===
2026-01-23 19:20:16,753 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': 0.8}
2026-01-23 19:20:16,753 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:20:16,753 - INFO - integration_test -   Planner output success: False
2026-01-23 19:20:16,753 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': 0.8}
2026-01-23 19:20:16,755 - INFO - integration_test - Step 18 completed in 9.616s
2026-01-23 19:20:16,819 - INFO - integration_test - Step 19 (contouring until path end)
2026-01-23 19:20:16,826 - DEBUG - integration_test - Syncing planner state at step 19: vehicle_state=[3.79277318 1.95741256 0.73014615 1.76141824 4.34760925]
2026-01-23 19:20:16,826 - DEBUG - integration_test - Step 19: Using propagated spline 4.3476 (close to path, dist=0.171m, drift=0.230m)
2026-01-23 19:20:16,826 - DEBUG - integration_test -   Set spline state to 4.3476
2026-01-23 19:20:16,827 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:20:18,031 - DEBUG - integration_test - Step 19: Checking path alignment: vehicle=(3.793, 1.957), path_start=(0.000, 0.000), dist=4.268m
2026-01-23 19:20:18,031 - INFO - integration_test - === Calling planner.solve_mpc() at step 19 ===
2026-01-23 19:20:19,060 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:20:19,089 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:20:19,089 - INFO - integration_test - Warmstart k=0: x0=3.792773177175955 , y0=1.9574125574298469 , psi0=0.7301461492295759 , v0=1.7614182380355268 , spline0=4.347609254696457 , a0=0.0 , w0=0.0
2026-01-23 19:20:19,089 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:20:19,090 - INFO - integration_test - Dyn residual k=0: pred=[3.924012386835397, 2.0748953729426143, 0.7301461492295759, 1.7614182380355268, 4.52375107850001], ws=[3.924012386835397, 2.0748953729426143, 0.7301461492295758, 1.7614182380355268, 4.204984794390195], res=[0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.3187662841098149], res_norm=3.188e-01
2026-01-23 19:20:19,091 - INFO - integration_test - Dyn residual k=1: pred=[4.055251596494839, 2.1923781884553817, 0.7301461492295758, 1.7614182380355268, 4.381126618193748], ws=[4.055251596494839, 2.1923781884553817, 0.7301461492295758, 1.7614182380355268, 4.473178446437539], res=[0.0, 0.0, 0.0, 0.0, -0.09205182824379143], res_norm=9.205e-02
2026-01-23 19:20:19,092 - INFO - integration_test - Dyn residual k=2: pred=[4.18649080615428, 2.309861003968149, 0.7301461492295758, 1.7614182380355268, 4.649320270241092], ws=[3.9743730302489997, 2.1680759136889414, 0.7301461492295758, 1.7614182380355268, 3.995847992719988], res=[0.21211777590528058, 0.14178509027920772, 0.0, 0.0, 0.6534722775211042], res_norm=7.015e-01
2026-01-23 19:20:19,110 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:20,143 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:20:20,165 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:20,212 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:20,235 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:20,285 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:20,307 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:20,356 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:20,377 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:20,425 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:20,446 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:20,497 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:20,519 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:20,567 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:20,589 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:20,636 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:20,658 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:20,708 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:20,730 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:20,781 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:20:20,805 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:20,853 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:20:26,760 - WARNING - integration_test - Step 19: MPC solve failed
2026-01-23 19:20:26,761 - WARNING - integration_test -   Consecutive MPC failures: 6/20
2026-01-23 19:20:26,777 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:20:26,777 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1859 scenarios available
2026-01-23 19:20:26,797 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1859 trajectory groups with 18590 total points
2026-01-23 19:20:26,798 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:20:27,309 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:20:27,339 - INFO - integration_test - Step 19: Computed 6 numeric contouring constraints for visualization (s=4.348)
2026-01-23 19:20:27,340 - DEBUG - integration_test - Step 19: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:20:27,340 - INFO - integration_test - === Applying control at step 19 ===
2026-01-23 19:20:27,340 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': -0.16629018061509981}
2026-01-23 19:20:27,340 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:20:27,340 - INFO - integration_test -   Planner output success: False
2026-01-23 19:20:27,340 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': -0.16629018061509981}
2026-01-23 19:20:27,342 - INFO - integration_test - Step 19 completed in 10.516s
2026-01-23 19:20:27,419 - INFO - integration_test - Step 20 (contouring until path end)
2026-01-23 19:20:27,428 - DEBUG - integration_test - Syncing planner state at step 20: vehicle_state=[3.91745893 2.06721207 0.71351713 1.56141824 4.50375108]
2026-01-23 19:20:27,429 - DEBUG - integration_test - Step 20: Using propagated spline 4.5038 (close to path, dist=0.084m, drift=0.092m)
2026-01-23 19:20:27,430 - DEBUG - integration_test -   Set spline state to 4.5038
2026-01-23 19:20:27,430 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:20:28,491 - DEBUG - integration_test - Step 20: Checking path alignment: vehicle=(3.917, 2.067), path_start=(0.000, 0.000), dist=4.429m
2026-01-23 19:20:28,491 - INFO - integration_test - === Calling planner.solve_mpc() at step 20 ===
2026-01-23 19:20:29,719 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:20:29,747 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:20:29,747 - INFO - integration_test - Warmstart k=0: x0=3.9174589344342663 , y0=2.067212066772127 , psi0=0.7135171311680659 , v0=1.5614182380355268 , spline0=4.503751078500009 , a0=0.0 , w0=0.0
2026-01-23 19:20:29,747 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:20:29,748 - INFO - integration_test - Dyn residual k=0: pred=[4.035512240819286, 2.1694064207857635, 0.7135171311680659, 1.5614182380355268, 4.659892902303562], ws=[4.035512240819286, 2.1694064207857635, 0.7135171311680661, 1.5614182380355268, 4.030362928568808], res=[0.0, 0.0, -2.220446049250313e-16, 0.0, 0.629529973734754], res_norm=6.295e-01
2026-01-23 19:20:29,749 - INFO - integration_test - Dyn residual k=1: pred=[4.153565547204305, 2.2716007747994, 0.7135171311680661, 1.5614182380355268, 4.18650475237236], ws=[4.153565547204305, 2.2716007747994, 0.7135171311680661, 1.5614182380355268, 4.511715333243912], res=[0.0, 0.0, 0.0, 0.0, -0.32521058087155197], res_norm=3.252e-01
2026-01-23 19:20:29,750 - INFO - integration_test - Dyn residual k=2: pred=[4.271618853589325, 2.3737951288130366, 0.7135171311680661, 1.5614182380355268, 4.6678571570474645], ws=[4.037542106799654, 2.0259391762472054, 0.7135171311680661, 1.5614182380355268, 4.451684716870002], res=[0.23407674678967094, 0.34785595256583113, 0.0, 0.0, 0.21617244017746273], res_norm=4.717e-01
2026-01-23 19:20:29,767 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:30,829 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:20:30,853 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:30,913 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:30,941 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:30,994 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:31,018 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:31,071 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:31,095 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:31,152 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:31,186 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:31,255 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:31,278 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:31,329 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:31,353 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:31,405 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:31,429 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:31,479 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:31,502 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:31,551 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:20:31,573 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:31,622 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:20:36,792 - WARNING - integration_test - Step 20: MPC solve failed
2026-01-23 19:20:36,792 - WARNING - integration_test -   Consecutive MPC failures: 7/20
2026-01-23 19:20:36,800 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:20:36,800 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1850 scenarios available
2026-01-23 19:20:36,814 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1850 trajectory groups with 18500 total points
2026-01-23 19:20:36,815 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:20:37,138 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:20:37,154 - INFO - integration_test - Step 20: Computed 6 numeric contouring constraints for visualization (s=4.504)
2026-01-23 19:20:37,154 - DEBUG - integration_test - Step 20: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:20:37,154 - INFO - integration_test - === Applying control at step 20 ===
2026-01-23 19:20:37,154 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': 0.03334996652644229}
2026-01-23 19:20:37,154 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:20:37,154 - INFO - integration_test -   Planner output success: False
2026-01-23 19:20:37,154 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': 0.03334996652644229}
2026-01-23 19:20:37,156 - INFO - integration_test - Step 20 completed in 9.728s
2026-01-23 19:20:37,214 - INFO - integration_test - Step 21 (contouring until path end)
2026-01-23 19:20:37,216 - DEBUG - integration_test - Syncing planner state at step 21: vehicle_state=[4.02779554 2.16304132 0.71685213 1.36141824 4.6398929 ]
2026-01-23 19:20:37,216 - DEBUG - integration_test - Step 21: Using propagated spline 4.6399 (close to path, dist=0.160m, drift=0.228m)
2026-01-23 19:20:37,216 - DEBUG - integration_test -   Set spline state to 4.6399
2026-01-23 19:20:37,217 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:20:38,276 - DEBUG - integration_test - Step 21: Checking path alignment: vehicle=(4.028, 2.163), path_start=(0.000, 0.000), dist=4.572m
2026-01-23 19:20:38,277 - INFO - integration_test - === Calling planner.solve_mpc() at step 21 ===
2026-01-23 19:20:39,272 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:20:39,301 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:20:39,301 - INFO - integration_test - Warmstart k=0: x0=4.0277955398156715 , y0=2.1630413233345127 , psi0=0.7168521278207102 , v0=1.3614182380355269 , spline0=4.639892902303562 , a0=0.0 , w0=0.0
2026-01-23 19:20:39,301 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:20:39,302 - INFO - integration_test - Dyn residual k=0: pred=[4.130429819307688, 2.2524885192755386, 0.7168521278207102, 1.3614182380355269, 4.776034726107115], ws=[3.9860809056760056, 2.2118683143958098, 0.7168521278207103, 1.3614182380355269, 4.009617214627173], res=[0.14434891363168223, 0.04062020487972884, -1.1102230246251565e-16, 0.0, 0.7664175114799416], res_norm=7.809e-01
2026-01-23 19:20:39,303 - INFO - integration_test - Dyn residual k=1: pred=[4.088715185168022, 2.3013155103368357, 0.7168521278207103, 1.3614182380355269, 4.145759038430726], ws=[4.060289256983559, 2.266175823572145, 0.7168521278207103, 1.3614182380355269, 4.037864361039099], res=[0.02842592818446299, 0.03513968676469048, 0.0, 0.0, 0.10789467739162717], res_norm=1.170e-01
2026-01-23 19:20:39,304 - INFO - integration_test - Dyn residual k=2: pred=[4.162923536475575, 2.355623019513171, 0.7168521278207103, 1.3614182380355269, 4.174006184842652], ws=[4.007822716443297, 2.313599088099161, 0.7168521278207103, 1.3614182380355269, 4.504080000483098], res=[0.15510082003227854, 0.042023931414010285, 0.0, 0.0, -0.33007381564044636], res_norm=3.671e-01
2026-01-23 19:20:39,323 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:40,393 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:20:40,415 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:40,464 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:40,488 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:40,537 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:40,561 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:40,610 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:40,632 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:40,678 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:40,701 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:40,750 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:40,774 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:40,822 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:40,846 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:40,896 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:40,919 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:40,970 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:40,993 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:41,043 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:20:41,065 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:41,112 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:20:46,447 - WARNING - integration_test - Step 21: MPC solve failed
2026-01-23 19:20:46,447 - WARNING - integration_test -   Consecutive MPC failures: 8/20
2026-01-23 19:20:46,468 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:20:46,468 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1857 scenarios available
2026-01-23 19:20:46,489 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1857 trajectory groups with 18570 total points
2026-01-23 19:20:46,490 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:20:46,990 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:20:47,016 - INFO - integration_test - Step 21: Computed 6 numeric contouring constraints for visualization (s=4.640)
2026-01-23 19:20:47,017 - DEBUG - integration_test - Step 21: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:20:47,017 - INFO - integration_test - === Applying control at step 21 ===
2026-01-23 19:20:47,017 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': -0.40293204641882774}
2026-01-23 19:20:47,017 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:20:47,017 - INFO - integration_test -   Planner output success: False
2026-01-23 19:20:47,017 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': -0.40293204641882774}
2026-01-23 19:20:47,019 - INFO - integration_test - Step 21 completed in 9.803s
2026-01-23 19:20:47,094 - INFO - integration_test - Step 22 (contouring until path end)
2026-01-23 19:20:47,098 - DEBUG - integration_test - Syncing planner state at step 22: vehicle_state=[4.12449169 2.24403186 0.67655892 1.16141824 4.75603473]
2026-01-23 19:20:47,098 - DEBUG - integration_test - Step 22: Using propagated spline 4.7560 (close to path, dist=0.277m, drift=0.344m)
2026-01-23 19:20:47,098 - DEBUG - integration_test -   Set spline state to 4.7560
2026-01-23 19:20:47,099 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:20:48,138 - DEBUG - integration_test - Step 22: Checking path alignment: vehicle=(4.124, 2.244), path_start=(0.000, 0.000), dist=4.695m
2026-01-23 19:20:48,138 - INFO - integration_test - === Calling planner.solve_mpc() at step 22 ===
2026-01-23 19:20:49,378 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:20:49,405 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:20:49,405 - INFO - integration_test - Warmstart k=0: x0=4.124491687699809 , y0=2.2440318571460423 , psi0=0.6765589231788274 , v0=1.161418238035527 , spline0=4.7560347261071145 , a0=0.0 , w0=0.0
2026-01-23 19:20:49,405 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:20:49,406 - INFO - integration_test - Dyn residual k=0: pred=[4.215051165206195, 2.316749834773214, 0.6765589231788274, 1.161418238035527, 4.872176549910667], ws=[4.215051165206195, 2.316749834773214, 0.6765589231788276, 1.161418238035527, 4.3048442444279695], res=[0.0, 0.0, -2.220446049250313e-16, 0.0, 0.5673323054826973], res_norm=5.673e-01
2026-01-23 19:20:49,407 - INFO - integration_test - Dyn residual k=1: pred=[4.3056106427125815, 2.3894678124003854, 0.6765589231788276, 1.161418238035527, 4.420986068231522], ws=[4.133341745356036, 2.0293423289492383, 0.6765589231788276, 1.161418238035527, 4.481263811050996], res=[0.17226889735654538, 0.36012548345114714, 0.0, 0.0, -0.06027774281947451], res_norm=4.037e-01
2026-01-23 19:20:49,408 - INFO - integration_test - Dyn residual k=2: pred=[4.223901222862422, 2.10206030657641, 0.6765589231788276, 1.161418238035527, 4.597405634854549], ws=[3.900871480983204, 2.392871491230792, 0.6765589231788276, 1.161418238035527, 4.471440895868968], res=[0.3230297418792185, -0.29081118465438216, 0.0, 0.0, 0.12596473898558092], res_norm=4.525e-01
2026-01-23 19:20:49,424 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:50,341 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:20:50,362 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:50,406 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:50,426 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:50,470 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:50,491 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:50,534 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:50,560 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:50,635 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:50,662 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:50,712 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:50,733 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:50,783 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:50,805 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:50,855 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:50,879 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:50,933 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:50,959 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:51,010 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:20:51,034 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:51,085 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:20:55,154 - WARNING - integration_test - Step 22: MPC solve failed
2026-01-23 19:20:55,154 - WARNING - integration_test -   Consecutive MPC failures: 9/20
2026-01-23 19:20:55,168 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:20:55,168 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1855 scenarios available
2026-01-23 19:20:55,184 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1855 trajectory groups with 18550 total points
2026-01-23 19:20:55,185 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:20:55,540 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:20:55,562 - INFO - integration_test - Step 22: Computed 6 numeric contouring constraints for visualization (s=4.756)
2026-01-23 19:20:55,562 - DEBUG - integration_test - Step 22: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:20:55,562 - INFO - integration_test - === Applying control at step 22 ===
2026-01-23 19:20:55,562 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': -0.2893386903675701}
2026-01-23 19:20:55,562 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:20:55,562 - INFO - integration_test -   Planner output success: False
2026-01-23 19:20:55,562 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': -0.2893386903675701}
2026-01-23 19:20:55,564 - INFO - integration_test - Step 22 completed in 8.467s
2026-01-23 19:20:55,642 - INFO - integration_test - Step 23 (contouring until path end)
2026-01-23 19:20:55,642 - DEBUG - integration_test - Syncing planner state at step 23: vehicle_state=[4.20817401 2.30932023 0.64762505 0.96141824 4.85217655]
2026-01-23 19:20:55,643 - DEBUG - integration_test - Step 23: Using propagated spline 4.8522 (close to path, dist=0.380m, drift=0.441m)
2026-01-23 19:20:55,643 - DEBUG - integration_test -   Set spline state to 4.8522
2026-01-23 19:20:55,644 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:20:56,597 - DEBUG - integration_test - Step 23: Checking path alignment: vehicle=(4.208, 2.309), path_start=(0.000, 0.000), dist=4.800m
2026-01-23 19:20:56,598 - INFO - integration_test - === Calling planner.solve_mpc() at step 23 ===
2026-01-23 19:20:57,568 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:20:57,597 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:20:57,597 - INFO - integration_test - Warmstart k=0: x0=4.208174014401423 , y0=2.309320227801653 , psi0=0.6476250541420704 , v0=0.961418238035527 , spline0=4.852176549910667 , a0=0.0 , w0=0.0
2026-01-23 19:20:57,597 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:20:57,598 - INFO - integration_test - Dyn residual k=0: pred=[4.284848929912505, 2.3673220175640544, 0.6476250541420704, 0.961418238035527, 4.94831837371422], ws=[4.121300674426591, 1.9483623449651741, 0.6476250541420705, 0.961418238035527, 4.484823984057747], res=[0.16354825548591467, 0.41895967259888023, -1.1102230246251565e-16, 0.0, 0.46349438965647316], res_norm=6.458e-01
2026-01-23 19:20:57,599 - INFO - integration_test - Dyn residual k=1: pred=[4.197975589937673, 2.0063641347275754, 0.6476250541420705, 0.961418238035527, 4.5809658078613], ws=[4.354297656442092, 2.004164707275404, 0.6476250541420705, 0.961418238035527, 4.317398254166223], res=[-0.15632206650441827, 0.0021994274521714985, 0.0, 0.0, 0.26356755369507656], res_norm=3.064e-01
2026-01-23 19:20:57,600 - INFO - integration_test - Dyn residual k=2: pred=[4.430972571953174, 2.062166497037805, 0.6476250541420705, 0.961418238035527, 4.413540077969776], ws=[4.195054170782864, 2.052904290958466, 0.6476250541420705, 0.961418238035527, 4.717953542645915], res=[0.23591840117031015, 0.00926220607933903, 0.0, 0.0, -0.3044134646761396], res_norm=3.852e-01
2026-01-23 19:20:57,618 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:58,549 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:20:58,570 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:58,614 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:58,634 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:58,678 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:58,697 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:58,739 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:58,761 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:58,806 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:58,826 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:58,869 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:58,889 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:58,935 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:58,958 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:59,005 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:59,025 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:59,071 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:20:59,092 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:59,134 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:20:59,160 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:20:59,203 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:21:05,005 - WARNING - integration_test - Step 23: MPC solve failed
2026-01-23 19:21:05,005 - WARNING - integration_test -   Consecutive MPC failures: 10/20
2026-01-23 19:21:05,016 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:21:05,016 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1850 scenarios available
2026-01-23 19:21:05,031 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1850 trajectory groups with 18500 total points
2026-01-23 19:21:05,032 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:21:05,370 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:21:05,395 - INFO - integration_test - Step 23: Computed 6 numeric contouring constraints for visualization (s=4.852)
2026-01-23 19:21:05,395 - DEBUG - integration_test - Step 23: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:21:05,395 - INFO - integration_test - === Applying control at step 23 ===
2026-01-23 19:21:05,395 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': -0.47418088561682037}
2026-01-23 19:21:05,395 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:21:05,395 - INFO - integration_test -   Planner output success: False
2026-01-23 19:21:05,395 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': -0.47418088561682037}
2026-01-23 19:21:05,396 - INFO - integration_test - Step 23 completed in 9.755s
2026-01-23 19:21:05,458 - INFO - integration_test - Step 24 (contouring until path end)
2026-01-23 19:21:05,462 - DEBUG - integration_test - Syncing planner state at step 24: vehicle_state=[4.27803373 2.35970524 0.60020697 0.76141824 4.92831837]
2026-01-23 19:21:05,463 - DEBUG - integration_test - Step 24: Using propagated spline 4.9283 (close to path, dist=0.465m, drift=0.517m)
2026-01-23 19:21:05,463 - DEBUG - integration_test -   Set spline state to 4.9283
2026-01-23 19:21:05,463 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:21:06,327 - DEBUG - integration_test - Step 24: Checking path alignment: vehicle=(4.278, 2.360), path_start=(0.000, 0.000), dist=4.886m
2026-01-23 19:21:06,327 - INFO - integration_test - === Calling planner.solve_mpc() at step 24 ===
2026-01-23 19:21:07,272 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:21:07,298 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:21:07,298 - INFO - integration_test - Warmstart k=0: x0=4.278033734022129 , y0=2.3597052391930533 , psi0=0.6002069655803883 , v0=0.761418238035527 , spline0=4.9283183737142195 , a0=0.0 , w0=0.0
2026-01-23 19:21:07,298 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:21:07,299 - INFO - integration_test - Dyn residual k=0: pred=[4.34086739359342, 2.4027111522401023, 0.6002069655803883, 0.761418238035527, 5.004460197517772], ws=[4.126252686340067, 2.3062208103694566, 0.6002069655803881, 0.761418238035527, 4.077369492765738], res=[0.21461470725335374, 0.09649034187064576, 2.220446049250313e-16, 0.0, 0.9270907047520343], res_norm=9.565e-01
2026-01-23 19:21:07,300 - INFO - integration_test - Dyn residual k=1: pred=[4.189086345911358, 2.3492267234165056, 0.6002069655803881, 0.761418238035527, 4.15351131656929], ws=[4.083547611197411, 2.513329289282878, 0.6002069655803881, 0.761418238035527, 4.74942322457487], res=[0.1055387347139467, -0.16410256586637217, 0.0, 0.0, -0.5959119080055801], res_norm=6.270e-01
2026-01-23 19:21:07,300 - INFO - integration_test - Dyn residual k=2: pred=[4.146381270768702, 2.556335202329927, 0.6002069655803881, 0.761418238035527, 4.825565048378422], ws=[4.084706115978046, 1.8941520381769006, 0.6002069655803881, 0.761418238035527, 3.78154438942478], res=[0.06167515479065688, 0.6621831641530262, 0.0, 0.0, 1.044020658953642], res_norm=1.238e+00
2026-01-23 19:21:07,317 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:08,397 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:21:08,420 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:08,470 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:08,495 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:08,544 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:08,567 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:08,618 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:08,642 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:08,690 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:08,713 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:08,762 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:08,787 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:08,838 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:08,861 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:08,910 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:08,932 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:08,984 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:09,009 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:09,058 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:21:09,082 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:09,128 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:21:14,459 - WARNING - integration_test - Step 24: MPC solve failed
2026-01-23 19:21:14,459 - WARNING - integration_test -   Consecutive MPC failures: 11/20
2026-01-23 19:21:14,471 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:21:14,472 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1867 scenarios available
2026-01-23 19:21:14,718 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1867 trajectory groups with 18670 total points
2026-01-23 19:21:14,719 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:21:15,302 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:21:15,330 - INFO - integration_test - Step 24: Computed 6 numeric contouring constraints for visualization (s=4.928)
2026-01-23 19:21:15,331 - DEBUG - integration_test - Step 24: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:21:15,331 - INFO - integration_test - === Applying control at step 24 ===
2026-01-23 19:21:15,331 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': -0.4357615525377003}
2026-01-23 19:21:15,331 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:21:15,331 - INFO - integration_test -   Planner output success: False
2026-01-23 19:21:15,331 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': -0.4357615525377003}
2026-01-23 19:21:15,333 - INFO - integration_test - Step 24 completed in 9.871s
2026-01-23 19:21:15,410 - INFO - integration_test - Step 25 (contouring until path end)
2026-01-23 19:21:15,422 - DEBUG - integration_test - Syncing planner state at step 25: vehicle_state=[4.33337206 2.39592297 0.55663081 0.56141824 4.9844602 ]
2026-01-23 19:21:15,422 - DEBUG - integration_test - Step 25: Using propagated spline 4.9845 (close to path, dist=0.433m, drift=0.279m)
2026-01-23 19:21:15,423 - DEBUG - integration_test -   Set spline state to 4.9845
2026-01-23 19:21:15,424 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:21:16,594 - DEBUG - integration_test - Step 25: Checking path alignment: vehicle=(4.333, 2.396), path_start=(0.000, 0.000), dist=4.952m
2026-01-23 19:21:16,594 - INFO - integration_test - === Calling planner.solve_mpc() at step 25 ===
2026-01-23 19:21:17,593 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:21:17,619 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:21:17,619 - INFO - integration_test - Warmstart k=0: x0=4.333372057363899 , y0=2.3959229682068552 , psi0=0.5566308103266183 , v0=0.561418238035527 , spline0=4.984460197517772 , a0=0.0 , w0=0.0
2026-01-23 19:21:17,620 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:21:17,620 - INFO - integration_test - Dyn residual k=0: pred=[4.381038709531765, 2.4255843007982416, 0.5566308103266183, 0.561418238035527, 5.040602021321325], ws=[3.6344244678860567, 2.0486611772014696, 0.5566308103266184, 0.561418238035527, 4.143342872987389], res=[0.7466142416457084, 0.37692312359677205, -1.1102230246251565e-16, 0.0, 0.8972591483339363], res_norm=1.227e+00
2026-01-23 19:21:17,621 - INFO - integration_test - Dyn residual k=1: pred=[3.6820911200539226, 2.078322509792856, 0.5566308103266184, 0.561418238035527, 4.199484696790941], ws=[4.133876924268498, 2.261917573508072, 0.5566308103266184, 0.561418238035527, 4.728814521176494], res=[-0.4517858042145755, -0.18359506371521617, 0.0, 0.0, -0.5293298243855524], res_norm=7.197e-01
2026-01-23 19:21:17,622 - INFO - integration_test - Dyn residual k=2: pred=[4.181543576436364, 2.2915789060994585, 0.5566308103266184, 0.561418238035527, 4.7849563449800465], ws=[4.282737812265263, 2.1615918594110832, 0.5566308103266184, 0.561418238035527, 4.753629052154334], res=[-0.10119423582889908, 0.12998704668837524, 0.0, 0.0, 0.03132729282571223], res_norm=1.677e-01
2026-01-23 19:21:17,640 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:18,618 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:21:18,638 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:18,681 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:18,701 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:18,743 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:18,764 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:18,809 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:18,829 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:18,871 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:18,892 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:18,934 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:18,953 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:19,000 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:19,022 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:19,066 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:19,086 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:19,129 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:19,150 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:19,195 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:21:19,215 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:19,259 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:21:24,927 - WARNING - integration_test - Step 25: MPC solve failed
2026-01-23 19:21:24,928 - WARNING - integration_test -   Consecutive MPC failures: 12/20
2026-01-23 19:21:24,941 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:21:24,941 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1858 scenarios available
2026-01-23 19:21:25,201 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1858 trajectory groups with 18580 total points
2026-01-23 19:21:25,202 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:21:25,647 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:21:25,670 - INFO - integration_test - Step 25: Computed 6 numeric contouring constraints for visualization (s=4.984)
2026-01-23 19:21:25,671 - DEBUG - integration_test - Step 25: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:21:25,671 - INFO - integration_test - === Applying control at step 25 ===
2026-01-23 19:21:25,671 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': -0.3699123773342583}
2026-01-23 19:21:25,671 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:21:25,671 - INFO - integration_test -   Planner output success: False
2026-01-23 19:21:25,671 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': -0.3699123773342583}
2026-01-23 19:21:25,672 - INFO - integration_test - Step 25 completed in 10.251s
2026-01-23 19:21:25,743 - INFO - integration_test - Step 26 (contouring until path end)
2026-01-23 19:21:25,756 - DEBUG - integration_test - Syncing planner state at step 26: vehicle_state=[4.37295861 2.41962388 0.51963957 0.36141824 5.02060202]
2026-01-23 19:21:25,756 - DEBUG - integration_test - Step 26: Using propagated spline 5.0206 (close to path, dist=0.388m, drift=0.315m)
2026-01-23 19:21:25,756 - DEBUG - integration_test -   Set spline state to 5.0206
2026-01-23 19:21:25,758 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:21:26,718 - DEBUG - integration_test - Step 26: Checking path alignment: vehicle=(4.373, 2.420), path_start=(0.000, 0.000), dist=4.998m
2026-01-23 19:21:26,718 - INFO - integration_test - === Calling planner.solve_mpc() at step 26 ===
2026-01-23 19:21:27,576 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:21:27,602 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:21:27,602 - INFO - integration_test - Warmstart k=0: x0=4.372958614592099 , y0=2.4196238844124873 , psi0=0.5196395725931925 , v0=0.36141823803552703 , spline0=5.020602021321325 , a0=0.0 , w0=0.0
2026-01-23 19:21:27,602 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:21:27,603 - INFO - integration_test - Dyn residual k=0: pred=[4.404329653050978, 2.4375707329898435, 0.5196395725931925, 0.36141823803552703, 5.0567438451248785], ws=[4.389436418777893, 2.0080049596328458, 0.5196395725931926, 0.37874095828108617, 4.306671264381704], res=[0.014893234273085199, 0.42956577335699775, -1.1102230246251565e-16, -0.017322720245559142, 0.7500725807431747], res_norm=8.647e-01
2026-01-23 19:21:27,604 - INFO - integration_test - Dyn residual k=1: pred=[4.422311066257694, 2.0268119978865307, 0.5196395725931926, 0.37874095828108617, 4.344545360209812], ws=[3.864326354474473, 2.1823441963962162, 0.5196395725931926, 0.3938983384959504, 3.7661519340596894], res=[0.5579847117832211, -0.15553219850968558, 0.0, -0.015157380214864236, 0.5783934261501229], res_norm=8.187e-01
2026-01-23 19:21:27,605 - INFO - integration_test - Dyn residual k=2: pred=[3.8985166598475804, 2.2019039006166885, 0.5196395725931926, 0.3938983384959504, 3.8055417679092844], ws=[4.162431341464993, 2.159433820935683, 0.5196395725931926, 0.4071610461839566, 4.0654863833280315], res=[-0.2639146816174125, 0.04247007968100558, 0.0, -0.013262707688006192, -0.259944615418747], res_norm=3.731e-01
2026-01-23 19:21:27,620 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:28,538 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:21:28,559 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:28,608 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:28,632 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:28,678 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:28,701 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:28,747 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:28,770 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:28,821 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:28,843 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:28,891 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:28,914 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:28,962 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:28,985 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:29,037 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:29,061 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:29,113 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:29,136 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:29,186 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:21:29,211 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:29,262 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:21:34,730 - WARNING - integration_test - Step 26: MPC solve failed
2026-01-23 19:21:34,730 - WARNING - integration_test -   Consecutive MPC failures: 13/20
2026-01-23 19:21:34,744 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:21:34,745 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1850 scenarios available
2026-01-23 19:21:34,758 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1850 trajectory groups with 18500 total points
2026-01-23 19:21:34,759 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:21:35,094 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:21:35,113 - INFO - integration_test - Step 26: Computed 6 numeric contouring constraints for visualization (s=5.021)
2026-01-23 19:21:35,113 - DEBUG - integration_test - Step 26: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:21:35,113 - INFO - integration_test - === Applying control at step 26 ===
2026-01-23 19:21:35,113 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': 0.0}
2026-01-23 19:21:35,113 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:21:35,113 - INFO - integration_test -   Planner output success: False
2026-01-23 19:21:35,113 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': 0.0}
2026-01-23 19:21:35,115 - INFO - integration_test - Step 26 completed in 9.359s
2026-01-23 19:21:35,175 - INFO - integration_test - Step 27 (contouring until path end)
2026-01-23 19:21:35,185 - DEBUG - integration_test - Syncing planner state at step 27: vehicle_state=[4.39564967 2.43260506 0.51963957 0.16141824 5.03674385]
2026-01-23 19:21:35,186 - DEBUG - integration_test - Step 27: Using propagated spline 5.0367 (close to path, dist=0.362m, drift=0.331m)
2026-01-23 19:21:35,186 - DEBUG - integration_test -   Set spline state to 5.0367
2026-01-23 19:21:35,187 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:21:36,353 - DEBUG - integration_test - Step 27: Checking path alignment: vehicle=(4.396, 2.433), path_start=(0.000, 0.000), dist=5.024m
2026-01-23 19:21:36,353 - INFO - integration_test - === Calling planner.solve_mpc() at step 27 ===
2026-01-23 19:21:37,390 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:21:37,421 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:21:37,421 - INFO - integration_test - Warmstart k=0: x0=4.395649670925727 , y0=2.432605059792247 , psi0=0.5196395725931925 , v0=0.16141823803552702 , spline0=5.036743845124878 , a0=0.0 , w0=0.0
2026-01-23 19:21:37,421 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:21:37,422 - INFO - integration_test - Dyn residual k=0: pred=[4.409660745134105, 2.4406205619744097, 0.5196395725931925, 0.16141823803552702, 5.052885668928431], ws=[3.8442202488249757, 2.22438501987162, 0.5196395725931926, 0.20374095828108613, 4.208636111791737], res=[0.5654404963091295, 0.2162355421027895, -1.1102230246251565e-16, -0.04232272024555911, 0.8442495571366937], res_norm=1.040e+00
2026-01-23 19:21:37,423 - INFO - integration_test - Dyn residual k=1: pred=[3.8619049275855883, 2.2345021300295107, 0.5196395725931926, 0.20374095828108613, 4.2290102076198455], ws=[4.201254098237152, 2.0398273260345126, 0.5196395725931926, 0.24077333849595037, 4.055401604649895], res=[-0.3393491706515639, 0.19467480399499815, 0.0, -0.03703238021486424, 0.17360860296995018], res_norm=4.296e-01
2026-01-23 19:21:37,424 - INFO - integration_test - Dyn residual k=2: pred=[4.22215318098097, 2.0517833431711647, 0.5196395725931926, 0.24077333849595037, 4.0794789384994905], ws=[4.037866384179895, 2.3996591343821656, 0.5196395725931926, 0.27317667118395655, 4.736466994391914], res=[0.18428679680107507, -0.3478757912110009, 0.0, -0.03240333268800619, -0.6569880558924233], res_norm=7.666e-01
2026-01-23 19:21:37,442 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:38,475 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:21:38,498 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:38,545 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:38,569 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:38,619 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:38,640 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:38,689 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:38,712 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:38,759 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:38,783 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:38,833 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:38,857 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:38,904 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:38,927 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:38,974 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:38,998 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:39,047 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:39,072 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:39,121 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:21:39,143 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:39,191 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:21:43,439 - WARNING - integration_test - Step 27: MPC solve failed
2026-01-23 19:21:43,439 - WARNING - integration_test -   Consecutive MPC failures: 14/20
2026-01-23 19:21:43,453 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:21:43,453 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1857 scenarios available
2026-01-23 19:21:43,470 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1857 trajectory groups with 18570 total points
2026-01-23 19:21:43,471 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:21:44,177 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:21:44,214 - INFO - integration_test - Step 27: Computed 6 numeric contouring constraints for visualization (s=5.037)
2026-01-23 19:21:44,214 - DEBUG - integration_test - Step 27: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:21:44,214 - INFO - integration_test - === Applying control at step 27 ===
2026-01-23 19:21:44,214 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': 0.0}
2026-01-23 19:21:44,214 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:21:44,214 - INFO - integration_test -   Planner output success: False
2026-01-23 19:21:44,214 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': 0.0}
2026-01-23 19:21:44,216 - INFO - integration_test - Step 27 completed in 9.031s
2026-01-23 19:21:44,290 - INFO - integration_test - Step 28 (contouring until path end)
2026-01-23 19:21:44,304 - DEBUG - integration_test - Syncing planner state at step 28: vehicle_state=[ 4.40098076  2.43565489  0.51963957 -0.03858176  5.03288567]
2026-01-23 19:21:44,305 - DEBUG - integration_test - Step 28: Using propagated spline 5.0329 (close to path, dist=0.356m, drift=0.327m)
2026-01-23 19:21:44,305 - DEBUG - integration_test -   Set spline state to 5.0329
2026-01-23 19:21:44,306 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:21:45,290 - DEBUG - integration_test - Step 28: Checking path alignment: vehicle=(4.401, 2.436), path_start=(0.000, 0.000), dist=5.030m
2026-01-23 19:21:45,290 - INFO - integration_test - === Calling planner.solve_mpc() at step 28 ===
2026-01-23 19:21:46,304 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:21:46,331 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:21:46,331 - INFO - integration_test - Warmstart k=0: x0=4.400980763008855 , y0=2.435654888776813 , psi0=0.5196395725931925 , v0=-0.038581761964472994 , spline0=5.032885668928431 , a0=0.0 , w0=0.0
2026-01-23 19:21:46,331 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:21:46,332 - INFO - integration_test - Dyn residual k=0: pred=[4.397631872966732, 2.4337390445637825, 0.5196395725931925, -0.038581761964472994, 5.029027492731984], ws=[4.1158053896559785, 2.1903784884839905, 0.5196395725931926, 0.17875, 4.48594723539003], res=[0.2818264833107538, 0.243360556079792, -1.1102230246251565e-16, -0.21733176196447299, 0.5430802573419546], res_norm=6.934e-01
2026-01-23 19:21:46,333 - INFO - integration_test - Dyn residual k=1: pred=[4.131320857704864, 2.1992546293246944, 0.5196395725931926, 0.17875, 4.50382223539003], ws=[4.074935865185154, 2.130560640975947, 0.5196395725931926, 0.34390624999999997, 4.012363840687274], res=[0.05638499251971041, 0.0686939883487474, 0.0, -0.16515624999999998, 0.49145839470275554], res_norm=5.260e-01
2026-01-23 19:21:46,333 - INFO - integration_test - Dyn residual k=2: pred=[4.104786866212773, 2.147637901457057, 0.5196395725931926, 0.34390624999999997, 4.0467544656872745], ws=[3.746448863571387, 2.176256158214944, 0.5196395725931926, 0.48841796875, 4.1758811346966525], res=[0.3583380026413865, -0.028618256757886762, 0.0, -0.14451171875000002, -0.12912666900937797], res_norm=4.084e-01
2026-01-23 19:21:46,349 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:47,355 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:21:47,377 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:47,422 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:47,443 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:47,488 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:47,508 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:47,552 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:47,571 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:47,617 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:47,637 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:47,680 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:47,700 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:47,742 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:47,762 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:47,805 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:47,826 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:47,870 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:47,890 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:47,932 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:21:47,952 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:47,995 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:21:52,292 - WARNING - integration_test - Step 28: MPC solve failed
2026-01-23 19:21:52,292 - WARNING - integration_test -   Consecutive MPC failures: 15/20
2026-01-23 19:21:52,304 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:21:52,304 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1867 scenarios available
2026-01-23 19:21:52,577 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1867 trajectory groups with 18670 total points
2026-01-23 19:21:52,578 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:21:53,159 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:21:53,202 - INFO - integration_test - Step 28: Computed 6 numeric contouring constraints for visualization (s=5.033)
2026-01-23 19:21:53,202 - DEBUG - integration_test - Step 28: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:21:53,202 - INFO - integration_test - === Applying control at step 28 ===
2026-01-23 19:21:53,202 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': 0.0}
2026-01-23 19:21:53,203 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:21:53,203 - INFO - integration_test -   Planner output success: False
2026-01-23 19:21:53,203 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': 0.0}
2026-01-23 19:21:53,205 - INFO - integration_test - Step 28 completed in 8.901s
2026-01-23 19:21:53,291 - INFO - integration_test - Step 29 (contouring until path end)
2026-01-23 19:21:53,295 - DEBUG - integration_test - Syncing planner state at step 29: vehicle_state=[ 4.38895189  2.42877337  0.51963957 -0.23858176  5.00902749]
2026-01-23 19:21:53,297 - DEBUG - integration_test - Step 29: Using propagated spline 5.0090 (close to path, dist=0.370m, drift=0.303m)
2026-01-23 19:21:53,297 - DEBUG - integration_test -   Set spline state to 5.0090
2026-01-23 19:21:53,298 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:21:54,238 - DEBUG - integration_test - Step 29: Checking path alignment: vehicle=(4.389, 2.429), path_start=(0.000, 0.000), dist=5.016m
2026-01-23 19:21:54,238 - INFO - integration_test - === Calling planner.solve_mpc() at step 29 ===
2026-01-23 19:21:55,138 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:21:55,165 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:21:55,165 - INFO - integration_test - Warmstart k=0: x0=4.388951890841481 , y0=2.428773371366186 , psi0=0.5196395725931925 , v0=-0.238581761964473 , spline0=5.009027492731984 , a0=0.0 , w0=0.0
2026-01-23 19:21:55,165 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:21:55,166 - INFO - integration_test - Dyn residual k=0: pred=[4.368243036548857, 2.416926180757962, 0.5196395725931925, -0.238581761964473, 4.985169316535536], ws=[3.98888744180495, 2.107080834412966, 0.5196395725931926, 0.17875, 4.013939929070529], res=[0.3793555947439069, 0.30984534634499594, -1.1102230246251565e-16, -0.41733176196447297, 0.9712293874650078], res_norm=1.165e+00
2026-01-23 19:21:55,167 - INFO - integration_test - Dyn residual k=1: pred=[4.004402909853836, 2.11595697525367, 0.5196395725931926, 0.17875, 4.031814929070529], ws=[3.9991797386754517, 2.672709773746288, 0.5196395725931926, 0.34390624999999997, 4.74288277644418], res=[0.00522317117838389, -0.5567527984926182, 0.0, -0.16515624999999998, -0.7110678473736511], res_norm=9.181e-01
2026-01-23 19:21:55,168 - INFO - integration_test - Dyn residual k=2: pred=[4.029030739703072, 2.689787034227398, 0.5196395725931926, 0.34390624999999997, 4.77727340144418], ws=[4.3509490021907515, 2.0914482709253717, 0.5196395725931926, 0.48841796875, 4.534912400130731], res=[-0.32191826248767974, 0.5983387633020265, 0.0, -0.14451171875000002, 0.24236100131344962], res_norm=7.357e-01
2026-01-23 19:21:55,184 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:56,104 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:21:56,126 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:56,172 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:56,192 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:56,238 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:56,259 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:56,302 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:56,322 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:56,365 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:56,385 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:56,431 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:56,451 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:56,495 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:56,515 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:56,558 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:56,578 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:56,637 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:21:56,670 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:56,723 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:21:56,743 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:21:56,786 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:22:00,852 - WARNING - integration_test - Step 29: MPC solve failed
2026-01-23 19:22:00,853 - WARNING - integration_test -   Consecutive MPC failures: 16/20
2026-01-23 19:22:00,872 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:22:00,873 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1864 scenarios available
2026-01-23 19:22:01,169 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1864 trajectory groups with 18640 total points
2026-01-23 19:22:01,176 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:22:01,732 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:22:01,761 - INFO - integration_test - Step 29: Computed 6 numeric contouring constraints for visualization (s=5.009)
2026-01-23 19:22:01,761 - DEBUG - integration_test - Step 29: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:22:01,761 - INFO - integration_test - === Applying control at step 29 ===
2026-01-23 19:22:01,761 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': -0.3179337091585497}
2026-01-23 19:22:01,761 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:22:01,761 - INFO - integration_test -   Planner output success: False
2026-01-23 19:22:01,761 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': -0.3179337091585497}
2026-01-23 19:22:01,763 - INFO - integration_test - Step 29 completed in 8.468s
2026-01-23 19:22:01,841 - INFO - integration_test - Step 30 (contouring until path end)
2026-01-23 19:22:01,848 - DEBUG - integration_test - Syncing planner state at step 30: vehicle_state=[ 4.35927518  2.41247689  0.4878462  -0.43858176  4.96516932]
2026-01-23 19:22:01,849 - DEBUG - integration_test - Step 30: Using propagated spline 4.9652 (close to path, dist=0.403m, drift=0.259m)
2026-01-23 19:22:01,849 - DEBUG - integration_test -   Set spline state to 4.9652
2026-01-23 19:22:01,850 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:22:02,775 - DEBUG - integration_test - Step 30: Checking path alignment: vehicle=(4.359, 2.412), path_start=(0.000, 0.000), dist=4.982m
2026-01-23 19:22:02,775 - INFO - integration_test - === Calling planner.solve_mpc() at step 30 ===
2026-01-23 19:22:03,688 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:22:03,712 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:22:03,712 - INFO - integration_test - Warmstart k=0: x0=4.359275181944074 , y0=2.4124768904213045 , psi0=0.4878462016773375 , v0=-0.438581761964473 , spline0=4.965169316535537 , a0=0.0 , w0=0.0
2026-01-23 19:22:03,712 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:22:03,713 - INFO - integration_test - Dyn residual k=0: pred=[4.320533305651877, 2.3919194917376494, 0.4878462016773375, -0.438581761964473, 4.92131114033909], ws=[4.156659200277375, 2.2432460023600695, 0.4878462016773373, 0.17875, 4.750530056075374], res=[0.16387410537450275, 0.14867348937757985, 2.220446049250313e-16, -0.617331761964473, 0.17078108426371585], res_norm=6.777e-01
2026-01-23 19:22:03,714 - INFO - integration_test - Dyn residual k=1: pred=[4.172448982224101, 2.2516244515647155, 0.4878462016773373, 0.17875, 4.768405056075374], ws=[4.193177746771001, 2.0868273411532545, 0.4878462016773373, 0.34390624999999997, 4.731874552012495], res=[-0.020728764546899647, 0.16479711041146095, 0.0, -0.16515624999999998, 0.03653050406287939], res_norm=2.371e-01
2026-01-23 19:22:03,715 - INFO - integration_test - Dyn residual k=2: pred=[4.223556514310114, 2.102947067289116, 0.4878462016773373, 0.34390624999999997, 4.766265177012495], ws=[4.078593634227865, 2.2967313408244503, 0.4878462016773373, 0.48841796875, 4.060642739234112], res=[0.14496288008224933, -0.19378427353533434, 0.0, -0.14451171875000002, 0.7056224377783833], res_norm=7.598e-01
2026-01-23 19:22:03,732 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:04,674 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:22:04,696 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:04,744 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:04,768 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:04,816 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:04,840 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:04,889 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:04,912 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:04,961 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:04,984 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:05,035 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:05,058 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:05,110 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:05,134 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:05,188 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:05,215 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:05,270 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:05,295 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:05,348 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:22:05,373 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:05,429 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:22:11,096 - WARNING - integration_test - Step 30: MPC solve failed
2026-01-23 19:22:11,096 - WARNING - integration_test -   Consecutive MPC failures: 17/20
2026-01-23 19:22:11,108 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:22:11,108 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1851 scenarios available
2026-01-23 19:22:11,124 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1851 trajectory groups with 18510 total points
2026-01-23 19:22:11,125 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:22:11,560 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:22:11,580 - INFO - integration_test - Step 30: Computed 6 numeric contouring constraints for visualization (s=4.965)
2026-01-23 19:22:11,581 - DEBUG - integration_test - Step 30: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:22:11,581 - INFO - integration_test - === Applying control at step 30 ===
2026-01-23 19:22:11,581 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': -0.26300727727597106}
2026-01-23 19:22:11,581 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:22:11,581 - INFO - integration_test -   Planner output success: False
2026-01-23 19:22:11,581 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': -0.26300727727597106}
2026-01-23 19:22:11,582 - INFO - integration_test - Step 30 completed in 9.734s
2026-01-23 19:22:11,649 - INFO - integration_test - Step 31 (contouring until path end)
2026-01-23 19:22:11,661 - DEBUG - integration_test - Syncing planner state at step 31: vehicle_state=[ 4.31135335  2.38789974  0.46154547 -0.63858176  4.90131114]
2026-01-23 19:22:11,662 - DEBUG - integration_test - Step 31: Using propagated spline 4.9013 (close to path, dist=0.456m, drift=0.196m)
2026-01-23 19:22:11,662 - DEBUG - integration_test -   Set spline state to 4.9013
2026-01-23 19:22:11,663 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:22:12,652 - DEBUG - integration_test - Step 31: Checking path alignment: vehicle=(4.311, 2.388), path_start=(0.000, 0.000), dist=4.928m
2026-01-23 19:22:12,652 - INFO - integration_test - === Calling planner.solve_mpc() at step 31 ===
2026-01-23 19:22:13,670 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:22:13,697 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:22:13,697 - INFO - integration_test - Warmstart k=0: x0=4.3113533539811675 , y0=2.387899741158675 , psi0=0.4615454739497404 , v0=-0.638581761964473 , spline0=4.901311140339089 , a0=0.0 , w0=0.0
2026-01-23 19:22:13,698 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:22:13,699 - INFO - integration_test - Dyn residual k=0: pred=[4.25417695777872, 2.3594616261642307, 0.4615454739497404, -0.638581761964473, 4.837452964142642], ws=[3.919536924657475, 2.01571843386614, 0.46154547394974044, 0.17875, 3.7385199858225895], res=[0.3346400331212447, 0.3437431922980907, -5.551115123125783e-17, -0.817331761964473, 1.0989329783200525], res_norm=1.451e+00
2026-01-23 19:22:13,700 - INFO - integration_test - Dyn residual k=1: pred=[3.9355415797070443, 2.0236787505523215, 0.46154547394974044, 0.17875, 3.7563949858225896], ws=[4.081762134706592, 2.147258476462925, 0.46154547394974044, 0.34390624999999997, 4.508984275715144], res=[-0.14622055499954767, -0.12357972591060351, 0.0, -0.16515624999999998, -0.7525892898925544], res_norm=7.939e-01
2026-01-23 19:22:13,701 - INFO - integration_test - Dyn residual k=2: pred=[4.1125543075773106, 2.1625737361012862, 0.46154547394974044, 0.34390624999999997, 4.543374900715144], ws=[4.129734928650263, 2.2100556116803296, 0.46154547394974044, 0.48841796875, 4.72740403338611], res=[-0.017180621072952817, -0.047481875579043376, 0.0, -0.14451171875000002, -0.18402913267096555], res_norm=2.394e-01
2026-01-23 19:22:13,719 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:14,803 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:22:14,827 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:14,877 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:14,900 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:14,950 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:14,972 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:15,019 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:15,043 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:15,095 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:15,118 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:15,167 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:15,191 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:15,243 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:15,266 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:15,315 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:15,339 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:15,388 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:15,411 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:15,465 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:22:15,489 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:15,537 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:22:19,669 - WARNING - integration_test - Step 31: MPC solve failed
2026-01-23 19:22:19,670 - WARNING - integration_test -   Consecutive MPC failures: 18/20
2026-01-23 19:22:19,689 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:22:19,689 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1849 scenarios available
2026-01-23 19:22:19,981 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1849 trajectory groups with 18490 total points
2026-01-23 19:22:19,982 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:22:20,627 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:22:20,663 - INFO - integration_test - Step 31: Computed 6 numeric contouring constraints for visualization (s=4.901)
2026-01-23 19:22:20,663 - DEBUG - integration_test - Step 31: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:22:20,663 - INFO - integration_test - === Applying control at step 31 ===
2026-01-23 19:22:20,663 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': -0.24296394249241082}
2026-01-23 19:22:20,663 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:22:20,663 - INFO - integration_test -   Planner output success: False
2026-01-23 19:22:20,663 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': -0.24296394249241082}
2026-01-23 19:22:20,665 - INFO - integration_test - Step 31 completed in 9.003s
2026-01-23 19:22:20,741 - INFO - integration_test - Step 32 (contouring until path end)
2026-01-23 19:22:20,754 - DEBUG - integration_test - Syncing planner state at step 32: vehicle_state=[ 4.24481267  2.35585133  0.43724908 -0.83858176  4.81745296]
2026-01-23 19:22:20,754 - DEBUG - integration_test - Step 32: Using propagated spline 4.8175 (close to path, dist=0.435m, drift=0.406m)
2026-01-23 19:22:20,754 - DEBUG - integration_test -   Set spline state to 4.8175
2026-01-23 19:22:20,755 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:22:21,719 - DEBUG - integration_test - Step 32: Checking path alignment: vehicle=(4.245, 2.356), path_start=(0.000, 0.000), dist=4.855m
2026-01-23 19:22:21,719 - INFO - integration_test - === Calling planner.solve_mpc() at step 32 ===
2026-01-23 19:22:22,710 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:22:22,736 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:22:22,736 - INFO - integration_test - Warmstart k=0: x0=4.2448126675550375 , y0=2.355851331860471 , psi0=0.4372490797004993 , v0=-0.8385817619644731 , spline0=4.8174529641426425 , a0=0.0 , w0=0.0
2026-01-23 19:22:22,736 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:22:22,737 - INFO - integration_test - Dyn residual k=0: pred=[4.168843871603882, 2.3203416746285828, 0.4372490797004993, -0.8385817619644731, 4.7335947879461955], ws=[3.7678644146247158, 2.3911296013761403, 0.4372490797004991, 0.17875, 3.986586370169615], res=[0.4009794569791665, -0.07078792674755752, 2.220446049250313e-16, -1.017331761964473, 0.7470084177765806], res_norm=1.326e+00
2026-01-23 19:22:22,738 - INFO - integration_test - Dyn residual k=1: pred=[3.784057733979119, 2.398698751479442, 0.4372490797004991, 0.17875, 4.004461370169615], ws=[3.9456384691371924, 1.9314006020456018, 0.4372490797004991, 0.34390624999999997, 4.425605714045003], res=[-0.16158073515807336, 0.46729814943383996, 0.0, -0.16515624999999998, -0.4211443438753877], res_norm=6.702e-01
2026-01-23 19:22:22,739 - INFO - integration_test - Dyn residual k=2: pred=[3.976793622895096, 1.9459632763265164, 0.4372490797004991, 0.34390624999999997, 4.459996339045003], ws=[3.9799010875610574, 2.2219937165133876, 0.4372490797004991, 0.48841796875, 4.449923139434442], res=[-0.003107464665961235, -0.2760304401868712, 0.0, -0.14451171875000002, 0.01007319961056119], res_norm=3.117e-01
2026-01-23 19:22:22,756 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:23,739 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:22:23,759 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:23,804 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:23,826 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:23,873 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:23,895 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:23,941 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:23,962 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:24,007 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:24,030 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:24,076 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:24,098 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:24,143 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:24,163 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:24,212 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:24,235 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:24,283 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:24,304 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:24,347 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:22:24,366 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:24,409 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:22:28,242 - WARNING - integration_test - Step 32: MPC solve failed
2026-01-23 19:22:28,242 - WARNING - integration_test -   Consecutive MPC failures: 19/20
2026-01-23 19:22:28,266 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:22:28,267 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1850 scenarios available
2026-01-23 19:22:28,285 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1850 trajectory groups with 18500 total points
2026-01-23 19:22:28,286 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:22:29,316 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:22:29,353 - INFO - integration_test - Step 32: Computed 6 numeric contouring constraints for visualization (s=4.817)
2026-01-23 19:22:29,354 - DEBUG - integration_test - Step 32: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:22:29,354 - INFO - integration_test - === Applying control at step 32 ===
2026-01-23 19:22:29,354 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': -0.35128666141032383}
2026-01-23 19:22:29,354 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:22:29,354 - INFO - integration_test -   Planner output success: False
2026-01-23 19:22:29,354 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': -0.35128666141032383}
2026-01-23 19:22:29,355 - INFO - integration_test - Step 32 completed in 8.602s
2026-01-23 19:22:29,429 - INFO - integration_test - Step 33 (contouring until path end)
2026-01-23 19:22:29,444 - DEBUG - integration_test - Syncing planner state at step 33: vehicle_state=[ 4.1590803   2.31766213  0.40212041 -1.03858176  4.71359479]
2026-01-23 19:22:29,446 - DEBUG - integration_test - Step 33: Using propagated spline 4.7136 (close to path, dist=0.341m, drift=0.302m)
2026-01-23 19:22:29,446 - DEBUG - integration_test -   Set spline state to 4.7136
2026-01-23 19:22:29,447 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:22:30,423 - DEBUG - integration_test - Step 33: Checking path alignment: vehicle=(4.159, 2.318), path_start=(0.000, 0.000), dist=4.761m
2026-01-23 19:22:30,424 - INFO - integration_test - === Calling planner.solve_mpc() at step 33 ===
2026-01-23 19:22:31,344 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:22:31,370 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:22:31,370 - INFO - integration_test - Warmstart k=0: x0=4.159080295558984 , y0=2.317662129298333 , psi0=0.4021204135594669 , v0=-1.038581761964473 , spline0=4.713594787946195 , a0=0.0 , w0=0.0
2026-01-23 19:22:31,370 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:22:31,371 - INFO - integration_test - Dyn residual k=0: pred=[4.063506554139392, 2.2770151034057364, 0.4021204135594669, -1.038581761964473, 4.609736611749748], ws=[4.100027210915951, 2.1966024504706416, 0.4021204135594667, 0.17875, 4.513387477227526], res=[-0.0365206567765588, 0.08041265293509481, 2.220446049250313e-16, -1.217331761964473, 0.09634913452222182], res_norm=1.224e+00
2026-01-23 19:22:31,371 - INFO - integration_test - Dyn residual k=1: pred=[4.11647637929576, 2.2035981980799186, 0.4021204135594667, 0.17875, 4.531262477227526], ws=[3.853845525839597, 2.1934271193691277, 0.4021204135594667, 0.34390624999999997, 4.419273858887386], res=[0.26263085345616277, 0.010171078710790926, 0.0, -0.16515624999999998, 0.11198861834014018], res_norm=3.300e-01
2026-01-23 19:22:31,372 - INFO - integration_test - Dyn residual k=2: pred=[3.885492920598302, 2.206886595320193, 0.4021204135594667, 0.34390624999999997, 4.453664483887386], ws=[4.131088327269872, 2.219229420205032, 0.4021204135594667, 0.48841796875, 4.728125554337462], res=[-0.24559540667156954, -0.012342824884838954, 0.0, -0.14451171875000002, -0.2744610704500756], res_norm=3.958e-01
2026-01-23 19:22:31,389 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:32,351 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:22:32,371 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:32,414 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:32,435 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:32,480 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:32,501 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:32,546 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:32,567 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:32,609 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:32,628 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:32,674 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:32,694 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:32,739 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:32,759 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:32,802 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:32,821 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:32,866 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:32,887 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:32,931 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:22:32,952 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:32,995 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:22:37,097 - WARNING - integration_test - Step 33: MPC solve failed
2026-01-23 19:22:37,097 - WARNING - integration_test -   Consecutive MPC failures: 20/20
2026-01-23 19:22:37,097 - WARNING - integration_test - Step 33: Checking if vehicle should continue despite 20 consecutive failures...
2026-01-23 19:22:37,097 - ERROR - integration_test - Max consecutive MPC failures (20) reached. No successful solve in last 20 attempts. Terminating test early at step 33.
2026-01-23 19:22:37,121 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:22:37,121 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1860 scenarios available
2026-01-23 19:22:37,140 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1860 trajectory groups with 18600 total points
2026-01-23 19:22:37,141 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:22:37,971 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:22:38,002 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=4.714)
2026-01-23 19:22:38,002 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:22:38,002 - INFO - integration_test - === Applying control at step 200 ===
2026-01-23 19:22:38,002 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': 0.0}
2026-01-23 19:22:38,002 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:22:38,002 - INFO - integration_test -   Planner output success: False
2026-01-23 19:22:38,002 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': 0.0}
2026-01-23 19:22:38,004 - INFO - integration_test - Step 200 completed in 8.560s
2026-01-23 19:22:38,082 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-23 19:22:38,096 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 4.05430422  2.2731014   0.40212041 -1.23858176  4.58973661]
2026-01-23 19:22:38,097 - DEBUG - integration_test - Step 201: Using propagated spline 4.5897 (close to path, dist=0.230m, drift=0.178m)
2026-01-23 19:22:38,099 - DEBUG - integration_test -   Set spline state to 4.5897
2026-01-23 19:22:38,099 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:22:39,065 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(4.054, 2.273), path_start=(0.000, 0.000), dist=4.648m
2026-01-23 19:22:39,065 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-23 19:22:39,958 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:22:39,983 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:22:39,983 - INFO - integration_test - Warmstart k=0: x0=4.0543042221786605 , y0=2.2731013984494974 , psi0=0.4021204135594669 , v0=-1.238581761964473 , spline0=4.589736611749748 , a0=0.0 , w0=0.0
2026-01-23 19:22:39,984 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:22:39,984 - INFO - integration_test - Dyn residual k=0: pred=[3.940325816837605, 2.2246269626444235, 0.4021204135594669, -1.238581761964473, 4.465878435553301], ws=[3.952531917461096, 2.2552947465626896, 0.4021204135594667, 0.17875, 4.0080654122068555], res=[-0.012206100623490812, -0.03066778391826608, 2.220446049250313e-16, -1.417331761964473, 0.45781302334644547], res_norm=1.490e+00
2026-01-23 19:22:39,985 - INFO - integration_test - Dyn residual k=1: pred=[3.9689810858409045, 2.2622904941719666, 0.4021204135594667, 0.17875, 4.025940412206856], ws=[4.069833157362396, 2.2797057755631505, 0.4021204135594667, 0.34390624999999997, 4.26754610665204], res=[-0.10085207152149156, -0.017415281391183868, 0.0, -0.16515624999999998, -0.24160569444518476], res_norm=3.100e-01
2026-01-23 19:22:39,986 - INFO - integration_test - Dyn residual k=2: pred=[4.101480552121101, 2.293165251514216, 0.4021204135594667, 0.34390624999999997, 4.301936731652041], ws=[4.101480552121101, 2.293165251514216, 0.4021204135594667, 0.48841796875, 4.507904080985961], res=[0.0, 0.0, 0.0, -0.14451171875000002, -0.20596734933392025], res_norm=2.516e-01
2026-01-23 19:22:40,002 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:40,983 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:22:41,007 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:41,056 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:41,082 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:41,133 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:41,157 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:41,209 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:41,233 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:41,290 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:41,316 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:41,369 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:41,394 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:41,445 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:41,470 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:41,522 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:41,557 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:41,631 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:41,656 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:41,711 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:22:41,735 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:41,784 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:22:45,862 - WARNING - integration_test - Step 201: MPC solve failed
2026-01-23 19:22:45,862 - WARNING - integration_test -   Consecutive MPC failures: 21/20
2026-01-23 19:22:45,862 - WARNING - integration_test - Step 201: Checking if vehicle should continue despite 21 consecutive failures...
2026-01-23 19:22:45,862 - ERROR - integration_test - Max consecutive MPC failures (20) reached. No successful solve in last 20 attempts. Terminating test early at step 201.
2026-01-23 19:22:45,888 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:22:45,888 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1865 scenarios available
2026-01-23 19:22:46,215 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1865 trajectory groups with 18650 total points
2026-01-23 19:22:46,216 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:22:47,063 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:22:47,103 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=4.590)
2026-01-23 19:22:47,103 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:22:47,103 - INFO - integration_test - === Applying control at step 200 ===
2026-01-23 19:22:47,103 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': -0.15973705251188441}
2026-01-23 19:22:47,103 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:22:47,103 - INFO - integration_test -   Planner output success: False
2026-01-23 19:22:47,103 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': -0.15973705251188441}
2026-01-23 19:22:47,105 - INFO - integration_test - Step 200 completed in 9.010s
2026-01-23 19:22:47,185 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-23 19:22:47,198 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 3.93070009  2.22172387  0.38614671 -1.43858176  4.44587844]
2026-01-23 19:22:47,198 - DEBUG - integration_test - Step 201: Using propagated spline 4.4459 (close to path, dist=0.105m, drift=0.034m)
2026-01-23 19:22:47,200 - DEBUG - integration_test -   Set spline state to 4.4459
2026-01-23 19:22:47,203 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:22:48,228 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(3.931, 2.222), path_start=(0.000, 0.000), dist=4.515m
2026-01-23 19:22:48,229 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-23 19:22:49,189 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:22:49,215 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:22:49,215 - INFO - integration_test - Warmstart k=0: x0=3.930700092511151 , y0=2.221723872418693 , psi0=0.38614670830827846 , v0=-1.438581761964473 , spline0=4.4458784355533005 , a0=0.0 , w0=0.0
2026-01-23 19:22:49,215 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:22:49,216 - INFO - integration_test - Dyn residual k=0: pred=[3.7974346014295994, 2.167543767718158, 0.38614670830827846, -1.438581761964473, 4.302020259356853], ws=[3.929773725344508, 2.2213472507616348, 0.38614670830827835, 0.17875, 4.009035495864079], res=[-0.13233912391490854, -0.053803483043476596, 1.1102230246251565e-16, -1.617331761964473, 0.29298476349277447], res_norm=1.650e+00
2026-01-23 19:22:49,217 - INFO - integration_test - Dyn residual k=1: pred=[3.946332538448254, 2.2280793628815574, 0.38614670830827835, 0.17875, 4.026910495864079], ws=[3.619818207931793, 2.0438223078064888, 0.38614670830827835, 0.34390624999999997, 4.115208285777248], res=[0.32651433051646084, 0.18425705507506862, 0.0, -0.16515624999999998, -0.08829778991316939], res_norm=4.191e-01
2026-01-23 19:22:49,218 - INFO - integration_test - Dyn residual k=2: pred=[3.6516765537721296, 2.05677456198127, 0.38614670830827835, 0.34390624999999997, 4.149598910777248], ws=[3.8323817673785974, 2.234878732130011, 0.38614670830827835, 0.48841796875, 4.426671094843307], res=[-0.18070521360646774, -0.17810417014874114, 0.0, -0.14451171875000002, -0.2770721840660588], res_norm=4.025e-01
2026-01-23 19:22:49,237 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:50,293 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:22:50,318 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:50,366 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:50,390 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:50,438 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:50,461 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:50,511 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:50,535 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:50,583 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:50,607 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:50,657 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:50,683 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:50,732 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:50,755 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:50,803 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:50,825 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:50,877 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:50,902 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:50,950 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:22:50,973 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:51,022 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:22:54,904 - WARNING - integration_test - Step 201: MPC solve failed
2026-01-23 19:22:54,904 - WARNING - integration_test -   Consecutive MPC failures: 22/20
2026-01-23 19:22:54,904 - WARNING - integration_test - Step 201: Checking if vehicle should continue despite 22 consecutive failures...
2026-01-23 19:22:54,904 - ERROR - integration_test - Max consecutive MPC failures (20) reached. No successful solve in last 20 attempts. Terminating test early at step 201.
2026-01-23 19:22:54,930 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:22:54,930 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1848 scenarios available
2026-01-23 19:22:54,947 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1848 trajectory groups with 18480 total points
2026-01-23 19:22:54,948 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:22:55,826 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:22:55,869 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=4.446)
2026-01-23 19:22:55,870 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:22:55,870 - INFO - integration_test - === Applying control at step 200 ===
2026-01-23 19:22:55,870 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': 0.0}
2026-01-23 19:22:55,870 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:22:55,870 - INFO - integration_test -   Planner output success: False
2026-01-23 19:22:55,870 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': 0.0}
2026-01-23 19:22:55,871 - INFO - integration_test - Step 200 completed in 8.674s
2026-01-23 19:22:55,952 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-23 19:22:55,965 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 3.78817093  2.16377755  0.38614671 -1.63858176  4.28202026]
2026-01-23 19:22:55,966 - DEBUG - integration_test - Step 201: Using propagated spline 4.2820 (close to path, dist=0.086m, drift=0.130m)
2026-01-23 19:22:55,967 - DEBUG - integration_test -   Set spline state to 4.2820
2026-01-23 19:22:55,969 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:22:56,951 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(3.788, 2.164), path_start=(0.000, 0.000), dist=4.363m
2026-01-23 19:22:56,951 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-23 19:22:58,304 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:22:58,335 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:22:58,335 - INFO - integration_test - Warmstart k=0: x0=3.788170929763168 , y0=2.163777551147572 , psi0=0.38614670830827846 , v0=-1.638581761964473 , spline0=4.2820202593568535 , a0=0.0 , w0=0.0
2026-01-23 19:22:58,336 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:22:58,337 - INFO - integration_test - Dyn residual k=0: pred=[3.6363780953487534, 2.102065013305865, 0.38614670830827846, -1.638581761964473, 4.118162083160406], ws=[3.7872445625965248, 2.1634009294905137, 0.38614670830827835, 0.17875, 3.9727073129300514], res=[-0.1508664672477713, -0.06133591618464873, 1.1102230246251565e-16, -1.8173317619644729, 0.14545477023035502], res_norm=1.830e+00
2026-01-23 19:22:58,338 - INFO - integration_test - Dyn residual k=1: pred=[3.8038033757002707, 2.1701330416104363, 0.38614670830827835, 0.17875, 3.9905823129300515], ws=[3.8038033757002707, 2.1701330416104363, 0.38614670830827835, 0.34390624999999997, 3.743394539881332], res=[0.0, 0.0, 0.0, -0.16515624999999998, 0.24718777304871953], res_norm=2.973e-01
2026-01-23 19:22:58,339 - INFO - integration_test - Dyn residual k=2: pred=[3.8356617215406072, 2.1830852957852174, 0.38614670830827835, 0.34390624999999997, 3.777785164881332], ws=[3.8356617215406072, 2.1830852957852174, 0.38614670830827835, 0.48841796875, 3.774407396833379], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.003377768047952756], res_norm=1.446e-01
2026-01-23 19:22:58,357 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:59,385 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:22:59,409 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:59,454 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:59,476 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:59,525 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:59,546 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:59,592 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:59,614 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:59,659 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:59,682 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:59,730 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:59,751 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:59,796 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:59,819 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:59,864 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:59,888 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:22:59,936 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:22:59,957 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:23:00,002 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:23:00,024 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:23:00,070 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:23:03,853 - WARNING - integration_test - Step 201: MPC solve failed
2026-01-23 19:23:03,853 - WARNING - integration_test -   Consecutive MPC failures: 23/20
2026-01-23 19:23:03,853 - WARNING - integration_test - Step 201: Checking if vehicle should continue despite 23 consecutive failures...
2026-01-23 19:23:03,853 - ERROR - integration_test - Max consecutive MPC failures (20) reached. No successful solve in last 20 attempts. Terminating test early at step 201.
2026-01-23 19:23:03,880 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:23:03,880 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1852 scenarios available
2026-01-23 19:23:03,898 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1852 trajectory groups with 18520 total points
2026-01-23 19:23:03,899 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:23:04,797 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:23:04,827 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=4.282)
2026-01-23 19:23:04,827 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:23:04,827 - INFO - integration_test - === Applying control at step 200 ===
2026-01-23 19:23:04,827 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': -0.2297840333978769}
2026-01-23 19:23:04,827 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:23:04,828 - INFO - integration_test -   Planner output success: False
2026-01-23 19:23:04,828 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': -0.2297840333978769}
2026-01-23 19:23:04,829 - INFO - integration_test - Step 200 completed in 8.864s
2026-01-23 19:23:04,906 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-23 19:23:04,917 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 3.62636232  2.10019053  0.3631683  -1.83858176  4.09816208]
2026-01-23 19:23:04,918 - DEBUG - integration_test - Step 201: Using propagated spline 4.0982 (close to path, dist=0.081m, drift=0.019m)
2026-01-23 19:23:04,918 - DEBUG - integration_test -   Set spline state to 4.0982
2026-01-23 19:23:04,922 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:23:05,892 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(3.626, 2.100), path_start=(0.000, 0.000), dist=4.191m
2026-01-23 19:23:05,892 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-23 19:23:06,915 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:23:06,944 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:23:06,945 - INFO - integration_test - Warmstart k=0: x0=3.626362316190982 , y0=2.1001905280286857 , psi0=0.3631683049684908 , v0=-1.8385817619644729 , spline0=4.098162083160406 , a0=0.0 , w0=0.0
2026-01-23 19:23:06,945 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:23:06,946 - INFO - integration_test - Dyn residual k=0: pred=[3.4544961027358903, 2.03487717849819, 0.3631683049684908, -1.8385817619644729, 3.9143039069639585], ws=[3.625427540174976, 2.0998352903619053, 0.36316830496849084, 0.17875, 3.923009910924776], res=[-0.1709314374390858, -0.06495811186371547, -5.551115123125783e-17, -2.017331761964473, -0.008706003960817554], res_norm=2.026e+00
2026-01-23 19:23:06,947 - INFO - integration_test - Dyn residual k=1: pred=[3.642136661461088, 2.106185163655602, 0.36316830496849084, 0.17875, 3.940884910924776], ws=[3.642136661461088, 2.106185163655602, 0.36316830496849084, 0.34390624999999997, 4.152736819092749], res=[0.0, 0.0, 0.0, -0.16515624999999998, -0.21185190816797306], res_norm=2.686e-01
2026-01-23 19:23:06,948 - INFO - integration_test - Dyn residual k=2: pred=[3.674284192886553, 2.118402009039716, 0.36316830496849084, 0.34390624999999997, 4.1871274440927495], ws=[3.674284192886553, 2.118402009039716, 0.36316830496849084, 0.48841796875, 3.9344888870307417], res=[0.0, 0.0, 0.0, -0.14451171875000002, 0.2526385570620078], res_norm=2.910e-01
2026-01-23 19:23:06,966 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:23:07,956 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:23:07,977 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:23:08,023 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:23:08,044 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:23:08,089 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:23:08,111 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:23:08,157 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:23:08,179 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:23:08,224 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:23:08,247 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:23:08,293 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:23:08,317 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:23:08,364 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:23:08,387 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:23:08,431 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:23:08,452 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:23:08,498 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:23:08,519 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:23:08,563 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:23:08,582 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:23:08,624 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:23:12,599 - WARNING - integration_test - Step 201: MPC solve failed
2026-01-23 19:23:12,599 - WARNING - integration_test -   Consecutive MPC failures: 24/20
2026-01-23 19:23:12,599 - WARNING - integration_test - Step 201: Checking if vehicle should continue despite 24 consecutive failures...
2026-01-23 19:23:12,599 - ERROR - integration_test - Max consecutive MPC failures (20) reached. No successful solve in last 20 attempts. Terminating test early at step 201.
2026-01-23 19:23:12,620 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:23:12,620 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1849 scenarios available
2026-01-23 19:23:12,637 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1849 trajectory groups with 18490 total points
2026-01-23 19:23:12,638 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:23:13,740 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:23:13,767 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=4.098)
2026-01-23 19:23:13,768 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:23:13,768 - INFO - integration_test - === Applying control at step 200 ===
2026-01-23 19:23:13,768 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': -0.07131386858959843}
2026-01-23 19:23:13,768 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:23:13,768 - INFO - integration_test -   Planner output success: False
2026-01-23 19:23:13,768 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': -0.07131386858959843}
2026-01-23 19:23:13,769 - INFO - integration_test - Step 200 completed in 8.852s
2026-01-23 19:23:13,836 - INFO - integration_test - Step 201 (contouring until path end)
2026-01-23 19:23:13,846 - DEBUG - integration_test - Syncing planner state at step 201: vehicle_state=[ 3.44490014  2.03198266  0.35603692 -2.03858176  3.89430391]
2026-01-23 19:23:13,847 - DEBUG - integration_test - Step 201: Using propagated spline 3.8943 (close to path, dist=0.138m, drift=0.071m)
2026-01-23 19:23:13,848 - DEBUG - integration_test -   Set spline state to 3.8943
2026-01-23 19:23:13,850 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:23:14,818 - DEBUG - integration_test - Step 201: Checking path alignment: vehicle=(3.445, 2.032), path_start=(0.000, 0.000), dist=4.000m
2026-01-23 19:23:14,819 - INFO - integration_test - === Calling planner.solve_mpc() at step 201 ===
2026-01-23 19:23:15,817 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-23 19:23:15,847 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-23 19:23:15,847 - INFO - integration_test - Warmstart k=0: x0=3.444900142958383 , y0=2.031982661655742 , psi0=0.3560369181095309 , v0=-2.038581761964473 , spline0=3.894303906963959 , a0=0.0 , w0=0.0
2026-01-23 19:23:15,848 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-23 19:23:15,849 - INFO - integration_test - Dyn residual k=0: pred=[3.2538268177013228, 1.9609253581792416, 0.3560369181095309, -2.038581761964473, 3.690445730767512], ws=[3.443962857396322, 2.03163409921492, 0.3560369181095311, 0.17875, 3.4261837833620366], res=[-0.19013603969499915, -0.07070874103567859, -1.6653345369377348e-16, -2.217331761964473, 0.26426194740547526], res_norm=2.242e+00
2026-01-23 19:23:15,850 - INFO - integration_test - Dyn residual k=1: pred=[3.460716836818166, 2.0378646528446085, 0.3560369181095311, 0.17875, 3.4440587833620366], ws=[3.225482879852109, 1.6644153766561498, 0.3560369181095311, 0.34390624999999997, 3.087844096429546], res=[0.2352339569660571, 0.3734492761884587, 0.0, -0.16515624999999998, 0.3562146869324905], res_norm=5.907e-01
2026-01-23 19:23:15,851 - INFO - integration_test - Dyn residual k=2: pred=[3.2577167161348703, 1.6764026568475348, 0.3560369181095311, 0.34390624999999997, 3.122234721429546], ws=[3.4929506731009274, 2.0498519330359932, 0.3560369181095311, 0.48841796875, 3.861338314353893], res=[-0.2352339569660571, -0.37344927618845847, 0.0, -0.14451171875000002, -0.739103592924347], res_norm=8.729e-01
2026-01-23 19:23:15,871 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:23:17,051 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:23:17,076 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:23:17,127 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:23:17,150 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:23:17,199 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:23:17,223 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:23:17,271 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:23:17,294 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:23:17,357 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:23:17,384 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:23:17,438 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:23:17,461 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:23:17,511 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:23:17,533 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:23:17,581 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:23:17,605 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:23:17,652 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-23 19:23:17,675 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:23:17,722 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:23:17,745 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-23 19:23:17,791 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-23 19:23:21,767 - WARNING - integration_test - Step 201: MPC solve failed
2026-01-23 19:23:21,767 - WARNING - integration_test -   Consecutive MPC failures: 25/20
2026-01-23 19:23:21,767 - WARNING - integration_test - Step 201: Checking if vehicle should continue despite 25 consecutive failures...
2026-01-23 19:23:21,767 - ERROR - integration_test - Max consecutive MPC failures (20) reached. No successful solve in last 20 attempts. Terminating test early at step 201.
2026-01-23 19:23:21,790 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:23:21,791 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1860 scenarios available
2026-01-23 19:23:21,806 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1860 trajectory groups with 18600 total points
2026-01-23 19:23:21,807 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:23:22,399 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:23:22,439 - INFO - integration_test - Step 200: Computed 6 numeric contouring constraints for visualization (s=3.894)
2026-01-23 19:23:22,439 - DEBUG - integration_test - Step 200: Captured 6 contouring constraint halfspaces for visualization
2026-01-23 19:23:22,439 - INFO - integration_test - === Applying control at step 200 ===
2026-01-23 19:23:22,439 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': -0.8}
2026-01-23 19:23:22,439 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-23 19:23:22,439 - INFO - integration_test -   Planner output success: False
2026-01-23 19:23:22,439 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': -0.8}
2026-01-23 19:23:22,441 - INFO - integration_test - Step 200 completed in 8.595s
2026-01-23 19:23:22,512 - WARNING - integration_test - Test timeout reached (300.0s) at step 201. Terminating test early.
2026-01-23 19:23:22,513 - INFO - integration_test - Saving test results...
2026-01-23 19:23:22,515 - INFO - integration_test - Saved 40 vehicle states to test_outputs/20260123_191821_contouring_safe_horizon_contouring_unicycle/vehicle_states.csv
2026-01-23 19:23:22,515 - INFO - integration_test - Saved obstacle summary to test_outputs/20260123_191821_contouring_safe_horizon_contouring_unicycle/obstacle_summary.csv
2026-01-23 19:23:22,515 - INFO - integration_test - Saved 50 states for obstacle 0 to test_outputs/20260123_191821_contouring_safe_horizon_contouring_unicycle/obstacle_0_detailed_states.csv
2026-01-23 19:23:22,515 - INFO - integration_test - Saved 50 states for obstacle 1 to test_outputs/20260123_191821_contouring_safe_horizon_contouring_unicycle/obstacle_1_detailed_states.csv
2026-01-23 19:23:22,515 - INFO - integration_test - Saved state history: 40 vehicle states, 2 obstacles
2026-01-23 19:23:22,515 - INFO - integration_test - Creating animation...
2026-01-23 19:23:22,558 - DEBUG - integration_test - Creating animation with 40 frames (range: 0 to 39)
2026-01-23 19:23:22,559 - DEBUG - integration_test - Frame 0: Drawing 6 contouring constraint halfspaces
2026-01-23 19:23:23,481 - INFO - integration_test - Frame 0: Safe Horizon module has 1862 scenarios after update
2026-01-23 19:23:23,481 - INFO - integration_test - Frame 0: Calling Safe Horizon visualizer
2026-01-23 19:23:23,482 - DEBUG - integration_test - Frame 0: Safe Horizon scenario_cache has 40 constraints across 10 keys: [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4)]
2026-01-23 19:23:23,483 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:23:23,483 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1862 scenarios available
2026-01-23 19:23:23,501 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1862 trajectory groups with 18620 total points
2026-01-23 19:23:23,502 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:23:23,906 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:23:23,912 - INFO - integration_test - Frame 0: Safe Horizon visualizer completed
2026-01-23 19:23:23,913 - DEBUG - integration_test - Frame 0: Drawing 6 contouring constraint halfspaces
2026-01-23 19:23:24,888 - INFO - integration_test - Frame 0: Safe Horizon module has 1845 scenarios after update
2026-01-23 19:23:24,888 - INFO - integration_test - Frame 0: Calling Safe Horizon visualizer
2026-01-23 19:23:24,888 - DEBUG - integration_test - Frame 0: Safe Horizon scenario_cache has 40 constraints across 10 keys: [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4)]
2026-01-23 19:23:24,890 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:23:24,890 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1845 scenarios available
2026-01-23 19:23:24,909 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1845 trajectory groups with 18450 total points
2026-01-23 19:23:24,910 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:23:24,961 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-23 19:23:24,969 - INFO - integration_test - Frame 0: Safe Horizon visualizer completed
2026-01-23 19:23:25,100 - DEBUG - integration_test - Frame 1: Drawing 6 contouring constraint halfspaces
2026-01-23 19:23:26,059 - INFO - integration_test - Frame 1: Safe Horizon module has 1863 scenarios after update
2026-01-23 19:23:26,059 - INFO - integration_test - Frame 1: Calling Safe Horizon visualizer
2026-01-23 19:23:26,059 - DEBUG - integration_test - Frame 1: Safe Horizon scenario_cache has 40 constraints across 10 keys: [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4)]
2026-01-23 19:23:26,061 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:23:26,061 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1863 scenarios available
2026-01-23 19:23:26,079 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1863 trajectory groups with 18630 total points
2026-01-23 19:23:26,081 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:23:26,134 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:23:26,141 - INFO - integration_test - Frame 1: Safe Horizon visualizer completed
2026-01-23 19:23:26,243 - DEBUG - integration_test - Frame 2: Drawing 6 contouring constraint halfspaces
2026-01-23 19:23:27,297 - INFO - integration_test - Frame 2: Safe Horizon module has 1860 scenarios after update
2026-01-23 19:23:27,297 - INFO - integration_test - Frame 2: Calling Safe Horizon visualizer
2026-01-23 19:23:27,297 - DEBUG - integration_test - Frame 2: Safe Horizon scenario_cache has 40 constraints across 10 keys: [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4)]
2026-01-23 19:23:27,299 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:23:27,299 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1860 scenarios available
2026-01-23 19:23:27,319 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1860 trajectory groups with 18600 total points
2026-01-23 19:23:27,320 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:23:27,726 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:23:27,734 - INFO - integration_test - Frame 2: Safe Horizon visualizer completed
2026-01-23 19:23:28,774 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:23:28,774 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1862 scenarios available
2026-01-23 19:23:28,791 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1862 trajectory groups with 18620 total points
2026-01-23 19:23:28,792 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:23:28,841 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:23:29,833 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:23:29,833 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1850 scenarios available
2026-01-23 19:23:29,866 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1850 trajectory groups with 18500 total points
2026-01-23 19:23:29,868 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:23:29,935 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:23:30,957 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:23:30,957 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1867 scenarios available
2026-01-23 19:23:30,977 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1867 trajectory groups with 18670 total points
2026-01-23 19:23:30,979 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:23:31,395 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:23:32,545 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:23:32,545 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1872 scenarios available
2026-01-23 19:23:32,565 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1872 trajectory groups with 18720 total points
2026-01-23 19:23:32,566 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:23:32,617 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:23:33,736 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:23:33,736 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1865 scenarios available
2026-01-23 19:23:33,755 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1865 trajectory groups with 18650 total points
2026-01-23 19:23:33,756 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:23:33,808 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:23:34,921 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:23:34,921 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1851 scenarios available
2026-01-23 19:23:34,941 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1851 trajectory groups with 18510 total points
2026-01-23 19:23:34,943 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:23:35,393 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:23:36,456 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:23:36,456 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1855 scenarios available
2026-01-23 19:23:36,474 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1855 trajectory groups with 18550 total points
2026-01-23 19:23:36,475 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:23:36,523 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:23:37,538 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:23:37,538 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1860 scenarios available
2026-01-23 19:23:37,556 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1860 trajectory groups with 18600 total points
2026-01-23 19:23:37,557 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:23:37,602 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:23:38,714 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:23:38,714 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1849 scenarios available
2026-01-23 19:23:38,737 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1849 trajectory groups with 18490 total points
2026-01-23 19:23:38,738 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:23:39,155 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:23:40,302 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:23:40,302 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1856 scenarios available
2026-01-23 19:23:40,325 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1856 trajectory groups with 18560 total points
2026-01-23 19:23:40,326 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:23:40,382 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:23:41,542 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:23:41,542 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1860 scenarios available
2026-01-23 19:23:41,570 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1860 trajectory groups with 18600 total points
2026-01-23 19:23:41,572 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:23:41,631 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:23:42,629 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:23:42,629 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1846 scenarios available
2026-01-23 19:23:42,646 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1846 trajectory groups with 18460 total points
2026-01-23 19:23:42,647 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:23:43,059 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:23:44,173 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:23:44,173 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1855 scenarios available
2026-01-23 19:23:44,193 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1855 trajectory groups with 18550 total points
2026-01-23 19:23:44,194 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:23:44,247 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:23:45,337 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:23:45,337 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1852 scenarios available
2026-01-23 19:23:45,358 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1852 trajectory groups with 18520 total points
2026-01-23 19:23:45,359 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:23:45,410 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:23:46,536 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:23:46,536 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1849 scenarios available
2026-01-23 19:23:46,907 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1849 trajectory groups with 18490 total points
2026-01-23 19:23:46,909 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:23:46,964 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:23:48,057 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:23:48,057 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1867 scenarios available
2026-01-23 19:23:48,079 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1867 trajectory groups with 18670 total points
2026-01-23 19:23:48,081 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:23:48,134 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:23:49,282 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:23:49,282 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1855 scenarios available
2026-01-23 19:23:49,303 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1855 trajectory groups with 18550 total points
2026-01-23 19:23:49,304 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:23:49,357 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:23:50,392 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:23:50,392 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1845 scenarios available
2026-01-23 19:23:50,409 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1845 trajectory groups with 18450 total points
2026-01-23 19:23:50,410 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:23:50,782 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:23:51,753 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:23:51,753 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1865 scenarios available
2026-01-23 19:23:51,771 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1865 trajectory groups with 18650 total points
2026-01-23 19:23:51,772 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:23:51,818 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:23:52,947 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:23:52,947 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1857 scenarios available
2026-01-23 19:23:52,969 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1857 trajectory groups with 18570 total points
2026-01-23 19:23:52,971 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:23:53,028 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:23:54,103 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:23:54,103 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1862 scenarios available
2026-01-23 19:23:54,489 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1862 trajectory groups with 18620 total points
2026-01-23 19:23:54,491 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:23:54,545 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:23:55,636 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:23:55,636 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1867 scenarios available
2026-01-23 19:23:55,657 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1867 trajectory groups with 18670 total points
2026-01-23 19:23:55,658 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:23:55,710 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:23:56,871 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:23:56,871 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1842 scenarios available
2026-01-23 19:23:56,891 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1842 trajectory groups with 18420 total points
2026-01-23 19:23:56,893 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:23:56,943 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:23:57,956 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:23:57,956 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1846 scenarios available
2026-01-23 19:23:58,294 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1846 trajectory groups with 18460 total points
2026-01-23 19:23:58,295 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:23:58,342 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:23:59,398 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:23:59,398 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1859 scenarios available
2026-01-23 19:23:59,418 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1859 trajectory groups with 18590 total points
2026-01-23 19:23:59,419 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:23:59,470 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:24:00,598 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:24:00,598 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1847 scenarios available
2026-01-23 19:24:00,620 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1847 trajectory groups with 18470 total points
2026-01-23 19:24:00,621 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:24:00,672 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:24:01,799 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:24:01,799 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1850 scenarios available
2026-01-23 19:24:02,169 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1850 trajectory groups with 18500 total points
2026-01-23 19:24:02,171 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:24:02,260 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:24:03,357 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:24:03,357 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1876 scenarios available
2026-01-23 19:24:03,380 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1876 trajectory groups with 18760 total points
2026-01-23 19:24:03,382 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:24:03,436 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:24:04,588 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:24:04,588 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1859 scenarios available
2026-01-23 19:24:04,608 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1859 trajectory groups with 18590 total points
2026-01-23 19:24:04,609 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:24:04,658 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:24:05,700 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:24:05,700 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1850 scenarios available
2026-01-23 19:24:06,038 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1850 trajectory groups with 18500 total points
2026-01-23 19:24:06,039 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:24:06,084 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:24:07,134 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:24:07,134 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1859 scenarios available
2026-01-23 19:24:07,157 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1859 trajectory groups with 18590 total points
2026-01-23 19:24:07,158 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:24:07,213 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:24:08,400 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:24:08,400 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1859 scenarios available
2026-01-23 19:24:08,420 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1859 trajectory groups with 18590 total points
2026-01-23 19:24:08,421 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:24:08,475 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:24:09,594 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:24:09,594 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1865 scenarios available
2026-01-23 19:24:09,953 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1865 trajectory groups with 18650 total points
2026-01-23 19:24:09,954 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:24:10,006 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:24:11,027 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:24:11,027 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1870 scenarios available
2026-01-23 19:24:11,045 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1870 trajectory groups with 18700 total points
2026-01-23 19:24:11,046 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:24:11,090 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:24:12,245 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:24:12,245 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1856 scenarios available
2026-01-23 19:24:12,267 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1856 trajectory groups with 18560 total points
2026-01-23 19:24:12,268 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:24:12,687 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:24:13,785 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:24:13,785 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1849 scenarios available
2026-01-23 19:24:13,807 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1849 trajectory groups with 18490 total points
2026-01-23 19:24:13,809 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:24:13,860 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:24:14,966 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-23 19:24:14,966 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1846 scenarios available
2026-01-23 19:24:14,985 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1846 trajectory groups with 18460 total points
2026-01-23 19:24:14,986 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-23 19:24:15,038 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.161548,0.11;0.701905x0.77)
2026-01-23 19:24:18,110 - INFO - integration_test - Saved animation with 40 frames at 10.00 fps to test_outputs/20260123_191821_contouring_safe_horizon_contouring_unicycle/animation.gif (duration: 4.00s, size: 858661 bytes)
2026-01-23 19:24:18,135 - INFO - integration_test - Animation created successfully
2026-01-23 19:24:18,136 - WARNING - integration_test - Test exited early due to solver failures, but files were saved
