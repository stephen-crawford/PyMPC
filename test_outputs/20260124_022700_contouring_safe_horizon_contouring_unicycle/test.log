2026-01-24 02:27:00,248 - INFO - integration_test - Contouring objective detected: automatically switching to contouring-aware dynamics model
2026-01-24 02:27:00,248 - INFO - integration_test -   Converted 'unicycle' -> 'contouring_unicycle'
2026-01-24 02:27:00,248 - INFO - integration_test - Created vehicle dynamics model: ContouringSecondOrderUnicycleModel
2026-01-24 02:27:00,248 - INFO - integration_test - ✓ Validation passed: Contouring objective with dynamics model that has 'spline' state
2026-01-24 02:27:00,248 - INFO - integration_test - Creating objective module: contouring
2026-01-24 02:27:00,256 - INFO - integration_test - Objective module 'contouring' created: contouring_objective
2026-01-24 02:27:00,256 - INFO - integration_test - Creating 2 constraint module(s): ['safe_horizon', 'contouring']
2026-01-24 02:27:00,256 - DEBUG - integration_test - Creating constraint module: safe_horizon
2026-01-24 02:27:00,281 - INFO - integration_test - Constraint module 'safe_horizon' created: safe_horizon_constraint
2026-01-24 02:27:00,281 - DEBUG - integration_test - Creating constraint module: contouring
2026-01-24 02:27:00,288 - INFO - integration_test - Constraint module 'contouring' created: contouring_constraints
2026-01-24 02:27:00,288 - INFO - integration_test - Created 2 constraint module(s)
2026-01-24 02:27:00,309 - INFO - integration_test - Setting solver on all modules...
2026-01-24 02:27:00,309 - DEBUG - integration_test -   Set solver on module: safe_horizon_constraint
2026-01-24 02:27:00,309 - DEBUG - integration_test -   Set solver on module: contouring_constraints
2026-01-24 02:27:00,309 - DEBUG - integration_test -   Set solver on module: control_effort_objective
2026-01-24 02:27:00,309 - DEBUG - integration_test -   Set solver on module: control_jerk_objective
2026-01-24 02:27:00,309 - DEBUG - integration_test -   Set solver on module: path_reference_velocity_objective
2026-01-24 02:27:00,309 - DEBUG - integration_test -   Set solver on module: contouring_objective
2026-01-24 02:27:00,309 - INFO - integration_test - Placing obstacles within reference path boundaries
2026-01-24 02:27:00,309 - INFO - integration_test - Obstacle 0: s=8.03, pos=(6.24, 5.59), lateral_offset=0.00m, vel=(0.47, 0.37)
2026-01-24 02:27:00,309 - INFO - integration_test - Obstacle 1: s=17.06, pos=(13.71, 10.71), lateral_offset=0.00m, vel=(-0.69, -0.41)
2026-01-24 02:27:00,310 - WARNING - integration_test - Error shaping obstacles: name 'get_dummy_obstacle' is not defined
2026-01-24 02:27:00,310 - WARNING - integration_test - Error in on_data_received: 'Planner' object has no attribute 'on_data_received'
2026-01-24 02:27:00,310 - INFO - integration_test - Initial vehicle state (before spline): [0. 0. 0. 1.]
2026-01-24 02:27:00,310 - INFO - integration_test - Vehicle starting position: (0.00, 0.00)
2026-01-24 02:27:00,310 - INFO - integration_test - Reference path start: (0.00, 0.00)
2026-01-24 02:27:00,310 - INFO - integration_test - Reference path starts at vehicle position (requirement satisfied)
2026-01-24 02:27:00,310 - INFO - integration_test - Contouring-aware dynamics detected: initializing spline variable
2026-01-24 02:27:00,311 - INFO - integration_test - Initialized spline to closest path point: s=0.0000 (vehicle at (0.00, 0.00), closest path point at (0.00, 0.00), distance=0.000m)
2026-01-24 02:27:00,311 - INFO - integration_test - Added spline variable: 0.0000
2026-01-24 02:27:00,311 - INFO - integration_test - Final initial state: [0. 0. 0. 1. 0.] (variables: ['x', 'y', 'psi', 'v', 'spline'])
2026-01-24 02:27:00,311 - INFO - integration_test - Auto-calculated timeout: 180s for 100 steps
2026-01-24 02:27:00,311 - INFO - integration_test - Step 0 (contouring until path end)
2026-01-24 02:27:00,311 - DEBUG - integration_test - Syncing planner state at step 0: vehicle_state=[0. 0. 0. 1. 0.]
2026-01-24 02:27:00,312 - DEBUG - integration_test - Step 0: Using propagated spline 0.0000 (close to path, dist=0.000m, drift=0.000m)
2026-01-24 02:27:00,312 - DEBUG - integration_test -   Set spline state to 0.0000
2026-01-24 02:27:00,313 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:27:01,480 - DEBUG - integration_test - Step 0: Checking path alignment: vehicle=(0.000, 0.000), path_start=(0.000, 0.000), dist=0.000m
2026-01-24 02:27:01,480 - INFO - integration_test - === Calling planner.solve_mpc() at step 0 ===
2026-01-24 02:27:02,576 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:27:02,604 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:27:02,604 - INFO - integration_test - Warmstart k=0: x0=0.0 , y0=0.0 , psi0=0.0 , v0=1.0 , spline0=0.0 , a0=0.0 , w0=0.0
2026-01-24 02:27:02,604 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:27:02,605 - INFO - integration_test - Dyn residual k=0: pred=[0.1, 0.0, 0.0, 1.0, 0.1], ws=[0.1, 0.0, 0.0, 1.0, 0.051515151515151514], res=[0.0, 0.0, 0.0, 0.0, 0.04848484848484849], res_norm=4.848e-02
2026-01-24 02:27:02,606 - INFO - integration_test - Dyn residual k=1: pred=[0.2, 0.0, 0.0, 1.0, 0.15151515151515152], ws=[0.2, 0.0, 0.0, 1.0, 0.05252525252525253], res=[0.0, 0.0, 0.0, 0.0, 0.09898989898989899], res_norm=9.899e-02
2026-01-24 02:27:02,607 - INFO - integration_test - Dyn residual k=2: pred=[0.30000000000000004, 0.0, 0.0, 1.0, 0.15252525252525254], ws=[0.30000000000000004, 0.0, 0.0, 1.0, 0.10707070707070707], res=[0.0, 0.0, 0.0, 0.0, 0.04545454545454547], res_norm=4.545e-02
2026-01-24 02:27:02,624 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:03,587 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:03,607 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:03,651 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:03,674 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:03,721 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:03,742 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:03,790 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:03,811 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:03,858 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:03,881 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:03,928 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:03,948 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:03,994 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:04,017 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:04,064 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:04,086 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:04,132 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:04,152 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:04,199 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:04,219 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:04,264 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:05,329 - INFO - integration_test - Step 0: MPC solve successful
2026-01-24 02:27:05,565 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:27:05,565 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1873 scenarios available
2026-01-24 02:27:05,651 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1873 trajectory groups with 18730 total points
2026-01-24 02:27:05,652 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:27:05,744 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:27:05,758 - INFO - integration_test - Step 0: Computed 6 numeric contouring constraints for visualization (s=0.000)
2026-01-24 02:27:05,758 - DEBUG - integration_test - Step 0: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:27:05,758 - DEBUG - integration_test - Linearized constraints module not found at step 0
2026-01-24 02:27:05,758 - INFO - integration_test - === Applying control at step 0 ===
2026-01-24 02:27:05,758 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000184714763, 'w': 0.7999999766286723}
2026-01-24 02:27:05,758 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:27:05,758 - INFO - integration_test -   Planner output success: True
2026-01-24 02:27:05,760 - INFO - integration_test - Step 0 completed in 5.449s
2026-01-24 02:27:05,834 - INFO - integration_test - Step 1 (contouring until path end)
2026-01-24 02:27:05,836 - DEBUG - integration_test - Syncing planner state at step 1: vehicle_state=[0.10987738 0.00453084 0.08       1.2        0.12      ]
2026-01-24 02:27:05,836 - DEBUG - integration_test - Step 1: Using propagated spline 0.1200 (close to path, dist=0.110m, drift=0.120m)
2026-01-24 02:27:05,836 - DEBUG - integration_test -   Set spline state to 0.1200
2026-01-24 02:27:05,837 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:27:06,832 - DEBUG - integration_test - Step 1: Checking path alignment: vehicle=(0.110, 0.005), path_start=(0.000, 0.000), dist=0.110m
2026-01-24 02:27:06,832 - INFO - integration_test - === Calling planner.solve_mpc() at step 1 ===
2026-01-24 02:27:07,815 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:27:07,841 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:27:07,841 - INFO - integration_test - Warmstart k=0: x0=0.10987737538056273 , y0=0.004530844925772923 , psi0=0.07999999766286722 , v0=1.2000000018471477 , spline0=0.12000000018471478 , a0=0.0 , w0=0.0
2026-01-24 02:27:07,841 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:27:07,842 - INFO - integration_test - Dyn residual k=0: pred=[0.2294935803434136, 0.014120607937276115, 0.07999999766286722, 1.2000000018471477, 0.24000000036942956], ws=[0.2294935803434136, 0.014120607937276116, 0.07999999766286736, 1.2000000018471477, 0.052929292933024535], res=[0.0, -1.734723475976807e-18, -1.3877787807814457e-16, 0.0, 0.18707070743640503], res_norm=1.871e-01
2026-01-24 02:27:07,843 - INFO - integration_test - Dyn residual k=1: pred=[0.34910978530626446, 0.023710370948779327, 0.07999999766286736, 1.2000000018471477, 0.1729292931177393], ws=[0.34910978530626446, 0.023710370948779327, 0.07999999766286736, 1.2000000018471477, 0.10828282829402312], res=[0.0, 0.0, 0.0, 0.0, 0.06464646482371618], res_norm=6.465e-02
2026-01-24 02:27:07,844 - INFO - integration_test - Dyn residual k=2: pred=[0.4687259902691153, 0.03330013396028254, 0.07999999766286736, 1.2000000018471477, 0.2282828284787379], ws=[0.4687259902691153, 0.03330013396028254, 0.07999999766286736, 1.2000000018471477, 0.16606060608299575], res=[0.0, 0.0, 0.0, 0.0, 0.062222222395742155], res_norm=6.222e-02
2026-01-24 02:27:07,863 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:08,855 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:08,875 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:08,923 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:08,944 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:09,015 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:09,048 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:09,103 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:09,125 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:09,174 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:09,196 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:09,243 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:09,263 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:09,310 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:09,331 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:09,381 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:09,404 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:09,450 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:09,471 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:09,516 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:09,537 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:09,580 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:10,204 - INFO - integration_test - Step 1: MPC solve successful
2026-01-24 02:27:10,208 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:27:10,208 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1865 scenarios available
2026-01-24 02:27:10,293 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1865 trajectory groups with 18650 total points
2026-01-24 02:27:10,294 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:27:10,390 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:27:10,401 - INFO - integration_test - Step 1: Computed 6 numeric contouring constraints for visualization (s=0.120)
2026-01-24 02:27:10,402 - DEBUG - integration_test - Step 1: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:27:10,402 - INFO - integration_test - === Applying control at step 1 ===
2026-01-24 02:27:10,402 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000189036626, 'w': 0.800000002618454}
2026-01-24 02:27:10,402 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:27:10,402 - INFO - integration_test -   Planner output success: True
2026-01-24 02:27:10,404 - INFO - integration_test - Step 1 completed in 4.568s
2026-01-24 02:27:10,470 - INFO - integration_test - Step 2 (contouring until path end)
2026-01-24 02:27:10,472 - DEBUG - integration_test - Syncing planner state at step 2: vehicle_state=[0.23889213 0.02022162 0.16       1.4        0.26      ]
2026-01-24 02:27:10,472 - DEBUG - integration_test - Step 2: Using propagated spline 0.2600 (close to path, dist=0.240m, drift=0.260m)
2026-01-24 02:27:10,472 - DEBUG - integration_test -   Set spline state to 0.2600
2026-01-24 02:27:10,473 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:27:11,464 - DEBUG - integration_test - Step 2: Checking path alignment: vehicle=(0.239, 0.020), path_start=(0.000, 0.000), dist=0.240m
2026-01-24 02:27:11,464 - INFO - integration_test - === Calling planner.solve_mpc() at step 2 ===
2026-01-24 02:27:12,442 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:27:12,497 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:27:12,497 - INFO - integration_test - Warmstart k=0: x0=0.2388921282040548 , y0=0.020221621341636787 , psi0=0.15999999792471262 , v0=1.400000003737514 , spline0=0.26000000055846617 , a0=0.0 , w0=0.0
2026-01-24 02:27:12,497 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:27:12,499 - INFO - integration_test - Dyn residual k=0: pred=[0.3771039482919085, 0.04252617004034738, 0.15999999792471262, 1.400000003737514, 0.40000000093221755], ws=[0.3771039482919085, 0.04252617004034738, 0.15999999792471264, 1.400000003737514, 0.10909090910974177], res=[0.0, 0.0, -2.7755575615628914e-17, 0.0, 0.29090909182247576], res_norm=2.909e-01
2026-01-24 02:27:12,500 - INFO - integration_test - Dyn residual k=1: pred=[0.5153157683797622, 0.06483071873905798, 0.15999999792471264, 1.400000003737514, 0.24909090948349316], ws=[0.5153157683797622, 0.06483071873905798, 0.15999999792471264, 1.400000003737514, 0.1678787879183627], res=[0.0, 0.0, 0.0, 0.0, 0.08121212156513047], res_norm=8.121e-02
2026-01-24 02:27:12,501 - INFO - integration_test - Dyn residual k=2: pred=[0.6535275884676159, 0.08713526743776857, 0.15999999792471264, 1.400000003737514, 0.3078787882921141], ws=[0.6535275884676159, 0.08713526743776857, 0.15999999792471264, 1.400000003737514, 0.4589898991256339], res=[0.0, 0.0, 0.0, 0.0, -0.1511111108335198], res_norm=1.511e-01
2026-01-24 02:27:12,527 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:13,565 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:13,587 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:13,635 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:13,659 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:13,710 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:13,733 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:13,784 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:13,805 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:13,853 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:13,878 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:13,928 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:13,951 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:14,002 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:14,025 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:14,074 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:14,097 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:14,146 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:14,169 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:14,217 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:14,239 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:14,288 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:14,901 - INFO - integration_test - Step 2: MPC solve successful
2026-01-24 02:27:14,905 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:27:14,905 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1867 scenarios available
2026-01-24 02:27:14,987 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1867 trajectory groups with 18670 total points
2026-01-24 02:27:14,988 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:27:15,087 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:27:15,098 - INFO - integration_test - Step 2: Computed 6 numeric contouring constraints for visualization (s=0.260)
2026-01-24 02:27:15,099 - DEBUG - integration_test - Step 2: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:27:15,099 - INFO - integration_test - === Applying control at step 2 ===
2026-01-24 02:27:15,099 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000194506247, 'w': 0.8000000058862885}
2026-01-24 02:27:15,099 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:27:15,099 - INFO - integration_test -   Planner output success: True
2026-01-24 02:27:15,100 - INFO - integration_test - Step 2 completed in 4.629s
2026-01-24 02:27:15,164 - INFO - integration_test - Step 3 (contouring until path end)
2026-01-24 02:27:15,164 - DEBUG - integration_test - Syncing planner state at step 3: vehicle_state=[0.38583644 0.05014472 0.24       1.60000001 0.42      ]
2026-01-24 02:27:15,165 - DEBUG - integration_test - Step 3: Using propagated spline 0.4200 (close to path, dist=0.261m, drift=0.010m)
2026-01-24 02:27:15,165 - DEBUG - integration_test -   Set spline state to 0.4200
2026-01-24 02:27:15,165 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:27:16,163 - DEBUG - integration_test - Step 3: Checking path alignment: vehicle=(0.386, 0.050), path_start=(0.000, 0.000), dist=0.389m
2026-01-24 02:27:16,163 - INFO - integration_test - === Calling planner.solve_mpc() at step 3 ===
2026-01-24 02:27:17,080 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:27:17,108 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:27:17,108 - INFO - integration_test - Warmstart k=0: x0=0.38583643577675364 , y0=0.05014471578082527 , psi0=0.23999999851334147 , v0=1.6000000056825765 , spline0=0.42000000112672387 , a0=0.0 , w0=0.0
2026-01-24 02:27:17,108 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:27:17,109 - INFO - integration_test - Dyn residual k=0: pred=[0.5412505123615898, 0.08817713591319548, 0.23999999851334147, 1.6000000056825765, 0.5800000016949816], ws=[0.5412505123615898, 0.08817713591319548, 0.23999999851334142, 1.6000000056825765, 0.16909090914227218], res=[0.0, 0.0, 5.551115123125783e-17, 0.0, 0.41090909255270935], res_norm=4.109e-01
2026-01-24 02:27:17,110 - INFO - integration_test - Dyn residual k=1: pred=[0.696664588946426, 0.12620955604556566, 0.23999999851334142, 1.6000000056825765, 0.32909090971052984], ws=[0.696664588946426, 0.1262095560455657, 0.23999999851334142, 1.6000000056825765, 0.23191919201063593], res=[0.0, -2.7755575615628914e-17, 0.0, 0.0, 0.09717171769989391], res_norm=9.717e-02
2026-01-24 02:27:17,111 - INFO - integration_test - Dyn residual k=2: pred=[0.8520786655312622, 0.1642419761779359, 0.23999999851334142, 1.6000000056825765, 0.3919191925788936], ws=[0.8520786655312622, 0.1642419761779359, 0.23999999851334142, 1.6000000056825765, 0.2979797981228029], res=[0.0, 0.0, 0.0, 0.0, 0.09393939445609073], res_norm=9.394e-02
2026-01-24 02:27:17,127 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:18,163 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:18,184 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:18,229 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:18,249 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:18,297 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:18,319 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:18,364 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:18,385 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:18,434 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:18,460 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:18,519 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:18,545 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:18,589 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:18,607 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:18,654 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:18,674 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:18,736 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:18,759 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:18,807 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:18,828 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:18,872 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:19,566 - INFO - integration_test - Step 3: MPC solve successful
2026-01-24 02:27:19,571 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:27:19,571 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1846 scenarios available
2026-01-24 02:27:19,587 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1846 trajectory groups with 18460 total points
2026-01-24 02:27:19,589 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:27:19,709 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:27:19,722 - INFO - integration_test - Step 3: Computed 6 numeric contouring constraints for visualization (s=0.420)
2026-01-24 02:27:19,722 - DEBUG - integration_test - Step 3: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:27:19,722 - INFO - integration_test - === Applying control at step 3 ===
2026-01-24 02:27:19,722 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000197589696, 'w': 0.8000000078059324}
2026-01-24 02:27:19,722 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:27:19,722 - INFO - integration_test -   Planner output success: True
2026-01-24 02:27:19,724 - INFO - integration_test - Step 3 completed in 4.560s
2026-01-24 02:27:19,790 - INFO - integration_test - Step 4 (contouring until path end)
2026-01-24 02:27:19,792 - DEBUG - integration_test - Syncing planner state at step 4: vehicle_state=[0.54913546 0.09724076 0.32       1.80000001 0.6       ]
2026-01-24 02:27:19,793 - DEBUG - integration_test - Step 4: Using propagated spline 0.6000 (close to path, dist=0.325m, drift=0.190m)
2026-01-24 02:27:19,793 - DEBUG - integration_test -   Set spline state to 0.6000
2026-01-24 02:27:19,793 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:27:20,782 - DEBUG - integration_test - Step 4: Checking path alignment: vehicle=(0.549, 0.097), path_start=(0.000, 0.000), dist=0.558m
2026-01-24 02:27:20,782 - INFO - integration_test - === Calling planner.solve_mpc() at step 4 ===
2026-01-24 02:27:21,831 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:27:21,858 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:27:21,858 - INFO - integration_test - Warmstart k=0: x0=0.549135461348133 , y0=0.09724075614882889 , psi0=0.3199999992939347 , v0=1.8000000076584735 , spline0=0.6000000018925712 , a0=0.0 , w0=0.0
2026-01-24 02:27:21,858 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:27:21,859 - INFO - integration_test - Dyn residual k=0: pred=[0.7199978373699205, 0.15386273718000004, 0.3199999992939347, 1.8000000076584735, 0.7800000026584185], ws=[0.7199978373699205, 0.15386273718000004, 0.31999999929393486, 1.8000000076584735, 0.2335353536427644], res=[0.0, 0.0, -1.6653345369377348e-16, 0.0, 0.5464646490156542], res_norm=5.465e-01
2026-01-24 02:27:21,860 - INFO - integration_test - Dyn residual k=1: pred=[0.8908602133917081, 0.21048471821117126, 0.31999999929393486, 1.8000000076584735, 0.4135353544086118], ws=[0.8908602133917081, 0.21048471821117123, 0.31999999929393486, 1.8000000076584735, 0.3010101011830437], res=[0.0, 2.7755575615628914e-17, 0.0, 0.0, 0.11252525322556806], res_norm=1.125e-01
2026-01-24 02:27:21,860 - INFO - integration_test - Dyn residual k=2: pred=[1.0617225894134956, 0.2671066992423424, 0.31999999929393486, 1.8000000076584735, 0.48101010194889104], ws=[1.0617225894134956, 0.2671066992423424, 0.31999999929393486, 1.8000000076584735, 0.37212121237515844], res=[0.0, 0.0, 0.0, 0.0, 0.1088888895737326], res_norm=1.089e-01
2026-01-24 02:27:21,878 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:22,894 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:22,919 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:22,977 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:23,002 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:23,053 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:23,086 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:23,169 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:23,197 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:23,251 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:23,280 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:23,363 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:23,393 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:23,446 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:23,471 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:23,523 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:23,545 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:23,593 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:23,615 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:23,662 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:23,685 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:23,730 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:24,344 - INFO - integration_test - Step 4: MPC solve successful
2026-01-24 02:27:24,347 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:27:24,347 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1863 scenarios available
2026-01-24 02:27:24,359 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1863 trajectory groups with 18630 total points
2026-01-24 02:27:24,360 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:27:24,479 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:27:24,491 - INFO - integration_test - Step 4: Computed 6 numeric contouring constraints for visualization (s=0.600)
2026-01-24 02:27:24,491 - DEBUG - integration_test - Step 4: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:27:24,491 - INFO - integration_test - === Applying control at step 4 ===
2026-01-24 02:27:24,491 - INFO - integration_test -   Control dict from planner: {'a': 2.000000010788877, 'w': 0.7999999386814589}
2026-01-24 02:27:24,491 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:27:24,491 - INFO - integration_test -   Planner output success: True
2026-01-24 02:27:24,493 - INFO - integration_test - Step 4 completed in 4.701s
2026-01-24 02:27:24,550 - INFO - integration_test - Step 5 (contouring until path end)
2026-01-24 02:27:24,551 - DEBUG - integration_test - Syncing planner state at step 5: vehicle_state=[0.72686149 0.16427977 0.39999999 2.00000001 0.8       ]
2026-01-24 02:27:24,551 - DEBUG - integration_test - Step 5: Using propagated spline 0.8000 (close to path, dist=0.443m, drift=0.019m)
2026-01-24 02:27:24,551 - DEBUG - integration_test -   Set spline state to 0.8000
2026-01-24 02:27:24,552 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:27:25,539 - DEBUG - integration_test - Step 5: Checking path alignment: vehicle=(0.727, 0.164), path_start=(0.000, 0.000), dist=0.745m
2026-01-24 02:27:25,539 - INFO - integration_test - === Calling planner.solve_mpc() at step 5 ===
2026-01-24 02:27:26,501 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:27:26,530 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:27:26,530 - INFO - integration_test - Warmstart k=0: x0=0.7268614890537585 , y0=0.16427976687129683 , psi0=0.39999999316208057 , v0=2.000000008737361 , spline0=0.8000000027663073 , a0=0.0 , w0=0.0
2026-01-24 02:27:26,530 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:27:26,531 - INFO - integration_test - Dyn residual k=0: pred=[0.911073689191662, 0.24216343441364763, 0.39999999316208057, 2.000000008737361, 1.0000000036400434], ws=[0.911073689191662, 0.24216343441364763, 0.3999999931620808, 2.000000008737361, 0.3636363638569723], res=[0.0, 0.0, -2.220446049250313e-16, 0.0, 0.6363636397830711], res_norm=6.364e-01
2026-01-24 02:27:26,532 - INFO - integration_test - Dyn residual k=1: pred=[1.0952858893295654, 0.32004710195599845, 0.3999999931620808, 2.000000008737361, 0.5636363647307084], ws=[1.0952858893295656, 0.32004710195599845, 0.3999999931620808, 2.000000008737361, 0.8767676774059892], res=[-2.220446049250313e-16, 0.0, 0.0, 0.0, -0.3131313126752807], res_norm=3.131e-01
2026-01-24 02:27:26,533 - INFO - integration_test - Dyn residual k=2: pred=[1.279498089467469, 0.39793076949834927, 0.3999999931620808, 2.000000008737361, 1.0767676782797253], ws=[1.2794980894674692, 0.39793076949834927, 0.3999999931620808, 2.000000008737361, 0.9696969705132599], res=[-2.220446049250313e-16, 0.0, 0.0, 0.0, 0.10707070776646543], res_norm=1.071e-01
2026-01-24 02:27:26,550 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:27,605 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:27,629 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:27,680 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:27,703 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:27,754 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:27,777 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:27,827 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:27,849 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:27,899 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:27,923 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:27,980 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:28,014 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:28,090 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:28,116 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:28,170 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:28,192 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:28,241 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:28,263 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:28,313 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:28,335 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:28,387 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:29,021 - INFO - integration_test - Step 5: MPC solve successful
2026-01-24 02:27:29,025 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:27:29,025 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1866 scenarios available
2026-01-24 02:27:29,037 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1866 trajectory groups with 18660 total points
2026-01-24 02:27:29,038 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:27:29,261 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:27:29,273 - INFO - integration_test - Step 5: Computed 6 numeric contouring constraints for visualization (s=0.800)
2026-01-24 02:27:29,273 - DEBUG - integration_test - Step 5: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:27:29,273 - INFO - integration_test - === Applying control at step 5 ===
2026-01-24 02:27:29,273 - INFO - integration_test -   Control dict from planner: {'a': 2.000000017072958, 'w': 0.7999999975600921}
2026-01-24 02:27:29,274 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:27:29,274 - INFO - integration_test -   Planner output success: True
2026-01-24 02:27:29,275 - INFO - integration_test - Step 5 completed in 4.725s
2026-01-24 02:27:29,336 - INFO - integration_test - Step 6 (contouring until path end)
2026-01-24 02:27:29,339 - DEBUG - integration_test - Syncing planner state at step 6: vehicle_state=[0.9167519  0.25382381 0.47999999 2.20000001 1.02      ]
2026-01-24 02:27:29,339 - DEBUG - integration_test - Step 6: Using propagated spline 1.0200 (close to path, dist=0.471m, drift=0.201m)
2026-01-24 02:27:29,339 - DEBUG - integration_test -   Set spline state to 1.0200
2026-01-24 02:27:29,340 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:27:30,423 - DEBUG - integration_test - Step 6: Checking path alignment: vehicle=(0.917, 0.254), path_start=(0.000, 0.000), dist=0.951m
2026-01-24 02:27:30,423 - INFO - integration_test - === Calling planner.solve_mpc() at step 6 ===
2026-01-24 02:27:31,439 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:27:31,468 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:27:31,468 - INFO - integration_test - Warmstart k=0: x0=0.9167519036972896 , y0=0.25382380558160905 , psi0=0.4799999929180898 , v0=2.200000010444657 , spline0=1.020000003810773 , a0=0.0 , w0=0.0
2026-01-24 02:27:31,468 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:27:31,469 - INFO - integration_test - Dyn residual k=0: pred=[1.1118907883546292, 0.3554152233010917, 0.4799999929180898, 2.200000010444657, 1.2400000048552386], ws=[1.1118907883546292, 0.35541522330109176, 0.4799999929180898, 2.200000010444657, 0.6933333338728043], res=[0.0, -5.551115123125783e-17, 0.0, 0.0, 0.5466666709824344], res_norm=5.467e-01
2026-01-24 02:27:31,470 - INFO - integration_test - Dyn residual k=1: pred=[1.3070296730119688, 0.4570066410205744, 0.4799999929180898, 2.200000010444657, 0.91333333491727], ws=[1.3070296730119688, 0.4570066410205744, 0.4799999929180898, 2.200000010444657, 1.2397979809302462], res=[0.0, 0.0, 0.0, 0.0, -0.3264646460129762], res_norm=3.265e-01
2026-01-24 02:27:31,471 - INFO - integration_test - Dyn residual k=2: pred=[1.5021685576693085, 0.5585980587400571, 0.4799999929180898, 2.200000010444657, 1.4597979819747118], ws=[1.5021685576693085, 0.5585980587400571, 0.4799999929180898, 2.200000010444657, 1.0795959607182497], res=[0.0, 0.0, 0.0, 0.0, 0.3802020212564621], res_norm=3.802e-01
2026-01-24 02:27:31,489 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:32,438 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:32,461 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:32,511 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:32,535 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:32,583 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:32,603 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:32,650 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:32,671 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:32,718 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:32,739 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:32,786 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:32,807 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:32,853 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:32,872 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:32,922 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:32,945 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:32,995 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:33,016 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:33,061 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:33,084 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:33,131 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:33,842 - INFO - integration_test - Step 6: MPC solve successful
2026-01-24 02:27:33,846 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:27:33,847 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1866 scenarios available
2026-01-24 02:27:33,970 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1866 trajectory groups with 18660 total points
2026-01-24 02:27:33,971 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:27:34,140 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:27:34,155 - INFO - integration_test - Step 6: Computed 6 numeric contouring constraints for visualization (s=1.020)
2026-01-24 02:27:34,155 - DEBUG - integration_test - Step 6: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:27:34,155 - INFO - integration_test - === Applying control at step 6 ===
2026-01-24 02:27:34,155 - INFO - integration_test -   Control dict from planner: {'a': 2.000000017835006, 'w': 0.7999999805367652}
2026-01-24 02:27:34,155 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:27:34,155 - INFO - integration_test -   Planner output success: True
2026-01-24 02:27:34,157 - INFO - integration_test - Step 6 completed in 4.818s
2026-01-24 02:27:34,226 - INFO - integration_test - Step 7 (contouring until path end)
2026-01-24 02:27:34,227 - DEBUG - integration_test - Syncing planner state at step 7: vehicle_state=[1.11623086 0.36819144 0.55999999 2.40000001 1.26000001]
2026-01-24 02:27:34,228 - DEBUG - integration_test - Step 7: Using propagated spline 1.2600 (close to path, dist=0.559m, drift=0.031m)
2026-01-24 02:27:34,228 - DEBUG - integration_test -   Set spline state to 1.2600
2026-01-24 02:27:34,229 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:27:35,237 - DEBUG - integration_test - Step 7: Checking path alignment: vehicle=(1.116, 0.368), path_start=(0.000, 0.000), dist=1.175m
2026-01-24 02:27:35,237 - INFO - integration_test - === Calling planner.solve_mpc() at step 7 ===
2026-01-24 02:27:36,230 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:27:36,261 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:27:36,261 - INFO - integration_test - Warmstart k=0: x0=1.1162308647653545 , y0=0.3681914433603556 , psi0=0.5599999909717663 , v0=2.4000000122281575 , spline0=1.2600000050335889 , a0=0.0 , w0=0.0
2026-01-24 02:27:36,261 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:27:36,263 - INFO - integration_test - Dyn residual k=0: pred=[1.3195720935955728, 0.49567612967509833, 0.5599999909717663, 2.4000000122281575, 1.5000000062564047], ws=[1.3195720935955728, 0.49567612967509833, 0.5599999909717663, 2.4000000122281575, 1.2474747486754716], res=[0.0, 0.0, 0.0, 0.0, 0.25252525758093314], res_norm=2.525e-01
2026-01-24 02:27:36,264 - INFO - integration_test - Dyn residual k=1: pred=[1.5229133224257911, 0.6231608159898411, 0.5599999909717663, 2.4000000122281575, 1.4874747498982874], ws=[1.5229133224257911, 0.6231608159898411, 0.5599999909717663, 2.4000000122281575, 1.3616161631271153], res=[0.0, 0.0, 0.0, 0.0, 0.12585858677117212], res_norm=1.259e-01
2026-01-24 02:27:36,265 - INFO - integration_test - Dyn residual k=2: pred=[1.7262545512560095, 0.7506455023045838, 0.5599999909717663, 2.4000000122281575, 1.6016161643499311], ws=[1.7262545512560095, 0.7506455023045838, 0.5599999909717663, 2.4000000122281575, 1.1985858600801478], res=[0.0, 0.0, 0.0, 0.0, 0.40303030426978337], res_norm=4.030e-01
2026-01-24 02:27:36,283 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:37,351 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:37,374 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:37,420 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:37,441 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:37,490 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:37,512 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:37,557 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:37,579 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:37,630 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:37,652 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:37,704 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:37,726 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:37,771 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:37,792 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:37,836 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:37,855 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:37,904 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:37,926 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:37,975 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:37,999 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:38,045 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:38,681 - INFO - integration_test - Step 7: MPC solve successful
2026-01-24 02:27:38,686 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:27:38,686 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1857 scenarios available
2026-01-24 02:27:38,818 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1857 trajectory groups with 18570 total points
2026-01-24 02:27:38,819 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:27:39,059 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:27:39,073 - INFO - integration_test - Step 7: Computed 6 numeric contouring constraints for visualization (s=1.260)
2026-01-24 02:27:39,073 - DEBUG - integration_test - Step 7: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:27:39,073 - INFO - integration_test - === Applying control at step 7 ===
2026-01-24 02:27:39,073 - INFO - integration_test -   Control dict from planner: {'a': 2.00000001957692, 'w': 0.8000000017571711}
2026-01-24 02:27:39,073 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:27:39,073 - INFO - integration_test -   Planner output success: True
2026-01-24 02:27:39,075 - INFO - integration_test - Step 7 completed in 4.848s
2026-01-24 02:27:39,140 - INFO - integration_test - Step 8 (contouring until path end)
2026-01-24 02:27:39,142 - DEBUG - integration_test - Syncing planner state at step 8: vehicle_state=[1.32243449 0.50942444 0.63999999 2.60000001 1.52000001]
2026-01-24 02:27:39,143 - DEBUG - integration_test - Step 8: Using propagated spline 1.5200 (close to path, dist=0.577m, drift=0.291m)
2026-01-24 02:27:39,143 - DEBUG - integration_test -   Set spline state to 1.5200
2026-01-24 02:27:39,144 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:27:40,157 - DEBUG - integration_test - Step 8: Checking path alignment: vehicle=(1.322, 0.509), path_start=(0.000, 0.000), dist=1.417m
2026-01-24 02:27:40,157 - INFO - integration_test - === Calling planner.solve_mpc() at step 8 ===
2026-01-24 02:27:41,177 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:27:41,203 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:27:41,203 - INFO - integration_test - Warmstart k=0: x0=1.3224344902170864 , y0=0.5094244382052071 , psi0=0.6399999911474834 , v0=2.6000000141858495 , spline0=1.520000006452174 , a0=0.0 , w0=0.0
2026-01-24 02:27:41,204 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:27:41,204 - INFO - integration_test - Dyn residual k=0: pred=[1.5309793897793809, 0.6646952519604543, 0.6399999911474834, 2.6000000141858495, 1.780000007870759], ws=[1.5309793897793809, 0.6646952519604543, 0.6399999911474836, 2.6000000141858495, 1.3696969712870222], res=[0.0, 0.0, -2.220446049250313e-16, 0.0, 0.4103030365837368], res_norm=4.103e-01
2026-01-24 02:27:41,205 - INFO - integration_test - Dyn residual k=1: pred=[1.7395242893416754, 0.8199660657157016, 0.6399999911474836, 2.6000000141858495, 1.6296969727056072], ws=[1.7395242893416754, 0.8199660657157016, 0.6399999911474836, 2.6000000141858495, 1.7066666689186287], res=[0.0, 0.0, 0.0, 0.0, -0.07696969621302152], res_norm=7.697e-02
2026-01-24 02:27:41,206 - INFO - integration_test - Dyn residual k=2: pred=[1.9480691889039699, 0.975236879470949, 0.6399999911474836, 2.6000000141858495, 1.9666666703372138], ws=[1.9480691889039699, 0.975236879470949, 0.6399999911474836, 2.6000000141858495, 2.0646464676749696], res=[0.0, 0.0, 0.0, 0.0, -0.09797979733775586], res_norm=9.798e-02
2026-01-24 02:27:41,224 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:42,270 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:42,294 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:42,355 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:42,379 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:42,433 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:42,457 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:42,509 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:42,533 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:42,582 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:42,605 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:42,656 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:42,678 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:42,728 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:42,751 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:42,803 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:42,825 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:42,873 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:42,896 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:42,952 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:42,977 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:43,027 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:43,696 - INFO - integration_test - Step 8: MPC solve successful
2026-01-24 02:27:43,702 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:27:43,702 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1864 scenarios available
2026-01-24 02:27:43,837 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1864 trajectory groups with 18640 total points
2026-01-24 02:27:43,838 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:27:44,003 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:27:44,018 - INFO - integration_test - Step 8: Computed 6 numeric contouring constraints for visualization (s=1.520)
2026-01-24 02:27:44,018 - DEBUG - integration_test - Step 8: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:27:44,018 - INFO - integration_test - === Applying control at step 8 ===
2026-01-24 02:27:44,018 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000199922074, 'w': 0.8000000098295753}
2026-01-24 02:27:44,018 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:27:44,019 - INFO - integration_test -   Planner output success: True
2026-01-24 02:27:44,020 - INFO - integration_test - Step 8 completed in 4.879s
2026-01-24 02:27:44,106 - INFO - integration_test - Step 9 (contouring until path end)
2026-01-24 02:27:44,109 - DEBUG - integration_test - Syncing planner state at step 9: vehicle_state=[1.53223933 0.67925694 0.71999999 2.80000002 1.80000001]
2026-01-24 02:27:44,110 - DEBUG - integration_test - Step 9: Using propagated spline 1.8000 (close to path, dist=0.602m, drift=0.161m)
2026-01-24 02:27:44,110 - DEBUG - integration_test -   Set spline state to 1.8000
2026-01-24 02:27:44,112 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:27:45,087 - DEBUG - integration_test - Step 9: Checking path alignment: vehicle=(1.532, 0.679), path_start=(0.000, 0.000), dist=1.676m
2026-01-24 02:27:45,087 - INFO - integration_test - === Calling planner.solve_mpc() at step 9 ===
2026-01-24 02:27:46,008 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:27:46,036 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:27:46,036 - INFO - integration_test - Warmstart k=0: x0=1.532239332391013 , y0=0.6792569355478442 , psi0=0.719999992130441 , v0=2.80000001618507 , spline0=1.8000000080706808 , a0=0.0 , w0=0.0
2026-01-24 02:27:46,036 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:27:46,037 - INFO - integration_test - Dyn residual k=0: pred=[1.7427449392202052, 0.8638846431104891, 0.719999992130441, 2.80000001618507, 2.0800000096891877], ws=[1.7427449392202052, 0.8638846431104891, 0.719999992130441, 2.80000001618507, 1.7163636387125305], res=[0.0, 0.0, 0.0, 0.0, 0.36363637097665724], res_norm=3.636e-01
2026-01-24 02:27:46,038 - INFO - integration_test - Dyn residual k=1: pred=[1.9532505460493974, 1.048512350673134, 0.719999992130441, 2.80000001618507, 1.9963636403310376], ws=[1.9532505460493974, 1.048512350673134, 0.719999992130441, 2.80000001618507, 2.0816161648142977], res=[0.0, 0.0, 0.0, 0.0, -0.08525252448326004], res_norm=8.525e-02
2026-01-24 02:27:46,039 - INFO - integration_test - Dyn residual k=2: pred=[2.1637561528785896, 1.233140058235779, 0.719999992130441, 2.80000001618507, 2.3616161664328046], ws=[2.1637561528785896, 1.233140058235779, 0.719999992130441, 2.80000001618507, 1.9292929325571215], res=[0.0, 0.0, 0.0, 0.0, 0.43232323387568306], res_norm=4.323e-01
2026-01-24 02:27:46,054 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:47,117 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:47,138 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:47,183 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:47,203 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:47,248 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:47,269 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:47,317 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:47,338 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:47,382 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:47,405 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:47,448 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:47,469 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:47,517 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:47,538 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:47,609 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:47,649 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:47,704 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:47,729 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:47,775 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:47,796 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:47,843 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:48,574 - INFO - integration_test - Step 9: MPC solve successful
2026-01-24 02:27:48,581 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:27:48,582 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1856 scenarios available
2026-01-24 02:27:48,597 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1856 trajectory groups with 18560 total points
2026-01-24 02:27:48,598 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:27:48,771 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:27:48,786 - INFO - integration_test - Step 9: Computed 6 numeric contouring constraints for visualization (s=1.800)
2026-01-24 02:27:48,787 - DEBUG - integration_test - Step 9: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:27:48,787 - INFO - integration_test - === Applying control at step 9 ===
2026-01-24 02:27:48,787 - INFO - integration_test -   Control dict from planner: {'a': 2.000000019998891, 'w': 0.800000009973578}
2026-01-24 02:27:48,787 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:27:48,787 - INFO - integration_test -   Planner output success: True
2026-01-24 02:27:48,788 - INFO - integration_test - Step 9 completed in 4.680s
2026-01-24 02:27:48,850 - INFO - integration_test - Step 10 (contouring until path end)
2026-01-24 02:27:48,851 - DEBUG - integration_test - Syncing planner state at step 10: vehicle_state=[1.7422939  0.8790875  0.79999999 3.00000002 2.10000001]
2026-01-24 02:27:48,852 - DEBUG - integration_test - Step 10: Using propagated spline 2.1000 (close to path, dist=0.628m, drift=0.052m)
2026-01-24 02:27:48,852 - DEBUG - integration_test -   Set spline state to 2.1000
2026-01-24 02:27:48,853 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:27:49,845 - DEBUG - integration_test - Step 10: Checking path alignment: vehicle=(1.742, 0.879), path_start=(0.000, 0.000), dist=1.952m
2026-01-24 02:27:49,845 - INFO - integration_test - === Calling planner.solve_mpc() at step 10 ===
2026-01-24 02:27:50,945 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:27:50,990 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:27:50,991 - INFO - integration_test - Warmstart k=0: x0=1.7422939000096218 , y0=0.8790875038090141 , psi0=0.7999999931277988 , v0=3.0000000181849593 , spline0=2.1000000098891767 , a0=0.0 , w0=0.0
2026-01-24 02:27:50,991 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:27:50,992 - INFO - integration_test - Dyn residual k=0: pred=[1.9513059155596744, 1.0942943309470075, 0.7999999931277988, 3.0000000181849593, 2.4000000117076725], ws=[1.951305914292716, 1.0942943296424983, 0.7999999931277988, 3.0, 2.0929292957262318], res=[1.2669583160374032e-09, 1.304509167354695e-09, 0.0, 1.818495931615871e-08, 0.30707071598144076], res_norm=3.071e-01
2026-01-24 02:27:50,993 - INFO - integration_test - Dyn residual k=1: pred=[2.16031792857581, 1.3095011554759826, 0.7999999931277988, 3.0, 2.3929292957262316], ws=[2.16031792857581, 1.3095011554759826, 0.7999999931277988, 3.0, 2.4888888920853907], res=[0.0, 0.0, 0.0, 0.0, -0.09595959635915907], res_norm=9.596e-02
2026-01-24 02:27:50,995 - INFO - integration_test - Dyn residual k=2: pred=[2.3693299428589043, 1.5247079813094668, 0.7999999931277988, 3.0, 2.7888888920853905], ws=[2.3693299428589043, 1.5247079813094668, 0.7999999931277988, 3.0, 2.3434343463311733], res=[0.0, 0.0, 0.0, 0.0, 0.44545454575421717], res_norm=4.455e-01
2026-01-24 02:27:51,022 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:52,072 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:52,095 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:52,145 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:52,169 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:52,218 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:52,243 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:52,295 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:52,318 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:52,368 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:52,391 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:52,439 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:52,461 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:52,510 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:52,532 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:52,580 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:52,601 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:52,648 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:52,668 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:52,714 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:52,735 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:52,784 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:53,481 - INFO - integration_test - Step 10: MPC solve successful
2026-01-24 02:27:53,487 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:27:53,487 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1872 scenarios available
2026-01-24 02:27:53,502 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1872 trajectory groups with 18720 total points
2026-01-24 02:27:53,503 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:27:53,675 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:27:53,686 - INFO - integration_test - Step 10: Computed 6 numeric contouring constraints for visualization (s=2.100)
2026-01-24 02:27:53,686 - DEBUG - integration_test - Step 10: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:27:53,686 - INFO - integration_test - === Applying control at step 10 ===
2026-01-24 02:27:53,687 - INFO - integration_test -   Control dict from planner: {'a': 1.181492455125851e-07, 'w': 0.8000000098644615}
2026-01-24 02:27:53,687 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:27:53,687 - INFO - integration_test -   Planner output success: True
2026-01-24 02:27:53,688 - INFO - integration_test - Step 10 completed in 4.837s
2026-01-24 02:27:53,742 - INFO - integration_test - Step 11 (contouring until path end)
2026-01-24 02:27:53,748 - DEBUG - integration_test - Syncing planner state at step 11: vehicle_state=[1.94247936 1.10242088 0.87999999 3.00000003 2.40000001]
2026-01-24 02:27:53,748 - DEBUG - integration_test - Step 11: Using propagated spline 2.4000 (close to path, dist=0.588m, drift=0.352m)
2026-01-24 02:27:53,748 - DEBUG - integration_test -   Set spline state to 2.4000
2026-01-24 02:27:53,749 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:27:54,828 - DEBUG - integration_test - Step 11: Checking path alignment: vehicle=(1.942, 1.102), path_start=(0.000, 0.000), dist=2.234m
2026-01-24 02:27:54,828 - INFO - integration_test - === Calling planner.solve_mpc() at step 11 ===
2026-01-24 02:27:55,849 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:27:55,880 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:27:55,880 - INFO - integration_test - Warmstart k=0: x0=1.9424793608802802 , y0=1.1024208768134665 , psi0=0.8799999941142449 , v0=3.000000029999884 , spline0=2.400000012889165 , a0=0.0 , w0=0.0
2026-01-24 02:27:55,880 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:27:55,881 - INFO - integration_test - Dyn residual k=0: pred=[2.1336247074122143, 1.3336425416703301, 0.8799999941142449, 3.000000029999884, 2.7000000158891537], ws=[2.133624705500768, 1.3336425393581226, 0.8799999941142449, 3.0, 2.488888893055084], res=[1.9114461125013804e-09, 2.3122075365478167e-09, 0.0, 2.99998839103921e-08, 0.21111112283406985], res_norm=2.111e-01
2026-01-24 02:27:55,882 - INFO - integration_test - Dyn residual k=1: pred=[2.3247700501212565, 1.5648642019027788, 0.8799999941142449, 3.0, 2.788888893055084], ws=[2.3247700501212565, 1.5648642019027788, 0.8799999941142449, 3.0, 2.3434343472099575], res=[0.0, 0.0, 0.0, 0.0, 0.44545454584512667], res_norm=4.455e-01
2026-01-24 02:27:55,883 - INFO - integration_test - Dyn residual k=2: pred=[2.5159153947417447, 1.796085864447435, 0.8799999941142449, 3.0, 2.6434343472099577], ws=[2.5159153947417447, 1.796085864447435, 0.8799999941142449, 3.0, 2.9343434389002097], res=[0.0, 0.0, 0.0, 0.0, -0.2909090916902519], res_norm=2.909e-01
2026-01-24 02:27:55,901 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:56,977 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:57,021 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:57,082 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:57,107 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:57,157 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:57,181 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:57,230 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:57,253 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:57,302 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:57,326 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:57,374 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:27:57,397 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:57,446 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:57,468 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:57,520 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:57,543 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:57,590 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:57,613 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:57,662 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:57,686 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:27:57,741 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:27:58,727 - INFO - integration_test - Step 11: MPC solve successful
2026-01-24 02:27:58,735 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:27:58,735 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1869 scenarios available
2026-01-24 02:27:58,750 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1869 trajectory groups with 18690 total points
2026-01-24 02:27:58,751 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:27:59,007 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:27:59,028 - INFO - integration_test - Step 11: Computed 6 numeric contouring constraints for visualization (s=2.400)
2026-01-24 02:27:59,029 - DEBUG - integration_test - Step 11: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:27:59,029 - INFO - integration_test - === Applying control at step 11 ===
2026-01-24 02:27:59,029 - INFO - integration_test -   Control dict from planner: {'a': -7.831870286814174e-07, 'w': 0.07331909995891989}
2026-01-24 02:27:59,029 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:27:59,029 - INFO - integration_test -   Planner output success: True
2026-01-24 02:27:59,031 - INFO - integration_test - Step 11 completed in 5.284s
2026-01-24 02:27:59,099 - INFO - integration_test - Step 12 (contouring until path end)
2026-01-24 02:27:59,100 - DEBUG - integration_test - Syncing planner state at step 12: vehicle_state=[2.13277535 1.33434119 0.8873319  2.99999995 2.70000001]
2026-01-24 02:27:59,101 - DEBUG - integration_test - Step 12: Using propagated spline 2.7000 (close to path, dist=0.540m, drift=0.242m)
2026-01-24 02:27:59,101 - DEBUG - integration_test -   Set spline state to 2.7000
2026-01-24 02:27:59,102 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:28:00,311 - DEBUG - integration_test - Step 12: Checking path alignment: vehicle=(2.133, 1.334), path_start=(0.000, 0.000), dist=2.516m
2026-01-24 02:28:00,311 - INFO - integration_test - === Calling planner.solve_mpc() at step 12 ===
2026-01-24 02:28:01,235 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:28:01,260 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:28:01,260 - INFO - integration_test - Warmstart k=0: x0=2.132775347952395 , y0=1.3343411941183665 , psi0=0.8873319041101368 , v0=2.999999951681181 , spline0=2.7000000080572835 , a0=0.0 , w0=0.0
2026-01-24 02:28:01,260 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:28:01,261 - INFO - integration_test - Dyn residual k=0: pred=[2.322220270623721, 1.5669580859704548, 0.8873319041101368, 2.999999951681181, 3.0000000032254017], ws=[2.322220270623721, 1.5669580859704548, 0.8873319041101366, 2.999999951681181, 2.3434343443791583], res=[0.0, 0.0, 2.220446049250313e-16, 0.0, 0.6565656588462434], res_norm=6.566e-01
2026-01-24 02:28:01,262 - INFO - integration_test - Dyn residual k=1: pred=[2.511665193295047, 1.7995749778225432, 0.8873319041101366, 2.999999951681181, 2.6434343395472766], ws=[2.511665193295047, 1.7995749778225432, 0.8873319041101366, 2.999999951681181, 2.9343434337754872], res=[0.0, 0.0, 0.0, 0.0, -0.29090909422821065], res_norm=2.909e-01
2026-01-24 02:28:01,262 - INFO - integration_test - Dyn residual k=2: pred=[2.701110115966373, 2.0321918696746315, 0.8873319041101366, 2.999999951681181, 3.2343434289436055], ws=[2.701110115966373, 2.0321918696746315, 0.8873319041101366, 2.999999951681181, 3.301010098538811], res=[0.0, 0.0, 0.0, 0.0, -0.06666666959520562], res_norm=6.667e-02
2026-01-24 02:28:01,280 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:02,344 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:02,366 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:02,418 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:02,442 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:02,493 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:02,519 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:02,571 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:02,593 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:02,643 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:02,666 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:02,716 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:02,740 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:02,790 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:02,813 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:02,861 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:02,885 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:02,940 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:02,966 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:03,021 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:03,045 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:03,097 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:03,782 - INFO - integration_test - Step 12: MPC solve successful
2026-01-24 02:28:03,788 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:28:03,788 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1876 scenarios available
2026-01-24 02:28:03,803 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1876 trajectory groups with 18760 total points
2026-01-24 02:28:03,804 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:28:04,220 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:28:04,236 - INFO - integration_test - Step 12: Computed 6 numeric contouring constraints for visualization (s=2.700)
2026-01-24 02:28:04,236 - DEBUG - integration_test - Step 12: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:28:04,236 - INFO - integration_test - === Applying control at step 12 ===
2026-01-24 02:28:04,236 - INFO - integration_test -   Control dict from planner: {'a': 7.820403294200305e-07, 'w': -0.2499468709824036}
2026-01-24 02:28:04,236 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:28:04,236 - INFO - integration_test -   Planner output success: True
2026-01-24 02:28:04,238 - INFO - integration_test - Step 12 completed in 5.138s
2026-01-24 02:28:04,305 - INFO - integration_test - Step 13 (contouring until path end)
2026-01-24 02:28:04,308 - DEBUG - integration_test - Syncing planner state at step 13: vehicle_state=[2.32510749 1.56456643 0.86233722 3.00000003 3.00000001]
2026-01-24 02:28:04,309 - DEBUG - integration_test - Step 13: Using propagated spline 3.0000 (close to path, dist=0.514m, drift=0.132m)
2026-01-24 02:28:04,309 - DEBUG - integration_test -   Set spline state to 3.0000
2026-01-24 02:28:04,310 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:28:05,345 - DEBUG - integration_test - Step 13: Checking path alignment: vehicle=(2.325, 1.565), path_start=(0.000, 0.000), dist=2.802m
2026-01-24 02:28:05,345 - INFO - integration_test - === Calling planner.solve_mpc() at step 13 ===
2026-01-24 02:28:06,290 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:28:06,318 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:28:06,318 - INFO - integration_test - Warmstart k=0: x0=2.325107490195009 , y0=1.5645664340932195 , psi0=0.8623372170118965 , v0=3.000000029885214 , spline0=3.0000000110458047 , a0=0.0 , w0=0.0
2026-01-24 02:28:06,318 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:28:06,319 - INFO - integration_test - Dyn residual k=0: pred=[2.5203068257145604, 1.7923760502331851, 0.8623372170118965, 3.000000029885214, 3.300000014034326], ws=[2.520306823770036, 1.7923760479638053, 0.8623372170118966, 3.0, 2.934343438248517], res=[1.944524541386272e-09, 2.2693797951944816e-09, -1.1102230246251565e-16, 2.9885213859159876e-08, 0.3656565757858088], res_norm=3.657e-01
2026-01-24 02:28:06,320 - INFO - integration_test - Dyn residual k=1: pred=[2.7155061573450627, 2.0201856618343914, 0.8623372170118966, 3.0, 3.2343434382485174], ws=[2.7155061573450627, 2.0201856618343914, 0.8623372170118966, 3.0, 3.3010101052499046], res=[0.0, 0.0, 0.0, 0.0, -0.06666666700138713], res_norm=6.667e-02
2026-01-24 02:28:06,321 - INFO - integration_test - Dyn residual k=2: pred=[2.9107054909200896, 2.2479952757049775, 0.8623372170118966, 3.0, 3.6010101052499044], ws=[2.9107054909200896, 2.2479952757049775, 0.8623372170118966, 3.0, 3.6858585904331114], res=[0.0, 0.0, 0.0, 0.0, -0.08484848518320698], res_norm=8.485e-02
2026-01-24 02:28:06,338 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:07,302 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:07,328 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:07,382 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:07,414 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:07,492 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:07,525 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:07,585 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:07,613 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:07,668 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:07,692 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:07,747 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:07,772 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:07,825 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:07,848 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:07,896 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:07,921 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:07,980 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:08,006 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:08,076 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:08,115 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:08,176 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:08,931 - INFO - integration_test - Step 13: MPC solve successful
2026-01-24 02:28:08,939 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:28:08,939 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1852 scenarios available
2026-01-24 02:28:08,954 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1852 trajectory groups with 18520 total points
2026-01-24 02:28:08,955 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:28:09,188 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:28:09,208 - INFO - integration_test - Step 13: Computed 6 numeric contouring constraints for visualization (s=3.000)
2026-01-24 02:28:09,208 - DEBUG - integration_test - Step 13: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:28:09,208 - INFO - integration_test - === Applying control at step 13 ===
2026-01-24 02:28:09,208 - INFO - integration_test -   Control dict from planner: {'a': 1.1467422313393995e-09, 'w': -0.13140501982329766}
2026-01-24 02:28:09,208 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:28:09,208 - INFO - integration_test -   Planner output success: True
2026-01-24 02:28:09,210 - INFO - integration_test - Step 13 completed in 4.903s
2026-01-24 02:28:09,276 - INFO - integration_test - Step 14 (contouring until path end)
2026-01-24 02:28:09,278 - DEBUG - integration_test - Syncing planner state at step 14: vehicle_state=[2.52179795 1.791087   0.84919672 3.00000003 3.30000001]
2026-01-24 02:28:09,279 - DEBUG - integration_test - Step 14: Using propagated spline 3.3000 (close to path, dist=0.510m, drift=0.432m)
2026-01-24 02:28:09,279 - DEBUG - integration_test -   Set spline state to 3.3000
2026-01-24 02:28:09,279 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:28:10,242 - DEBUG - integration_test - Step 14: Checking path alignment: vehicle=(2.522, 1.791), path_start=(0.000, 0.000), dist=3.093m
2026-01-24 02:28:10,242 - INFO - integration_test - === Calling planner.solve_mpc() at step 14 ===
2026-01-24 02:28:11,359 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:28:11,387 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:28:11,387 - INFO - integration_test - Warmstart k=0: x0=2.521797952985273 , y0=1.791087004036114 , psi0=0.8491967150295667 , v0=3.000000029999888 , spline0=3.3000000140457937 , a0=0.0 , w0=0.0
2026-01-24 02:28:11,387 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:28:11,388 - INFO - integration_test - Dyn residual k=0: pred=[2.7199738825106854, 2.016312008768564, 0.8491967150295667, 3.000000029999888, 3.6000000170457827], ws=[2.7199738805289333, 2.0163120065163227, 0.8491967150295667, 3.0, 3.3010101064014155], res=[1.981752095758793e-09, 2.252241504407948e-09, 0.0, 2.999988790719499e-08, 0.2989899106443672], res_norm=2.990e-01
2026-01-24 02:28:11,389 - INFO - integration_test - Dyn residual k=1: pred=[2.9181498080725934, 2.241537008996531, 0.8491967150295667, 3.0, 3.6010101064014153], ws=[2.9181498080725934, 2.241537008996531, 0.8491967150295667, 3.0, 3.6858585916755313], res=[0.0, 0.0, 0.0, 0.0, -0.08484848527411604], res_norm=8.485e-02
2026-01-24 02:28:11,390 - INFO - integration_test - Dyn residual k=2: pred=[3.1163257356162535, 2.4667620114767397, 0.8491967150295667, 3.0, 3.985858591675531], ws=[3.1163257356162535, 2.4667620114767397, 0.8491967150295667, 3.0, 3.8101010159179545], res=[0.0, 0.0, 0.0, 0.0, 0.17575757575757667], res_norm=1.758e-01
2026-01-24 02:28:11,406 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:12,467 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:12,489 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:12,542 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:12,565 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:12,614 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:12,636 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:12,684 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:12,707 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:12,758 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:12,780 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:12,828 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:12,851 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:12,898 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:12,921 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:12,975 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:12,998 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:13,047 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:13,069 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:13,115 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:13,139 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:13,188 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:13,890 - INFO - integration_test - Step 14: MPC solve successful
2026-01-24 02:28:13,898 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:28:13,898 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1854 scenarios available
2026-01-24 02:28:13,912 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1854 trajectory groups with 18540 total points
2026-01-24 02:28:13,913 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:28:14,135 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:28:14,154 - INFO - integration_test - Step 14: Computed 6 numeric contouring constraints for visualization (s=3.300)
2026-01-24 02:28:14,155 - DEBUG - integration_test - Step 14: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:28:14,155 - INFO - integration_test - === Applying control at step 14 ===
2026-01-24 02:28:14,155 - INFO - integration_test -   Control dict from planner: {'a': -1.7414678070129257e-06, 'w': -0.1719140834444841}
2026-01-24 02:28:14,155 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:28:14,155 - INFO - integration_test -   Planner output success: True
2026-01-24 02:28:14,157 - INFO - integration_test - Step 14 completed in 4.879s
2026-01-24 02:28:14,218 - INFO - integration_test - Step 15 (contouring until path end)
2026-01-24 02:28:14,219 - DEBUG - integration_test - Syncing planner state at step 15: vehicle_state=[2.72190004 2.01459749 0.83200531 2.99999986 3.6       ]
2026-01-24 02:28:14,220 - DEBUG - integration_test - Step 15: Using propagated spline 3.6000 (close to path, dist=0.451m, drift=0.322m)
2026-01-24 02:28:14,220 - DEBUG - integration_test -   Set spline state to 3.6000
2026-01-24 02:28:14,220 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:28:15,159 - DEBUG - integration_test - Step 15: Checking path alignment: vehicle=(2.722, 2.015), path_start=(0.000, 0.000), dist=3.386m
2026-01-24 02:28:15,159 - INFO - integration_test - === Calling planner.solve_mpc() at step 15 ===
2026-01-24 02:28:16,083 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:28:16,108 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:28:16,108 - INFO - integration_test - Warmstart k=0: x0=2.721900035032492 , y0=2.014597488755358 , psi0=0.8320053066851183 , v0=2.9999998558531074 , spline0=3.5999999996311045 , a0=0.0 , w0=0.0
2026-01-24 02:28:16,108 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:28:16,109 - INFO - integration_test - Dyn residual k=0: pred=[2.92391841295415, 2.236382443910321, 0.8320053066851183, 2.9999998558531074, 3.8999999852164153], ws=[2.92391841295415, 2.236382443910321, 0.8320053066851183, 2.9999998558531074, 3.6858585797360908], res=[0.0, 0.0, 0.0, 0.0, 0.21414140548032456], res_norm=2.141e-01
2026-01-24 02:28:16,110 - INFO - integration_test - Dyn residual k=1: pred=[3.1259367908758082, 2.4581673990652835, 0.8320053066851183, 2.9999998558531074, 3.9858585653214016], ws=[3.1259367908758082, 2.4581673990652835, 0.8320053066851183, 2.9999998558531074, 3.810100998008796], res=[0.0, 0.0, 0.0, 0.0, 0.17575756731260572], res_norm=1.758e-01
2026-01-24 02:28:16,111 - INFO - integration_test - Dyn residual k=2: pred=[3.3279551687974664, 2.679952354220246, 0.8320053066851183, 2.9999998558531074, 4.110100983594107], ws=[3.3279551687974664, 2.679952354220246, 0.8320053066851183, 2.9999998558531074, 3.9343434162814996], res=[0.0, 0.0, 0.0, 0.0, 0.17575756731260705], res_norm=1.758e-01
2026-01-24 02:28:16,127 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:17,346 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:17,369 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:17,418 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:17,443 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:17,490 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:17,512 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:17,564 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:17,587 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:17,634 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:17,658 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:17,705 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:17,727 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:17,777 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:17,799 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:17,850 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:17,874 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:17,933 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:17,958 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:18,010 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:18,033 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:18,079 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:18,785 - INFO - integration_test - Step 15: MPC solve successful
2026-01-24 02:28:18,795 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:28:18,795 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1851 scenarios available
2026-01-24 02:28:18,811 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1851 trajectory groups with 18510 total points
2026-01-24 02:28:18,812 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:28:19,064 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:28:19,080 - INFO - integration_test - Step 15: Computed 6 numeric contouring constraints for visualization (s=3.600)
2026-01-24 02:28:19,081 - DEBUG - integration_test - Step 15: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:28:19,081 - INFO - integration_test - === Applying control at step 15 ===
2026-01-24 02:28:19,081 - INFO - integration_test -   Control dict from planner: {'a': 1.7414628133941942e-06, 'w': -0.10170683466172732}
2026-01-24 02:28:19,081 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:28:19,081 - INFO - integration_test -   Planner output success: True
2026-01-24 02:28:19,082 - INFO - integration_test - Step 15 completed in 4.863s
2026-01-24 02:28:19,148 - INFO - integration_test - Step 16 (contouring until path end)
2026-01-24 02:28:19,150 - DEBUG - integration_test - Syncing planner state at step 16: vehicle_state=[2.92504278 2.2353513  0.82183462 3.00000003 3.9       ]
2026-01-24 02:28:19,150 - DEBUG - integration_test - Step 16: Using propagated spline 3.9000 (close to path, dist=0.418m, drift=0.213m)
2026-01-24 02:28:19,150 - DEBUG - integration_test -   Set spline state to 3.9000
2026-01-24 02:28:19,151 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:28:20,121 - DEBUG - integration_test - Step 16: Checking path alignment: vehicle=(2.925, 2.235), path_start=(0.000, 0.000), dist=3.681m
2026-01-24 02:28:20,121 - INFO - integration_test - === Calling planner.solve_mpc() at step 16 ===
2026-01-24 02:28:21,138 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:28:21,165 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:28:21,165 - INFO - integration_test - Warmstart k=0: x0=2.9250427785545923 , y0=2.2353513030196788 , psi0=0.8218346232189455 , v0=3.0000000299993888 , spline0=3.9000000026310433 , a0=0.0 , w0=0.0
2026-01-24 02:28:21,165 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:28:21,166 - INFO - integration_test - Dyn residual k=0: pred=[3.1293063854372596, 2.455070170446321, 0.8218346232189455, 3.0000000299993888, 4.200000005630982], ws=[3.129306383394665, 2.4550701682491773, 0.8218346232189457, 3.0, 3.8101010111906337], res=[2.042594537954301e-09, 2.1971438002310606e-09, -2.220446049250313e-16, 2.999938875092312e-08, 0.38989899444034837], res_norm=3.899e-01
2026-01-24 02:28:21,167 - INFO - integration_test - Dyn residual k=1: pred=[3.333569988234738, 2.674789033478676, 0.8218346232189457, 3.0, 4.1101010111906335], ws=[3.333569988234738, 2.674789033478676, 0.8218346232189457, 3.0, 3.9343434354330586], res=[0.0, 0.0, 0.0, 0.0, 0.1757575757575749], res_norm=1.758e-01
2026-01-24 02:28:21,168 - INFO - integration_test - Dyn residual k=2: pred=[3.5378335930748106, 2.8945078987081745, 0.8218346232189457, 3.0, 4.2343434354330585], ws=[3.5378335930748106, 2.8945078987081745, 0.8218346232189457, 3.0, 4.058585859675482], res=[0.0, 0.0, 0.0, 0.0, 0.17575757575757667], res_norm=1.758e-01
2026-01-24 02:28:21,185 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:22,209 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:22,232 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:22,277 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:22,301 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:22,348 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:22,370 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:22,416 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:22,436 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:22,480 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:22,501 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:22,548 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:22,570 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:22,616 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:22,636 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:22,681 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:22,701 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:22,745 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:22,765 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:22,808 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:22,829 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:22,871 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:23,485 - INFO - integration_test - Step 16: MPC solve successful
2026-01-24 02:28:23,495 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:28:23,495 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1868 scenarios available
2026-01-24 02:28:23,675 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1868 trajectory groups with 18680 total points
2026-01-24 02:28:23,676 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:28:23,945 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:28:23,965 - INFO - integration_test - Step 16: Computed 6 numeric contouring constraints for visualization (s=3.900)
2026-01-24 02:28:23,965 - DEBUG - integration_test - Step 16: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:28:23,965 - INFO - integration_test - === Applying control at step 16 ===
2026-01-24 02:28:23,965 - INFO - integration_test -   Control dict from planner: {'a': -1.3891006103208167e-11, 'w': -0.13134823113098865}
2026-01-24 02:28:23,965 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:28:23,965 - INFO - integration_test -   Planner output success: True
2026-01-24 02:28:23,967 - INFO - integration_test - Step 16 completed in 4.817s
2026-01-24 02:28:24,037 - INFO - integration_test - Step 17 (contouring until path end)
2026-01-24 02:28:24,038 - DEBUG - integration_test - Syncing planner state at step 17: vehicle_state=[3.13074348 2.45372239 0.8086998  3.00000003 4.20000001]
2026-01-24 02:28:24,039 - DEBUG - integration_test - Step 17: Using propagated spline 4.2000 (close to path, dist=0.415m, drift=0.103m)
2026-01-24 02:28:24,039 - DEBUG - integration_test -   Set spline state to 4.2000
2026-01-24 02:28:24,039 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:28:25,064 - DEBUG - integration_test - Step 17: Checking path alignment: vehicle=(3.131, 2.454), path_start=(0.000, 0.000), dist=3.978m
2026-01-24 02:28:25,064 - INFO - integration_test - === Calling planner.solve_mpc() at step 17 ===
2026-01-24 02:28:26,138 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:28:26,166 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:28:26,166 - INFO - integration_test - Warmstart k=0: x0=3.1307434755921246 , y0=2.4537223888360793 , psi0=0.8086998001058466 , v0=3.0000000299979996 , spline0=4.2000000056308435 , a0=0.0 , w0=0.0
2026-01-24 02:28:26,166 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:28:26,167 - INFO - integration_test - Dyn residual k=0: pred=[3.337875348059881, 2.6707394139928193, 0.8086998001058466, 3.0000000299979996, 4.500000008630644], ws=[3.3378753459887003, 2.670739411822794, 0.8086998001058467, 3.0, 3.9343434366753995], res=[2.0711805603923494e-09, 2.1700254926315665e-09, -1.1102230246251565e-16, 2.9997999639874706e-08, 0.5656565719552442], res_norm=5.657e-01
2026-01-24 02:28:26,168 - INFO - integration_test - Dyn residual k=1: pred=[3.545007216385276, 2.8877564348095084, 0.8086998001058467, 3.0, 4.2343434366754], ws=[3.545007216385276, 2.8877564348095084, 0.8086998001058467, 3.0, 4.058585860917824], res=[0.0, 0.0, 0.0, 0.0, 0.17575757575757578], res_norm=1.758e-01
2026-01-24 02:28:26,169 - INFO - integration_test - Dyn residual k=2: pred=[3.7521390867818516, 3.104773457796223, 0.8086998001058467, 3.0, 4.358585860917824], ws=[3.7521390867818516, 3.104773457796223, 0.8086998001058467, 3.0, 4.645454551085388], res=[0.0, 0.0, 0.0, 0.0, -0.2868686901675641], res_norm=2.869e-01
2026-01-24 02:28:26,186 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:27,216 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:27,241 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:27,291 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:27,315 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:27,367 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:27,390 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:27,441 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:27,465 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:27,515 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:27,542 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:27,602 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:27,628 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:27,686 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:27,712 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:27,771 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:27,797 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:27,854 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:27,882 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:27,943 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:27,971 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:28,030 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:28,747 - INFO - integration_test - Step 17: MPC solve successful
2026-01-24 02:28:28,758 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:28:28,758 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1877 scenarios available
2026-01-24 02:28:28,980 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1877 trajectory groups with 18770 total points
2026-01-24 02:28:28,981 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:28:29,244 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:28:29,259 - INFO - integration_test - Step 17: Computed 6 numeric contouring constraints for visualization (s=4.200)
2026-01-24 02:28:29,259 - DEBUG - integration_test - Step 17: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:28:29,259 - INFO - integration_test - === Applying control at step 17 ===
2026-01-24 02:28:29,259 - INFO - integration_test -   Control dict from planner: {'a': -5.387769565466117e-10, 'w': -0.10842108508867418}
2026-01-24 02:28:29,259 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:28:29,259 - INFO - integration_test -   Planner output success: True
2026-01-24 02:28:29,261 - INFO - integration_test - Step 17 completed in 5.223s
2026-01-24 02:28:29,316 - INFO - integration_test - Step 18 (contouring until path end)
2026-01-24 02:28:29,319 - DEBUG - integration_test - Syncing planner state at step 18: vehicle_state=[3.33904774 2.6696123  0.79785769 3.00000003 4.50000001]
2026-01-24 02:28:29,320 - DEBUG - integration_test - Step 18: Using propagated spline 4.5000 (close to path, dist=0.408m, drift=0.403m)
2026-01-24 02:28:29,320 - DEBUG - integration_test -   Set spline state to 4.5000
2026-01-24 02:28:29,321 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:28:30,233 - DEBUG - integration_test - Step 18: Checking path alignment: vehicle=(3.339, 2.670), path_start=(0.000, 0.000), dist=4.275m
2026-01-24 02:28:30,233 - INFO - integration_test - === Calling planner.solve_mpc() at step 18 ===
2026-01-24 02:28:31,168 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:28:31,197 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:28:31,197 - INFO - integration_test - Warmstart k=0: x0=3.339047739521804 , y0=2.6696123001251477 , psi0=0.7978576915969792 , v0=3.000000029944122 , spline0=4.500000008625256 , a0=0.0 , w0=0.0
2026-01-24 02:28:31,197 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:28:31,198 - INFO - integration_test - Dyn residual k=0: pred=[3.548520313829974, 2.884370867845636, 0.7978576915969792, 3.000000029944122, 4.800000011619669], ws=[3.54852031173915, 2.8843708657020506, 0.7978576915969793, 3.0, 4.058585862157934], res=[2.0908239584116473e-09, 2.1435853092555135e-09, -1.1102230246251565e-16, 2.994412184875728e-08, 0.7414141494617343], res_norm=7.414e-01
2026-01-24 02:28:31,199 - INFO - integration_test - Dyn residual k=1: pred=[3.7579928839564958, 3.0991294312789535, 0.7978576915969793, 3.0, 4.358585862157934], ws=[3.7579928839564958, 3.0991294312789535, 0.7978576915969793, 3.0, 4.645454554079801], res=[0.0, 0.0, 0.0, 0.0, -0.2868686919218666], res_norm=2.869e-01
2026-01-24 02:28:31,200 - INFO - integration_test - Dyn residual k=2: pred=[3.9674654561738416, 3.3138879968558563, 0.7978576915969793, 3.0, 4.9454545540798005], ws=[3.9674654561738416, 3.3138879968558563, 0.7978576915969793, 3.0, 5.046464655089902], res=[0.0, 0.0, 0.0, 0.0, -0.10101010101010122], res_norm=1.010e-01
2026-01-24 02:28:31,218 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:32,293 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:32,317 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:32,397 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:32,436 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:32,494 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:32,519 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:32,572 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:32,598 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:32,650 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:32,676 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:32,726 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:32,753 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:32,807 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:32,832 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:32,885 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:32,909 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:32,967 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:32,992 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:33,044 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:33,068 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:33,119 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:33,828 - INFO - integration_test - Step 18: MPC solve successful
2026-01-24 02:28:33,838 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:28:33,838 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1853 scenarios available
2026-01-24 02:28:33,854 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1853 trajectory groups with 18530 total points
2026-01-24 02:28:33,855 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:28:34,193 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:28:34,212 - INFO - integration_test - Step 18: Computed 6 numeric contouring constraints for visualization (s=4.500)
2026-01-24 02:28:34,212 - DEBUG - integration_test - Step 18: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:28:34,212 - INFO - integration_test - === Applying control at step 18 ===
2026-01-24 02:28:34,212 - INFO - integration_test -   Control dict from planner: {'a': 4.073347551832789e-10, 'w': -0.11949657472056292}
2026-01-24 02:28:34,212 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:28:34,212 - INFO - integration_test -   Planner output success: True
2026-01-24 02:28:34,214 - INFO - integration_test - Step 18 completed in 4.895s
2026-01-24 02:28:34,275 - INFO - integration_test - Step 19 (contouring until path end)
2026-01-24 02:28:34,283 - DEBUG - integration_test - Syncing planner state at step 19: vehicle_state=[3.54979846 2.88311421 0.78590803 3.00000003 4.80000001]
2026-01-24 02:28:34,284 - DEBUG - integration_test - Step 19: Using propagated spline 4.8000 (close to path, dist=0.358m, drift=0.293m)
2026-01-24 02:28:34,284 - DEBUG - integration_test -   Set spline state to 4.8000
2026-01-24 02:28:34,285 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:28:35,391 - DEBUG - integration_test - Step 19: Checking path alignment: vehicle=(3.550, 2.883), path_start=(0.000, 0.000), dist=4.573m
2026-01-24 02:28:35,391 - INFO - integration_test - === Calling planner.solve_mpc() at step 19 ===
2026-01-24 02:28:36,439 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:28:36,470 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:28:36,470 - INFO - integration_test - Warmstart k=0: x0=3.5497984590127167 , y0=2.883114208971251 , psi0=0.7859080341249228 , v0=3.0000000299848555 , spline0=4.800000011623742 , a0=0.0 , w0=0.0
2026-01-24 02:28:36,470 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:28:36,471 - INFO - integration_test - Dyn residual k=0: pred=[3.761822308004071, 3.09535437778475, 0.7859080341249228, 3.0000000299848555, 5.1000000146222275], ws=[3.761822305884903, 3.09535437566342, 0.7859080341249229, 3.0, 4.645454557078287], res=[2.1191679522303275e-09, 2.1213302225930875e-09, -1.1102230246251565e-16, 2.9984855487441564e-08, 0.45454545754394093], res_norm=4.545e-01
2026-01-24 02:28:36,473 - INFO - integration_test - Dyn residual k=1: pred=[3.9738461527570896, 3.307594542355589, 0.7859080341249229, 3.0, 4.945454557078286], ws=[3.9738461527570896, 3.307594542355589, 0.7859080341249229, 3.0, 5.046464658088388], res=[0.0, 0.0, 0.0, 0.0, -0.10101010101010122], res_norm=1.010e-01
2026-01-24 02:28:36,474 - INFO - integration_test - Dyn residual k=2: pred=[4.185869999629276, 3.5198347090477577, 0.7859080341249229, 3.0, 5.3464646580883874], ws=[4.185869999629276, 3.5198347090477577, 0.7859080341249229, 3.0, 5.144444456068186], res=[0.0, 0.0, 0.0, 0.0, 0.20202020202020154], res_norm=2.020e-01
2026-01-24 02:28:36,492 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:37,518 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:37,544 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:37,596 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:37,622 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:37,674 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:37,698 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:37,753 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:37,779 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:37,831 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:37,861 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:37,909 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:37,936 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:37,998 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:38,026 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:38,079 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:38,101 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:38,148 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:38,172 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:38,219 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:38,243 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:38,289 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:39,046 - INFO - integration_test - Step 19: MPC solve successful
2026-01-24 02:28:39,056 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:28:39,056 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1856 scenarios available
2026-01-24 02:28:39,071 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1856 trajectory groups with 18560 total points
2026-01-24 02:28:39,072 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:28:39,460 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:28:39,481 - INFO - integration_test - Step 19: Computed 6 numeric contouring constraints for visualization (s=4.800)
2026-01-24 02:28:39,481 - DEBUG - integration_test - Step 19: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:28:39,481 - INFO - integration_test - === Applying control at step 19 ===
2026-01-24 02:28:39,481 - INFO - integration_test -   Control dict from planner: {'a': -5.652422601853664e-06, 'w': -0.09767957107056711}
2026-01-24 02:28:39,481 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:28:39,481 - INFO - integration_test -   Planner output success: True
2026-01-24 02:28:39,483 - INFO - integration_test - Step 19 completed in 5.200s
2026-01-24 02:28:39,549 - INFO - integration_test - Step 20 (contouring until path end)
2026-01-24 02:28:39,551 - DEBUG - integration_test - Syncing planner state at step 20: vehicle_state=[3.76285548 3.09431547 0.77614008 2.99999946 5.09999996]
2026-01-24 02:28:39,551 - DEBUG - integration_test - Step 20: Using propagated spline 5.1000 (close to path, dist=0.339m, drift=0.184m)
2026-01-24 02:28:39,551 - DEBUG - integration_test -   Set spline state to 5.1000
2026-01-24 02:28:39,552 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:28:40,531 - DEBUG - integration_test - Step 20: Checking path alignment: vehicle=(3.763, 3.094), path_start=(0.000, 0.000), dist=4.872m
2026-01-24 02:28:40,531 - INFO - integration_test - === Calling planner.solve_mpc() at step 20 ===
2026-01-24 02:28:41,501 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:28:41,529 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:28:41,529 - INFO - integration_test - Warmstart k=0: x0=3.762855484469677 , y0=3.0943154711616705 , psi0=0.7761400770178661 , v0=2.9999994647425954 , spline0=5.099999958098001 , a0=0.0 , w0=0.0
2026-01-24 02:28:41,529 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:28:41,530 - INFO - integration_test - Dyn residual k=0: pred=[3.9769422981881086, 3.3044744682958593, 0.7761400770178661, 2.9999994647425954, 5.399999904572261], ws=[3.9769422981881086, 3.3044744682958593, 0.7761400770178661, 2.9999994647425954, 5.046464551036907], res=[0.0, 0.0, 0.0, 0.0, 0.3535353535353538], res_norm=3.535e-01
2026-01-24 02:28:41,531 - INFO - integration_test - Dyn residual k=1: pred=[4.19102911190654, 3.514633465430048, 0.7761400770178661, 2.9999994647425954, 5.346464497511167], ws=[4.19102911190654, 3.514633465430048, 0.7761400770178661, 2.9999994647425954, 5.144444295490965], res=[0.0, 0.0, 0.0, 0.0, 0.20202020202020154], res_norm=2.020e-01
2026-01-24 02:28:41,532 - INFO - integration_test - Dyn residual k=2: pred=[4.405115925624973, 3.724792462564237, 0.7761400770178661, 2.9999994647425954, 5.444444241965225], ws=[4.405115925624973, 3.724792462564237, 0.7761400770178661, 2.9999994647425954, 5.747474544995527], res=[0.0, 0.0, 0.0, 0.0, -0.30303030303030276], res_norm=3.030e-01
2026-01-24 02:28:41,549 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:42,553 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:42,574 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:42,623 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:42,646 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:42,692 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:42,715 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:42,763 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:42,785 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:42,841 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:42,880 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:42,946 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:42,972 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:43,021 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:43,044 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:43,090 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:43,110 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:43,155 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:43,178 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:43,222 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:43,246 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:43,292 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:43,923 - INFO - integration_test - Step 20: MPC solve successful
2026-01-24 02:28:43,935 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:28:43,935 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1849 scenarios available
2026-01-24 02:28:44,138 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1849 trajectory groups with 18490 total points
2026-01-24 02:28:44,139 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:28:44,415 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:28:44,431 - INFO - integration_test - Step 20: Computed 6 numeric contouring constraints for visualization (s=5.100)
2026-01-24 02:28:44,431 - DEBUG - integration_test - Step 20: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:28:44,431 - INFO - integration_test - === Applying control at step 20 ===
2026-01-24 02:28:44,431 - INFO - integration_test -   Control dict from planner: {'a': 5.6525706637277104e-06, 'w': -0.09062587602209517}
2026-01-24 02:28:44,431 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:28:44,431 - INFO - integration_test -   Planner output success: True
2026-01-24 02:28:44,433 - INFO - integration_test - Step 20 completed in 4.882s
2026-01-24 02:28:44,485 - INFO - integration_test - Step 21 (contouring until path end)
2026-01-24 02:28:44,489 - DEBUG - integration_test - Syncing planner state at step 21: vehicle_state=[3.97789167 3.30350153 0.76707749 3.00000003 5.39999996]
2026-01-24 02:28:44,490 - DEBUG - integration_test - Step 21: Using propagated spline 5.4000 (close to path, dist=0.356m, drift=0.074m)
2026-01-24 02:28:44,490 - DEBUG - integration_test -   Set spline state to 5.4000
2026-01-24 02:28:44,491 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:28:45,429 - DEBUG - integration_test - Step 21: Checking path alignment: vehicle=(3.978, 3.304), path_start=(0.000, 0.000), dist=5.171m
2026-01-24 02:28:45,429 - INFO - integration_test - === Calling planner.solve_mpc() at step 21 ===
2026-01-24 02:28:46,502 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:28:46,530 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:28:46,530 - INFO - integration_test - Warmstart k=0: x0=3.9778916736228656 , y0=3.3035015276287516 , psi0=0.7670774894156566 , v0=3.000000029999662 , spline0=5.399999961097968 , a0=0.0 , w0=0.0
2026-01-24 02:28:46,530 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:28:46,531 - INFO - integration_test - Dyn residual k=0: pred=[4.193874294820098, 3.5117117798757347, 0.7670774894156566, 3.000000029999662, 5.699999964097934], ws=[4.193874292660297, 3.5117117777936553, 0.7670774894156565, 3.0, 5.144444405542412], res=[2.1598012267531885e-09, 2.0820793977804897e-09, 1.1102230246251565e-16, 2.9999661865787175e-08, 0.5555555585555219], res_norm=5.556e-01
2026-01-24 02:28:46,531 - INFO - integration_test - Dyn residual k=1: pred=[4.409856911697728, 3.719922027958559, 0.7670774894156565, 3.0, 5.444444405542412], ws=[4.409856911697728, 3.719922027958559, 0.7670774894156565, 3.0, 5.747474708572715], res=[0.0, 0.0, 0.0, 0.0, -0.30303030303030276], res_norm=3.030e-01
2026-01-24 02:28:46,532 - INFO - integration_test - Dyn residual k=2: pred=[4.62583953073516, 3.9281322781234627, 0.7670774894156565, 3.0, 6.0474747085727145], ws=[4.62583953073516, 3.9281322781234627, 0.7670774894156565, 3.0, 5.6434343045323105], res=[0.0, 0.0, 0.0, 0.0, 0.404040404040404], res_norm=4.040e-01
2026-01-24 02:28:46,550 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:47,584 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:47,608 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:47,657 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:47,679 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:47,727 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:47,750 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:47,800 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:47,824 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:47,872 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:47,895 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:47,947 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:47,971 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:48,023 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:48,045 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:48,094 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:48,116 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:48,171 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:48,194 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:48,242 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:48,264 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:48,312 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:49,123 - INFO - integration_test - Step 21: MPC solve successful
2026-01-24 02:28:49,136 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:28:49,136 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1870 scenarios available
2026-01-24 02:28:49,370 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1870 trajectory groups with 18700 total points
2026-01-24 02:28:49,371 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:28:49,785 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:28:49,805 - INFO - integration_test - Step 21: Computed 6 numeric contouring constraints for visualization (s=5.400)
2026-01-24 02:28:49,805 - DEBUG - integration_test - Step 21: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:28:49,805 - INFO - integration_test - === Applying control at step 21 ===
2026-01-24 02:28:49,805 - INFO - integration_test -   Control dict from planner: {'a': -2.523379475730413e-07, 'w': -0.08687369247316294}
2026-01-24 02:28:49,806 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:28:49,806 - INFO - integration_test -   Planner output success: True
2026-01-24 02:28:49,807 - INFO - integration_test - Step 21 completed in 5.318s
2026-01-24 02:28:49,867 - INFO - integration_test - Step 22 (contouring until path end)
2026-01-24 02:28:49,871 - DEBUG - integration_test - Syncing planner state at step 22: vehicle_state=[4.19477597 3.51077101 0.75839012 3.         5.69999996]
2026-01-24 02:28:49,872 - DEBUG - integration_test - Step 22: Using propagated spline 5.7000 (close to path, dist=0.336m, drift=0.374m)
2026-01-24 02:28:49,872 - DEBUG - integration_test -   Set spline state to 5.7000
2026-01-24 02:28:49,873 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:28:50,815 - DEBUG - integration_test - Step 22: Checking path alignment: vehicle=(4.195, 3.511), path_start=(0.000, 0.000), dist=5.470m
2026-01-24 02:28:50,815 - INFO - integration_test - === Calling planner.solve_mpc() at step 22 ===
2026-01-24 02:28:51,717 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:28:51,744 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:28:51,744 - INFO - integration_test - Warmstart k=0: x0=4.194775971185377 , y0=3.5107710055739423 , psi0=0.7583901201683403 , v0=3.0000000047658673 , spline0=5.699999961574554 , a0=0.0 , w0=0.0
2026-01-24 02:28:51,744 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:28:51,745 - INFO - integration_test - Dyn residual k=0: pred=[4.412559217046944, 3.7170971021006602, 0.7583901201683403, 3.0000000047658673, 5.999999962051141], ws=[4.412559216700968, 3.717097101772886, 0.7583901201683405, 3.0, 5.7474747090493015], res=[3.459756925394686e-10, 3.277742521845539e-10, -2.220446049250313e-16, 4.765867256395495e-09, 0.25252525300183937], res_norm=2.525e-01
2026-01-24 02:28:51,746 - INFO - integration_test - Dyn residual k=1: pred=[4.630342462216559, 3.9234231979718297, 0.7583901201683405, 3.0, 6.047474709049301], ws=[4.630342462216559, 3.9234231979718297, 0.7583901201683405, 3.0, 5.643434305008897], res=[0.0, 0.0, 0.0, 0.0, 0.404040404040404], res_norm=4.040e-01
2026-01-24 02:28:51,746 - INFO - integration_test - Dyn residual k=2: pred=[4.84812570773215, 4.129749294170773, 0.7583901201683405, 3.0, 5.943434305008897], ws=[4.84812570773215, 4.129749294170773, 0.7583901201683405, 3.0, 6.2464646080392], res=[0.0, 0.0, 0.0, 0.0, -0.30303030303030276], res_norm=3.030e-01
2026-01-24 02:28:51,763 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:52,812 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:52,837 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:52,889 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:52,917 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:52,974 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:53,000 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:53,058 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:53,083 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:53,141 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:53,177 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:53,256 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:53,284 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:53,340 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:53,366 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:53,420 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:53,443 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:53,495 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:53,518 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:53,568 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:53,592 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:53,644 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:54,373 - INFO - integration_test - Step 22: MPC solve successful
2026-01-24 02:28:54,388 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:28:54,388 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1865 scenarios available
2026-01-24 02:28:54,404 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1865 trajectory groups with 18650 total points
2026-01-24 02:28:54,405 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:28:54,877 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:28:54,907 - INFO - integration_test - Step 22: Computed 6 numeric contouring constraints for visualization (s=5.700)
2026-01-24 02:28:54,907 - DEBUG - integration_test - Step 22: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:28:54,907 - INFO - integration_test - === Applying control at step 22 ===
2026-01-24 02:28:54,907 - INFO - integration_test -   Control dict from planner: {'a': -1.9999994301578679, 'w': -0.7999998833179348}
2026-01-24 02:28:54,907 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:28:54,908 - INFO - integration_test -   Planner output success: True
2026-01-24 02:28:54,909 - INFO - integration_test - Step 22 completed in 5.038s
2026-01-24 02:28:54,981 - INFO - integration_test - Step 23 (contouring until path end)
2026-01-24 02:28:54,983 - DEBUG - integration_test - Syncing planner state at step 23: vehicle_state=[4.41296125 3.70169079 0.67839013 2.80000006 5.97999997]
2026-01-24 02:28:54,984 - DEBUG - integration_test - Step 23: Using propagated spline 5.9800 (close to path, dist=0.303m, drift=0.244m)
2026-01-24 02:28:54,984 - DEBUG - integration_test -   Set spline state to 5.9800
2026-01-24 02:28:54,984 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:28:55,962 - DEBUG - integration_test - Step 23: Checking path alignment: vehicle=(4.413, 3.702), path_start=(0.000, 0.000), dist=5.760m
2026-01-24 02:28:55,962 - INFO - integration_test - === Calling planner.solve_mpc() at step 23 ===
2026-01-24 02:28:57,249 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:28:57,276 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:28:57,276 - INFO - integration_test - Warmstart k=0: x0=4.412961248180807 , y0=3.7016907877793597 , psi0=0.6783901318365468 , v0=2.8000000617500804 , spline0=5.9799999677495626 , a0=0.0 , w0=0.0
2026-01-24 02:28:57,276 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:28:57,277 - INFO - integration_test - Dyn residual k=0: pred=[4.630964768670013, 3.8774021093050854, 0.6783901318365468, 2.8000000617500804, 6.259999973924571], ws=[4.630964768670013, 3.877402109305086, 0.6783901318365468, 2.8000000617500804, 5.603434317358914], res=[0.0, -4.440892098500626e-16, 0.0, 0.0, 0.6565656565656566], res_norm=6.566e-01
2026-01-24 02:28:57,278 - INFO - integration_test - Dyn residual k=1: pred=[4.8489682891592185, 4.053113430830812, 0.6783901318365468, 2.8000000617500804, 5.883434323533923], ws=[4.8489682891592185, 4.053113430830812, 0.6783901318365468, 2.8000000617500804, 5.984444424544024], res=[0.0, 0.0, 0.0, 0.0, -0.10101010101010122], res_norm=1.010e-01
2026-01-24 02:28:57,279 - INFO - integration_test - Dyn residual k=2: pred=[5.066971809648424, 4.228824752356537, 0.6783901318365468, 2.8000000617500804, 6.264444430719032], ws=[5.066971809648424, 4.228824752356537, 0.6783901318365468, 2.8000000617500804, 6.567474733749335], res=[0.0, 0.0, 0.0, 0.0, -0.30303030303030276], res_norm=3.030e-01
2026-01-24 02:28:57,296 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:58,304 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:58,326 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:58,370 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:58,395 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:58,439 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:58,460 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:58,505 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:58,526 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:58,573 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:58,595 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:58,645 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:28:58,667 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:58,714 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:58,734 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:58,782 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:58,805 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:58,862 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:58,888 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:58,944 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:58,969 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:28:59,023 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:28:59,658 - INFO - integration_test - Step 23: MPC solve successful
2026-01-24 02:28:59,671 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:28:59,671 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1861 scenarios available
2026-01-24 02:28:59,688 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1861 trajectory groups with 18610 total points
2026-01-24 02:28:59,689 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:29:00,256 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:29:00,285 - INFO - integration_test - Step 23: Computed 6 numeric contouring constraints for visualization (s=5.980)
2026-01-24 02:29:00,285 - DEBUG - integration_test - Step 23: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:29:00,285 - INFO - integration_test - === Applying control at step 23 ===
2026-01-24 02:29:00,285 - INFO - integration_test -   Control dict from planner: {'a': 0.13884142472544622, 'w': -0.8000000050839131}
2026-01-24 02:29:00,285 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:29:00,285 - INFO - integration_test -   Planner output success: True
2026-01-24 02:29:00,287 - INFO - integration_test - Step 23 completed in 5.304s
2026-01-24 02:29:00,366 - INFO - integration_test - Step 24 (contouring until path end)
2026-01-24 02:29:00,369 - DEBUG - integration_test - Syncing planner state at step 24: vehicle_state=[4.63831987 3.86890539 0.59839013 2.8138842  6.26138839]
2026-01-24 02:29:00,370 - DEBUG - integration_test - Step 24: Using propagated spline 6.2614 (close to path, dist=0.336m, drift=0.116m)
2026-01-24 02:29:00,370 - DEBUG - integration_test -   Set spline state to 6.2614
2026-01-24 02:29:00,371 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:29:01,433 - DEBUG - integration_test - Step 24: Checking path alignment: vehicle=(4.638, 3.869), path_start=(0.000, 0.000), dist=6.040m
2026-01-24 02:29:01,433 - INFO - integration_test - === Calling planner.solve_mpc() at step 24 ===
2026-01-24 02:29:02,448 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:29:02,478 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:29:02,478 - INFO - integration_test - Warmstart k=0: x0=4.638319867280156 , y0=3.8689053940107603 , psi0=0.5983901313281556 , v0=2.813884204222625 , spline0=6.261388388171825 , a0=0.0 , w0=0.0
2026-01-24 02:29:02,478 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:29:02,479 - INFO - integration_test - Dyn residual k=0: pred=[4.870815233360529, 4.0274151662612105, 0.5983901313281556, 2.813884204222625, 6.542776808594087], ws=[4.870815233360529, 4.0274151662612105, 0.5983901313281557, 2.813884204222625, 5.987221253038531], res=[0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.5555555555555554], res_norm=5.556e-01
2026-01-24 02:29:02,480 - INFO - integration_test - Dyn residual k=1: pred=[5.103310599440901, 4.185924938511661, 0.5983901313281557, 2.813884204222625, 6.2686096734607935], ws=[5.103310599440901, 4.185924938511661, 0.5983901313281557, 2.813884204222625, 6.571639976491096], res=[0.0, 0.0, 0.0, 0.0, -0.30303030303030276], res_norm=3.030e-01
2026-01-24 02:29:02,481 - INFO - integration_test - Dyn residual k=2: pred=[5.335805965521273, 4.344434710762112, 0.5983901313281557, 2.813884204222625, 6.853028396913358], ws=[5.335805965521273, 4.344434710762112, 0.5983901313281557, 2.813884204222625, 6.448987992872954], res=[0.0, 0.0, 0.0, 0.0, 0.404040404040404], res_norm=4.040e-01
2026-01-24 02:29:02,499 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:03,528 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:03,549 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:03,597 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:29:03,618 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:03,667 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:29:03,689 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:03,735 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:29:03,756 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:03,804 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:29:03,824 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:03,870 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:29:03,890 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:03,955 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:03,991 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:04,046 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:04,069 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:04,115 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:04,136 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:04,180 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:04,201 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:04,247 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:09,918 - WARNING - integration_test - Step 24: MPC solve failed
2026-01-24 02:29:09,918 - WARNING - integration_test -   Consecutive MPC failures: 1/20
2026-01-24 02:29:09,930 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:29:09,930 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1866 scenarios available
2026-01-24 02:29:09,948 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1866 trajectory groups with 18660 total points
2026-01-24 02:29:09,949 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:29:10,443 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:29:10,469 - INFO - integration_test - Step 24: Computed 6 numeric contouring constraints for visualization (s=6.261)
2026-01-24 02:29:10,469 - DEBUG - integration_test - Step 24: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:29:10,470 - INFO - integration_test - === Applying control at step 24 ===
2026-01-24 02:29:10,470 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': 0.8}
2026-01-24 02:29:10,470 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:29:10,470 - INFO - integration_test -   Planner output success: False
2026-01-24 02:29:10,470 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': 0.8}
2026-01-24 02:29:10,471 - INFO - integration_test - Step 24 completed in 10.103s
2026-01-24 02:29:10,540 - INFO - integration_test - Step 25 (contouring until path end)
2026-01-24 02:29:10,542 - DEBUG - integration_test - Syncing planner state at step 25: vehicle_state=[4.85628132 4.03047651 0.67839013 2.6138842  6.52277681]
2026-01-24 02:29:10,542 - DEBUG - integration_test - Step 25: Using propagated spline 6.5228 (close to path, dist=0.377m, drift=0.377m)
2026-01-24 02:29:10,542 - DEBUG - integration_test -   Set spline state to 6.5228
2026-01-24 02:29:10,543 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:29:11,548 - DEBUG - integration_test - Step 25: Checking path alignment: vehicle=(4.856, 4.030), path_start=(0.000, 0.000), dist=6.311m
2026-01-24 02:29:11,548 - INFO - integration_test - === Calling planner.solve_mpc() at step 25 ===
2026-01-24 02:29:12,465 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:29:12,493 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:29:12,493 - INFO - integration_test - Warmstart k=0: x0=4.856281323348657 , y0=4.030476510724494 , psi0=0.6783901313281555 , v0=2.6138842042226247 , spline0=6.522776808594087 , a0=0.0 , w0=0.0
2026-01-24 02:29:12,493 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:29:12,494 - INFO - integration_test - Dyn residual k=0: pred=[5.059794161326594, 4.194508309803244, 0.6783901313281555, 2.6138842042226247, 6.78416522901635], ws=[5.059794161326594, 4.194508309803244, 0.6783901313281557, 2.6138842042226247, 6.329619774470895], res=[0.0, 0.0, -2.220446049250313e-16, 0.0, 0.45454545454545503], res_norm=4.545e-01
2026-01-24 02:29:12,495 - INFO - integration_test - Dyn residual k=1: pred=[5.263306999304531, 4.358540108881995, 0.6783901313281557, 2.6138842042226247, 6.591008194893157], ws=[5.263306999304531, 4.358540108881995, 0.6783901313281557, 2.6138842042226247, 6.692018295903258], res=[0.0, 0.0, 0.0, 0.0, -0.10101010101010122], res_norm=1.010e-01
2026-01-24 02:29:12,495 - INFO - integration_test - Dyn residual k=2: pred=[5.4668198372824675, 4.522571907960745, 0.6783901313281557, 2.6138842042226247, 6.953406716325521], ws=[5.181823451107186, 4.3335790977112865, 0.6783901313281557, 2.6138842042226247, 6.650376413295218], res=[0.28499638617528156, 0.18899281024945846, 0.0, 0.0, 0.30303030303030276], res_norm=4.569e-01
2026-01-24 02:29:12,511 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:13,484 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:13,505 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:13,552 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:29:13,573 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:13,618 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:29:13,641 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:13,690 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:29:13,720 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:13,765 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:29:13,788 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:13,839 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:29:13,862 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:13,910 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:13,932 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:13,980 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:14,003 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:14,056 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:14,080 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:14,130 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:14,152 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:14,201 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:14,997 - INFO - integration_test - Step 25: MPC solve successful
2026-01-24 02:29:15,015 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:29:15,015 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1851 scenarios available
2026-01-24 02:29:15,277 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1851 trajectory groups with 18510 total points
2026-01-24 02:29:15,278 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:29:15,748 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:29:15,774 - INFO - integration_test - Step 25: Computed 6 numeric contouring constraints for visualization (s=6.523)
2026-01-24 02:29:15,774 - DEBUG - integration_test - Step 25: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:29:15,774 - INFO - integration_test - === Applying control at step 25 ===
2026-01-24 02:29:15,774 - INFO - integration_test -   Control dict from planner: {'a': -0.8651757362576725, 'w': -0.8000000088734095}
2026-01-24 02:29:15,774 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:29:15,774 - INFO - integration_test -   Planner output success: True
2026-01-24 02:29:15,777 - INFO - integration_test - Step 25 completed in 5.235s
2026-01-24 02:29:15,838 - INFO - integration_test - Step 26 (contouring until path end)
2026-01-24 02:29:15,842 - DEBUG - integration_test - Syncing planner state at step 26: vehicle_state=[5.06262757 4.18366642 0.59839013 2.52736663 6.77551347]
2026-01-24 02:29:15,842 - DEBUG - integration_test - Step 26: Using propagated spline 6.7755 (close to path, dist=0.353m, drift=0.220m)
2026-01-24 02:29:15,842 - DEBUG - integration_test -   Set spline state to 6.7755
2026-01-24 02:29:15,843 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:29:16,828 - DEBUG - integration_test - Step 26: Checking path alignment: vehicle=(5.063, 4.184), path_start=(0.000, 0.000), dist=6.568m
2026-01-24 02:29:16,828 - INFO - integration_test - === Calling planner.solve_mpc() at step 26 ===
2026-01-24 02:29:17,818 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:29:17,849 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:29:17,849 - INFO - integration_test - Warmstart k=0: x0=5.062627568145935 , y0=4.183666415956992 , psi0=0.5983901304408146 , v0=2.5273666305968576 , spline0=6.775513471653773 , a0=0.0 , w0=0.0
2026-01-24 02:29:17,849 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:29:17,850 - INFO - integration_test - Dyn residual k=0: pred=[5.271449604771903, 4.326036278898303, 0.5983901304408146, 2.5273666305968576, 7.028250134713459], ws=[5.271449604771903, 4.326036278898303, 0.5983901304408148, 2.5273666305968576, 6.674714781178105], res=[0.0, 0.0, -2.220446049250313e-16, 0.0, 0.3535353535353538], res_norm=3.535e-01
2026-01-24 02:29:17,851 - INFO - integration_test - Dyn residual k=1: pred=[5.480271641397872, 4.468406141839614, 0.5983901304408148, 2.5273666305968576, 6.927451444237791], ws=[5.480271641397872, 4.468406141839614, 0.5983901304408148, 2.5273666305968576, 6.523411040197387], res=[0.0, 0.0, 0.0, 0.0, 0.404040404040404], res_norm=4.040e-01
2026-01-24 02:29:17,852 - INFO - integration_test - Dyn residual k=2: pred=[5.68909367802384, 4.6107760047809245, 0.5983901304408148, 2.5273666305968576, 6.776147703257073], ws=[5.170978359032513, 4.53465223508461, 0.5983901304408148, 2.5273666305968576, 6.675137602246972], res=[0.5181153189913275, 0.07612376969631462, 0.0, 0.0, 0.10101010101010122], res_norm=5.333e-01
2026-01-24 02:29:17,869 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:18,949 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:18,972 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:19,022 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:29:19,046 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:19,092 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:29:19,113 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:19,160 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:29:19,181 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:19,228 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:29:19,251 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:19,297 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:29:19,319 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:19,364 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:19,383 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:19,430 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:19,451 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:19,496 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:19,516 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:19,562 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:19,585 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:19,634 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:25,421 - WARNING - integration_test - Step 26: MPC solve failed
2026-01-24 02:29:25,421 - WARNING - integration_test -   Consecutive MPC failures: 1/20
2026-01-24 02:29:25,442 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:29:25,442 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1841 scenarios available
2026-01-24 02:29:25,459 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1841 trajectory groups with 18410 total points
2026-01-24 02:29:25,460 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:29:25,986 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:29:26,012 - INFO - integration_test - Step 26: Computed 6 numeric contouring constraints for visualization (s=6.776)
2026-01-24 02:29:26,013 - DEBUG - integration_test - Step 26: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:29:26,013 - INFO - integration_test - === Applying control at step 26 ===
2026-01-24 02:29:26,013 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': 0.8}
2026-01-24 02:29:26,013 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:29:26,013 - INFO - integration_test -   Planner output success: False
2026-01-24 02:29:26,013 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': 0.8}
2026-01-24 02:29:26,014 - INFO - integration_test - Step 26 completed in 10.173s
2026-01-24 02:29:26,086 - INFO - integration_test - Step 27 (contouring until path end)
2026-01-24 02:29:26,088 - DEBUG - integration_test - Syncing planner state at step 27: vehicle_state=[5.25758619 4.32816841 0.67839013 2.32736663 7.00825013]
2026-01-24 02:29:26,089 - DEBUG - integration_test - Step 27: Using propagated spline 7.0083 (close to path, dist=0.394m, drift=0.043m)
2026-01-24 02:29:26,089 - DEBUG - integration_test -   Set spline state to 7.0083
2026-01-24 02:29:26,089 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:29:27,020 - DEBUG - integration_test - Step 27: Checking path alignment: vehicle=(5.258, 4.328), path_start=(0.000, 0.000), dist=6.810m
2026-01-24 02:29:27,020 - INFO - integration_test - === Calling planner.solve_mpc() at step 27 ===
2026-01-24 02:29:28,178 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:29:28,204 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:29:28,204 - INFO - integration_test - Warmstart k=0: x0=5.257586190027337 , y0=4.32816840526597 , psi0=0.6783901304408145 , v0=2.3273666305968574 , spline0=7.0082501347134585 , a0=0.0 , w0=0.0
2026-01-24 02:29:28,204 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:29:28,205 - INFO - integration_test - Dyn residual k=0: pred=[5.438791228713254, 4.474220068341038, 0.6783901304408145, 2.3273666305968574, 7.240986797773144], ws=[5.438791228713254, 4.474220068341038, 0.6783901304408144, 2.3273666305968574, 6.988461545247891], res=[0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.2525252525252526], res_norm=2.525e-01
2026-01-24 02:29:28,206 - INFO - integration_test - Dyn residual k=1: pred=[5.619996267399171, 4.620271731416105, 0.6783901304408144, 2.3273666305968574, 7.221198208307577], ws=[5.619996267399171, 4.620271731416105, 0.6783901304408144, 2.3273666305968574, 7.1201881072974755], res=[0.0, 0.0, 0.0, 0.0, 0.10101010101010122], res_norm=1.010e-01
2026-01-24 02:29:28,207 - INFO - integration_test - Dyn residual k=2: pred=[5.801201306085088, 4.766323394491173, 0.6783901304408144, 2.3273666305968574, 7.352924770357161], ws=[5.824900260512662, 4.471115334562649, 0.6783901304408144, 2.3273666305968574, 7.150904568336959], res=[-0.02369895442757386, 0.29520805992852406, 0.0, 0.0, 0.20202020202020154], res_norm=3.585e-01
2026-01-24 02:29:28,226 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:29,375 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:29,398 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:29,450 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:29:29,475 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:29,526 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:29:29,549 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:29,595 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:29:29,618 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:29,670 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:29:29,692 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:29,745 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:29:29,769 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:29,818 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:29,843 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:29,892 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:29,915 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:29,965 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:29,988 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:30,041 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:30,065 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:30,114 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:35,650 - WARNING - integration_test - Step 27: MPC solve failed
2026-01-24 02:29:35,650 - WARNING - integration_test -   Consecutive MPC failures: 2/20
2026-01-24 02:29:35,668 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:29:35,668 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1857 scenarios available
2026-01-24 02:29:35,683 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1857 trajectory groups with 18570 total points
2026-01-24 02:29:35,684 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:29:36,280 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:29:36,308 - INFO - integration_test - Step 27: Computed 6 numeric contouring constraints for visualization (s=7.008)
2026-01-24 02:29:36,309 - DEBUG - integration_test - Step 27: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:29:36,309 - INFO - integration_test - === Applying control at step 27 ===
2026-01-24 02:29:36,309 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': 0.8}
2026-01-24 02:29:36,309 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:29:36,309 - INFO - integration_test -   Planner output success: False
2026-01-24 02:29:36,309 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': 0.8}
2026-01-24 02:29:36,311 - INFO - integration_test - Step 27 completed in 10.223s
2026-01-24 02:29:36,385 - INFO - integration_test - Step 28 (contouring until path end)
2026-01-24 02:29:36,390 - DEBUG - integration_test - Syncing planner state at step 28: vehicle_state=[5.42532013 4.47462833 0.75839013 2.12736663 7.2209868 ]
2026-01-24 02:29:36,391 - DEBUG - integration_test - Step 28: Using propagated spline 7.2210 (close to path, dist=0.367m, drift=0.256m)
2026-01-24 02:29:36,391 - DEBUG - integration_test -   Set spline state to 7.2210
2026-01-24 02:29:36,392 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:29:37,392 - DEBUG - integration_test - Step 28: Checking path alignment: vehicle=(5.425, 4.475), path_start=(0.000, 0.000), dist=7.033m
2026-01-24 02:29:37,392 - INFO - integration_test - === Calling planner.solve_mpc() at step 28 ===
2026-01-24 02:29:38,393 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:29:38,426 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:29:38,426 - INFO - integration_test - Warmstart k=0: x0=5.4253201339195565 , y0=4.474628332990697 , psi0=0.7583901304408145 , v0=2.1273666305968573 , spline0=7.220986797773144 , a0=0.0 , w0=0.0
2026-01-24 02:29:38,426 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:29:38,427 - INFO - integration_test - Dyn residual k=0: pred=[5.579755068820903, 4.620938751935443, 0.7583901304408145, 2.1273666305968573, 7.43372346083283], ws=[5.495508943259718, 4.549533867675726, 0.7583901304408145, 2.1273666305968573, 6.777157804267174], res=[0.08424612556118483, 0.07140488425971636, 0.0, 0.0, 0.6565656565656566], res_norm=6.658e-01
2026-01-24 02:29:38,428 - INFO - integration_test - Dyn residual k=1: pred=[5.649943878161065, 4.6958442866204715, 0.7583901304408145, 2.1273666305968573, 6.9898944673268595], ws=[5.605376771076976, 4.38143263152394, 0.7583901304408145, 2.1273666305968573, 6.787874265306657], res=[0.04456710708408895, 0.31441165509653146, 0.0, 0.0, 0.20202020202020243], res_norm=3.764e-01
2026-01-24 02:29:38,429 - INFO - integration_test - Dyn residual k=2: pred=[5.759811705978323, 4.527743050468685, 0.7583901304408145, 2.1273666305968573, 7.000610928366343], ws=[5.649167983930537, 4.679483953822994, 0.7583901304408145, 2.1273666305968573, 7.101621029376444], res=[0.11064372204778561, -0.1517409033543089, 0.0, 0.0, -0.10101010101010122], res_norm=2.132e-01
2026-01-24 02:29:38,448 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:39,507 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:39,530 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:39,578 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:29:39,600 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:39,651 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:29:39,673 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:39,719 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:29:39,742 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:39,793 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:29:39,816 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:39,868 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:29:39,891 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:39,939 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:39,961 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:40,006 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:40,028 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:40,077 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:40,098 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:40,146 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:40,166 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:40,211 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:45,839 - WARNING - integration_test - Step 28: MPC solve failed
2026-01-24 02:29:45,839 - WARNING - integration_test -   Consecutive MPC failures: 3/20
2026-01-24 02:29:45,855 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:29:45,855 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1858 scenarios available
2026-01-24 02:29:45,870 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1858 trajectory groups with 18580 total points
2026-01-24 02:29:45,872 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:29:46,499 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:29:46,536 - INFO - integration_test - Step 28: Computed 6 numeric contouring constraints for visualization (s=7.221)
2026-01-24 02:29:46,537 - DEBUG - integration_test - Step 28: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:29:46,537 - INFO - integration_test - === Applying control at step 28 ===
2026-01-24 02:29:46,537 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': 0.8}
2026-01-24 02:29:46,537 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:29:46,537 - INFO - integration_test -   Planner output success: False
2026-01-24 02:29:46,537 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': 0.8}
2026-01-24 02:29:46,538 - INFO - integration_test - Step 28 completed in 10.148s
2026-01-24 02:29:46,608 - INFO - integration_test - Step 29 (contouring until path end)
2026-01-24 02:29:46,611 - DEBUG - integration_test - Syncing planner state at step 29: vehicle_state=[5.56685982 4.61970339 0.83839013 1.92736663 7.41372346]
2026-01-24 02:29:46,612 - DEBUG - integration_test - Step 29: Using propagated spline 7.4137 (close to path, dist=0.361m, drift=0.039m)
2026-01-24 02:29:46,612 - DEBUG - integration_test -   Set spline state to 7.4137
2026-01-24 02:29:46,613 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:29:47,576 - DEBUG - integration_test - Step 29: Checking path alignment: vehicle=(5.567, 4.620), path_start=(0.000, 0.000), dist=7.234m
2026-01-24 02:29:47,576 - INFO - integration_test - === Calling planner.solve_mpc() at step 29 ===
2026-01-24 02:29:48,510 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:29:48,537 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:29:48,537 - INFO - integration_test - Warmstart k=0: x0=5.566859823405348 , y0=4.6197033939514025 , psi0=0.8383901304408145 , v0=1.9273666305968573 , spline0=7.41372346083283 , a0=0.0 , w0=0.0
2026-01-24 02:29:48,537 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:29:48,538 - INFO - integration_test - Dyn residual k=0: pred=[5.6957352628994755, 4.763016137217933, 0.8383901304408145, 1.9273666305968573, 7.606460123892515], ws=[5.750798008201269, 4.437500066309242, 0.8383901304408146, 1.9273666305968573, 6.848884366316757], res=[-0.055062745301793115, 0.3255160709086917, -1.1102230246251565e-16, 0.0, 0.7575757575757578], res_norm=8.264e-01
2026-01-24 02:29:48,539 - INFO - integration_test - Dyn residual k=1: pred=[5.879673447695396, 4.5808128095757725, 0.8383901304408146, 1.9273666305968573, 7.041621029376443], ws=[5.630414396766519, 4.601685384127541, 0.8383901304408146, 1.9273666305968573, 6.839600827356241], res=[0.24925905092887657, -0.020872574551768608, 0.0, 0.0, 0.20202020202020154], res_norm=3.215e-01
2026-01-24 02:29:48,540 - INFO - integration_test - Dyn residual k=2: pred=[5.759289836260646, 4.744998127394072, 0.8383901304408146, 1.9273666305968573, 7.032337490415927], ws=[5.998344290617408, 4.7701485405995845, 0.8383901304408146, 1.9273666305968573, 7.234357692436128], res=[-0.23905445435676143, -0.02515041320551248, 0.0, 0.0, -0.20202020202020154], res_norm=3.140e-01
2026-01-24 02:29:48,556 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:49,558 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:49,580 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:49,626 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:29:49,649 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:49,694 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:29:49,715 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:49,764 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:29:49,788 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:49,838 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:29:49,863 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:49,912 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:29:49,934 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:49,984 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:50,007 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:50,059 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:50,082 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:50,131 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:50,155 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:50,204 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:50,228 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:29:50,281 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:29:56,078 - WARNING - integration_test - Step 29: MPC solve failed
2026-01-24 02:29:56,078 - WARNING - integration_test -   Consecutive MPC failures: 4/20
2026-01-24 02:29:56,094 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:29:56,095 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1841 scenarios available
2026-01-24 02:29:56,370 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1841 trajectory groups with 18410 total points
2026-01-24 02:29:56,371 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:29:56,851 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:29:56,879 - INFO - integration_test - Step 29: Computed 6 numeric contouring constraints for visualization (s=7.414)
2026-01-24 02:29:56,880 - DEBUG - integration_test - Step 29: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:29:56,880 - INFO - integration_test - === Applying control at step 29 ===
2026-01-24 02:29:56,880 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': 0.8}
2026-01-24 02:29:56,880 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:29:56,880 - INFO - integration_test -   Planner output success: False
2026-01-24 02:29:56,880 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': 0.8}
2026-01-24 02:29:56,881 - INFO - integration_test - Step 29 completed in 10.271s
2026-01-24 02:29:56,945 - INFO - integration_test - Step 30 (contouring until path end)
2026-01-24 02:29:56,954 - DEBUG - integration_test - Syncing planner state at step 30: vehicle_state=[5.68358878 4.76023542 0.91839013 1.72736663 7.58646012]
2026-01-24 02:29:56,954 - DEBUG - integration_test - Step 30: Using propagated spline 7.5865 (close to path, dist=0.306m, drift=0.212m)
2026-01-24 02:29:56,954 - DEBUG - integration_test -   Set spline state to 7.5865
2026-01-24 02:29:56,955 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:29:57,973 - DEBUG - integration_test - Step 30: Checking path alignment: vehicle=(5.684, 4.760), path_start=(0.000, 0.000), dist=7.414m
2026-01-24 02:29:57,973 - INFO - integration_test - === Calling planner.solve_mpc() at step 30 ===
2026-01-24 02:29:59,024 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:29:59,058 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:29:59,058 - INFO - integration_test - Warmstart k=0: x0=5.683588780452202 , y0=4.760235424805759 , psi0=0.9183901304408144 , v0=1.7273666305968574 , spline0=7.586460123892516 , a0=0.0 , w0=0.0
2026-01-24 02:29:59,058 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:29:59,060 - INFO - integration_test - Dyn residual k=0: pred=[5.788457240702946, 4.897496347174923, 0.9183901304408144, 1.7273666305968574, 7.759196786952201], ws=[5.731424124823215, 4.6767335160529235, 0.9183901304408142, 1.7273666305968574, 6.900610928366342], res=[0.05703311587973037, 0.22076283112199935, 2.220446049250313e-16, 0.0, 0.858585858585859], res_norm=8.883e-01
2026-01-24 02:29:59,061 - INFO - integration_test - Dyn residual k=1: pred=[5.836292585073959, 4.813994438422087, 0.9183901304408142, 1.7273666305968574, 7.073347591426028], ws=[5.6512570655863845, 4.808363468949185, 0.9183901304408142, 1.7273666305968574, 7.174357692436129], res=[0.1850355194875748, 0.005630969472901981, 0.0, 0.0, -0.10101010101010122], res_norm=2.109e-01
2026-01-24 02:29:59,062 - INFO - integration_test - Dyn residual k=2: pred=[5.756125525837128, 4.945624391318349, 0.9183901304408142, 1.7273666305968574, 7.347094355495815], ws=[5.3734563064147665, 4.587322245499047, 0.9183901304408142, 1.7273666305968574, 6.539013547415006], res=[0.382669219422362, 0.35830214581930164, 0.0, 0.0, 0.8080808080808088], res_norm=9.632e-01
2026-01-24 02:29:59,082 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:30:00,306 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:30:00,329 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:30:00,381 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:30:00,404 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:30:00,454 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:30:00,480 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:30:00,531 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:30:00,554 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:30:00,601 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:30:00,626 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:30:00,677 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:30:00,701 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:30:00,750 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:30:00,773 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:30:00,824 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:30:00,848 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:30:00,898 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:30:00,920 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:30:00,967 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:30:00,988 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:30:01,032 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:30:06,928 - WARNING - integration_test - Step 30: MPC solve failed
2026-01-24 02:30:06,928 - WARNING - integration_test -   Consecutive MPC failures: 5/20
2026-01-24 02:30:06,947 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:06,947 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1858 scenarios available
2026-01-24 02:30:06,964 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1858 trajectory groups with 18580 total points
2026-01-24 02:30:06,965 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:07,637 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:30:07,674 - INFO - integration_test - Step 30: Computed 6 numeric contouring constraints for visualization (s=7.586)
2026-01-24 02:30:07,674 - DEBUG - integration_test - Step 30: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:30:07,674 - INFO - integration_test - === Applying control at step 30 ===
2026-01-24 02:30:07,674 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': 0.6686590087614732}
2026-01-24 02:30:07,674 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:30:07,675 - INFO - integration_test -   Planner output success: False
2026-01-24 02:30:07,675 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': 0.6686590087614732}
2026-01-24 02:30:07,676 - INFO - integration_test - Step 30 completed in 10.723s
2026-01-24 02:30:07,746 - WARNING - integration_test - Test timeout reached (180.0s) at step 31. Terminating test early.
2026-01-24 02:30:07,752 - INFO - integration_test - Saving test results...
2026-01-24 02:30:07,752 - INFO - integration_test - Saved 32 vehicle states to test_outputs/20260124_022700_contouring_safe_horizon_contouring_unicycle/vehicle_states.csv
2026-01-24 02:30:07,752 - INFO - integration_test - Saved obstacle summary to test_outputs/20260124_022700_contouring_safe_horizon_contouring_unicycle/obstacle_summary.csv
2026-01-24 02:30:07,753 - INFO - integration_test - Saved 42 states for obstacle 0 to test_outputs/20260124_022700_contouring_safe_horizon_contouring_unicycle/obstacle_0_detailed_states.csv
2026-01-24 02:30:07,753 - INFO - integration_test - Saved 42 states for obstacle 1 to test_outputs/20260124_022700_contouring_safe_horizon_contouring_unicycle/obstacle_1_detailed_states.csv
2026-01-24 02:30:07,753 - INFO - integration_test - Saved state history: 32 vehicle states, 2 obstacles
2026-01-24 02:30:07,753 - INFO - integration_test - Creating animation...
2026-01-24 02:30:07,798 - DEBUG - integration_test - Creating animation with 32 frames (range: 0 to 31)
2026-01-24 02:30:07,799 - DEBUG - integration_test - Frame 0: Drawing 6 contouring constraint halfspaces
2026-01-24 02:30:08,761 - INFO - integration_test - Frame 0: Safe Horizon module has 1836 scenarios after update
2026-01-24 02:30:08,761 - INFO - integration_test - Frame 0: Calling Safe Horizon visualizer
2026-01-24 02:30:08,761 - DEBUG - integration_test - Frame 0: Safe Horizon scenario_cache has 40 constraints across 10 keys: [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4)]
2026-01-24 02:30:08,763 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:08,763 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1836 scenarios available
2026-01-24 02:30:09,056 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1836 trajectory groups with 18360 total points
2026-01-24 02:30:09,056 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:09,108 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:30:09,115 - INFO - integration_test - Frame 0: Safe Horizon visualizer completed
2026-01-24 02:30:09,115 - DEBUG - integration_test - Frame 0: Drawing 6 contouring constraint halfspaces
2026-01-24 02:30:10,094 - INFO - integration_test - Frame 0: Safe Horizon module has 1844 scenarios after update
2026-01-24 02:30:10,094 - INFO - integration_test - Frame 0: Calling Safe Horizon visualizer
2026-01-24 02:30:10,094 - DEBUG - integration_test - Frame 0: Safe Horizon scenario_cache has 40 constraints across 10 keys: [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4)]
2026-01-24 02:30:10,095 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:10,095 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1844 scenarios available
2026-01-24 02:30:10,110 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1844 trajectory groups with 18440 total points
2026-01-24 02:30:10,111 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:10,159 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:30:10,165 - INFO - integration_test - Frame 0: Safe Horizon visualizer completed
2026-01-24 02:30:10,292 - DEBUG - integration_test - Frame 1: Drawing 6 contouring constraint halfspaces
2026-01-24 02:30:11,211 - INFO - integration_test - Frame 1: Safe Horizon module has 1855 scenarios after update
2026-01-24 02:30:11,211 - INFO - integration_test - Frame 1: Calling Safe Horizon visualizer
2026-01-24 02:30:11,211 - DEBUG - integration_test - Frame 1: Safe Horizon scenario_cache has 40 constraints across 10 keys: [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4)]
2026-01-24 02:30:11,213 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:11,213 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1855 scenarios available
2026-01-24 02:30:11,529 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1855 trajectory groups with 18550 total points
2026-01-24 02:30:11,530 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:11,582 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:30:11,591 - INFO - integration_test - Frame 1: Safe Horizon visualizer completed
2026-01-24 02:30:11,700 - DEBUG - integration_test - Frame 2: Drawing 6 contouring constraint halfspaces
2026-01-24 02:30:12,737 - INFO - integration_test - Frame 2: Safe Horizon module has 1846 scenarios after update
2026-01-24 02:30:12,737 - INFO - integration_test - Frame 2: Calling Safe Horizon visualizer
2026-01-24 02:30:12,737 - DEBUG - integration_test - Frame 2: Safe Horizon scenario_cache has 40 constraints across 10 keys: [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4)]
2026-01-24 02:30:12,738 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:12,739 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1846 scenarios available
2026-01-24 02:30:12,758 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1846 trajectory groups with 18460 total points
2026-01-24 02:30:12,759 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:12,814 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:30:12,822 - INFO - integration_test - Frame 2: Safe Horizon visualizer completed
2026-01-24 02:30:13,977 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:13,977 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1854 scenarios available
2026-01-24 02:30:13,997 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1854 trajectory groups with 18540 total points
2026-01-24 02:30:13,998 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:14,360 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:30:15,485 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:15,485 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1847 scenarios available
2026-01-24 02:30:15,505 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1847 trajectory groups with 18470 total points
2026-01-24 02:30:15,506 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:15,558 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:30:16,633 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:16,633 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1861 scenarios available
2026-01-24 02:30:16,654 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1861 trajectory groups with 18610 total points
2026-01-24 02:30:16,655 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:16,707 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:30:17,768 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:17,768 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1855 scenarios available
2026-01-24 02:30:18,062 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1855 trajectory groups with 18550 total points
2026-01-24 02:30:18,063 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:18,112 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:30:19,289 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:19,289 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1840 scenarios available
2026-01-24 02:30:19,309 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1840 trajectory groups with 18400 total points
2026-01-24 02:30:19,310 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:19,375 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:30:20,543 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:20,543 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1859 scenarios available
2026-01-24 02:30:20,565 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1859 trajectory groups with 18590 total points
2026-01-24 02:30:20,566 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:20,930 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:30:22,075 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:22,075 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1867 scenarios available
2026-01-24 02:30:22,093 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1867 trajectory groups with 18670 total points
2026-01-24 02:30:22,094 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:22,149 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:30:23,610 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:23,610 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1851 scenarios available
2026-01-24 02:30:23,629 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1851 trajectory groups with 18510 total points
2026-01-24 02:30:23,630 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:23,700 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:30:24,866 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:24,866 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1850 scenarios available
2026-01-24 02:30:25,195 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1850 trajectory groups with 18500 total points
2026-01-24 02:30:25,196 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:25,280 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:30:26,534 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:26,534 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1850 scenarios available
2026-01-24 02:30:26,555 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1850 trajectory groups with 18500 total points
2026-01-24 02:30:26,557 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:26,612 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:30:27,869 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:27,869 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1864 scenarios available
2026-01-24 02:30:27,898 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1864 trajectory groups with 18640 total points
2026-01-24 02:30:27,899 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:28,339 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:30:29,595 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:29,595 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1848 scenarios available
2026-01-24 02:30:29,618 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1848 trajectory groups with 18480 total points
2026-01-24 02:30:29,619 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:29,690 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:30:30,920 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:30,921 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1854 scenarios available
2026-01-24 02:30:30,946 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1854 trajectory groups with 18540 total points
2026-01-24 02:30:30,947 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:31,011 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:30:32,434 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:32,434 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1859 scenarios available
2026-01-24 02:30:32,760 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1859 trajectory groups with 18590 total points
2026-01-24 02:30:32,761 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:32,814 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:30:33,925 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:33,925 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1849 scenarios available
2026-01-24 02:30:33,946 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1849 trajectory groups with 18490 total points
2026-01-24 02:30:33,947 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:34,007 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:30:35,121 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:35,121 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1832 scenarios available
2026-01-24 02:30:35,144 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1832 trajectory groups with 18320 total points
2026-01-24 02:30:35,145 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:35,198 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:30:36,667 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:36,667 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1853 scenarios available
2026-01-24 02:30:36,687 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1853 trajectory groups with 18530 total points
2026-01-24 02:30:36,688 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:36,745 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:30:37,819 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:37,819 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1860 scenarios available
2026-01-24 02:30:37,841 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1860 trajectory groups with 18600 total points
2026-01-24 02:30:37,842 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:37,897 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:30:38,961 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:38,961 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1865 scenarios available
2026-01-24 02:30:39,256 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1865 trajectory groups with 18650 total points
2026-01-24 02:30:39,257 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:39,306 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:30:40,390 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:40,390 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1856 scenarios available
2026-01-24 02:30:40,412 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1856 trajectory groups with 18560 total points
2026-01-24 02:30:40,413 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:40,469 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:30:41,622 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:41,623 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1864 scenarios available
2026-01-24 02:30:41,644 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1864 trajectory groups with 18640 total points
2026-01-24 02:30:41,645 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:42,013 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:30:43,138 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:43,138 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1852 scenarios available
2026-01-24 02:30:43,158 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1852 trajectory groups with 18520 total points
2026-01-24 02:30:43,159 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:43,212 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:30:44,341 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:44,341 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1848 scenarios available
2026-01-24 02:30:44,362 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1848 trajectory groups with 18480 total points
2026-01-24 02:30:44,363 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:44,421 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:30:45,474 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:45,475 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1862 scenarios available
2026-01-24 02:30:45,764 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1862 trajectory groups with 18620 total points
2026-01-24 02:30:45,765 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:45,813 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:30:46,865 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:46,866 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1853 scenarios available
2026-01-24 02:30:46,885 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1853 trajectory groups with 18530 total points
2026-01-24 02:30:46,886 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:46,942 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:30:48,071 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:48,071 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1872 scenarios available
2026-01-24 02:30:48,096 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1872 trajectory groups with 18720 total points
2026-01-24 02:30:48,098 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:48,474 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:30:49,595 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:49,595 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1855 scenarios available
2026-01-24 02:30:49,613 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1855 trajectory groups with 18550 total points
2026-01-24 02:30:49,614 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:49,670 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:30:50,816 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:50,816 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1853 scenarios available
2026-01-24 02:30:50,839 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1853 trajectory groups with 18530 total points
2026-01-24 02:30:50,840 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:50,893 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:30:52,075 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:30:52,076 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1865 scenarios available
2026-01-24 02:30:52,392 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1865 trajectory groups with 18650 total points
2026-01-24 02:30:52,393 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:30:52,447 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:30:54,586 - INFO - integration_test - Saved animation with 32 frames at 10.00 fps to test_outputs/20260124_022700_contouring_safe_horizon_contouring_unicycle/animation.gif (duration: 3.20s, size: 537270 bytes)
2026-01-24 02:30:54,608 - INFO - integration_test - Animation created successfully
2026-01-24 02:30:54,609 - INFO - integration_test - Test completed successfully
