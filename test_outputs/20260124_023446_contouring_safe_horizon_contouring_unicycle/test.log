2026-01-24 02:34:46,406 - INFO - integration_test - Contouring objective detected: automatically switching to contouring-aware dynamics model
2026-01-24 02:34:46,406 - INFO - integration_test -   Converted 'unicycle' -> 'contouring_unicycle'
2026-01-24 02:34:46,406 - INFO - integration_test - Created vehicle dynamics model: ContouringSecondOrderUnicycleModel
2026-01-24 02:34:46,406 - INFO - integration_test - ✓ Validation passed: Contouring objective with dynamics model that has 'spline' state
2026-01-24 02:34:46,406 - INFO - integration_test - Creating objective module: contouring
2026-01-24 02:34:46,415 - INFO - integration_test - Objective module 'contouring' created: contouring_objective
2026-01-24 02:34:46,415 - INFO - integration_test - Creating 2 constraint module(s): ['safe_horizon', 'contouring']
2026-01-24 02:34:46,415 - DEBUG - integration_test - Creating constraint module: safe_horizon
2026-01-24 02:34:46,441 - INFO - integration_test - Constraint module 'safe_horizon' created: safe_horizon_constraint
2026-01-24 02:34:46,441 - DEBUG - integration_test - Creating constraint module: contouring
2026-01-24 02:34:46,449 - INFO - integration_test - Constraint module 'contouring' created: contouring_constraints
2026-01-24 02:34:46,449 - INFO - integration_test - Created 2 constraint module(s)
2026-01-24 02:34:46,471 - INFO - integration_test - Setting solver on all modules...
2026-01-24 02:34:46,471 - DEBUG - integration_test -   Set solver on module: safe_horizon_constraint
2026-01-24 02:34:46,471 - DEBUG - integration_test -   Set solver on module: contouring_constraints
2026-01-24 02:34:46,471 - DEBUG - integration_test -   Set solver on module: control_effort_objective
2026-01-24 02:34:46,471 - DEBUG - integration_test -   Set solver on module: control_jerk_objective
2026-01-24 02:34:46,471 - DEBUG - integration_test -   Set solver on module: path_reference_velocity_objective
2026-01-24 02:34:46,471 - DEBUG - integration_test -   Set solver on module: contouring_objective
2026-01-24 02:34:46,471 - INFO - integration_test - Placing obstacles within reference path boundaries
2026-01-24 02:34:46,472 - INFO - integration_test - Obstacle 0: s=8.03, pos=(6.24, 5.59), lateral_offset=0.00m, vel=(0.47, 0.37)
2026-01-24 02:34:46,472 - INFO - integration_test - Obstacle 1: s=17.06, pos=(13.71, 10.71), lateral_offset=0.00m, vel=(-0.69, -0.41)
2026-01-24 02:34:46,472 - WARNING - integration_test - Error shaping obstacles: name 'get_dummy_obstacle' is not defined
2026-01-24 02:34:46,472 - WARNING - integration_test - Error in on_data_received: 'Planner' object has no attribute 'on_data_received'
2026-01-24 02:34:46,473 - INFO - integration_test - Initial vehicle state (before spline): [0. 0. 0. 1.]
2026-01-24 02:34:46,473 - INFO - integration_test - Vehicle starting position: (0.00, 0.00)
2026-01-24 02:34:46,473 - INFO - integration_test - Reference path start: (0.00, 0.00)
2026-01-24 02:34:46,473 - INFO - integration_test - Reference path starts at vehicle position (requirement satisfied)
2026-01-24 02:34:46,473 - INFO - integration_test - Contouring-aware dynamics detected: initializing spline variable
2026-01-24 02:34:46,473 - INFO - integration_test - Initialized spline to closest path point: s=0.0000 (vehicle at (0.00, 0.00), closest path point at (0.00, 0.00), distance=0.000m)
2026-01-24 02:34:46,473 - INFO - integration_test - Added spline variable: 0.0000
2026-01-24 02:34:46,474 - INFO - integration_test - Final initial state: [0. 0. 0. 1. 0.] (variables: ['x', 'y', 'psi', 'v', 'spline'])
2026-01-24 02:34:46,474 - INFO - integration_test - Auto-calculated timeout: 180s for 100 steps
2026-01-24 02:34:46,474 - INFO - integration_test - Step 0 (contouring until path end)
2026-01-24 02:34:46,474 - DEBUG - integration_test - Syncing planner state at step 0: vehicle_state=[0. 0. 0. 1. 0.]
2026-01-24 02:34:46,474 - DEBUG - integration_test - Step 0: Using propagated spline 0.0000 (close to path, dist=0.000m, drift=0.000m)
2026-01-24 02:34:46,474 - DEBUG - integration_test -   Set spline state to 0.0000
2026-01-24 02:34:46,475 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:34:47,740 - DEBUG - integration_test - Step 0: Checking path alignment: vehicle=(0.000, 0.000), path_start=(0.000, 0.000), dist=0.000m
2026-01-24 02:34:47,740 - INFO - integration_test - === Calling planner.solve_mpc() at step 0 ===
2026-01-24 02:34:48,650 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:34:48,677 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:34:48,677 - INFO - integration_test - Warmstart k=0: x0=0.0 , y0=0.0 , psi0=0.0 , v0=1.0 , spline0=0.0 , a0=0.0 , w0=0.0
2026-01-24 02:34:48,677 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:34:48,678 - INFO - integration_test - Dyn residual k=0: pred=[0.1, 0.0, 0.0, 1.0, 0.1], ws=[0.1, 0.0, 0.0, 1.0, 0.051515151515151514], res=[0.0, 0.0, 0.0, 0.0, 0.04848484848484849], res_norm=4.848e-02
2026-01-24 02:34:48,679 - INFO - integration_test - Dyn residual k=1: pred=[0.2, 0.0, 0.0, 1.0, 0.15151515151515152], ws=[0.2, 0.0, 0.0, 1.0, 0.05252525252525253], res=[0.0, 0.0, 0.0, 0.0, 0.09898989898989899], res_norm=9.899e-02
2026-01-24 02:34:48,680 - INFO - integration_test - Dyn residual k=2: pred=[0.30000000000000004, 0.0, 0.0, 1.0, 0.15252525252525254], ws=[0.30000000000000004, 0.0, 0.0, 1.0, 0.10707070707070707], res=[0.0, 0.0, 0.0, 0.0, 0.04545454545454547], res_norm=4.545e-02
2026-01-24 02:34:48,695 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:34:49,698 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:34:49,721 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:34:49,770 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:34:49,794 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:34:49,854 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:34:49,891 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:34:49,992 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:34:50,024 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:34:50,079 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:34:50,103 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:34:50,159 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:34:50,183 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:34:50,232 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:34:50,255 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:34:50,303 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:34:50,326 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:34:50,374 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:34:50,398 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:34:50,445 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:34:50,465 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:34:50,513 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:34:51,598 - INFO - integration_test - Step 0: MPC solve successful
2026-01-24 02:34:51,790 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:34:51,790 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1852 scenarios available
2026-01-24 02:34:51,864 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1852 trajectory groups with 18520 total points
2026-01-24 02:34:51,865 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:34:51,940 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:34:51,951 - INFO - integration_test - Step 0: Computed 6 numeric contouring constraints for visualization (s=0.000)
2026-01-24 02:34:51,951 - DEBUG - integration_test - Step 0: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:34:51,951 - DEBUG - integration_test - Linearized constraints module not found at step 0
2026-01-24 02:34:51,951 - INFO - integration_test - === Applying control at step 0 ===
2026-01-24 02:34:51,951 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000184714533, 'w': 0.7999999766349575}
2026-01-24 02:34:51,951 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:34:51,951 - INFO - integration_test -   Planner output success: True
2026-01-24 02:34:51,953 - INFO - integration_test - Step 0 completed in 5.479s
2026-01-24 02:34:52,019 - INFO - integration_test - Step 1 (contouring until path end)
2026-01-24 02:34:52,020 - DEBUG - integration_test - Syncing planner state at step 1: vehicle_state=[0.10987738 0.00453084 0.08       1.2        0.12      ]
2026-01-24 02:34:52,020 - DEBUG - integration_test - Step 1: Using propagated spline 0.1200 (close to path, dist=0.110m, drift=0.120m)
2026-01-24 02:34:52,020 - DEBUG - integration_test -   Set spline state to 0.1200
2026-01-24 02:34:52,021 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:34:52,993 - DEBUG - integration_test - Step 1: Checking path alignment: vehicle=(0.110, 0.005), path_start=(0.000, 0.000), dist=0.110m
2026-01-24 02:34:52,993 - INFO - integration_test - === Calling planner.solve_mpc() at step 1 ===
2026-01-24 02:34:54,003 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:34:54,031 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:34:54,031 - INFO - integration_test - Warmstart k=0: x0=0.10987737538056071 , y0=0.004530844925808473 , psi0=0.07999999766349575 , v0=1.2000000018471453 , spline0=0.12000000018471453 , a0=0.0 , w0=0.0
2026-01-24 02:34:54,031 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:34:54,032 - INFO - integration_test - Dyn residual k=0: pred=[0.22949358034340533, 0.014120607937386828, 0.07999999766349575, 1.2000000018471453, 0.24000000036942906], ws=[0.2294935803434053, 0.014120607937386828, 0.07999999766349575, 1.2000000018471453, 0.052929292933024535], res=[2.7755575615628914e-17, 0.0, 0.0, 0.0, 0.18707070743640453], res_norm=1.871e-01
2026-01-24 02:34:54,034 - INFO - integration_test - Dyn residual k=1: pred=[0.3491097853062499, 0.023710370948965182, 0.07999999766349575, 1.2000000018471453, 0.17292929311773908], ws=[0.3491097853062499, 0.023710370948965186, 0.07999999766349575, 1.2000000018471453, 0.10828282829402311], res=[0.0, -3.469446951953614e-18, 0.0, 0.0, 0.06464646482371597], res_norm=6.465e-02
2026-01-24 02:34:54,035 - INFO - integration_test - Dyn residual k=2: pred=[0.46872599026909456, 0.03330013396054354, 0.07999999766349575, 1.2000000018471453, 0.22828282847873765], ws=[0.4687259902690945, 0.03330013396054354, 0.07999999766349575, 1.2000000018471453, 0.1660606060829957], res=[5.551115123125783e-17, 0.0, 0.0, 0.0, 0.06222222239574196], res_norm=6.222e-02
2026-01-24 02:34:54,052 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:34:55,100 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:34:55,122 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:34:55,168 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:34:55,192 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:34:55,240 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:34:55,262 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:34:55,308 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:34:55,331 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:34:55,382 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:34:55,404 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:34:55,452 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:34:55,473 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:34:55,523 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:34:55,546 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:34:55,594 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:34:55,616 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:34:55,664 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:34:55,687 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:34:55,735 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:34:55,756 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:34:55,805 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:34:56,384 - INFO - integration_test - Step 1: MPC solve successful
2026-01-24 02:34:56,387 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:34:56,387 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1860 scenarios available
2026-01-24 02:34:56,458 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1860 trajectory groups with 18600 total points
2026-01-24 02:34:56,459 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:34:56,580 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:34:56,597 - INFO - integration_test - Step 1: Computed 6 numeric contouring constraints for visualization (s=0.120)
2026-01-24 02:34:56,597 - DEBUG - integration_test - Step 1: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:34:56,597 - INFO - integration_test - === Applying control at step 1 ===
2026-01-24 02:34:56,597 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000189035916, 'w': 0.8000000026177922}
2026-01-24 02:34:56,597 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:34:56,597 - INFO - integration_test -   Planner output success: True
2026-01-24 02:34:56,600 - INFO - integration_test - Step 1 completed in 4.580s
2026-01-24 02:34:56,660 - INFO - integration_test - Step 2 (contouring until path end)
2026-01-24 02:34:56,661 - DEBUG - integration_test - Syncing planner state at step 2: vehicle_state=[0.23889213 0.02022162 0.16       1.4        0.26      ]
2026-01-24 02:34:56,661 - DEBUG - integration_test - Step 2: Using propagated spline 0.2600 (close to path, dist=0.240m, drift=0.260m)
2026-01-24 02:34:56,661 - DEBUG - integration_test -   Set spline state to 0.2600
2026-01-24 02:34:56,662 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:34:57,559 - DEBUG - integration_test - Step 2: Checking path alignment: vehicle=(0.239, 0.020), path_start=(0.000, 0.000), dist=0.240m
2026-01-24 02:34:57,559 - INFO - integration_test - === Calling planner.solve_mpc() at step 2 ===
2026-01-24 02:34:58,461 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:34:58,487 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:34:58,488 - INFO - integration_test - Warmstart k=0: x0=0.23889212820404288 , y0=0.02022162134174898 , psi0=0.15999999792527497 , v0=1.4000000037375044 , spline0=0.260000000558465 , a0=0.0 , w0=0.0
2026-01-24 02:34:58,488 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:34:58,489 - INFO - integration_test - Dyn residual k=0: pred=[0.3771039482918831, 0.04252617004053714, 0.15999999792527497, 1.4000000037375044, 0.40000000093221544], ws=[0.3771039482918831, 0.042526170040537145, 0.15999999792527486, 1.4000000037375044, 0.10909090910974173], res=[0.0, -6.938893903907228e-18, 1.1102230246251565e-16, 0.0, 0.2909090918224737], res_norm=2.909e-01
2026-01-24 02:34:58,489 - INFO - integration_test - Dyn residual k=1: pred=[0.5153157683797234, 0.06483071873932529, 0.15999999792527486, 1.4000000037375044, 0.2490909094834922], ws=[0.5153157683797234, 0.06483071873932529, 0.15999999792527486, 1.4000000037375044, 0.1678787879183626], res=[0.0, 0.0, 0.0, 0.0, 0.08121212156512958], res_norm=8.121e-02
2026-01-24 02:34:58,490 - INFO - integration_test - Dyn residual k=2: pred=[0.6535275884675635, 0.08713526743811344, 0.15999999792527486, 1.4000000037375044, 0.30787878829211307], ws=[0.6535275884675635, 0.08713526743811344, 0.15999999792527486, 1.4000000037375044, 0.45898989912563365], res=[0.0, 0.0, 0.0, 0.0, -0.15111111083352058], res_norm=1.511e-01
2026-01-24 02:34:58,507 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:34:59,621 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:34:59,646 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:34:59,701 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:34:59,727 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:34:59,782 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:34:59,809 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:34:59,866 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:34:59,892 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:34:59,948 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:34:59,973 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:00,030 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:00,058 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:00,124 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:00,165 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:00,246 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:00,271 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:00,326 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:00,353 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:00,408 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:00,432 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:00,485 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:01,110 - INFO - integration_test - Step 2: MPC solve successful
2026-01-24 02:35:01,114 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:35:01,114 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1856 scenarios available
2026-01-24 02:35:01,196 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1856 trajectory groups with 18560 total points
2026-01-24 02:35:01,197 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:35:01,290 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:35:01,301 - INFO - integration_test - Step 2: Computed 6 numeric contouring constraints for visualization (s=0.260)
2026-01-24 02:35:01,301 - DEBUG - integration_test - Step 2: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:35:01,301 - INFO - integration_test - === Applying control at step 2 ===
2026-01-24 02:35:01,301 - INFO - integration_test -   Control dict from planner: {'a': 2.000000019453001, 'w': 0.800000005901475}
2026-01-24 02:35:01,301 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:35:01,301 - INFO - integration_test -   Planner output success: True
2026-01-24 02:35:01,303 - INFO - integration_test - Step 2 completed in 4.642s
2026-01-24 02:35:01,367 - INFO - integration_test - Step 3 (contouring until path end)
2026-01-24 02:35:01,368 - DEBUG - integration_test - Syncing planner state at step 3: vehicle_state=[0.38583644 0.05014472 0.24       1.60000001 0.42      ]
2026-01-24 02:35:01,368 - DEBUG - integration_test - Step 3: Using propagated spline 0.4200 (close to path, dist=0.261m, drift=0.010m)
2026-01-24 02:35:01,368 - DEBUG - integration_test -   Set spline state to 0.4200
2026-01-24 02:35:01,369 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:35:02,328 - DEBUG - integration_test - Step 3: Checking path alignment: vehicle=(0.386, 0.050), path_start=(0.000, 0.000), dist=0.389m
2026-01-24 02:35:02,328 - INFO - integration_test - === Calling planner.solve_mpc() at step 3 ===
2026-01-24 02:35:03,276 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:35:03,302 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:35:03,302 - INFO - integration_test - Warmstart k=0: x0=0.38583643577671084 , y0=0.050144715781136176 , psi0=0.23999999851542247 , v0=1.6000000056828045 , spline0=0.42000000112674546 , a0=0.0 , w0=0.0
2026-01-24 02:35:03,302 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:35:03,303 - INFO - integration_test - Dyn residual k=0: pred=[0.54125051236149, 0.08817713591383522, 0.23999999851542247, 1.6000000056828045, 0.580000001695026], ws=[0.54125051236149, 0.08817713591383522, 0.23999999851542242, 1.6000000056828045, 0.16909090914227354], res=[0.0, 0.0, 5.551115123125783e-17, 0.0, 0.41090909255275243], res_norm=4.109e-01
2026-01-24 02:35:03,303 - INFO - integration_test - Dyn residual k=1: pred=[0.6966645889462693, 0.12620955604653425, 0.23999999851542242, 1.6000000056828045, 0.329090909710554], ws=[0.6966645889462693, 0.12620955604653425, 0.23999999851542242, 1.6000000056828045, 0.23191919201063863], res=[0.0, 0.0, 0.0, 0.0, 0.09717171769991537], res_norm=9.717e-02
2026-01-24 02:35:03,304 - INFO - integration_test - Dyn residual k=2: pred=[0.8520786655310485, 0.16424197617923328, 0.23999999851542242, 1.6000000056828045, 0.39191919257891905], ws=[0.8520786655310485, 0.16424197617923328, 0.23999999851542242, 1.6000000056828045, 0.2979797981228074], res=[0.0, 0.0, 0.0, 0.0, 0.09393939445611166], res_norm=9.394e-02
2026-01-24 02:35:03,321 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:04,375 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:04,396 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:04,442 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:04,462 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:04,506 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:04,526 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:04,571 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:04,594 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:04,642 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:04,663 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:04,709 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:04,730 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:04,775 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:04,796 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:04,844 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:04,866 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:04,913 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:04,933 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:04,980 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:05,000 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:05,047 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:05,609 - INFO - integration_test - Step 3: MPC solve successful
2026-01-24 02:35:05,613 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:35:05,613 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1863 scenarios available
2026-01-24 02:35:05,625 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1863 trajectory groups with 18630 total points
2026-01-24 02:35:05,626 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:35:05,726 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:35:05,738 - INFO - integration_test - Step 3: Computed 6 numeric contouring constraints for visualization (s=0.420)
2026-01-24 02:35:05,738 - DEBUG - integration_test - Step 3: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:35:05,738 - INFO - integration_test - === Applying control at step 3 ===
2026-01-24 02:35:05,738 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000197590055, 'w': 0.8000000078062677}
2026-01-24 02:35:05,738 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:35:05,738 - INFO - integration_test -   Planner output success: True
2026-01-24 02:35:05,740 - INFO - integration_test - Step 3 completed in 4.372s
2026-01-24 02:35:05,807 - INFO - integration_test - Step 4 (contouring until path end)
2026-01-24 02:35:05,808 - DEBUG - integration_test - Syncing planner state at step 4: vehicle_state=[0.54913546 0.09724076 0.32       1.80000001 0.6       ]
2026-01-24 02:35:05,809 - DEBUG - integration_test - Step 4: Using propagated spline 0.6000 (close to path, dist=0.325m, drift=0.190m)
2026-01-24 02:35:05,809 - DEBUG - integration_test -   Set spline state to 0.6000
2026-01-24 02:35:05,810 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:35:06,862 - DEBUG - integration_test - Step 4: Checking path alignment: vehicle=(0.549, 0.097), path_start=(0.000, 0.000), dist=0.558m
2026-01-24 02:35:06,863 - INFO - integration_test - === Calling planner.solve_mpc() at step 4 ===
2026-01-24 02:35:07,972 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:35:08,001 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:35:08,001 - INFO - integration_test - Warmstart k=0: x0=0.5491354613480135 , y0=0.09724075614948874 , psi0=0.3199999992960492 , v0=1.800000007658705 , spline0=0.6000000018926159 , a0=0.0 , w0=0.0
2026-01-24 02:35:08,001 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:35:08,002 - INFO - integration_test - Dyn residual k=0: pred=[0.7199978373697034, 0.15386273718102847, 0.3199999992960492, 1.800000007658705, 0.7800000026584865], ws=[0.7199978373697034, 0.1538627371810285, 0.31999999929604916, 1.800000007658705, 0.23353535364276712], res=[0.0, -2.7755575615628914e-17, 5.551115123125783e-17, 0.0, 0.5464646490157193], res_norm=5.465e-01
2026-01-24 02:35:08,003 - INFO - integration_test - Dyn residual k=1: pred=[0.8908602133913932, 0.21048471821256823, 0.31999999929604916, 1.800000007658705, 0.41353535440863765], ws=[0.8908602133913932, 0.21048471821256823, 0.31999999929604916, 1.800000007658705, 0.30101010118304833], res=[0.0, 0.0, 0.0, 0.0, 0.11252525322558932], res_norm=1.125e-01
2026-01-24 02:35:08,004 - INFO - integration_test - Dyn residual k=2: pred=[1.061722589413083, 0.26710669924410796, 0.31999999929604916, 1.800000007658705, 0.48101010194891886], ws=[1.061722589413083, 0.26710669924410796, 0.31999999929604916, 1.800000007658705, 0.37212121237516527], res=[0.0, 0.0, 0.0, 0.0, 0.10888888957375359], res_norm=1.089e-01
2026-01-24 02:35:08,022 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:09,028 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:09,052 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:09,101 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:09,125 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:09,177 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:09,200 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:09,249 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:09,272 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:09,320 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:09,344 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:09,399 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:09,423 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:09,481 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:09,506 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:09,561 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:09,587 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:09,647 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:09,673 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:09,729 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:09,752 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:09,809 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:10,506 - INFO - integration_test - Step 4: MPC solve successful
2026-01-24 02:35:10,513 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:35:10,513 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1854 scenarios available
2026-01-24 02:35:10,530 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1854 trajectory groups with 18540 total points
2026-01-24 02:35:10,532 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:35:10,663 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:35:10,674 - INFO - integration_test - Step 4: Computed 6 numeric contouring constraints for visualization (s=0.600)
2026-01-24 02:35:10,675 - DEBUG - integration_test - Step 4: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:35:10,675 - INFO - integration_test - === Applying control at step 4 ===
2026-01-24 02:35:10,675 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000107778217, 'w': 0.7999999386107064}
2026-01-24 02:35:10,675 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:35:10,675 - INFO - integration_test -   Planner output success: True
2026-01-24 02:35:10,677 - INFO - integration_test - Step 4 completed in 4.869s
2026-01-24 02:35:10,746 - INFO - integration_test - Step 5 (contouring until path end)
2026-01-24 02:35:10,747 - DEBUG - integration_test - Syncing planner state at step 5: vehicle_state=[0.72686149 0.16427977 0.39999999 2.00000001 0.8       ]
2026-01-24 02:35:10,747 - DEBUG - integration_test - Step 5: Using propagated spline 0.8000 (close to path, dist=0.443m, drift=0.019m)
2026-01-24 02:35:10,747 - DEBUG - integration_test -   Set spline state to 0.8000
2026-01-24 02:35:10,748 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:35:11,724 - DEBUG - integration_test - Step 5: Checking path alignment: vehicle=(0.727, 0.164), path_start=(0.000, 0.000), dist=0.745m
2026-01-24 02:35:11,724 - INFO - integration_test - === Calling planner.solve_mpc() at step 5 ===
2026-01-24 02:35:12,625 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:35:12,650 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:35:12,650 - INFO - integration_test - Warmstart k=0: x0=0.7268614890537172 , y0=0.16427976687168389 , psi0=0.39999999315711987 , v0=2.000000008736487 , spline0=0.8000000027662646 , a0=0.0 , w0=0.0
2026-01-24 02:35:12,650 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:35:12,651 - INFO - integration_test - Dyn residual k=0: pred=[0.9110736891919266, 0.2421634344130868, 0.39999999315711987, 2.000000008736487, 1.0000000036399133], ws=[0.9110736891919266, 0.2421634344130868, 0.39999999315711987, 2.000000008736487, 0.3636363638569644], res=[0.0, 0.0, 0.0, 0.0, 0.6363636397829489], res_norm=6.364e-01
2026-01-24 02:35:12,652 - INFO - integration_test - Dyn residual k=1: pred=[1.0952858893301358, 0.3200471019544897, 0.39999999315711987, 2.000000008736487, 0.5636363647306131], ws=[1.0952858893301358, 0.3200471019544897, 0.39999999315711987, 2.000000008736487, 0.8767676774059582], res=[0.0, 0.0, 0.0, 0.0, -0.3131313126753451], res_norm=3.131e-01
2026-01-24 02:35:12,653 - INFO - integration_test - Dyn residual k=2: pred=[1.2794980894683452, 0.3979307694958926, 0.39999999315711987, 2.000000008736487, 1.076767678279607], ws=[1.2794980894683452, 0.3979307694958926, 0.39999999315711987, 2.000000008736487, 0.9696969705132139], res=[0.0, 0.0, 0.0, 0.0, 0.10707070776639305], res_norm=1.071e-01
2026-01-24 02:35:12,670 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:13,704 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:13,739 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:13,798 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:13,834 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:13,910 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:13,936 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:13,987 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:14,014 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:14,067 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:14,091 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:14,141 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:14,166 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:14,219 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:14,241 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:14,294 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:14,319 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:14,388 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:14,416 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:14,468 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:14,490 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:14,540 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:15,198 - INFO - integration_test - Step 5: MPC solve successful
2026-01-24 02:35:15,203 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:35:15,203 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1874 scenarios available
2026-01-24 02:35:15,217 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1874 trajectory groups with 18740 total points
2026-01-24 02:35:15,218 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:35:15,460 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:35:15,475 - INFO - integration_test - Step 5: Computed 6 numeric contouring constraints for visualization (s=0.800)
2026-01-24 02:35:15,475 - DEBUG - integration_test - Step 5: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:35:15,475 - INFO - integration_test - === Applying control at step 5 ===
2026-01-24 02:35:15,476 - INFO - integration_test -   Control dict from planner: {'a': 2.000000017072731, 'w': 0.7999999975601401}
2026-01-24 02:35:15,476 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:35:15,476 - INFO - integration_test -   Planner output success: True
2026-01-24 02:35:15,477 - INFO - integration_test - Step 5 completed in 4.731s
2026-01-24 02:35:15,547 - INFO - integration_test - Step 6 (contouring until path end)
2026-01-24 02:35:15,549 - DEBUG - integration_test - Syncing planner state at step 6: vehicle_state=[0.9167519  0.25382381 0.47999999 2.20000001 1.02      ]
2026-01-24 02:35:15,549 - DEBUG - integration_test - Step 6: Using propagated spline 1.0200 (close to path, dist=0.471m, drift=0.201m)
2026-01-24 02:35:15,549 - DEBUG - integration_test -   Set spline state to 1.0200
2026-01-24 02:35:15,550 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:35:16,549 - DEBUG - integration_test - Step 6: Checking path alignment: vehicle=(0.917, 0.254), path_start=(0.000, 0.000), dist=0.951m
2026-01-24 02:35:16,549 - INFO - integration_test - === Calling planner.solve_mpc() at step 6 ===
2026-01-24 02:35:17,489 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:35:17,515 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:35:17,515 - INFO - integration_test - Warmstart k=0: x0=0.9167519036976122 , y0=0.25382380558101686 , psi0=0.4799999929131339 , v0=2.2000000104437603 , spline0=1.0200000038106407 , a0=0.0 , w0=0.0
2026-01-24 02:35:17,515 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:35:17,516 - INFO - integration_test - Dyn residual k=0: pred=[1.1118907883553757, 0.35541522329949105, 0.4799999929131339, 2.2000000104437603, 1.2400000048550168], ws=[1.1118907883553757, 0.35541522329949105, 0.4799999929131338, 2.2000000104437603, 0.6933333338727797], res=[0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.5466666709822371], res_norm=5.467e-01
2026-01-24 02:35:17,517 - INFO - integration_test - Dyn residual k=1: pred=[1.3070296730131392, 0.45700664101796523, 0.4799999929131338, 2.2000000104437603, 0.9133333349171557], ws=[1.3070296730131392, 0.45700664101796523, 0.4799999929131338, 2.2000000104437603, 1.2397979809301864], res=[0.0, 0.0, 0.0, 0.0, -0.3264646460130307], res_norm=3.265e-01
2026-01-24 02:35:17,518 - INFO - integration_test - Dyn residual k=2: pred=[1.5021685576709027, 0.5585980587364394, 0.4799999929131338, 2.2000000104437603, 1.4597979819745626], ws=[1.5021685576709027, 0.5585980587364394, 0.4799999929131338, 2.2000000104437603, 1.0795959607181849], res=[0.0, 0.0, 0.0, 0.0, 0.3802020212563777], res_norm=3.802e-01
2026-01-24 02:35:17,533 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:18,626 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:18,652 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:18,705 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:18,730 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:18,781 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:18,806 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:18,857 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:18,883 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:18,937 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:18,960 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:19,014 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:19,040 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:19,090 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:19,112 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:19,161 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:19,182 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:19,233 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:19,255 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:19,306 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:19,330 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:19,379 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:20,117 - INFO - integration_test - Step 6: MPC solve successful
2026-01-24 02:35:20,121 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:35:20,121 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1858 scenarios available
2026-01-24 02:35:20,239 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1858 trajectory groups with 18580 total points
2026-01-24 02:35:20,240 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:35:20,382 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:35:20,394 - INFO - integration_test - Step 6: Computed 6 numeric contouring constraints for visualization (s=1.020)
2026-01-24 02:35:20,394 - DEBUG - integration_test - Step 6: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:35:20,394 - INFO - integration_test - === Applying control at step 6 ===
2026-01-24 02:35:20,394 - INFO - integration_test -   Control dict from planner: {'a': 2.000000013331554, 'w': 0.7999999278498181}
2026-01-24 02:35:20,394 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:35:20,394 - INFO - integration_test -   Planner output success: True
2026-01-24 02:35:20,396 - INFO - integration_test - Step 6 completed in 4.847s
2026-01-24 02:35:20,457 - INFO - integration_test - Step 7 (contouring until path end)
2026-01-24 02:35:20,459 - DEBUG - integration_test - Syncing planner state at step 7: vehicle_state=[1.11623087 0.36819144 0.55999999 2.40000001 1.26      ]
2026-01-24 02:35:20,459 - DEBUG - integration_test - Step 7: Using propagated spline 1.2600 (close to path, dist=0.559m, drift=0.031m)
2026-01-24 02:35:20,460 - DEBUG - integration_test -   Set spline state to 1.2600
2026-01-24 02:35:20,460 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:35:21,451 - DEBUG - integration_test - Step 7: Checking path alignment: vehicle=(1.116, 0.368), path_start=(0.000, 0.000), dist=1.175m
2026-01-24 02:35:21,451 - INFO - integration_test - === Calling planner.solve_mpc() at step 7 ===
2026-01-24 02:35:22,429 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:35:22,457 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:35:22,458 - INFO - integration_test - Warmstart k=0: x0=1.1162308650594321 , y0=0.3681914428181862 , psi0=0.5599999856981157 , v0=2.400000011776916 , spline0=1.2600000049883322 , a0=0.0 , w0=0.0
2026-01-24 02:35:22,458 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:35:22,459 - INFO - integration_test - Dyn residual k=0: pred=[1.3195720945237284, 0.49567612803660904, 0.5599999856981157, 2.400000011776916, 1.5000000061660237], ws=[1.3195720945237284, 0.49567612803660904, 0.5599999856981155, 2.400000011776916, 1.247474748658126], res=[0.0, 0.0, 2.220446049250313e-16, 0.0, 0.2525252575078978], res_norm=2.525e-01
2026-01-24 02:35:22,460 - INFO - integration_test - Dyn residual k=1: pred=[1.5229133239880248, 0.6231608132550318, 0.5599999856981155, 2.400000011776916, 1.4874747498358176], ws=[1.5229133239880248, 0.6231608132550318, 0.5599999856981155, 2.400000011776916, 1.3616161630997403], res=[0.0, 0.0, 0.0, 0.0, 0.1258585867360773], res_norm=1.259e-01
2026-01-24 02:35:22,460 - INFO - integration_test - Dyn residual k=2: pred=[1.7262545534523213, 0.7506454984734545, 0.5599999856981155, 2.400000011776916, 1.601616164277432], ws=[1.7262545534523213, 0.7506454984734545, 0.5599999856981155, 2.400000011776916, 1.1985858600491304], res=[0.0, 0.0, 0.0, 0.0, 0.40303030422830166], res_norm=4.030e-01
2026-01-24 02:35:22,477 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:23,540 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:23,563 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:23,614 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:23,640 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:23,693 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:23,716 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:23,764 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:23,787 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:23,837 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:23,860 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:23,908 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:23,932 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:23,979 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:24,002 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:24,054 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:24,076 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:24,123 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:24,148 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:24,195 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:24,217 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:24,270 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:24,907 - INFO - integration_test - Step 7: MPC solve successful
2026-01-24 02:35:24,912 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:35:24,912 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1859 scenarios available
2026-01-24 02:35:25,031 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1859 trajectory groups with 18590 total points
2026-01-24 02:35:25,032 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:35:25,163 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:35:25,177 - INFO - integration_test - Step 7: Computed 6 numeric contouring constraints for visualization (s=1.260)
2026-01-24 02:35:25,177 - DEBUG - integration_test - Step 7: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:35:25,177 - INFO - integration_test - === Applying control at step 7 ===
2026-01-24 02:35:25,177 - INFO - integration_test -   Control dict from planner: {'a': 2.00000001939785, 'w': 0.7999999992195223}
2026-01-24 02:35:25,177 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:35:25,177 - INFO - integration_test -   Planner output success: True
2026-01-24 02:35:25,179 - INFO - integration_test - Step 7 completed in 4.720s
2026-01-24 02:35:25,241 - INFO - integration_test - Step 8 (contouring until path end)
2026-01-24 02:35:25,242 - DEBUG - integration_test - Syncing planner state at step 8: vehicle_state=[1.32243449 0.50942444 0.63999999 2.60000001 1.52000001]
2026-01-24 02:35:25,243 - DEBUG - integration_test - Step 8: Using propagated spline 1.5200 (close to path, dist=0.577m, drift=0.291m)
2026-01-24 02:35:25,243 - DEBUG - integration_test -   Set spline state to 1.5200
2026-01-24 02:35:25,243 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:35:26,145 - DEBUG - integration_test - Step 8: Checking path alignment: vehicle=(1.322, 0.509), path_start=(0.000, 0.000), dist=1.417m
2026-01-24 02:35:26,145 - INFO - integration_test - === Calling planner.solve_mpc() at step 8 ===
2026-01-24 02:35:27,074 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:35:27,102 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:35:27,103 - INFO - integration_test - Warmstart k=0: x0=1.3224344912365202 , y0=0.5094244365233307 , psi0=0.639999985620068 , v0=2.6000000137167008 , spline0=1.5200000063600023 , a0=0.0 , w0=0.0
2026-01-24 02:35:27,103 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:35:27,104 - INFO - integration_test - Dyn residual k=0: pred=[1.5309793916194308, 0.6646952490978463, 0.639999985620068, 2.6000000137167008, 1.7800000077316724], ws=[1.5309793916194308, 0.6646952490978463, 0.6399999856200678, 2.6000000137167008, 1.3696969712589238], res=[0.0, 0.0, 2.220446049250313e-16, 0.0, 0.4103030364727487], res_norm=4.103e-01
2026-01-24 02:35:27,105 - INFO - integration_test - Dyn residual k=1: pred=[1.7395242920023413, 0.8199660616723617, 0.6399999856200678, 2.6000000137167008, 1.6296969726305939], ws=[1.7395242920023413, 0.8199660616723619, 0.6399999856200678, 2.6000000137167008, 1.7066666688735377], res=[0.0, -1.1102230246251565e-16, 0.0, 0.0, -0.07696969624294381], res_norm=7.697e-02
2026-01-24 02:35:27,106 - INFO - integration_test - Dyn residual k=2: pred=[1.948069192385252, 0.9752368742468773, 0.6399999856200678, 2.6000000137167008, 1.9666666702452078], ws=[1.948069192385252, 0.9752368742468773, 0.6399999856200678, 2.6000000137167008, 2.0646464676090948], res=[0.0, 0.0, 0.0, 0.0, -0.09797979736388696], res_norm=9.798e-02
2026-01-24 02:35:27,124 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:28,213 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:28,236 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:28,287 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:28,310 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:28,360 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:28,382 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:28,432 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:28,455 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:28,504 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:28,529 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:28,577 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:28,600 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:28,653 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:28,677 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:28,729 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:28,751 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:28,798 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:28,820 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:28,871 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:28,893 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:28,945 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:29,613 - INFO - integration_test - Step 8: MPC solve successful
2026-01-24 02:35:29,619 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:35:29,619 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1869 scenarios available
2026-01-24 02:35:29,752 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1869 trajectory groups with 18690 total points
2026-01-24 02:35:29,752 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:35:29,910 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:35:29,923 - INFO - integration_test - Step 8: Computed 6 numeric contouring constraints for visualization (s=1.520)
2026-01-24 02:35:29,923 - DEBUG - integration_test - Step 8: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:35:29,923 - INFO - integration_test - === Applying control at step 8 ===
2026-01-24 02:35:29,923 - INFO - integration_test -   Control dict from planner: {'a': 2.000000019968966, 'w': 0.8000000036841414}
2026-01-24 02:35:29,923 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:35:29,923 - INFO - integration_test -   Planner output success: True
2026-01-24 02:35:29,925 - INFO - integration_test - Step 8 completed in 4.683s
2026-01-24 02:35:30,006 - INFO - integration_test - Step 9 (contouring until path end)
2026-01-24 02:35:30,008 - DEBUG - integration_test - Syncing planner state at step 9: vehicle_state=[1.53223933 0.67925693 0.71999999 2.80000002 1.80000001]
2026-01-24 02:35:30,009 - DEBUG - integration_test - Step 9: Using propagated spline 1.8000 (close to path, dist=0.602m, drift=0.161m)
2026-01-24 02:35:30,009 - DEBUG - integration_test -   Set spline state to 1.8000
2026-01-24 02:35:30,011 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:35:30,988 - DEBUG - integration_test - Step 9: Checking path alignment: vehicle=(1.532, 0.679), path_start=(0.000, 0.000), dist=1.676m
2026-01-24 02:35:30,988 - INFO - integration_test - === Calling planner.solve_mpc() at step 9 ===
2026-01-24 02:35:31,933 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:35:31,961 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:35:31,961 - INFO - integration_test - Warmstart k=0: x0=1.5322393343663103 , y0=0.6792569326121556 , psi0=0.7199999859884821 , v0=2.8000000157135974 , spline0=1.800000007931362 , a0=0.0 , w0=0.0
2026-01-24 02:35:31,961 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:35:31,962 - INFO - integration_test - Dyn residual k=0: pred=[1.7427449422940327, 0.8638846388507955, 0.7199999859884821, 2.8000000157135974, 2.080000009502722], ws=[1.7427449422940327, 0.8638846388507956, 0.719999985988482, 2.8000000157135974, 1.7163636386673267], res=[0.0, -1.1102230246251565e-16, 1.1102230246251565e-16, 0.0, 0.36363637083539513], res_norm=3.636e-01
2026-01-24 02:35:31,963 - INFO - integration_test - Dyn residual k=1: pred=[1.953250550221755, 1.0485123450894356, 0.719999985988482, 2.8000000157135974, 1.9963636402386864], ws=[1.953250550221755, 1.0485123450894356, 0.719999985988482, 2.8000000157135974, 2.0816161647482248], res=[0.0, 0.0, 0.0, 0.0, -0.08525252450953835], res_norm=8.525e-02
2026-01-24 02:35:31,964 - INFO - integration_test - Dyn residual k=2: pred=[2.1637561581494773, 1.2331400513280755, 0.719999985988482, 2.8000000157135974, 2.3616161663195845], ws=[2.1637561581494773, 1.2331400513280755, 0.719999985988482, 2.8000000157135974, 1.9292929324862225], res=[0.0, 0.0, 0.0, 0.0, 0.432323233833362], res_norm=4.323e-01
2026-01-24 02:35:31,980 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:33,051 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:33,072 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:33,118 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:33,140 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:33,186 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:33,207 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:33,254 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:33,275 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:33,320 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:33,341 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:33,386 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:33,408 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:33,453 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:33,473 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:33,547 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:33,574 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:33,623 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:33,646 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:33,692 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:33,714 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:33,757 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:34,366 - INFO - integration_test - Step 9: MPC solve successful
2026-01-24 02:35:34,373 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:35:34,373 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1867 scenarios available
2026-01-24 02:35:34,387 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1867 trajectory groups with 18670 total points
2026-01-24 02:35:34,389 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:35:34,622 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:35:34,637 - INFO - integration_test - Step 9: Computed 6 numeric contouring constraints for visualization (s=1.800)
2026-01-24 02:35:34,638 - DEBUG - integration_test - Step 9: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:35:34,638 - INFO - integration_test - === Applying control at step 9 ===
2026-01-24 02:35:34,638 - INFO - integration_test -   Control dict from planner: {'a': 2.000000019988171, 'w': 0.800000009679724}
2026-01-24 02:35:34,638 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:35:34,638 - INFO - integration_test -   Planner output success: True
2026-01-24 02:35:34,640 - INFO - integration_test - Step 9 completed in 4.632s
2026-01-24 02:35:34,707 - INFO - integration_test - Step 10 (contouring until path end)
2026-01-24 02:35:34,711 - DEBUG - integration_test - Syncing planner state at step 10: vehicle_state=[1.7422939  0.8790875  0.79999999 3.00000002 2.10000001]
2026-01-24 02:35:34,711 - DEBUG - integration_test - Step 10: Using propagated spline 2.1000 (close to path, dist=0.628m, drift=0.052m)
2026-01-24 02:35:34,711 - DEBUG - integration_test -   Set spline state to 2.1000
2026-01-24 02:35:34,712 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:35:35,706 - DEBUG - integration_test - Step 10: Checking path alignment: vehicle=(1.742, 0.879), path_start=(0.000, 0.000), dist=1.952m
2026-01-24 02:35:35,706 - INFO - integration_test - === Calling planner.solve_mpc() at step 10 ===
2026-01-24 02:35:36,843 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:35:36,869 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:35:36,869 - INFO - integration_test - Warmstart k=0: x0=1.7422939031810778 , y0=0.8790874995475869 , psi0=0.7999999869564546 , v0=3.0000000177124146 , spline0=2.1000000097026037 , a0=0.0 , w0=0.0
2026-01-24 02:35:36,869 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:35:36,870 - INFO - integration_test - Dyn residual k=0: pred=[1.9513059200263232, 1.094294325361797, 0.7999999869564546, 3.0000000177124146, 2.4000000114738453], ws=[1.9513059187922874, 1.094294324091186, 0.7999999869564545, 3.0, 2.0929292956734638], res=[1.2340357624651688e-09, 1.27061094978842e-09, 1.1102230246251565e-16, 1.7712414646098296e-08, 0.3070707158003816], res_norm=3.071e-01
2026-01-24 02:35:36,871 - INFO - integration_test - Dyn residual k=1: pred=[2.1603179344034973, 1.3095011486347852, 0.7999999869564545, 3.0, 2.392929295673464], ws=[2.1603179344034973, 1.3095011486347852, 0.7999999869564545, 3.0, 2.488888892025084], res=[0.0, 0.0, 0.0, 0.0, -0.09595959635161977], res_norm=9.596e-02
2026-01-24 02:35:36,872 - INFO - integration_test - Dyn residual k=2: pred=[2.369329950014707, 1.5247079731783844, 0.7999999869564545, 3.0, 2.788888892025084], ws=[2.369329950014707, 1.5247079731783844, 0.7999999869564545, 3.0, 2.34343434627652], res=[0.0, 0.0, 0.0, 0.0, 0.4454545457485639], res_norm=4.455e-01
2026-01-24 02:35:36,890 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:37,969 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:37,993 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:38,045 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:38,070 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:38,119 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:38,143 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:38,197 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:38,224 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:38,280 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:38,304 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:38,360 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:38,385 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:38,440 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:38,465 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:38,523 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:38,548 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:38,601 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:38,627 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:38,684 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:38,709 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:38,763 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:39,450 - INFO - integration_test - Step 10: MPC solve successful
2026-01-24 02:35:39,455 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:35:39,455 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1857 scenarios available
2026-01-24 02:35:39,469 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1857 trajectory groups with 18570 total points
2026-01-24 02:35:39,470 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:35:39,651 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:35:39,669 - INFO - integration_test - Step 10: Computed 6 numeric contouring constraints for visualization (s=2.100)
2026-01-24 02:35:39,669 - DEBUG - integration_test - Step 10: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:35:39,669 - INFO - integration_test - === Applying control at step 10 ===
2026-01-24 02:35:39,669 - INFO - integration_test -   Control dict from planner: {'a': 1.2287412298983808e-07, 'w': 0.8000000097883452}
2026-01-24 02:35:39,669 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:35:39,669 - INFO - integration_test -   Planner output success: True
2026-01-24 02:35:39,671 - INFO - integration_test - Step 10 completed in 4.960s
2026-01-24 02:35:39,732 - INFO - integration_test - Step 11 (contouring until path end)
2026-01-24 02:35:39,736 - DEBUG - integration_test - Syncing planner state at step 11: vehicle_state=[1.94247937 1.10242087 0.87999999 3.00000003 2.40000001]
2026-01-24 02:35:39,736 - DEBUG - integration_test - Step 11: Using propagated spline 2.4000 (close to path, dist=0.588m, drift=0.352m)
2026-01-24 02:35:39,736 - DEBUG - integration_test -   Set spline state to 2.4000
2026-01-24 02:35:39,737 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:35:40,809 - DEBUG - integration_test - Step 11: Checking path alignment: vehicle=(1.942, 1.102), path_start=(0.000, 0.000), dist=2.234m
2026-01-24 02:35:40,809 - INFO - integration_test - === Calling planner.solve_mpc() at step 11 ===
2026-01-24 02:35:41,770 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:35:41,799 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:35:41,799 - INFO - integration_test - Warmstart k=0: x0=1.9424793654148607 , y0=1.1024208712984942 , psi0=0.8799999879352891 , v0=3.000000029999827 , spline0=2.4000000127025864 , a0=0.0 , w0=0.0
2026-01-24 02:35:41,799 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:35:41,800 - INFO - integration_test - Dyn residual k=0: pred=[2.1336247133754997, 1.3336425349742749, 0.8799999879352891, 3.000000029999827, 2.700000015702569], ws=[2.133624711464057, 1.3336425326620716, 0.8799999879352889, 3.0, 2.4888888929947757], res=[1.9114425597877016e-09, 2.312203317700323e-09, 2.220446049250313e-16, 2.999982706697324e-08, 0.21111112270779353], res_norm=2.111e-01
2026-01-24 02:35:41,801 - INFO - integration_test - Dyn residual k=1: pred=[2.3247700575132537, 1.564864194025649, 0.8799999879352889, 3.0, 2.788888892994776], ws=[2.3247700575132537, 1.564864194025649, 0.8799999879352889, 3.0, 2.3434343471553025], res=[0.0, 0.0, 0.0, 0.0, 0.4454545458394734], res_norm=4.455e-01
2026-01-24 02:35:41,802 - INFO - integration_test - Dyn residual k=2: pred=[2.5159154035624502, 1.7960858553892263, 0.8799999879352889, 3.0, 2.643434347155303], ws=[2.5159154035624502, 1.7960858553892263, 0.8799999879352889, 3.0, 2.9343434388342478], res=[0.0, 0.0, 0.0, 0.0, -0.29090909167894496], res_norm=2.909e-01
2026-01-24 02:35:41,820 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:42,886 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:42,911 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:42,968 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:42,996 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:43,049 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:43,073 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:43,126 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:43,149 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:43,197 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:43,222 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:43,273 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:43,296 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:43,346 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:43,370 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:43,442 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:43,480 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:43,544 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:43,567 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:43,618 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:43,643 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:43,696 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:44,388 - INFO - integration_test - Step 11: MPC solve successful
2026-01-24 02:35:44,397 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:35:44,397 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1861 scenarios available
2026-01-24 02:35:44,412 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1861 trajectory groups with 18610 total points
2026-01-24 02:35:44,413 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:35:44,612 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:35:44,628 - INFO - integration_test - Step 11: Computed 6 numeric contouring constraints for visualization (s=2.400)
2026-01-24 02:35:44,628 - DEBUG - integration_test - Step 11: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:35:44,628 - INFO - integration_test - === Applying control at step 11 ===
2026-01-24 02:35:44,628 - INFO - integration_test -   Control dict from planner: {'a': -1.7545821522692265e-10, 'w': 0.0592819659741999}
2026-01-24 02:35:44,628 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:35:44,628 - INFO - integration_test -   Planner output success: True
2026-01-24 02:35:44,630 - INFO - integration_test - Step 11 completed in 4.894s
2026-01-24 02:35:44,695 - INFO - integration_test - Step 12 (contouring until path end)
2026-01-24 02:35:44,696 - DEBUG - integration_test - Syncing planner state at step 12: vehicle_state=[2.13293823 1.33420775 0.88592818 3.00000003 2.70000002]
2026-01-24 02:35:44,697 - DEBUG - integration_test - Step 12: Using propagated spline 2.7000 (close to path, dist=0.540m, drift=0.242m)
2026-01-24 02:35:44,697 - DEBUG - integration_test -   Set spline state to 2.7000
2026-01-24 02:35:44,697 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:35:45,818 - DEBUG - integration_test - Step 12: Checking path alignment: vehicle=(2.133, 1.334), path_start=(0.000, 0.000), dist=2.516m
2026-01-24 02:35:45,818 - INFO - integration_test - === Calling planner.solve_mpc() at step 12 ===
2026-01-24 02:35:46,735 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:35:46,776 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:35:46,777 - INFO - integration_test - Warmstart k=0: x0=2.132938232057674 , y0=1.3342077525938283 , psi0=0.885928184532709 , v0=3.000000029982281 , spline0=2.7000000157008146 , a0=0.0 , w0=0.0
2026-01-24 02:35:46,777 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:35:46,779 - INFO - integration_test - Dyn residual k=0: pred=[2.322709501816178, 1.5665584938734334, 0.885928184532709, 3.000000029982281, 3.0000000186990428], ws=[2.3227094999195863, 1.5665584915512982, 0.8859281845327089, 3.0, 2.343434348033572], res=[1.8965917725211057e-09, 2.322135150834015e-09, 1.1102230246251565e-16, 2.998228110229206e-08, 0.6565656706654708], res_norm=6.566e-01
2026-01-24 02:35:46,780 - INFO - integration_test - Dyn residual k=1: pred=[2.5124807677814984, 1.7989092305087682, 0.8859281845327089, 3.0, 2.643434348033572], ws=[2.5124807677814984, 1.7989092305087682, 0.8859281845327089, 3.0, 2.934343439894227], res=[0.0, 0.0, 0.0, 0.0, -0.29090909186065517], res_norm=2.909e-01
2026-01-24 02:35:46,782 - INFO - integration_test - Dyn residual k=2: pred=[2.7022520356434105, 2.031259969466238, 0.8859281845327089, 3.0, 3.234343439894227], ws=[2.7022520356434105, 2.0312599694662383, 0.8859281845327089, 3.0, 3.301010107036676], res=[0.0, -4.440892098500626e-16, 0.0, 0.0, -0.0666666671424494], res_norm=6.667e-02
2026-01-24 02:35:46,813 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:47,879 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:47,904 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:47,961 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:47,986 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:48,039 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:48,064 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:48,113 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:48,138 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:48,188 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:48,210 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:48,262 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:48,285 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:48,336 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:48,360 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:48,409 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:48,432 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:48,482 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:48,505 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:48,553 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:48,574 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:48,622 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:49,270 - INFO - integration_test - Step 12: MPC solve successful
2026-01-24 02:35:49,276 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:35:49,276 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1861 scenarios available
2026-01-24 02:35:49,291 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1861 trajectory groups with 18610 total points
2026-01-24 02:35:49,293 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:35:49,506 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:35:49,525 - INFO - integration_test - Step 12: Computed 6 numeric contouring constraints for visualization (s=2.700)
2026-01-24 02:35:49,525 - DEBUG - integration_test - Step 12: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:35:49,525 - INFO - integration_test - === Applying control at step 12 ===
2026-01-24 02:35:49,525 - INFO - integration_test -   Control dict from planner: {'a': -1.437241308946932e-06, 'w': -0.23432170717148962}
2026-01-24 02:35:49,525 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:35:49,525 - INFO - integration_test -   Planner output success: True
2026-01-24 02:35:49,527 - INFO - integration_test - Step 12 completed in 4.831s
2026-01-24 02:35:49,589 - INFO - integration_test - Step 13 (contouring until path end)
2026-01-24 02:35:49,590 - DEBUG - integration_test - Syncing planner state at step 13: vehicle_state=[2.32541425 1.56431395 0.86249601 2.99999989 3.        ]
2026-01-24 02:35:49,590 - DEBUG - integration_test - Step 13: Using propagated spline 3.0000 (close to path, dist=0.515m, drift=0.132m)
2026-01-24 02:35:49,591 - DEBUG - integration_test -   Set spline state to 3.0000
2026-01-24 02:35:49,591 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:35:50,737 - DEBUG - integration_test - Step 13: Checking path alignment: vehicle=(2.325, 1.564), path_start=(0.000, 0.000), dist=2.803m
2026-01-24 02:35:50,737 - INFO - integration_test - === Calling planner.solve_mpc() at step 13 ===
2026-01-24 02:35:51,696 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:35:51,726 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:35:51,726 - INFO - integration_test - Warmstart k=0: x0=2.325414248065154 , y0=1.5643139516492683 , psi0=0.8624960138155601 , v0=2.9999998862581503 , spline0=3.0000000043266297 , a0=0.0 , w0=0.0
2026-01-24 02:35:51,726 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:35:51,727 - INFO - integration_test - Dyn residual k=0: pred=[2.5205773963412854, 1.7921545510393635, 0.8624960138155601, 2.9999998862581503, 3.299999992952445], ws=[2.5205773963412854, 1.7921545510393635, 0.8624960138155604, 2.9999998862581503, 2.934343431851875], res=[0.0, 0.0, -3.3306690738754696e-16, 0.0, 0.36565656110057], res_norm=3.657e-01
2026-01-24 02:35:51,728 - INFO - integration_test - Dyn residual k=1: pred=[2.7157405446174168, 2.019995150429459, 0.8624960138155604, 2.9999998862581503, 3.23434342047769], ws=[2.7157405446174168, 2.019995150429459, 0.8624960138155604, 2.9999998862581503, 3.3010100939391305], res=[0.0, 0.0, 0.0, 0.0, -0.0666666734614405], res_norm=6.667e-02
2026-01-24 02:35:51,729 - INFO - integration_test - Dyn residual k=2: pred=[2.910903692893548, 2.2478357498195543, 0.8624960138155604, 2.9999998862581503, 3.6010100825649456], ws=[2.910903692893548, 2.2478357498195543, 0.8624960138155604, 2.9999998862581503, 3.685858573518859], res=[0.0, 0.0, 0.0, 0.0, -0.08484849095391356], res_norm=8.485e-02
2026-01-24 02:35:51,748 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:52,810 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:52,832 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:52,882 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:52,906 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:52,960 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:52,983 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:53,031 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:53,055 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:53,104 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:53,128 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:53,177 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:53,198 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:53,245 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:53,267 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:53,314 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:53,336 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:53,383 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:53,403 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:53,451 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:53,480 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:53,556 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:54,247 - INFO - integration_test - Step 13: MPC solve successful
2026-01-24 02:35:54,253 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:35:54,253 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1852 scenarios available
2026-01-24 02:35:54,269 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1852 trajectory groups with 18520 total points
2026-01-24 02:35:54,270 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:35:54,605 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:35:54,620 - INFO - integration_test - Step 13: Computed 6 numeric contouring constraints for visualization (s=3.000)
2026-01-24 02:35:54,621 - DEBUG - integration_test - Step 13: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:35:54,621 - INFO - integration_test - === Applying control at step 13 ===
2026-01-24 02:35:54,621 - INFO - integration_test -   Control dict from planner: {'a': 1.4374173746342728e-06, 'w': -0.12951215460428153}
2026-01-24 02:35:54,621 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:35:54,621 - INFO - integration_test -   Planner output success: True
2026-01-24 02:35:54,622 - INFO - integration_test - Step 13 completed in 5.033s
2026-01-24 02:35:54,682 - INFO - integration_test - Step 14 (contouring until path end)
2026-01-24 02:35:54,683 - DEBUG - integration_test - Syncing planner state at step 14: vehicle_state=[2.52204733 1.7908844  0.8495448  3.00000003 3.30000001]
2026-01-24 02:35:54,684 - DEBUG - integration_test - Step 14: Using propagated spline 3.3000 (close to path, dist=0.510m, drift=0.432m)
2026-01-24 02:35:54,684 - DEBUG - integration_test -   Set spline state to 3.3000
2026-01-24 02:35:54,685 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:35:55,603 - DEBUG - integration_test - Step 14: Checking path alignment: vehicle=(2.522, 1.791), path_start=(0.000, 0.000), dist=3.093m
2026-01-24 02:35:55,603 - INFO - integration_test - === Calling planner.solve_mpc() at step 14 ===
2026-01-24 02:35:56,598 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:35:56,627 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:35:56,627 - INFO - integration_test - Warmstart k=0: x0=2.5220473309198805 , y0=1.7908844047510581 , psi0=0.849544798355132 , v0=3.000000029999888 , spline0=3.3000000073266187 , a0=0.0 , w0=0.0
2026-01-24 02:35:56,627 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:35:56,628 - INFO - integration_test - Dyn residual k=0: pred=[2.720144851372532, 2.0161783775743554, 0.849544798355132, 3.000000029999888, 3.6000000103266077], ws=[2.720144849391564, 2.016178375321424, 0.8495447983551321, 3.0, 3.3010101038223385], res=[1.980967834214198e-09, 2.252931174950845e-09, -1.1102230246251565e-16, 2.999988790719499e-08, 0.29898990650426915], res_norm=2.990e-01
2026-01-24 02:35:56,629 - INFO - integration_test - Dyn residual k=1: pred=[2.9182423678632476, 2.2414723458917902, 0.8495447983551321, 3.0, 3.6010101038223388], ws=[2.9182423678632476, 2.2414723458917902, 0.8495447983551321, 3.0, 3.6858585888928417], res=[0.0, 0.0, 0.0, 0.0, -0.08484848507050291], res_norm=8.485e-02
2026-01-24 02:35:56,630 - INFO - integration_test - Dyn residual k=2: pred=[3.116339886334931, 2.4667663164621563, 0.8495447983551321, 3.0, 3.9858585888928415], ws=[3.116339886334931, 2.4667663164621563, 0.8495447983551321, 3.0, 3.810101013135266], res=[0.0, 0.0, 0.0, 0.0, 0.17575757575757534], res_norm=1.758e-01
2026-01-24 02:35:56,651 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:57,725 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:57,748 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:57,798 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:57,822 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:57,873 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:57,896 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:57,956 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:57,981 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:58,034 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:58,059 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:58,116 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:35:58,139 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:58,188 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:58,210 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:58,261 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:58,284 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:58,334 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:58,357 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:58,404 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:58,426 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:35:58,474 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:35:59,200 - INFO - integration_test - Step 14: MPC solve successful
2026-01-24 02:35:59,207 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:35:59,207 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1861 scenarios available
2026-01-24 02:35:59,223 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1861 trajectory groups with 18610 total points
2026-01-24 02:35:59,224 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:35:59,460 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:35:59,479 - INFO - integration_test - Step 14: Computed 6 numeric contouring constraints for visualization (s=3.300)
2026-01-24 02:35:59,479 - DEBUG - integration_test - Step 14: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:35:59,479 - INFO - integration_test - === Applying control at step 14 ===
2026-01-24 02:35:59,479 - INFO - integration_test -   Control dict from planner: {'a': -4.2048534226669935e-07, 'w': -0.15055588106127524}
2026-01-24 02:35:59,479 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:35:59,479 - INFO - integration_test -   Planner output success: True
2026-01-24 02:35:59,481 - INFO - integration_test - Step 14 completed in 4.798s
2026-01-24 02:35:59,547 - INFO - integration_test - Step 15 (contouring until path end)
2026-01-24 02:35:59,555 - DEBUG - integration_test - Syncing planner state at step 15: vehicle_state=[2.7218333  2.01467866 0.83448921 2.99999999 3.60000001]
2026-01-24 02:35:59,556 - DEBUG - integration_test - Step 15: Using propagated spline 3.6000 (close to path, dist=0.451m, drift=0.322m)
2026-01-24 02:35:59,556 - DEBUG - integration_test -   Set spline state to 3.6000
2026-01-24 02:35:59,557 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:36:00,718 - DEBUG - integration_test - Step 15: Checking path alignment: vehicle=(2.722, 2.015), path_start=(0.000, 0.000), dist=3.386m
2026-01-24 02:36:00,718 - INFO - integration_test - === Calling planner.solve_mpc() at step 15 ===
2026-01-24 02:36:01,789 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:36:01,814 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:36:01,814 - INFO - integration_test - Warmstart k=0: x0=2.7218333008320448 , y0=2.014678655683337 , psi0=0.8344892102490045 , v0=2.9999999879513535 , spline0=3.600000006121754 , a0=0.0 , w0=0.0
2026-01-24 02:36:01,814 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:36:01,815 - INFO - integration_test - Dyn residual k=0: pred=[2.923300172546956, 2.2369647300975672, 0.8344892102490045, 2.9999999879513535, 3.900000004916889], ws=[2.923300172546956, 2.2369647300975672, 0.8344892102490045, 2.9999999879513535, 3.6858585878948733], res=[0.0, 0.0, 0.0, 0.0, 0.21414141702201572], res_norm=2.141e-01
2026-01-24 02:36:01,816 - INFO - integration_test - Dyn residual k=1: pred=[3.1247670442618674, 2.4592508045117976, 0.8344892102490045, 2.9999999879513535, 3.9858585866900085], ws=[3.1247670442618674, 2.4592508045117976, 0.8344892102490045, 2.9999999879513535, 3.810101011638313], res=[0.0, 0.0, 0.0, 0.0, 0.17575757505169554], res_norm=1.758e-01
2026-01-24 02:36:01,817 - INFO - integration_test - Dyn residual k=2: pred=[3.3262339159767786, 2.681536878926028, 0.8344892102490045, 2.9999999879513535, 4.110101010433448], ws=[3.3262339159767786, 2.681536878926028, 0.8344892102490045, 2.9999999879513535, 3.9343434353817535], res=[0.0, 0.0, 0.0, 0.0, 0.17575757505169465], res_norm=1.758e-01
2026-01-24 02:36:01,832 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:02,768 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:02,790 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:02,835 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:02,858 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:02,902 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:02,926 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:02,980 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:03,002 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:03,052 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:03,076 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:03,125 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:03,147 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:03,195 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:03,217 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:03,266 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:03,289 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:03,340 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:03,364 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:03,415 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:03,438 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:03,492 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:04,236 - INFO - integration_test - Step 15: MPC solve successful
2026-01-24 02:36:04,248 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:36:04,248 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1861 scenarios available
2026-01-24 02:36:04,265 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1861 trajectory groups with 18610 total points
2026-01-24 02:36:04,266 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:36:04,528 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:36:04,543 - INFO - integration_test - Step 15: Computed 6 numeric contouring constraints for visualization (s=3.600)
2026-01-24 02:36:04,544 - DEBUG - integration_test - Step 15: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:36:04,544 - INFO - integration_test - === Applying control at step 15 ===
2026-01-24 02:36:04,544 - INFO - integration_test -   Control dict from planner: {'a': 4.199898713816479e-07, 'w': -0.13040980156280688}
2026-01-24 02:36:04,544 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:36:04,544 - INFO - integration_test -   Planner output success: True
2026-01-24 02:36:04,545 - INFO - integration_test - Step 15 completed in 4.990s
2026-01-24 02:36:04,625 - INFO - integration_test - Step 16 (contouring until path end)
2026-01-24 02:36:04,630 - DEBUG - integration_test - Syncing planner state at step 16: vehicle_state=[2.92474386 2.23564479 0.82144823 3.00000003 3.90000001]
2026-01-24 02:36:04,631 - DEBUG - integration_test - Step 16: Using propagated spline 3.9000 (close to path, dist=0.418m, drift=0.213m)
2026-01-24 02:36:04,631 - DEBUG - integration_test -   Set spline state to 3.9000
2026-01-24 02:36:04,632 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:36:05,630 - DEBUG - integration_test - Step 16: Checking path alignment: vehicle=(2.925, 2.236), path_start=(0.000, 0.000), dist=3.681m
2026-01-24 02:36:05,630 - INFO - integration_test - === Calling planner.solve_mpc() at step 16 ===
2026-01-24 02:36:06,598 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:36:06,628 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:36:06,628 - INFO - integration_test - Warmstart k=0: x0=2.9247438571393842 , y0=2.2356447869826876 , psi0=0.8214482300927238 , v0=3.0000000299503404 , spline0=3.9000000091167877 , a0=0.0 , w0=0.0
2026-01-24 02:36:06,628 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:36:06,630 - INFO - integration_test - Dyn residual k=0: pred=[3.129092346628431, 2.4552847119520917, 0.8214482300927238, 3.0000000299503404, 4.200000012111822], ws=[3.1290923445883285, 2.4552847097593284, 0.8214482300927237, 3.0, 3.8101010138766496], res=[2.0401023093086224e-09, 2.1927633042650996e-09, 1.1102230246251565e-16, 2.995034042996281e-08, 0.3898989982351724], res_norm=3.899e-01
2026-01-24 02:36:06,631 - INFO - integration_test - Dyn residual k=1: pred=[3.333440832037273, 2.674924632535969, 0.8214482300927237, 3.0, 4.110101013876649], ws=[3.333440832037273, 2.6749246325359692, 0.8214482300927237, 3.0, 3.9343434381190736], res=[0.0, -4.440892098500626e-16, 0.0, 0.0, 0.17575757575757578], res_norm=1.758e-01
2026-01-24 02:36:06,632 - INFO - integration_test - Dyn residual k=2: pred=[3.537789319486217, 2.8945645553126096, 0.8214482300927237, 3.0, 4.234343438119073], ws=[3.537789319486217, 2.89456455531261, 0.8214482300927237, 3.0, 4.058585862361498], res=[0.0, -4.440892098500626e-16, 0.0, 0.0, 0.17575757575757578], res_norm=1.758e-01
2026-01-24 02:36:06,649 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:07,802 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:07,825 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:07,877 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:07,900 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:07,953 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:07,977 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:08,027 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:08,050 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:08,101 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:08,124 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:08,173 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:08,195 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:08,243 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:08,267 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:08,318 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:08,340 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:08,391 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:08,416 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:08,467 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:08,492 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:08,542 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:09,155 - INFO - integration_test - Step 16: MPC solve successful
2026-01-24 02:36:09,162 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:36:09,162 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1854 scenarios available
2026-01-24 02:36:09,340 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1854 trajectory groups with 18540 total points
2026-01-24 02:36:09,341 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:36:09,565 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:36:09,580 - INFO - integration_test - Step 16: Computed 6 numeric contouring constraints for visualization (s=3.900)
2026-01-24 02:36:09,581 - DEBUG - integration_test - Step 16: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:36:09,581 - INFO - integration_test - === Applying control at step 16 ===
2026-01-24 02:36:09,581 - INFO - integration_test -   Control dict from planner: {'a': 4.916665332806941e-10, 'w': -0.1253084962661658}
2026-01-24 02:36:09,581 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:36:09,581 - INFO - integration_test -   Planner output success: True
2026-01-24 02:36:09,582 - INFO - integration_test - Step 16 completed in 4.953s
2026-01-24 02:36:09,637 - INFO - integration_test - Step 17 (contouring until path end)
2026-01-24 02:36:09,638 - DEBUG - integration_test - Syncing planner state at step 17: vehicle_state=[3.13046312 2.45399865 0.80891738 3.00000003 4.20000001]
2026-01-24 02:36:09,639 - DEBUG - integration_test - Step 17: Using propagated spline 4.2000 (close to path, dist=0.415m, drift=0.103m)
2026-01-24 02:36:09,639 - DEBUG - integration_test -   Set spline state to 4.2000
2026-01-24 02:36:09,640 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:36:10,626 - DEBUG - integration_test - Step 17: Checking path alignment: vehicle=(3.130, 2.454), path_start=(0.000, 0.000), dist=3.978m
2026-01-24 02:36:10,626 - INFO - integration_test - === Calling planner.solve_mpc() at step 17 ===
2026-01-24 02:36:11,632 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:36:11,662 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:36:11,662 - INFO - integration_test - Warmstart k=0: x0=3.1304631182282114 , y0=2.4539986506004423 , psi0=0.8089173804661073 , v0=3.000000029999507 , spline0=4.200000012116738 , a0=0.0 , w0=0.0
2026-01-24 02:36:11,662 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:36:11,663 - INFO - integration_test - Dyn residual k=0: pred=[3.337547767150991, 2.6710607384474443, 0.8089173804661073, 3.000000029999507, 4.500000015116688], ws=[3.3375477650801786, 2.6710607362768592, 0.8089173804661072, 3.0, 3.934343439361477], res=[2.0708124104373837e-09, 2.1705850450359776e-09, 1.1102230246251565e-16, 2.999950687865294e-08, 0.5656565757552112], res_norm=5.657e-01
2026-01-24 02:36:11,664 - INFO - integration_test - Dyn residual k=1: pred=[3.5446324119321457, 2.888122821953276, 0.8089173804661072, 3.0, 4.234343439361477], ws=[3.5446324119321457, 2.888122821953276, 0.8089173804661072, 3.0, 4.058585863603901], res=[0.0, 0.0, 0.0, 0.0, 0.17575757575757578], res_norm=1.758e-01
2026-01-24 02:36:11,665 - INFO - integration_test - Dyn residual k=2: pred=[3.751717058784113, 3.1051849076296927, 0.8089173804661072, 3.0, 4.358585863603901], ws=[3.751717058784113, 3.105184907629693, 0.8089173804661072, 3.0, 4.6454545575712825], res=[0.0, -4.440892098500626e-16, 0.0, 0.0, -0.28686869396738146], res_norm=2.869e-01
2026-01-24 02:36:11,683 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:12,739 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:12,763 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:12,816 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:12,839 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:12,894 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:12,918 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:12,975 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:13,001 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:13,052 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:13,077 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:13,128 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:13,151 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:13,200 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:13,222 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:13,271 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:13,296 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:13,346 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:13,368 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:13,417 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:13,440 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:13,488 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:14,278 - INFO - integration_test - Step 17: MPC solve successful
2026-01-24 02:36:14,285 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:36:14,285 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1852 scenarios available
2026-01-24 02:36:14,470 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1852 trajectory groups with 18520 total points
2026-01-24 02:36:14,471 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:36:14,695 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:36:14,710 - INFO - integration_test - Step 17: Computed 6 numeric contouring constraints for visualization (s=4.200)
2026-01-24 02:36:14,710 - DEBUG - integration_test - Step 17: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:36:14,710 - INFO - integration_test - === Applying control at step 17 ===
2026-01-24 02:36:14,710 - INFO - integration_test -   Control dict from planner: {'a': -6.658131951851045e-12, 'w': -0.1152474678594658}
2026-01-24 02:36:14,710 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:36:14,710 - INFO - integration_test -   Planner output success: True
2026-01-24 02:36:14,712 - INFO - integration_test - Step 17 completed in 5.073s
2026-01-24 02:36:14,770 - INFO - integration_test - Step 18 (contouring until path end)
2026-01-24 02:36:14,772 - DEBUG - integration_test - Syncing planner state at step 18: vehicle_state=[3.33879396 2.66986265 0.79739263 3.00000003 4.50000002]
2026-01-24 02:36:14,773 - DEBUG - integration_test - Step 18: Using propagated spline 4.5000 (close to path, dist=0.408m, drift=0.403m)
2026-01-24 02:36:14,773 - DEBUG - integration_test -   Set spline state to 4.5000
2026-01-24 02:36:14,774 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:36:15,771 - DEBUG - integration_test - Step 18: Checking path alignment: vehicle=(3.339, 2.670), path_start=(0.000, 0.000), dist=4.275m
2026-01-24 02:36:15,771 - INFO - integration_test - === Calling planner.solve_mpc() at step 18 ===
2026-01-24 02:36:16,767 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:36:16,794 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:36:16,794 - INFO - integration_test - Warmstart k=0: x0=3.338793961981667 , y0=2.6698626475939267 , psi0=0.7973926336801607 , v0=3.000000029998841 , spline0=4.500000015116623 , a0=0.0 , w0=0.0
2026-01-24 02:36:16,794 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:36:16,795 - INFO - integration_test - Dyn residual k=0: pred=[3.5483663888099373, 2.884523775218934, 0.7973926336801607, 3.000000029998841, 4.800000018116506], ws=[3.548366386714294, 2.884523773072406, 0.7973926336801607, 3.0, 4.058585864846278], res=[2.09564321451694e-09, 2.14652828844919e-09, 0.0, 2.999884118892737e-08, 0.7414141532702283], res_norm=7.414e-01
2026-01-24 02:36:16,796 - INFO - integration_test - Dyn residual k=1: pred=[3.757938811446921, 3.099184898550885, 0.7973926336801607, 3.0, 4.358585864846278], ws=[3.757938811446921, 3.099184898550885, 0.7973926336801607, 3.0, 4.645454560571167], res=[0.0, 0.0, 0.0, 0.0, -0.2868686957248894], res_norm=2.869e-01
2026-01-24 02:36:16,797 - INFO - integration_test - Dyn residual k=2: pred=[3.967511236179548, 3.313846024029364, 0.7973926336801607, 3.0, 4.945454560571167], ws=[3.967511236179548, 3.313846024029364, 0.7973926336801607, 3.0, 5.046464661581268], res=[0.0, 0.0, 0.0, 0.0, -0.10101010101010122], res_norm=1.010e-01
2026-01-24 02:36:16,815 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:17,890 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:17,912 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:17,967 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:17,994 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:18,044 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:18,067 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:18,117 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:18,140 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:18,192 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:18,217 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:18,271 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:18,296 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:18,344 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:18,367 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:18,414 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:18,436 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:18,484 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:18,507 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:18,555 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:18,576 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:18,624 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:19,367 - INFO - integration_test - Step 18: MPC solve successful
2026-01-24 02:36:19,377 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:36:19,377 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1858 scenarios available
2026-01-24 02:36:19,584 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1858 trajectory groups with 18580 total points
2026-01-24 02:36:19,585 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:36:19,901 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:36:19,919 - INFO - integration_test - Step 18: Computed 6 numeric contouring constraints for visualization (s=4.500)
2026-01-24 02:36:19,919 - DEBUG - integration_test - Step 18: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:36:19,919 - INFO - integration_test - === Applying control at step 18 ===
2026-01-24 02:36:19,919 - INFO - integration_test -   Control dict from planner: {'a': 1.0414706233586088e-11, 'w': -0.11209906838309061}
2026-01-24 02:36:19,919 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:36:19,919 - INFO - integration_test -   Planner output success: True
2026-01-24 02:36:19,921 - INFO - integration_test - Step 18 completed in 5.149s
2026-01-24 02:36:19,987 - INFO - integration_test - Step 19 (contouring until path end)
2026-01-24 02:36:19,990 - DEBUG - integration_test - Syncing planner state at step 19: vehicle_state=[3.54956515 2.88334465 0.78618273 3.00000003 4.80000002]
2026-01-24 02:36:19,990 - DEBUG - integration_test - Step 19: Using propagated spline 4.8000 (close to path, dist=0.357m, drift=0.293m)
2026-01-24 02:36:19,990 - DEBUG - integration_test -   Set spline state to 4.8000
2026-01-24 02:36:19,991 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:36:21,001 - DEBUG - integration_test - Step 19: Checking path alignment: vehicle=(3.550, 2.883), path_start=(0.000, 0.000), dist=4.573m
2026-01-24 02:36:21,001 - INFO - integration_test - === Calling planner.solve_mpc() at step 19 ===
2026-01-24 02:36:21,965 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:36:21,996 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:36:21,996 - INFO - integration_test - Warmstart k=0: x0=3.5495651526452052 , y0=2.8833446480671916 , psi0=0.7861827268418516 , v0=3.0000000299998826 , spline0=4.800000018116611 , a0=0.0 , w0=0.0
2026-01-24 02:36:21,996 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:36:21,997 - INFO - integration_test - Dyn residual k=0: pred=[3.7615306928104966, 3.0956430502807484, 0.7861827268418516, 3.0000000299998826, 5.1000000211166], ws=[3.7615306906908494, 3.095643048157773, 0.7861827268418518, 3.0, 4.645454563571156], res=[2.1196471244877557e-09, 2.122975573115582e-09, -1.1102230246251565e-16, 2.999988257812447e-08, 0.45454545754544373], res_norm=4.545e-01
2026-01-24 02:36:21,998 - INFO - integration_test - Dyn residual k=1: pred=[3.9734962287364937, 3.307941448248354, 0.7861827268418518, 3.0, 4.945454563571156], ws=[3.9734962287364937, 3.307941448248354, 0.7861827268418518, 3.0, 5.046464664581257], res=[0.0, 0.0, 0.0, 0.0, -0.10101010101010122], res_norm=1.010e-01
2026-01-24 02:36:21,998 - INFO - integration_test - Dyn residual k=2: pred=[4.185461766782138, 3.520239848338935, 0.7861827268418518, 3.0, 5.346464664581257], ws=[4.185461766782138, 3.520239848338935, 0.7861827268418518, 3.0, 5.144444462561055], res=[0.0, 0.0, 0.0, 0.0, 0.20202020202020154], res_norm=2.020e-01
2026-01-24 02:36:22,015 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:23,011 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:23,034 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:23,079 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:23,103 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:23,149 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:23,169 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:23,219 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:23,240 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:23,288 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:23,310 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:23,353 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:23,376 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:23,421 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:23,442 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:23,488 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:23,509 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:23,555 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:23,577 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:23,621 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:23,643 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:23,699 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:24,445 - INFO - integration_test - Step 19: MPC solve successful
2026-01-24 02:36:24,455 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:36:24,455 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1862 scenarios available
2026-01-24 02:36:24,472 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1862 trajectory groups with 18620 total points
2026-01-24 02:36:24,473 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:36:24,804 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:36:24,824 - INFO - integration_test - Step 19: Computed 6 numeric contouring constraints for visualization (s=4.800)
2026-01-24 02:36:24,825 - DEBUG - integration_test - Step 19: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:36:24,825 - INFO - integration_test - === Applying control at step 19 ===
2026-01-24 02:36:24,825 - INFO - integration_test -   Control dict from planner: {'a': -4.6451061008780244e-10, 'w': -0.10274023355847056}
2026-01-24 02:36:24,825 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:36:24,825 - INFO - integration_test -   Planner output success: True
2026-01-24 02:36:24,827 - INFO - integration_test - Step 19 completed in 4.838s
2026-01-24 02:36:24,894 - INFO - integration_test - Step 20 (contouring until path end)
2026-01-24 02:36:24,896 - DEBUG - integration_test - Syncing planner state at step 20: vehicle_state=[3.76261753 3.09455046 0.7759087  3.00000003 5.10000002]
2026-01-24 02:36:24,897 - DEBUG - integration_test - Step 20: Using propagated spline 5.1000 (close to path, dist=0.338m, drift=0.184m)
2026-01-24 02:36:24,897 - DEBUG - integration_test -   Set spline state to 5.1000
2026-01-24 02:36:24,897 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:36:26,113 - DEBUG - integration_test - Step 20: Checking path alignment: vehicle=(3.763, 3.095), path_start=(0.000, 0.000), dist=4.872m
2026-01-24 02:36:26,113 - INFO - integration_test - === Calling planner.solve_mpc() at step 20 ===
2026-01-24 02:36:27,066 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:36:27,095 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:36:27,095 - INFO - integration_test - Warmstart k=0: x0=3.762617533584295 , y0=3.0945504555431724 , psi0=0.7759087034860046 , v0=3.0000000299534317 , spline0=5.1000000211119545 , a0=0.0 , w0=0.0
2026-01-24 02:36:27,095 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:36:27,096 - INFO - integration_test - Dyn residual k=0: pred=[3.976753007145178, 3.3046599526156806, 0.7759087034860046, 3.0000000299534317, 5.400000024107298], ws=[3.976753005007147, 3.304659950517847, 0.7759087034860048, 3.0, 5.0464646675766005], res=[2.1380310855079188e-09, 2.0978334624999206e-09, -2.220446049250313e-16, 2.9953431734952574e-08, 0.35353535653069734], res_norm=3.535e-01
2026-01-24 02:36:27,097 - INFO - integration_test - Dyn residual k=1: pred=[4.19088847643, 3.514769445492522, 0.7759087034860048, 3.0, 5.3464646675766], ws=[4.19088847643, 3.514769445492522, 0.7759087034860048, 3.0, 5.144444465556399], res=[0.0, 0.0, 0.0, 0.0, 0.20202020202020154], res_norm=2.020e-01
2026-01-24 02:36:27,097 - INFO - integration_test - Dyn residual k=2: pred=[4.405023947852852, 3.7248789404671965, 0.7759087034860048, 3.0, 5.444444465556399], ws=[4.405023947852852, 3.7248789404671965, 0.7759087034860048, 3.0, 5.747474768586701], res=[0.0, 0.0, 0.0, 0.0, -0.30303030303030276], res_norm=3.030e-01
2026-01-24 02:36:27,114 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:28,175 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:28,198 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:28,246 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:28,270 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:28,322 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:28,347 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:28,398 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:28,425 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:28,477 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:28,502 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:28,553 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:28,578 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:28,627 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:28,649 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:28,702 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:28,725 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:28,776 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:28,799 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:28,848 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:28,871 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:28,922 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:29,615 - INFO - integration_test - Step 20: MPC solve successful
2026-01-24 02:36:29,631 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:36:29,631 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1873 scenarios available
2026-01-24 02:36:29,648 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1873 trajectory groups with 18730 total points
2026-01-24 02:36:29,649 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:36:29,960 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:36:29,977 - INFO - integration_test - Step 20: Computed 6 numeric contouring constraints for visualization (s=5.100)
2026-01-24 02:36:29,977 - DEBUG - integration_test - Step 20: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:36:29,977 - INFO - integration_test - === Applying control at step 20 ===
2026-01-24 02:36:29,977 - INFO - integration_test -   Control dict from planner: {'a': 4.6454315087708556e-10, 'w': -0.08742392123092912}
2026-01-24 02:36:29,977 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:36:29,977 - INFO - integration_test -   Planner output success: True
2026-01-24 02:36:29,979 - INFO - integration_test - Step 20 completed in 5.083s
2026-01-24 02:36:30,033 - INFO - integration_test - Step 21 (contouring until path end)
2026-01-24 02:36:30,037 - DEBUG - integration_test - Syncing planner state at step 21: vehicle_state=[3.9776687  3.30372125 0.76716631 3.00000003 5.40000002]
2026-01-24 02:36:30,038 - DEBUG - integration_test - Step 21: Using propagated spline 5.4000 (close to path, dist=0.356m, drift=0.074m)
2026-01-24 02:36:30,038 - DEBUG - integration_test -   Set spline state to 5.4000
2026-01-24 02:36:30,038 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:36:30,977 - DEBUG - integration_test - Step 21: Checking path alignment: vehicle=(3.978, 3.304), path_start=(0.000, 0.000), dist=5.171m
2026-01-24 02:36:30,977 - INFO - integration_test - === Calling planner.solve_mpc() at step 21 ===
2026-01-24 02:36:31,952 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:36:31,981 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:36:31,981 - INFO - integration_test - Warmstart k=0: x0=3.977668703405887 , y0=3.303721254026441 , psi0=0.7671663113629117 , v0=3.000000029999886 , spline0=5.400000024111943 , a0=0.0 , w0=0.0
2026-01-24 02:36:31,981 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:36:31,982 - INFO - integration_test - Dyn residual k=0: pred=[4.193632830111137, 3.511950689449082, 0.7671663113629117, 3.000000029999886, 5.7000000271119315], ws=[4.193632827951504, 3.511950687366795, 0.7671663113629119, 3.0, 5.1444444685563875], res=[2.159633361031865e-09, 2.0822867874414897e-09, -2.220446049250313e-16, 2.999988613083815e-08, 0.5555555585555441], res_norm=5.556e-01
2026-01-24 02:36:31,983 - INFO - integration_test - Dyn residual k=1: pred=[4.409596952497121, 3.7201801207071497, 0.7671663113629119, 3.0, 5.444444468556387], ws=[4.409596952497121, 3.7201801207071497, 0.7671663113629119, 3.0, 5.74747477158669], res=[0.0, 0.0, 0.0, 0.0, -0.30303030303030276], res_norm=3.030e-01
2026-01-24 02:36:31,984 - INFO - integration_test - Dyn residual k=2: pred=[4.625561077042738, 3.928409554047504, 0.7671663113629119, 3.0, 6.04747477158669], ws=[4.625561077042738, 3.928409554047504, 0.7671663113629119, 3.0, 5.643434367546286], res=[0.0, 0.0, 0.0, 0.0, 0.404040404040404], res_norm=4.040e-01
2026-01-24 02:36:32,002 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:33,078 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:33,102 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:33,153 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:33,178 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:33,229 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:33,255 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:33,308 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:33,332 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:33,383 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:33,407 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:33,458 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:33,482 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:33,556 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:33,592 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:33,649 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:33,671 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:33,725 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:33,762 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:33,838 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:33,863 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:33,915 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:34,682 - INFO - integration_test - Step 21: MPC solve successful
2026-01-24 02:36:34,692 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:36:34,692 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1867 scenarios available
2026-01-24 02:36:34,924 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1867 trajectory groups with 18670 total points
2026-01-24 02:36:34,925 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:36:35,290 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:36:35,319 - INFO - integration_test - Step 21: Computed 6 numeric contouring constraints for visualization (s=5.400)
2026-01-24 02:36:35,319 - DEBUG - integration_test - Step 21: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:36:35,319 - INFO - integration_test - === Applying control at step 21 ===
2026-01-24 02:36:35,319 - INFO - integration_test -   Control dict from planner: {'a': -4.942612848454958e-07, 'w': -0.10158182872469941}
2026-01-24 02:36:35,319 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:36:35,319 - INFO - integration_test -   Planner output success: True
2026-01-24 02:36:35,321 - INFO - integration_test - Step 21 completed in 5.284s
2026-01-24 02:36:35,394 - INFO - integration_test - Step 22 (contouring until path end)
2026-01-24 02:36:35,396 - DEBUG - integration_test - Syncing planner state at step 22: vehicle_state=[4.19468672 3.51085021 0.75700813 2.99999998 5.70000002]
2026-01-24 02:36:35,397 - DEBUG - integration_test - Step 22: Using propagated spline 5.7000 (close to path, dist=0.336m, drift=0.374m)
2026-01-24 02:36:35,397 - DEBUG - integration_test -   Set spline state to 5.7000
2026-01-24 02:36:35,398 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:36:36,427 - DEBUG - integration_test - Step 22: Checking path alignment: vehicle=(4.195, 3.511), path_start=(0.000, 0.000), dist=5.470m
2026-01-24 02:36:36,427 - INFO - integration_test - === Calling planner.solve_mpc() at step 22 ===
2026-01-24 02:36:37,383 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:36:37,410 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:36:37,411 - INFO - integration_test - Warmstart k=0: x0=4.194686721412742 , y0=3.510850214497486 , psi0=0.7570081284904417 , v0=2.9999999805737576 , spline0=5.700000022169319 , a0=0.0 , w0=0.0
2026-01-24 02:36:37,411 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:36:37,412 - INFO - integration_test - Dyn residual k=0: pred=[4.412754898401181, 3.716875137794073, 0.7570081284904417, 2.9999999805737576, 6.000000020226695], ws=[4.412754898401181, 3.716875137794073, 0.7570081284904417, 2.9999999805737576, 5.747474767701442], res=[0.0, 0.0, 0.0, 0.0, 0.2525252525252526], res_norm=2.525e-01
2026-01-24 02:36:37,412 - INFO - integration_test - Dyn residual k=1: pred=[4.630823075389619, 3.92290006109066, 0.7570081284904417, 2.9999999805737576, 6.047474765758818], ws=[4.630823075389619, 3.92290006109066, 0.7570081284904417, 2.9999999805737576, 5.643434361718414], res=[0.0, 0.0, 0.0, 0.0, 0.404040404040404], res_norm=4.040e-01
2026-01-24 02:36:37,413 - INFO - integration_test - Dyn residual k=2: pred=[4.848891252378058, 4.128924984387247, 0.7570081284904417, 2.9999999805737576, 5.94343435977579], ws=[4.848891252378058, 4.128924984387247, 0.7570081284904417, 2.9999999805737576, 6.246464662806093], res=[0.0, 0.0, 0.0, 0.0, -0.30303030303030276], res_norm=3.030e-01
2026-01-24 02:36:37,430 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:38,417 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:38,437 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:38,481 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:38,505 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:38,551 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:38,573 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:38,619 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:38,641 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:38,686 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:38,709 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:38,755 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:38,777 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:38,826 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:38,846 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:38,895 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:38,917 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:38,965 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:38,988 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:39,038 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:39,061 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:39,114 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:39,831 - INFO - integration_test - Step 22: MPC solve successful
2026-01-24 02:36:39,842 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:36:39,842 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1863 scenarios available
2026-01-24 02:36:40,100 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1863 trajectory groups with 18630 total points
2026-01-24 02:36:40,101 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:36:40,650 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:36:40,676 - INFO - integration_test - Step 22: Computed 6 numeric contouring constraints for visualization (s=5.700)
2026-01-24 02:36:40,677 - DEBUG - integration_test - Step 22: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:36:40,677 - INFO - integration_test - === Applying control at step 22 ===
2026-01-24 02:36:40,677 - INFO - integration_test -   Control dict from planner: {'a': 2.7266185155527134e-07, 'w': -0.8000000054297124}
2026-01-24 02:36:40,677 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:36:40,677 - INFO - integration_test -   Planner output success: True
2026-01-24 02:36:40,678 - INFO - integration_test - Step 22 completed in 5.282s
2026-01-24 02:36:40,753 - INFO - integration_test - Step 23 (contouring until path end)
2026-01-24 02:36:40,759 - DEBUG - integration_test - Syncing planner state at step 23: vehicle_state=[4.42075897 3.70793738 0.67700813 3.00000001 6.00000002]
2026-01-24 02:36:40,760 - DEBUG - integration_test - Step 23: Using propagated spline 6.0000 (close to path, dist=0.304m, drift=0.264m)
2026-01-24 02:36:40,760 - DEBUG - integration_test -   Set spline state to 6.0000
2026-01-24 02:36:40,761 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:36:41,841 - DEBUG - integration_test - Step 23: Checking path alignment: vehicle=(4.421, 3.708), path_start=(0.000, 0.000), dist=5.770m
2026-01-24 02:36:41,842 - INFO - integration_test - === Calling planner.solve_mpc() at step 23 ===
2026-01-24 02:36:42,798 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:36:42,827 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:36:42,827 - INFO - integration_test - Warmstart k=0: x0=4.420758973747205 , y0=3.7079373758609813 , psi0=0.6770081279474705 , v0=3.000000007839943 , spline0=6.000000022953313 , a0=0.0 , w0=0.0
2026-01-24 02:36:42,827 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:36:42,828 - INFO - integration_test - Dyn residual k=0: pred=[4.654594125582161, 3.895876520896601, 0.6770081279474705, 3.000000007839943, 6.300000023737307], ws=[4.6545941249710765, 3.895876520405457, 0.6770081279474702, 3.0, 5.643434366387656], res=[6.110845163220802e-10, 4.911440143473556e-10, 2.220446049250313e-16, 7.839942917087228e-09, 0.6565656573496508], res_norm=6.566e-01
2026-01-24 02:36:42,829 - INFO - integration_test - Dyn residual k=1: pred=[4.888429276194948, 4.083815664949932, 0.6770081279474702, 3.0, 5.943434366387656], ws=[4.888429276194948, 4.083815664949932, 0.6770081279474702, 3.0, 6.246464669417959], res=[0.0, 0.0, 0.0, 0.0, -0.30303030303030276], res_norm=3.030e-01
2026-01-24 02:36:42,830 - INFO - integration_test - Dyn residual k=2: pred=[5.12226442741882, 4.271754809494407, 0.6770081279474702, 3.0, 6.546464669417959], ws=[5.12226442741882, 4.271754809494407, 0.6770081279474702, 3.0, 6.344444467397757], res=[0.0, 0.0, 0.0, 0.0, 0.20202020202020154], res_norm=2.020e-01
2026-01-24 02:36:42,846 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:43,800 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:43,823 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:43,868 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:43,891 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:43,941 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:43,991 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:44,061 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:44,086 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:44,141 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:44,166 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:44,218 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:44,243 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:44,295 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:44,319 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:44,374 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:44,400 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:44,454 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:44,477 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:44,532 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:44,555 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:44,604 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:45,356 - INFO - integration_test - Step 23: MPC solve successful
2026-01-24 02:36:45,366 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:36:45,366 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1857 scenarios available
2026-01-24 02:36:45,382 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1857 trajectory groups with 18570 total points
2026-01-24 02:36:45,383 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:36:45,823 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:36:45,847 - INFO - integration_test - Step 23: Computed 6 numeric contouring constraints for visualization (s=6.000)
2026-01-24 02:36:45,847 - DEBUG - integration_test - Step 23: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:36:45,848 - INFO - integration_test - === Applying control at step 23 ===
2026-01-24 02:36:45,848 - INFO - integration_test -   Control dict from planner: {'a': -2.000000018405861, 'w': -0.800000008817501}
2026-01-24 02:36:45,848 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:36:45,848 - INFO - integration_test -   Planner output success: True
2026-01-24 02:36:45,849 - INFO - integration_test - Step 23 completed in 5.091s
2026-01-24 02:36:45,925 - INFO - integration_test - Step 24 (contouring until path end)
2026-01-24 02:36:45,928 - DEBUG - integration_test - Syncing planner state at step 24: vehicle_state=[4.65374241 3.88048851 0.59700813 2.80000001 6.28000002]
2026-01-24 02:36:45,929 - DEBUG - integration_test - Step 24: Using propagated spline 6.2800 (close to path, dist=0.332m, drift=0.135m)
2026-01-24 02:36:45,929 - DEBUG - integration_test -   Set spline state to 6.2800
2026-01-24 02:36:45,929 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:36:46,935 - DEBUG - integration_test - Step 24: Checking path alignment: vehicle=(4.654, 3.880), path_start=(0.000, 0.000), dist=6.059m
2026-01-24 02:36:46,935 - INFO - integration_test - === Calling planner.solve_mpc() at step 24 ===
2026-01-24 02:36:47,943 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:36:47,973 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:36:47,973 - INFO - integration_test - Warmstart k=0: x0=4.653742411767896 , y0=3.8804885114763032 , psi0=0.5970081270657204 , v0=2.800000005999357 , spline0=6.2800000235532485 , a0=0.0 , w0=0.0
2026-01-24 02:36:47,973 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:36:47,975 - INFO - integration_test - Dyn residual k=0: pred=[4.8853083642271296, 4.037896293995503, 0.5970081270657204, 2.800000005999357, 6.560000024153184], ws=[4.8853083642271296, 4.037896293995503, 0.5970081270657204, 2.800000005999357, 6.20646467061783], res=[0.0, 0.0, 0.0, 0.0, 0.3535353535353538], res_norm=3.535e-01
2026-01-24 02:36:47,976 - INFO - integration_test - Dyn residual k=1: pred=[5.1168743166863635, 4.195304076514703, 0.5970081270657204, 2.800000005999357, 6.486464671217766], ws=[5.1168743166863635, 4.195304076514703, 0.5970081270657204, 2.800000005999357, 6.587474772227867], res=[0.0, 0.0, 0.0, 0.0, -0.10101010101010122], res_norm=1.010e-01
2026-01-24 02:36:47,977 - INFO - integration_test - Dyn residual k=2: pred=[5.3484402691455974, 4.352711859033903, 0.5970081270657204, 2.800000005999357, 6.867474772827802], ws=[5.2560678291761205, 4.237982206646863, 0.5970081270657204, 2.800000005999357, 6.6654545708076], res=[0.09237243996947697, 0.11472965238704003, 0.0, 0.0, 0.20202020202020243], res_norm=2.500e-01
2026-01-24 02:36:47,996 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:49,237 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:49,261 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:49,313 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:49,338 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:49,389 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:49,414 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:49,465 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:49,489 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:49,541 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:49,564 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:49,613 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:49,638 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:49,689 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:49,713 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:49,761 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:49,784 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:49,834 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:49,857 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:49,906 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:49,931 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:49,983 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:50,685 - INFO - integration_test - Step 24: MPC solve successful
2026-01-24 02:36:50,696 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:36:50,696 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1859 scenarios available
2026-01-24 02:36:50,711 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1859 trajectory groups with 18590 total points
2026-01-24 02:36:50,712 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:36:51,089 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:36:51,114 - INFO - integration_test - Step 24: Computed 6 numeric contouring constraints for visualization (s=6.280)
2026-01-24 02:36:51,114 - DEBUG - integration_test - Step 24: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:36:51,114 - INFO - integration_test - === Applying control at step 24 ===
2026-01-24 02:36:51,114 - INFO - integration_test -   Control dict from planner: {'a': -2.000000015369955, 'w': -0.8000000094928453}
2026-01-24 02:36:51,114 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:36:51,114 - INFO - integration_test -   Planner output success: True
2026-01-24 02:36:51,116 - INFO - integration_test - Step 24 completed in 5.188s
2026-01-24 02:36:51,181 - INFO - integration_test - Step 25 (contouring until path end)
2026-01-24 02:36:51,183 - DEBUG - integration_test - Syncing planner state at step 25: vehicle_state=[4.88279779 4.02329882 0.51700813 2.6        6.54000002]
2026-01-24 02:36:51,183 - DEBUG - integration_test - Step 25: Using propagated spline 6.5400 (close to path, dist=0.404m, drift=0.395m)
2026-01-24 02:36:51,183 - DEBUG - integration_test -   Set spline state to 6.5400
2026-01-24 02:36:51,184 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:36:52,082 - DEBUG - integration_test - Step 25: Checking path alignment: vehicle=(4.883, 4.023), path_start=(0.000, 0.000), dist=6.327m
2026-01-24 02:36:52,082 - INFO - integration_test - === Calling planner.solve_mpc() at step 25 ===
2026-01-24 02:36:52,963 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:36:52,990 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:36:52,990 - INFO - integration_test - Warmstart k=0: x0=4.882797786897395 , y0=4.023298817618116 , psi0=0.5170081261164359 , v0=2.6000000044623612 , spline0=6.540000023999484 , a0=0.0 , w0=0.0
2026-01-24 02:36:52,990 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:36:52,991 - INFO - integration_test - Dyn residual k=0: pred=[5.108816280274279, 4.151812011040762, 0.5170081261164359, 2.6000000044623612, 6.80000002444572], ws=[5.108816280274279, 4.151812011040762, 0.5170081261164361, 2.6000000044623612, 6.345454569900265], res=[0.0, 0.0, -2.220446049250313e-16, 0.0, 0.45454545454545503], res_norm=4.545e-01
2026-01-24 02:36:52,992 - INFO - integration_test - Dyn residual k=1: pred=[5.334834773651163, 4.2803252044634075, 0.5170081261164361, 2.6000000044623612, 6.605454570346501], ws=[4.996734956053864, 4.068403904317493, 0.5170081261164361, 2.6000000044623612, 5.999393964285895], res=[0.3380998175972998, 0.2119213001459146, 0.0, 0.0, 0.6060606060606055], res_norm=7.256e-01
2026-01-24 02:36:52,993 - INFO - integration_test - Dyn residual k=2: pred=[5.222753449430748, 4.196917097740139, 0.5170081261164361, 2.6000000044623612, 6.259393964732131], ws=[5.654068103654067, 3.87829080196192, 0.5170081261164361, 2.6000000044623612, 6.663434368772535], res=[-0.4313146542233195, 0.31862629577821844, 0.0, 0.0, -0.404040404040404], res_norm=6.714e-01
2026-01-24 02:36:53,009 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:54,082 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:54,106 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:54,157 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:54,180 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:54,231 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:54,254 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:54,304 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:54,329 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:54,381 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:54,404 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:54,453 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:36:54,477 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:54,527 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:54,550 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:54,597 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:54,619 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:54,673 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:54,697 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:54,749 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:36:54,773 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:36:54,823 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:37:00,615 - WARNING - integration_test - Step 25: MPC solve failed
2026-01-24 02:37:00,615 - WARNING - integration_test -   Consecutive MPC failures: 1/20
2026-01-24 02:37:00,633 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:37:00,634 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1854 scenarios available
2026-01-24 02:37:00,894 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1854 trajectory groups with 18540 total points
2026-01-24 02:37:00,895 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:37:01,521 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:37:01,548 - INFO - integration_test - Step 25: Computed 6 numeric contouring constraints for visualization (s=6.540)
2026-01-24 02:37:01,548 - DEBUG - integration_test - Step 25: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:37:01,549 - INFO - integration_test - === Applying control at step 25 ===
2026-01-24 02:37:01,549 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': 0.8}
2026-01-24 02:37:01,549 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:37:01,549 - INFO - integration_test -   Planner output success: False
2026-01-24 02:37:01,549 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': 0.8}
2026-01-24 02:37:01,550 - INFO - integration_test - Step 25 completed in 10.368s
2026-01-24 02:37:01,624 - INFO - integration_test - Step 26 (contouring until path end)
2026-01-24 02:37:01,626 - DEBUG - integration_test - Syncing planner state at step 26: vehicle_state=[5.09502181 4.15531267 0.59700813 2.4        6.78000002]
2026-01-24 02:37:01,627 - DEBUG - integration_test - Step 26: Using propagated spline 6.7800 (close to path, dist=0.395m, drift=0.225m)
2026-01-24 02:37:01,627 - DEBUG - integration_test -   Set spline state to 6.7800
2026-01-24 02:37:01,628 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:37:02,611 - DEBUG - integration_test - Step 26: Checking path alignment: vehicle=(5.095, 4.155), path_start=(0.000, 0.000), dist=6.575m
2026-01-24 02:37:02,611 - INFO - integration_test - === Calling planner.solve_mpc() at step 26 ===
2026-01-24 02:37:03,587 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:37:03,614 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:37:03,614 - INFO - integration_test - Warmstart k=0: x0=5.095021812865501 , y0=4.155312666692066 , psi0=0.5970081261164358 , v0=2.400000004462361 , spline0=6.78000002444572 , a0=0.0 , w0=0.0
2026-01-24 02:37:03,615 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:37:03,615 - INFO - integration_test - Dyn residual k=0: pred=[5.293506915045262, 4.290233622910452, 0.5970081261164358, 2.400000004462361, 7.0200000248919565], ws=[5.176463086982224, 4.208058423185038, 0.5970081261164357, 2.400000004462361, 6.3634343683263], res=[0.11704382806303748, 0.08217519972541343, 1.1102230246251565e-16, 0.0, 0.6565656565656566], res_norm=6.720e-01
2026-01-24 02:37:03,616 - INFO - integration_test - Dyn residual k=1: pred=[5.374948189161985, 4.342979379403424, 0.5970081261164357, 2.400000004462361, 6.603434368772536], ws=[5.491992017225022, 4.425154579128837, 0.5970081261164357, 2.400000004462361, 7.00747477281294], res=[-0.11704382806303748, -0.08217519972541343, 0.0, 0.0, -0.404040404040404], res_norm=4.286e-01
2026-01-24 02:37:03,617 - INFO - integration_test - Dyn residual k=2: pred=[5.6904771194047825, 4.560075535347223, 0.5970081261164357, 2.400000004462361, 7.247474773259176], ws=[5.005122140203378, 4.134831107601575, 0.5970081261164357, 2.400000004462361, 6.035353561137964], res=[0.6853549792014046, 0.42524442774564797, 0.0, 0.0, 1.212121212121212], res_norm=1.456e+00
2026-01-24 02:37:03,635 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:04,742 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:37:04,768 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:04,824 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:37:04,851 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:04,907 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:37:04,948 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:05,027 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:37:05,051 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:05,100 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:37:05,125 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:05,175 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:37:05,196 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:05,245 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:37:05,268 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:05,320 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:37:05,345 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:05,397 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:37:05,421 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:05,471 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:37:05,494 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:05,542 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:37:11,436 - WARNING - integration_test - Step 26: MPC solve failed
2026-01-24 02:37:11,436 - WARNING - integration_test -   Consecutive MPC failures: 2/20
2026-01-24 02:37:11,448 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:37:11,448 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1858 scenarios available
2026-01-24 02:37:11,463 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1858 trajectory groups with 18580 total points
2026-01-24 02:37:11,464 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:37:12,081 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:37:12,100 - INFO - integration_test - Step 26: Computed 6 numeric contouring constraints for visualization (s=6.780)
2026-01-24 02:37:12,100 - DEBUG - integration_test - Step 26: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:37:12,100 - INFO - integration_test - === Applying control at step 26 ===
2026-01-24 02:37:12,100 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': 0.8}
2026-01-24 02:37:12,100 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:37:12,100 - INFO - integration_test -   Planner output success: False
2026-01-24 02:37:12,101 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': 0.8}
2026-01-24 02:37:12,102 - INFO - integration_test - Step 26 completed in 10.476s
2026-01-24 02:37:12,161 - INFO - integration_test - Step 27 (contouring until path end)
2026-01-24 02:37:12,164 - DEBUG - integration_test - Syncing planner state at step 27: vehicle_state=[5.27994395 4.29197143 0.67700813 2.2        7.00000002]
2026-01-24 02:37:12,165 - DEBUG - integration_test - Step 27: Using propagated spline 7.0000 (close to path, dist=0.436m, drift=0.035m)
2026-01-24 02:37:12,165 - DEBUG - integration_test -   Set spline state to 7.0000
2026-01-24 02:37:12,166 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:37:13,164 - DEBUG - integration_test - Step 27: Checking path alignment: vehicle=(5.280, 4.292), path_start=(0.000, 0.000), dist=6.804m
2026-01-24 02:37:13,164 - INFO - integration_test - === Calling planner.solve_mpc() at step 27 ===
2026-01-24 02:37:14,211 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:37:14,240 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:37:14,240 - INFO - integration_test - Warmstart k=0: x0=5.27994394652775 , y0=4.291971426544032 , psi0=0.6770081261164358 , v0=2.200000004462361 , spline0=7.000000024891956 , a0=0.0 , w0=0.0
2026-01-24 02:37:14,240 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:37:14,241 - INFO - integration_test - Dyn residual k=0: pred=[5.451423058025432, 4.429793465842215, 0.6770081261164358, 2.200000004462361, 7.220000025338192], ws=[5.069330482094798, 4.229461620946585, 0.6770081261164358, 2.200000004462361, 6.563434368772535], res=[0.38209257593063395, 0.20033184489562927, 0.0, 0.0, 0.6565656565656566], res_norm=7.856e-01
2026-01-24 02:37:14,242 - INFO - integration_test - Dyn residual k=1: pred=[5.24080959359248, 4.367283660244768, 0.6770081261164358, 2.200000004462361, 6.783434369218771], ws=[5.330501824943485, 4.44018087141245, 0.6770081261164358, 2.200000004462361, 6.480404066188468], res=[-0.08969223135100535, -0.07289721116768266, 0.0, 0.0, 0.30303030303030276], res_norm=3.243e-01
2026-01-24 02:37:14,243 - INFO - integration_test - Dyn residual k=2: pred=[5.501980936441167, 4.578002910710632, 0.6770081261164358, 2.200000004462361, 6.700404066634704], ws=[5.4297941334478415, 4.475921717299737, 0.6770081261164358, 2.200000004462361, 7.0034343696650065], res=[0.07218680299332547, 0.1020811934108945, 0.0, 0.0, -0.30303030303030276], res_norm=3.278e-01
2026-01-24 02:37:14,260 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:15,287 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:37:15,311 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:15,362 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:37:15,388 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:15,438 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:37:15,462 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:15,512 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:37:15,534 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:15,585 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:37:15,607 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:15,658 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:37:15,680 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:15,730 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:37:15,754 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:15,802 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:37:15,823 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:15,875 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:37:15,898 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:15,950 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:37:15,972 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:16,020 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:37:21,650 - WARNING - integration_test - Step 27: MPC solve failed
2026-01-24 02:37:21,650 - WARNING - integration_test -   Consecutive MPC failures: 3/20
2026-01-24 02:37:21,662 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:37:21,662 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1858 scenarios available
2026-01-24 02:37:21,676 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1858 trajectory groups with 18580 total points
2026-01-24 02:37:21,677 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:37:22,173 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:37:22,201 - INFO - integration_test - Step 27: Computed 6 numeric contouring constraints for visualization (s=7.000)
2026-01-24 02:37:22,201 - DEBUG - integration_test - Step 27: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:37:22,201 - INFO - integration_test - === Applying control at step 27 ===
2026-01-24 02:37:22,201 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': 0.8}
2026-01-24 02:37:22,201 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:37:22,201 - INFO - integration_test -   Planner output success: False
2026-01-24 02:37:22,201 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': 0.8}
2026-01-24 02:37:22,203 - INFO - integration_test - Step 27 completed in 10.039s
2026-01-24 02:37:22,277 - INFO - integration_test - Step 28 (contouring until path end)
2026-01-24 02:37:22,279 - DEBUG - integration_test - Syncing planner state at step 28: vehicle_state=[5.43828212 4.42983196 0.75700813 2.         7.20000003]
2026-01-24 02:37:22,280 - DEBUG - integration_test - Step 28: Using propagated spline 7.2000 (close to path, dist=0.406m, drift=0.235m)
2026-01-24 02:37:22,280 - DEBUG - integration_test -   Set spline state to 7.2000
2026-01-24 02:37:22,281 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:37:23,326 - DEBUG - integration_test - Step 28: Checking path alignment: vehicle=(5.438, 4.430), path_start=(0.000, 0.000), dist=7.014m
2026-01-24 02:37:23,326 - INFO - integration_test - === Calling planner.solve_mpc() at step 28 ===
2026-01-24 02:37:24,341 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:37:24,369 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:37:24,369 - INFO - integration_test - Warmstart k=0: x0=5.438282118378672 , y0=4.429831963179873 , psi0=0.7570081261164358 , v0=2.0000000044623607 , spline0=7.200000025338192 , a0=0.0 , w0=0.0
2026-01-24 02:37:24,369 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:37:24,371 - INFO - integration_test - Dyn residual k=0: pred=[5.583660904629455, 4.567181912894984, 0.7570081261164358, 2.0000000044623607, 7.400000025784428], ws=[5.511065113133171, 4.436071613888513, 0.7570081261164359, 2.0000000044623607, 6.541414167198569], res=[0.07259579149628426, 0.13111029900647164, -1.1102230246251565e-16, 0.0, 0.858585858585859], res_norm=8.716e-01
2026-01-24 02:37:24,372 - INFO - integration_test - Dyn residual k=1: pred=[5.656443899383953, 4.573421563603624, 0.7570081261164359, 2.0000000044623607, 6.741414167644805], ws=[5.509540541240806, 4.627976000309316, 0.7570081261164359, 2.0000000044623607, 7.044444470675109], res=[0.14690335814314714, -0.05455443670569249, 0.0, 0.0, -0.30303030303030365], res_norm=3.412e-01
2026-01-24 02:37:24,373 - INFO - integration_test - Dyn residual k=2: pred=[5.654919327491589, 4.765325950024428, 0.7570081261164359, 2.0000000044623607, 7.244444471121345], ws=[5.372169083942598, 4.8333096714068065, 0.7570081261164359, 2.0000000044623607, 6.840404067080941], res=[0.2827502435489908, -0.06798372138237863, 0.0, 0.0, 0.404040404040404], res_norm=4.978e-01
2026-01-24 02:37:24,390 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:25,657 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:37:25,681 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:25,734 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:37:25,760 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:25,815 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:37:25,839 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:25,892 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:37:25,917 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:25,970 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:37:25,995 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:26,046 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:37:26,069 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:26,122 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:37:26,147 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:26,200 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:37:26,226 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:26,276 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:37:26,299 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:26,355 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:37:26,381 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:26,435 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:37:31,940 - WARNING - integration_test - Step 28: MPC solve failed
2026-01-24 02:37:31,940 - WARNING - integration_test -   Consecutive MPC failures: 4/20
2026-01-24 02:37:31,960 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:37:31,960 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1859 scenarios available
2026-01-24 02:37:31,976 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1859 trajectory groups with 18590 total points
2026-01-24 02:37:31,977 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:37:32,547 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:37:32,579 - INFO - integration_test - Step 28: Computed 6 numeric contouring constraints for visualization (s=7.200)
2026-01-24 02:37:32,579 - DEBUG - integration_test - Step 28: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:37:32,579 - INFO - integration_test - === Applying control at step 28 ===
2026-01-24 02:37:32,579 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': 0.8}
2026-01-24 02:37:32,579 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:37:32,579 - INFO - integration_test -   Planner output success: False
2026-01-24 02:37:32,579 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': 0.8}
2026-01-24 02:37:32,581 - INFO - integration_test - Step 28 completed in 10.302s
2026-01-24 02:37:32,661 - INFO - integration_test - Step 29 (contouring until path end)
2026-01-24 02:37:32,663 - DEBUG - integration_test - Syncing planner state at step 29: vehicle_state=[5.57112353 4.56560357 0.83700813 1.8        7.38000003]
2026-01-24 02:37:32,664 - DEBUG - integration_test - Step 29: Using propagated spline 7.3800 (close to path, dist=0.414m, drift=0.006m)
2026-01-24 02:37:32,664 - DEBUG - integration_test -   Set spline state to 7.3800
2026-01-24 02:37:32,665 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:37:33,711 - DEBUG - integration_test - Step 29: Checking path alignment: vehicle=(5.571, 4.566), path_start=(0.000, 0.000), dist=7.203m
2026-01-24 02:37:33,712 - INFO - integration_test - === Calling planner.solve_mpc() at step 29 ===
2026-01-24 02:37:34,686 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:37:34,713 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:37:34,713 - INFO - integration_test - Warmstart k=0: x0=5.571123525821323 , y0=4.565603573638395 , psi0=0.8370081261164357 , v0=1.8000000044623607 , spline0=7.380000025784428 , a0=0.0 , w0=0.0
2026-01-24 02:37:34,713 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:37:34,714 - INFO - integration_test - Dyn residual k=0: pred=[5.691667314548345, 4.6992792825760334, 0.8370081261164357, 1.8000000044623607, 7.560000026230664], ws=[5.578806292030868, 4.467211809871825, 0.8370081261164355, 1.8000000044623607, 6.802424268654907], res=[0.11286102251747732, 0.23206747270420802, 2.220446049250313e-16, 0.0, 0.7575757575757578], res_norm=8.003e-01
2026-01-24 02:37:34,715 - INFO - integration_test - Dyn residual k=1: pred=[5.69935008075789, 4.600887518809463, 0.8370081261164355, 1.8000000044623607, 6.982424269101143], ws=[5.3181100593725965, 4.8419208094988315, 0.8370081261164355, 1.8000000044623607, 7.083434370111244], res=[0.38124002138529356, -0.2410332906893684, 0.0, 0.0, -0.10101010101010122], res_norm=4.622e-01
2026-01-24 02:37:34,715 - INFO - integration_test - Dyn residual k=2: pred=[5.4386538480996185, 4.975596518436469, 0.8370081261164355, 1.8000000044623607, 7.26343437055748], ws=[5.634984924911539, 4.327832485878161, 0.8370081261164355, 1.8000000044623607, 6.758383865506976], res=[-0.1963310768119202, 0.6477640325583085, 0.0, 0.0, 0.5050505050505043], res_norm=8.445e-01
2026-01-24 02:37:34,731 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:35,705 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:37:35,727 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:35,781 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:37:35,808 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:35,857 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:37:35,878 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:35,959 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:37:35,996 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:36,049 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:37:36,072 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:36,119 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:37:36,143 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:36,192 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:37:36,213 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:36,262 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:37:36,284 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:36,333 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:37:36,357 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:36,407 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:37:36,431 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:36,481 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:37:42,402 - WARNING - integration_test - Step 29: MPC solve failed
2026-01-24 02:37:42,402 - WARNING - integration_test -   Consecutive MPC failures: 5/20
2026-01-24 02:37:42,421 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:37:42,421 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1861 scenarios available
2026-01-24 02:37:42,706 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1861 trajectory groups with 18610 total points
2026-01-24 02:37:42,707 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:37:43,432 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:37:43,463 - INFO - integration_test - Step 29: Computed 6 numeric contouring constraints for visualization (s=7.380)
2026-01-24 02:37:43,463 - DEBUG - integration_test - Step 29: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:37:43,463 - INFO - integration_test - === Applying control at step 29 ===
2026-01-24 02:37:43,463 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': 0.8}
2026-01-24 02:37:43,463 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:37:43,464 - INFO - integration_test -   Planner output success: False
2026-01-24 02:37:43,464 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': 0.8}
2026-01-24 02:37:43,465 - INFO - integration_test - Step 29 completed in 10.802s
2026-01-24 02:37:43,538 - INFO - integration_test - Step 30 (contouring until path end)
2026-01-24 02:37:43,546 - DEBUG - integration_test - Syncing planner state at step 30: vehicle_state=[5.67990425 4.69618444 0.91700813 1.6        7.54000003]
2026-01-24 02:37:43,547 - DEBUG - integration_test - Step 30: Using propagated spline 7.5400 (close to path, dist=0.349m, drift=0.166m)
2026-01-24 02:37:43,547 - DEBUG - integration_test -   Set spline state to 7.5400
2026-01-24 02:37:43,548 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:37:44,572 - DEBUG - integration_test - Step 30: Checking path alignment: vehicle=(5.680, 4.696), path_start=(0.000, 0.000), dist=7.370m
2026-01-24 02:37:44,572 - INFO - integration_test - === Calling planner.solve_mpc() at step 30 ===
2026-01-24 02:37:45,571 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 02:37:45,598 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 02:37:45,598 - INFO - integration_test - Warmstart k=0: x0=5.679904245843937 , y0=4.696184443782267 , psi0=0.9170081261164357 , v0=1.6000000044623608 , spline0=7.540000026230664 , a0=0.0 , w0=0.0
2026-01-24 02:37:45,598 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 02:37:45,600 - INFO - integration_test - Dyn residual k=0: pred=[5.777215891133127, 4.823190128040517, 0.9170081261164357, 1.6000000044623608, 7.7000000266769], ws=[5.249180436369917, 4.5830382545049995, 0.9170081261164356, 1.6000000044623608, 6.740404067080941], res=[0.5280354547632102, 0.2401518735355177, 1.1102230246251565e-16, 0.0, 0.9595959595959593], res_norm=1.121e+00
2026-01-24 02:37:45,601 - INFO - integration_test - Dyn residual k=1: pred=[5.3464920816591075, 4.71004393876325, 0.9170081261164356, 1.6000000044623608, 6.900404067527177], ws=[6.405353498154239, 4.4499953527952, 0.9170081261164356, 1.6000000044623608, 7.304444471567581], res=[-1.058861416495131, 0.26004858596805036, 0.0, 0.0, -0.404040404040404], res_norm=1.163e+00
2026-01-24 02:37:45,602 - INFO - integration_test - Dyn residual k=2: pred=[6.502665143443429, 4.57700103705345, 0.9170081261164356, 1.6000000044623608, 7.464444472013817], ws=[5.612193294627906, 4.404008767313961, 0.9170081261164356, 1.6000000044623608, 7.060404067973413], res=[0.8904718488155234, 0.17299226973948922, 0.0, 0.0, 0.404040404040404], res_norm=9.930e-01
2026-01-24 02:37:45,621 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:46,631 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:37:46,656 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:46,706 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:37:46,729 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:46,781 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:37:46,806 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:46,857 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:37:46,880 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:46,931 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:37:46,958 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:47,010 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 02:37:47,034 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:47,084 - INFO - integration_test - Stage 6: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:37:47,108 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:47,159 - INFO - integration_test - Stage 7: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:37:47,182 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:47,232 - INFO - integration_test - Stage 8: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:37:47,256 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:47,305 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:37:47,327 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 02:37:47,376 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 02:37:52,884 - WARNING - integration_test - Step 30: MPC solve failed
2026-01-24 02:37:52,884 - WARNING - integration_test -   Consecutive MPC failures: 6/20
2026-01-24 02:37:52,903 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:37:52,903 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1860 scenarios available
2026-01-24 02:37:53,201 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1860 trajectory groups with 18600 total points
2026-01-24 02:37:53,202 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:37:53,896 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:37:53,933 - INFO - integration_test - Step 30: Computed 6 numeric contouring constraints for visualization (s=7.540)
2026-01-24 02:37:53,934 - DEBUG - integration_test - Step 30: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 02:37:53,934 - INFO - integration_test - === Applying control at step 30 ===
2026-01-24 02:37:53,934 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': 0.8}
2026-01-24 02:37:53,934 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 02:37:53,934 - INFO - integration_test -   Planner output success: False
2026-01-24 02:37:53,934 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': 0.8}
2026-01-24 02:37:53,936 - INFO - integration_test - Step 30 completed in 10.389s
2026-01-24 02:37:54,013 - WARNING - integration_test - Test timeout reached (180.0s) at step 31. Terminating test early.
2026-01-24 02:37:54,021 - INFO - integration_test - Saving test results...
2026-01-24 02:37:54,021 - INFO - integration_test - Saved 32 vehicle states to test_outputs/20260124_023446_contouring_safe_horizon_contouring_unicycle/vehicle_states.csv
2026-01-24 02:37:54,021 - INFO - integration_test - Saved obstacle summary to test_outputs/20260124_023446_contouring_safe_horizon_contouring_unicycle/obstacle_summary.csv
2026-01-24 02:37:54,022 - INFO - integration_test - Saved 42 states for obstacle 0 to test_outputs/20260124_023446_contouring_safe_horizon_contouring_unicycle/obstacle_0_detailed_states.csv
2026-01-24 02:37:54,022 - INFO - integration_test - Saved 42 states for obstacle 1 to test_outputs/20260124_023446_contouring_safe_horizon_contouring_unicycle/obstacle_1_detailed_states.csv
2026-01-24 02:37:54,022 - INFO - integration_test - Saved state history: 32 vehicle states, 2 obstacles
2026-01-24 02:37:54,022 - INFO - integration_test - Creating animation...
2026-01-24 02:37:54,070 - DEBUG - integration_test - Creating animation with 32 frames (range: 0 to 31)
2026-01-24 02:37:54,071 - DEBUG - integration_test - Frame 0: Drawing 6 contouring constraint halfspaces
2026-01-24 02:37:55,101 - INFO - integration_test - Frame 0: Safe Horizon module has 1863 scenarios after update
2026-01-24 02:37:55,101 - INFO - integration_test - Frame 0: Calling Safe Horizon visualizer
2026-01-24 02:37:55,101 - DEBUG - integration_test - Frame 0: Safe Horizon scenario_cache has 40 constraints across 10 keys: [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4)]
2026-01-24 02:37:55,103 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:37:55,104 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1863 scenarios available
2026-01-24 02:37:55,121 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1863 trajectory groups with 18630 total points
2026-01-24 02:37:55,122 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:37:55,176 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:37:55,184 - INFO - integration_test - Frame 0: Safe Horizon visualizer completed
2026-01-24 02:37:55,185 - DEBUG - integration_test - Frame 0: Drawing 6 contouring constraint halfspaces
2026-01-24 02:37:56,132 - INFO - integration_test - Frame 0: Safe Horizon module has 1854 scenarios after update
2026-01-24 02:37:56,132 - INFO - integration_test - Frame 0: Calling Safe Horizon visualizer
2026-01-24 02:37:56,132 - DEBUG - integration_test - Frame 0: Safe Horizon scenario_cache has 40 constraints across 10 keys: [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4)]
2026-01-24 02:37:56,133 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:37:56,133 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1854 scenarios available
2026-01-24 02:37:56,147 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1854 trajectory groups with 18540 total points
2026-01-24 02:37:56,148 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:37:56,484 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 02:37:56,490 - INFO - integration_test - Frame 0: Safe Horizon visualizer completed
2026-01-24 02:37:56,613 - DEBUG - integration_test - Frame 1: Drawing 6 contouring constraint halfspaces
2026-01-24 02:37:57,559 - INFO - integration_test - Frame 1: Safe Horizon module has 1858 scenarios after update
2026-01-24 02:37:57,559 - INFO - integration_test - Frame 1: Calling Safe Horizon visualizer
2026-01-24 02:37:57,560 - DEBUG - integration_test - Frame 1: Safe Horizon scenario_cache has 40 constraints across 10 keys: [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4)]
2026-01-24 02:37:57,561 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:37:57,561 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1858 scenarios available
2026-01-24 02:37:57,584 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1858 trajectory groups with 18580 total points
2026-01-24 02:37:57,586 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:37:57,672 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:37:57,679 - INFO - integration_test - Frame 1: Safe Horizon visualizer completed
2026-01-24 02:37:57,779 - DEBUG - integration_test - Frame 2: Drawing 6 contouring constraint halfspaces
2026-01-24 02:37:58,786 - INFO - integration_test - Frame 2: Safe Horizon module has 1851 scenarios after update
2026-01-24 02:37:58,786 - INFO - integration_test - Frame 2: Calling Safe Horizon visualizer
2026-01-24 02:37:58,786 - DEBUG - integration_test - Frame 2: Safe Horizon scenario_cache has 40 constraints across 10 keys: [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4)]
2026-01-24 02:37:58,788 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:37:58,788 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1851 scenarios available
2026-01-24 02:37:58,807 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1851 trajectory groups with 18510 total points
2026-01-24 02:37:58,808 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:37:58,861 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:37:58,868 - INFO - integration_test - Frame 2: Safe Horizon visualizer completed
2026-01-24 02:38:00,038 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:38:00,038 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1851 scenarios available
2026-01-24 02:38:00,361 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1851 trajectory groups with 18510 total points
2026-01-24 02:38:00,362 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:38:00,421 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:38:01,596 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:38:01,596 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1853 scenarios available
2026-01-24 02:38:01,615 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1853 trajectory groups with 18530 total points
2026-01-24 02:38:01,616 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:38:01,668 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:38:02,848 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:38:02,848 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1842 scenarios available
2026-01-24 02:38:02,865 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1842 trajectory groups with 18420 total points
2026-01-24 02:38:02,866 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:38:03,220 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:38:04,261 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:38:04,261 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1841 scenarios available
2026-01-24 02:38:04,277 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1841 trajectory groups with 18410 total points
2026-01-24 02:38:04,279 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:38:04,328 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:38:05,405 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:38:05,405 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1856 scenarios available
2026-01-24 02:38:05,426 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1856 trajectory groups with 18560 total points
2026-01-24 02:38:05,427 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:38:05,482 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:38:06,619 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:38:06,619 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1858 scenarios available
2026-01-24 02:38:06,943 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1858 trajectory groups with 18580 total points
2026-01-24 02:38:06,944 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:38:07,004 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:38:08,193 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:38:08,194 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1855 scenarios available
2026-01-24 02:38:08,213 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1855 trajectory groups with 18550 total points
2026-01-24 02:38:08,214 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:38:08,268 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:38:09,367 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:38:09,367 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1862 scenarios available
2026-01-24 02:38:09,387 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1862 trajectory groups with 18620 total points
2026-01-24 02:38:09,388 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:38:09,714 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:38:10,816 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:38:10,816 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1873 scenarios available
2026-01-24 02:38:10,838 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1873 trajectory groups with 18730 total points
2026-01-24 02:38:10,839 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:38:10,893 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:38:12,040 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:38:12,040 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1851 scenarios available
2026-01-24 02:38:12,061 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1851 trajectory groups with 18510 total points
2026-01-24 02:38:12,062 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:38:12,116 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:38:13,221 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:38:13,221 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1857 scenarios available
2026-01-24 02:38:13,536 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1857 trajectory groups with 18570 total points
2026-01-24 02:38:13,537 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:38:13,590 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:38:14,690 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:38:14,690 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1870 scenarios available
2026-01-24 02:38:14,710 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1870 trajectory groups with 18700 total points
2026-01-24 02:38:14,711 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:38:14,763 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:38:15,895 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:38:15,895 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1866 scenarios available
2026-01-24 02:38:16,232 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1866 trajectory groups with 18660 total points
2026-01-24 02:38:16,233 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:38:16,283 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:38:17,349 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:38:17,349 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1842 scenarios available
2026-01-24 02:38:17,368 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1842 trajectory groups with 18420 total points
2026-01-24 02:38:17,369 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:38:17,431 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:38:18,478 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:38:18,478 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1854 scenarios available
2026-01-24 02:38:18,495 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1854 trajectory groups with 18540 total points
2026-01-24 02:38:18,496 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:38:18,542 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:38:19,578 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:38:19,578 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1858 scenarios available
2026-01-24 02:38:19,893 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1858 trajectory groups with 18580 total points
2026-01-24 02:38:19,894 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:38:19,951 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:38:21,071 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:38:21,071 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1857 scenarios available
2026-01-24 02:38:21,091 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1857 trajectory groups with 18570 total points
2026-01-24 02:38:21,092 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:38:21,147 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:38:22,289 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:38:22,289 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1875 scenarios available
2026-01-24 02:38:22,310 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1875 trajectory groups with 18750 total points
2026-01-24 02:38:22,311 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:38:22,660 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:38:23,828 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:38:23,828 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1863 scenarios available
2026-01-24 02:38:23,848 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1863 trajectory groups with 18630 total points
2026-01-24 02:38:23,849 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:38:23,900 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:38:24,932 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:38:24,932 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1858 scenarios available
2026-01-24 02:38:24,950 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1858 trajectory groups with 18580 total points
2026-01-24 02:38:24,951 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:38:25,040 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:38:26,050 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:38:26,050 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1859 scenarios available
2026-01-24 02:38:26,341 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1859 trajectory groups with 18590 total points
2026-01-24 02:38:26,343 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:38:26,390 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:38:27,504 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:38:27,504 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1841 scenarios available
2026-01-24 02:38:27,525 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1841 trajectory groups with 18410 total points
2026-01-24 02:38:27,526 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:38:27,580 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:38:28,792 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:38:28,792 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1853 scenarios available
2026-01-24 02:38:29,107 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1853 trajectory groups with 18530 total points
2026-01-24 02:38:29,108 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:38:29,160 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:38:30,252 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:38:30,252 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1850 scenarios available
2026-01-24 02:38:30,272 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1850 trajectory groups with 18500 total points
2026-01-24 02:38:30,273 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:38:30,325 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:38:31,508 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:38:31,508 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1865 scenarios available
2026-01-24 02:38:31,528 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1865 trajectory groups with 18650 total points
2026-01-24 02:38:31,529 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:38:31,881 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:38:32,956 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:38:32,956 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1854 scenarios available
2026-01-24 02:38:32,977 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1854 trajectory groups with 18540 total points
2026-01-24 02:38:32,978 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:38:33,032 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:38:34,087 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:38:34,087 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1848 scenarios available
2026-01-24 02:38:34,107 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1848 trajectory groups with 18480 total points
2026-01-24 02:38:34,109 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:38:34,161 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:38:35,317 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:38:35,317 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1834 scenarios available
2026-01-24 02:38:35,657 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1834 trajectory groups with 18340 total points
2026-01-24 02:38:35,658 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:38:35,716 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:38:36,843 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 02:38:36,843 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1858 scenarios available
2026-01-24 02:38:36,863 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1858 trajectory groups with 18580 total points
2026-01-24 02:38:36,864 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 02:38:36,915 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 02:38:38,975 - INFO - integration_test - Saved animation with 32 frames at 10.00 fps to test_outputs/20260124_023446_contouring_safe_horizon_contouring_unicycle/animation.gif (duration: 3.20s, size: 527264 bytes)
2026-01-24 02:38:39,001 - INFO - integration_test - Animation created successfully
2026-01-24 02:38:39,001 - INFO - integration_test - Test completed successfully
