2026-01-24 11:31:40,815 - INFO - integration_test - Contouring objective detected: automatically switching to contouring-aware dynamics model
2026-01-24 11:31:40,815 - INFO - integration_test -   Converted 'unicycle' -> 'contouring_unicycle'
2026-01-24 11:31:40,815 - INFO - integration_test - Created vehicle dynamics model: ContouringSecondOrderUnicycleModel
2026-01-24 11:31:40,815 - INFO - integration_test - ✓ Validation passed: Contouring objective with dynamics model that has 'spline' state
2026-01-24 11:31:40,815 - INFO - integration_test - Creating objective module: contouring
2026-01-24 11:31:40,822 - INFO - integration_test - Objective module 'contouring' created: contouring_objective
2026-01-24 11:31:40,822 - INFO - integration_test - Creating 2 constraint module(s): ['safe_horizon', 'contouring']
2026-01-24 11:31:40,822 - DEBUG - integration_test - Creating constraint module: safe_horizon
2026-01-24 11:31:40,848 - INFO - integration_test - Constraint module 'safe_horizon' created: safe_horizon_constraint
2026-01-24 11:31:40,848 - DEBUG - integration_test - Creating constraint module: contouring
2026-01-24 11:31:40,855 - INFO - integration_test - Constraint module 'contouring' created: contouring_constraints
2026-01-24 11:31:40,855 - INFO - integration_test - Created 2 constraint module(s)
2026-01-24 11:31:40,873 - INFO - integration_test - Setting solver on all modules...
2026-01-24 11:31:40,873 - DEBUG - integration_test -   Set solver on module: safe_horizon_constraint
2026-01-24 11:31:40,873 - DEBUG - integration_test -   Set solver on module: contouring_constraints
2026-01-24 11:31:40,873 - DEBUG - integration_test -   Set solver on module: control_effort_objective
2026-01-24 11:31:40,873 - DEBUG - integration_test -   Set solver on module: control_jerk_objective
2026-01-24 11:31:40,873 - DEBUG - integration_test -   Set solver on module: path_reference_velocity_objective
2026-01-24 11:31:40,873 - DEBUG - integration_test -   Set solver on module: contouring_objective
2026-01-24 11:31:40,873 - INFO - integration_test - Placing obstacles within reference path boundaries
2026-01-24 11:31:40,873 - INFO - integration_test - Obstacle 0: s=8.03, pos=(6.24, 5.59), lateral_offset=0.00m, vel=(0.47, 0.37)
2026-01-24 11:31:40,873 - INFO - integration_test - Obstacle 1: s=17.06, pos=(13.71, 10.71), lateral_offset=0.00m, vel=(-0.69, -0.41)
2026-01-24 11:31:40,874 - WARNING - integration_test - Error shaping obstacles: name 'get_dummy_obstacle' is not defined
2026-01-24 11:31:40,874 - WARNING - integration_test - Error in on_data_received: 'Planner' object has no attribute 'on_data_received'
2026-01-24 11:31:40,874 - INFO - integration_test - Initial vehicle state (before spline): [0. 0. 0. 1.]
2026-01-24 11:31:40,874 - INFO - integration_test - Vehicle starting position: (0.00, 0.00)
2026-01-24 11:31:40,874 - INFO - integration_test - Reference path start: (0.00, 0.00)
2026-01-24 11:31:40,874 - INFO - integration_test - Reference path starts at vehicle position (requirement satisfied)
2026-01-24 11:31:40,874 - INFO - integration_test - Contouring-aware dynamics detected: initializing spline variable
2026-01-24 11:31:40,875 - INFO - integration_test - Initialized spline to closest path point: s=0.0000 (vehicle at (0.00, 0.00), closest path point at (0.00, 0.00), distance=0.000m)
2026-01-24 11:31:40,875 - INFO - integration_test - Added spline variable: 0.0000
2026-01-24 11:31:40,875 - INFO - integration_test - Final initial state: [0. 0. 0. 1. 0.] (variables: ['x', 'y', 'psi', 'v', 'spline'])
2026-01-24 11:31:40,875 - INFO - integration_test - Auto-calculated timeout: 180s for 100 steps
2026-01-24 11:31:40,875 - INFO - integration_test - Step 0 (contouring until path end)
2026-01-24 11:31:40,875 - DEBUG - integration_test - Syncing planner state at step 0: vehicle_state=[0. 0. 0. 1. 0.]
2026-01-24 11:31:40,876 - DEBUG - integration_test - Step 0: Using propagated spline 0.0000 (close to path, dist=0.000m, drift=0.000m)
2026-01-24 11:31:40,876 - DEBUG - integration_test -   Set spline state to 0.0000
2026-01-24 11:31:40,876 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:31:42,022 - DEBUG - integration_test - Step 0: Checking path alignment: vehicle=(0.000, 0.000), path_start=(0.000, 0.000), dist=0.000m
2026-01-24 11:31:42,023 - INFO - integration_test - === Calling planner.solve_mpc() at step 0 ===
2026-01-24 11:31:42,941 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:31:42,968 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 11:31:42,968 - INFO - integration_test - Warmstart k=0: x0=0.0 , y0=0.0 , psi0=0.0 , v0=1.0 , spline0=0.0 , a0=0.0 , w0=0.0
2026-01-24 11:31:42,968 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 11:31:42,969 - INFO - integration_test - Dyn residual k=0: pred=[0.1, 0.0, 0.0, 1.0, 0.1], ws=[0.1, 0.0, 0.0, 1.0, 0.051515151515151514], res=[0.0, 0.0, 0.0, 0.0, 0.04848484848484849], res_norm=4.848e-02
2026-01-24 11:31:42,970 - INFO - integration_test - Dyn residual k=1: pred=[0.2, 0.0, 0.0, 1.0, 0.15151515151515152], ws=[0.2, 0.0, 0.0, 1.0, 0.05252525252525253], res=[0.0, 0.0, 0.0, 0.0, 0.09898989898989899], res_norm=9.899e-02
2026-01-24 11:31:42,970 - INFO - integration_test - Dyn residual k=2: pred=[0.30000000000000004, 0.0, 0.0, 1.0, 0.15252525252525254], ws=[0.30000000000000004, 0.0, 0.0, 1.0, 0.10707070707070707], res=[0.0, 0.0, 0.0, 0.0, 0.04545454545454547], res_norm=4.545e-02
2026-01-24 11:31:42,985 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:43,961 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:31:43,982 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:44,030 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:31:44,053 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:44,099 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:31:44,120 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:44,165 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:31:44,187 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:44,237 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:31:44,260 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:44,309 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:31:44,331 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:44,376 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:31:44,398 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:44,445 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:31:44,468 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:44,515 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:31:44,538 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:44,586 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:31:44,608 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:44,655 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:31:45,631 - INFO - integration_test - Step 0: MPC solve successful
2026-01-24 11:31:45,807 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:31:45,807 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1852 scenarios available
2026-01-24 11:31:45,877 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1852 trajectory groups with 18520 total points
2026-01-24 11:31:45,878 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:31:45,947 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 11:31:45,956 - INFO - integration_test - Step 0: Computed 6 numeric contouring constraints for visualization (s=0.000)
2026-01-24 11:31:45,957 - DEBUG - integration_test - Step 0: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 11:31:45,957 - DEBUG - integration_test - Linearized constraints module not found at step 0
2026-01-24 11:31:45,957 - INFO - integration_test - === Applying control at step 0 ===
2026-01-24 11:31:45,957 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000184500957, 'w': 0.7999999763473087}
2026-01-24 11:31:45,957 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 11:31:45,957 - INFO - integration_test -   Planner output success: True
2026-01-24 11:31:45,958 - INFO - integration_test - Step 0 completed in 5.083s
2026-01-24 11:31:46,023 - INFO - integration_test - Step 1 (contouring until path end)
2026-01-24 11:31:46,026 - DEBUG - integration_test - Syncing planner state at step 1: vehicle_state=[0.10987738 0.00453084 0.08       1.2        0.12      ]
2026-01-24 11:31:46,026 - DEBUG - integration_test - Step 1: Using propagated spline 0.1200 (close to path, dist=0.110m, drift=0.120m)
2026-01-24 11:31:46,026 - DEBUG - integration_test -   Set spline state to 0.1200
2026-01-24 11:31:46,027 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:31:46,944 - DEBUG - integration_test - Step 1: Checking path alignment: vehicle=(0.110, 0.005), path_start=(0.000, 0.000), dist=0.110m
2026-01-24 11:31:46,945 - INFO - integration_test - === Calling planner.solve_mpc() at step 1 ===
2026-01-24 11:31:47,792 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:31:47,816 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 11:31:47,816 - INFO - integration_test - Warmstart k=0: x0=0.10987737538054224 , y0=0.004530844924175456 , psi0=0.07999999763473087 , v0=1.2000000018450097 , spline0=0.12000000018450097 , a0=0.0 , w0=0.0
2026-01-24 11:31:47,816 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 11:31:47,817 - INFO - integration_test - Dyn residual k=0: pred=[0.2294935803434498, 0.014120607932296, 0.07999999763473087, 1.2000000018450097, 0.24000000036900193], ws=[0.2294935803434498, 0.014120607932296001, 0.07999999763473076, 1.2000000018450097, 0.05292929293302022], res=[0.0, -1.734723475976807e-18, 1.1102230246251565e-16, 0.0, 0.1870707074359817], res_norm=1.871e-01
2026-01-24 11:31:47,818 - INFO - integration_test - Dyn residual k=1: pred=[0.34910978530635733, 0.02371037094041653, 0.07999999763473076, 1.2000000018450097, 0.1729292931175212], ws=[0.3491097853063574, 0.02371037094041653, 0.07999999763473076, 1.2000000018450097, 0.10828282829401017], res=[-5.551115123125783e-17, 0.0, 0.0, 0.0, 0.06464646482351102], res_norm=6.465e-02
2026-01-24 11:31:47,819 - INFO - integration_test - Dyn residual k=2: pred=[0.4687259902692649, 0.033300133948537064, 0.07999999763473076, 1.2000000018450097, 0.22828282847851114], ws=[0.468725990269265, 0.033300133948537064, 0.07999999763473076, 1.2000000018450097, 0.1660606060829698], res=[-5.551115123125783e-17, 0.0, 0.0, 0.0, 0.06222222239554134], res_norm=6.222e-02
2026-01-24 11:31:47,833 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:48,719 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:31:48,737 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:48,780 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:31:48,801 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:48,842 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:31:48,862 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:48,903 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:31:48,922 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:48,963 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:31:48,982 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:49,025 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:31:49,046 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:49,090 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:31:49,110 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:49,154 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:31:49,174 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:49,218 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:31:49,239 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:49,284 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:31:49,304 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:49,349 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:31:49,983 - INFO - integration_test - Step 1: MPC solve successful
2026-01-24 11:31:49,985 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:31:49,985 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1854 scenarios available
2026-01-24 11:31:50,065 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1854 trajectory groups with 18540 total points
2026-01-24 11:31:50,065 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:31:50,143 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 11:31:50,155 - INFO - integration_test - Step 1: Computed 6 numeric contouring constraints for visualization (s=0.120)
2026-01-24 11:31:50,155 - DEBUG - integration_test - Step 1: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 11:31:50,155 - INFO - integration_test - === Applying control at step 1 ===
2026-01-24 11:31:50,155 - INFO - integration_test -   Control dict from planner: {'a': 2.000000018928935, 'w': 0.8000000027414679}
2026-01-24 11:31:50,155 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 11:31:50,156 - INFO - integration_test -   Planner output success: True
2026-01-24 11:31:50,157 - INFO - integration_test - Step 1 completed in 4.131s
2026-01-24 11:31:50,219 - INFO - integration_test - Step 2 (contouring until path end)
2026-01-24 11:31:50,220 - DEBUG - integration_test - Syncing planner state at step 2: vehicle_state=[0.23889213 0.02022162 0.16       1.4        0.26      ]
2026-01-24 11:31:50,221 - DEBUG - integration_test - Step 2: Using propagated spline 0.2600 (close to path, dist=0.240m, drift=0.260m)
2026-01-24 11:31:50,221 - DEBUG - integration_test -   Set spline state to 0.2600
2026-01-24 11:31:50,221 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:31:51,111 - DEBUG - integration_test - Step 2: Checking path alignment: vehicle=(0.239, 0.020), path_start=(0.000, 0.000), dist=0.240m
2026-01-24 11:31:51,111 - INFO - integration_test - === Calling planner.solve_mpc() at step 2 ===
2026-01-24 11:31:51,987 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:31:52,014 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 11:31:52,014 - INFO - integration_test - Warmstart k=0: x0=0.23889212820427924 , y0=0.020221621337213114 , psi0=0.15999999790887764 , v0=1.4000000037379032 , spline0=0.2600000005582913 , a0=0.0 , w0=0.0
2026-01-24 11:31:52,014 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 11:31:52,015 - INFO - integration_test - Dyn residual k=0: pred=[0.3771039482925246, 0.042526170033741324, 0.15999999790887764, 1.4000000037379032, 0.40000000093208166], ws=[0.3771039482925246, 0.04252617003374133, 0.15999999790887776, 1.4000000037379032, 0.10909090910973902], res=[0.0, -6.938893903907228e-18, -1.1102230246251565e-16, 0.0, 0.29090909182234265], res_norm=2.909e-01
2026-01-24 11:31:52,016 - INFO - integration_test - Dyn residual k=1: pred=[0.5153157683807699, 0.06483071873026956, 0.15999999790887776, 1.4000000037379032, 0.24909090948352935], ws=[0.5153157683807699, 0.06483071873026956, 0.15999999790887776, 1.4000000037379032, 0.16787878791835975], res=[0.0, 0.0, 0.0, 0.0, 0.0812121215651696], res_norm=8.121e-02
2026-01-24 11:31:52,017 - INFO - integration_test - Dyn residual k=2: pred=[0.6535275884690152, 0.0871352674267978, 0.15999999790887776, 1.4000000037379032, 0.3078787882921501], ws=[0.6535275884690152, 0.0871352674267978, 0.15999999790887776, 1.4000000037379032, 0.45898989912562926], res=[0.0, 0.0, 0.0, 0.0, -0.15111111083347917], res_norm=1.511e-01
2026-01-24 11:31:52,033 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:53,034 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:31:53,056 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:53,103 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:31:53,124 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:53,171 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:31:53,192 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:53,240 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:31:53,261 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:53,306 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:31:53,326 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:53,370 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:31:53,390 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:53,437 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:31:53,458 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:53,503 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:31:53,524 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:53,568 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:31:53,587 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:53,633 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:31:53,652 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:53,697 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:31:54,247 - INFO - integration_test - Step 2: MPC solve successful
2026-01-24 11:31:54,250 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:31:54,250 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1864 scenarios available
2026-01-24 11:31:54,329 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1864 trajectory groups with 18640 total points
2026-01-24 11:31:54,330 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:31:54,417 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 11:31:54,429 - INFO - integration_test - Step 2: Computed 6 numeric contouring constraints for visualization (s=0.260)
2026-01-24 11:31:54,429 - DEBUG - integration_test - Step 2: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 11:31:54,429 - INFO - integration_test - === Applying control at step 2 ===
2026-01-24 11:31:54,429 - INFO - integration_test -   Control dict from planner: {'a': 2.000000018608778, 'w': 0.7999999995351265}
2026-01-24 11:31:54,429 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 11:31:54,429 - INFO - integration_test -   Planner output success: True
2026-01-24 11:31:54,430 - INFO - integration_test - Step 2 completed in 4.210s
2026-01-24 11:31:54,489 - INFO - integration_test - Step 3 (contouring until path end)
2026-01-24 11:31:54,490 - DEBUG - integration_test - Syncing planner state at step 3: vehicle_state=[0.38583644 0.05014472 0.24       1.60000001 0.42      ]
2026-01-24 11:31:54,490 - DEBUG - integration_test - Step 3: Using propagated spline 0.4200 (close to path, dist=0.261m, drift=0.010m)
2026-01-24 11:31:54,490 - DEBUG - integration_test -   Set spline state to 0.4200
2026-01-24 11:31:54,491 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:31:55,347 - DEBUG - integration_test - Step 3: Checking path alignment: vehicle=(0.386, 0.050), path_start=(0.000, 0.000), dist=0.389m
2026-01-24 11:31:55,347 - INFO - integration_test - === Calling planner.solve_mpc() at step 3 ===
2026-01-24 11:31:56,218 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:31:56,242 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 11:31:56,242 - INFO - integration_test - Warmstart k=0: x0=0.3858364357837117 , y0=0.05014471572561764 , psi0=0.2399999978623903 , v0=1.600000005598781 , spline0=0.42000000111816943 , a0=0.0 , w0=0.0
2026-01-24 11:31:56,242 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 11:31:56,243 - INFO - integration_test - Dyn residual k=0: pred=[0.5412505123851657, 0.08817713575482902, 0.2399999978623903, 1.600000005598781, 0.5800000016780475], ws=[0.5412505123851657, 0.08817713575482904, 0.23999999786239012, 1.600000005598781, 0.16909090914175903], res=[0.0, -1.3877787807814457e-17, 1.6653345369377348e-16, 0.0, 0.4109090925362885], res_norm=4.109e-01
2026-01-24 11:31:56,244 - INFO - integration_test - Dyn residual k=1: pred=[0.6966645889866199, 0.12620955578404042, 0.23999999786239012, 1.600000005598781, 0.3290909097016371], ws=[0.6966645889866199, 0.12620955578404042, 0.23999999786239012, 1.600000005598781, 0.23191919200961317], res=[0.0, 0.0, 0.0, 0.0, 0.09717171769202396], res_norm=9.717e-02
2026-01-24 11:31:56,245 - INFO - integration_test - Dyn residual k=2: pred=[0.8520786655880739, 0.16424197581325178, 0.23999999786239012, 1.600000005598781, 0.39191919256949126], ws=[0.852078665588074, 0.16424197581325178, 0.23999999786239012, 1.600000005598781, 0.2979797981211012], res=[-1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.09393939444839006], res_norm=9.394e-02
2026-01-24 11:31:56,260 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:57,305 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:31:57,326 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:57,371 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:31:57,392 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:57,438 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:31:57,459 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:57,503 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:31:57,524 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:57,567 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:31:57,587 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:57,632 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:31:57,653 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:57,704 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:31:57,734 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:57,791 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:31:57,816 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:57,872 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:31:57,896 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:57,940 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:31:57,961 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:31:58,005 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:31:58,612 - INFO - integration_test - Step 3: MPC solve successful
2026-01-24 11:31:58,615 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:31:58,616 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1859 scenarios available
2026-01-24 11:31:58,628 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1859 trajectory groups with 18590 total points
2026-01-24 11:31:58,629 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:31:58,725 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 11:31:58,736 - INFO - integration_test - Step 3: Computed 6 numeric contouring constraints for visualization (s=0.420)
2026-01-24 11:31:58,736 - DEBUG - integration_test - Step 3: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 11:31:58,736 - INFO - integration_test - === Applying control at step 3 ===
2026-01-24 11:31:58,736 - INFO - integration_test -   Control dict from planner: {'a': 2.000000018008938, 'w': 0.7999999946729939}
2026-01-24 11:31:58,736 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 11:31:58,736 - INFO - integration_test -   Planner output success: True
2026-01-24 11:31:58,738 - INFO - integration_test - Step 3 completed in 4.248s
2026-01-24 11:31:58,800 - INFO - integration_test - Step 4 (contouring until path end)
2026-01-24 11:31:58,801 - DEBUG - integration_test - Syncing planner state at step 4: vehicle_state=[0.54913546 0.09724076 0.32       1.80000001 0.6       ]
2026-01-24 11:31:58,802 - DEBUG - integration_test - Step 4: Using propagated spline 0.6000 (close to path, dist=0.325m, drift=0.190m)
2026-01-24 11:31:58,802 - DEBUG - integration_test -   Set spline state to 0.6000
2026-01-24 11:31:58,802 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:31:59,767 - DEBUG - integration_test - Step 4: Checking path alignment: vehicle=(0.549, 0.097), path_start=(0.000, 0.000), dist=0.558m
2026-01-24 11:31:59,767 - INFO - integration_test - === Calling planner.solve_mpc() at step 4 ===
2026-01-24 11:32:00,875 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:32:00,900 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 11:32:00,900 - INFO - integration_test - Warmstart k=0: x0=0.5491354614022822 , y0=0.09724075587355635 , psi0=0.31999999732968964 , v0=1.800000007399675 , spline0=0.600000001858137 , a0=0.0 , w0=0.0
2026-01-24 11:32:00,900 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 11:32:00,901 - INFO - integration_test - Dyn residual k=0: pred=[0.7199978375107232, 0.153862736560971, 0.31999999732968964, 1.800000007399675, 0.7800000025981044], ws=[0.7199978375107232, 0.153862736560971, 0.31999999732968964, 1.800000007399675, 0.23353535364032743], res=[0.0, 0.0, 0.0, 0.0, 0.546464648957777], res_norm=5.465e-01
2026-01-24 11:32:00,902 - INFO - integration_test - Dyn residual k=1: pred=[0.8908602136191641, 0.21048471724838563, 0.31999999732968964, 1.800000007399675, 0.41353535438029493], ws=[0.8908602136191642, 0.21048471724838563, 0.31999999732968964, 1.800000007399675, 0.3010101011786905], res=[-1.1102230246251565e-16, 0.0, 0.0, 0.0, 0.11252525320160445], res_norm=1.125e-01
2026-01-24 11:32:00,903 - INFO - integration_test - Dyn residual k=2: pred=[1.0617225897276052, 0.2671066979358003, 0.31999999732968964, 1.800000007399675, 0.481010101918658], ws=[1.0617225897276052, 0.2671066979358003, 0.31999999732968964, 1.800000007399675, 0.37212121236836604], res=[0.0, 0.0, 0.0, 0.0, 0.10888888955029197], res_norm=1.089e-01
2026-01-24 11:32:00,918 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:01,856 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:01,876 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:01,918 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:01,938 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:01,982 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:02,001 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:02,044 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:02,063 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:02,108 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:02,128 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:02,170 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:02,198 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:02,261 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:02,283 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:02,329 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:02,349 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:02,391 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:02,411 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:02,454 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:02,473 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:02,518 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:03,064 - INFO - integration_test - Step 4: MPC solve successful
2026-01-24 11:32:03,068 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:32:03,068 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1877 scenarios available
2026-01-24 11:32:03,080 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1877 trajectory groups with 18770 total points
2026-01-24 11:32:03,081 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:32:03,207 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 11:32:03,217 - INFO - integration_test - Step 4: Computed 6 numeric contouring constraints for visualization (s=0.600)
2026-01-24 11:32:03,218 - DEBUG - integration_test - Step 4: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 11:32:03,218 - INFO - integration_test - === Applying control at step 4 ===
2026-01-24 11:32:03,218 - INFO - integration_test -   Control dict from planner: {'a': 2.000000011871285, 'w': 0.7999999457765679}
2026-01-24 11:32:03,218 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 11:32:03,218 - INFO - integration_test -   Planner output success: True
2026-01-24 11:32:03,219 - INFO - integration_test - Step 4 completed in 4.418s
2026-01-24 11:32:03,274 - INFO - integration_test - Step 5 (contouring until path end)
2026-01-24 11:32:03,274 - DEBUG - integration_test - Syncing planner state at step 5: vehicle_state=[0.72686149 0.16427977 0.39999999 2.00000001 0.8       ]
2026-01-24 11:32:03,275 - DEBUG - integration_test - Step 5: Using propagated spline 0.8000 (close to path, dist=0.443m, drift=0.019m)
2026-01-24 11:32:03,275 - DEBUG - integration_test -   Set spline state to 0.8000
2026-01-24 11:32:03,276 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:32:04,276 - DEBUG - integration_test - Step 5: Checking path alignment: vehicle=(0.727, 0.164), path_start=(0.000, 0.000), dist=0.745m
2026-01-24 11:32:04,276 - INFO - integration_test - === Calling planner.solve_mpc() at step 5 ===
2026-01-24 11:32:05,207 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:32:05,233 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 11:32:05,233 - INFO - integration_test - Warmstart k=0: x0=0.7268614891953731 , y0=0.16427976630362456 , psi0=0.3999999919073464 , v0=2.0000000085868033 , spline0=0.8000000027168173 , a0=0.0 , w0=0.0
2026-01-24 11:32:05,233 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 11:32:05,234 - INFO - integration_test - Dyn residual k=0: pred=[0.9110736894171326, 0.24216343360897502, 0.3999999919073464, 2.0000000085868033, 1.0000000035754977], ws=[0.9110736894171326, 0.24216343360897502, 0.39999999190734625, 2.0000000085868033, 0.3636363638530604], res=[0.0, 0.0, 1.6653345369377348e-16, 0.0, 0.6363636397224373], res_norm=6.364e-01
2026-01-24 11:32:05,235 - INFO - integration_test - Dyn residual k=1: pred=[1.0952858896388922, 0.3200471009143254, 0.39999999190734625, 2.0000000085868033, 0.5636363647117407], ws=[1.0952858896388922, 0.3200471009143254, 0.39999999190734625, 2.0000000085868033, 0.8767676773947324], res=[0.0, 0.0, 0.0, 0.0, -0.31313131268299166], res_norm=3.131e-01
2026-01-24 11:32:05,236 - INFO - integration_test - Dyn residual k=2: pred=[1.2794980898606516, 0.3979307682196759, 0.39999999190734625, 2.0000000085868033, 1.0767676782534128], ws=[1.2794980898606516, 0.3979307682196759, 0.39999999190734625, 2.0000000085868033, 0.9696969704989178], res=[0.0, 0.0, 0.0, 0.0, 0.10707070775449501], res_norm=1.071e-01
2026-01-24 11:32:05,253 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:06,265 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:06,286 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:06,334 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:06,355 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:06,402 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:06,425 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:06,471 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:06,493 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:06,539 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:06,559 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:06,607 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:06,629 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:06,676 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:06,698 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:06,743 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:06,764 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:06,807 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:06,829 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:06,876 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:06,896 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:06,939 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:07,554 - INFO - integration_test - Step 5: MPC solve successful
2026-01-24 11:32:07,558 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:32:07,558 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1848 scenarios available
2026-01-24 11:32:07,569 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1848 trajectory groups with 18480 total points
2026-01-24 11:32:07,570 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:32:07,770 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 11:32:07,781 - INFO - integration_test - Step 5: Computed 6 numeric contouring constraints for visualization (s=0.800)
2026-01-24 11:32:07,781 - DEBUG - integration_test - Step 5: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 11:32:07,781 - INFO - integration_test - === Applying control at step 5 ===
2026-01-24 11:32:07,781 - INFO - integration_test -   Control dict from planner: {'a': 2.000000019562985, 'w': 0.8000000073143384}
2026-01-24 11:32:07,781 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 11:32:07,781 - INFO - integration_test -   Planner output success: True
2026-01-24 11:32:07,783 - INFO - integration_test - Step 5 completed in 4.508s
2026-01-24 11:32:07,841 - INFO - integration_test - Step 6 (contouring until path end)
2026-01-24 11:32:07,842 - DEBUG - integration_test - Syncing planner state at step 6: vehicle_state=[0.9167519  0.2538238  0.47999999 2.20000001 1.02      ]
2026-01-24 11:32:07,843 - DEBUG - integration_test - Step 6: Using propagated spline 1.0200 (close to path, dist=0.471m, drift=0.201m)
2026-01-24 11:32:07,843 - DEBUG - integration_test -   Set spline state to 1.0200
2026-01-24 11:32:07,844 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:32:08,739 - DEBUG - integration_test - Step 6: Checking path alignment: vehicle=(0.917, 0.254), path_start=(0.000, 0.000), dist=0.951m
2026-01-24 11:32:08,739 - INFO - integration_test - === Calling planner.solve_mpc() at step 6 ===
2026-01-24 11:32:09,715 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:32:09,741 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 11:32:09,741 - INFO - integration_test - Warmstart k=0: x0=0.9167519039032318 , y0=0.2538238048682155 , psi0=0.47999999263878024 , v0=2.2000000105431017 , spline0=1.0200000037711274 , a0=0.0 , w0=0.0
2026-01-24 11:32:09,741 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 11:32:09,742 - INFO - integration_test - Dyn residual k=0: pred=[1.1118907885976788, 0.35541522253774, 0.47999999263878024, 2.2000000105431017, 1.2400000048254376], ws=[1.111890788597679, 0.35541522253774, 0.47999999263878035, 2.2000000105431017, 0.693333333869493], res=[-2.220446049250313e-16, 0.0, -1.1102230246251565e-16, 0.0, 0.5466666709559446], res_norm=5.467e-01
2026-01-24 11:32:09,743 - INFO - integration_test - Dyn residual k=1: pred=[1.307029673292126, 0.4570066402072645, 0.47999999263878035, 2.2000000105431017, 0.9133333349238032], ws=[1.307029673292126, 0.45700664020726456, 0.47999999263878035, 2.2000000105431017, 1.2397979809264161], res=[0.0, -5.551115123125783e-17, 0.0, 0.0, -0.32646464600261293], res_norm=3.265e-01
2026-01-24 11:32:09,743 - INFO - integration_test - Dyn residual k=2: pred=[1.5021685579865731, 0.5585980578767891, 0.47999999263878035, 2.2000000105431017, 1.4597979819807263], ws=[1.5021685579865731, 0.5585980578767891, 0.47999999263878035, 2.2000000105431017, 1.0795959607166155], res=[0.0, 0.0, 0.0, 0.0, 0.38020202126411085], res_norm=3.802e-01
2026-01-24 11:32:09,760 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:10,720 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:10,741 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:10,784 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:10,805 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:10,850 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:10,870 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:10,916 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:10,938 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:10,982 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:11,002 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:11,049 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:11,069 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:11,116 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:11,138 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:11,185 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:11,209 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:11,255 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:11,276 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:11,322 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:11,343 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:11,388 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:12,088 - INFO - integration_test - Step 6: MPC solve successful
2026-01-24 11:32:12,092 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:32:12,092 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1862 scenarios available
2026-01-24 11:32:12,214 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1862 trajectory groups with 18620 total points
2026-01-24 11:32:12,214 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:32:12,339 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 11:32:12,351 - INFO - integration_test - Step 6: Computed 6 numeric contouring constraints for visualization (s=1.020)
2026-01-24 11:32:12,351 - DEBUG - integration_test - Step 6: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 11:32:12,351 - INFO - integration_test - === Applying control at step 6 ===
2026-01-24 11:32:12,351 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000166378356, 'w': 0.7999999670087937}
2026-01-24 11:32:12,351 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 11:32:12,352 - INFO - integration_test -   Planner output success: True
2026-01-24 11:32:12,353 - INFO - integration_test - Step 6 completed in 4.511s
2026-01-24 11:32:12,418 - INFO - integration_test - Step 7 (contouring until path end)
2026-01-24 11:32:12,420 - DEBUG - integration_test - Syncing planner state at step 7: vehicle_state=[1.11623087 0.36819144 0.55999999 2.40000001 1.26      ]
2026-01-24 11:32:12,421 - DEBUG - integration_test - Step 7: Using propagated spline 1.2600 (close to path, dist=0.559m, drift=0.031m)
2026-01-24 11:32:12,421 - DEBUG - integration_test -   Set spline state to 1.2600
2026-01-24 11:32:12,422 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:32:13,323 - DEBUG - integration_test - Step 7: Checking path alignment: vehicle=(1.116, 0.368), path_start=(0.000, 0.000), dist=1.175m
2026-01-24 11:32:13,323 - INFO - integration_test - === Calling planner.solve_mpc() at step 7 ===
2026-01-24 11:32:14,212 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:32:14,239 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 11:32:14,239 - INFO - integration_test - Warmstart k=0: x0=1.116230865086905 , y0=0.3681914424572412 , psi0=0.5599999893396597 , v0=2.400000012206885 , spline0=1.260000004991816 , a0=0.0 , w0=0.0
2026-01-24 11:32:14,239 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 11:32:14,240 - INFO - integration_test - Dyn residual k=0: pred=[1.3195720941233897, 0.49567612843897946, 0.5599999893396597, 2.400000012206885, 1.5000000062125047], ws=[1.3195720941233897, 0.49567612843897946, 0.5599999893396594, 2.400000012206885, 1.2474747486670463], res=[0.0, 0.0, 2.220446049250313e-16, 0.0, 0.2525252575454584], res_norm=2.525e-01
2026-01-24 11:32:14,241 - INFO - integration_test - Dyn residual k=1: pred=[1.5229133231598744, 0.6231608144207176, 0.5599999893396594, 2.400000012206885, 1.4874747498877348], ws=[1.5229133231598744, 0.6231608144207177, 0.5599999893396594, 2.400000012206885, 1.361616163117817], res=[0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.1258585867699178], res_norm=1.259e-01
2026-01-24 11:32:14,242 - INFO - integration_test - Dyn residual k=2: pred=[1.726254552196359, 0.7506455004024558, 0.5599999893396594, 2.400000012206885, 1.6016161643385054], ws=[1.726254552196359, 0.7506455004024559, 0.5599999893396594, 2.400000012206885, 1.1985858600718786], res=[0.0, -1.1102230246251565e-16, 0.0, 0.0, 0.4030303042666268], res_norm=4.030e-01
2026-01-24 11:32:14,258 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:15,347 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:15,368 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:15,412 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:15,433 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:15,477 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:15,498 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:15,543 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:15,563 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:15,606 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:15,628 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:15,673 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:15,692 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:15,735 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:15,755 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:15,798 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:15,819 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:15,863 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:15,884 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:15,927 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:15,946 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:15,989 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:16,599 - INFO - integration_test - Step 7: MPC solve successful
2026-01-24 11:32:16,604 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:32:16,604 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1853 scenarios available
2026-01-24 11:32:16,719 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1853 trajectory groups with 18530 total points
2026-01-24 11:32:16,720 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:32:16,840 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 11:32:16,851 - INFO - integration_test - Step 7: Computed 6 numeric contouring constraints for visualization (s=1.260)
2026-01-24 11:32:16,852 - DEBUG - integration_test - Step 7: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 11:32:16,852 - INFO - integration_test - === Applying control at step 7 ===
2026-01-24 11:32:16,852 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000195918326, 'w': 0.8000000010877297}
2026-01-24 11:32:16,852 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 11:32:16,852 - INFO - integration_test -   Planner output success: True
2026-01-24 11:32:16,853 - INFO - integration_test - Step 7 completed in 4.433s
2026-01-24 11:32:16,907 - INFO - integration_test - Step 8 (contouring until path end)
2026-01-24 11:32:16,908 - DEBUG - integration_test - Syncing planner state at step 8: vehicle_state=[1.32243449 0.50942444 0.63999999 2.60000001 1.52000001]
2026-01-24 11:32:16,909 - DEBUG - integration_test - Step 8: Using propagated spline 1.5200 (close to path, dist=0.577m, drift=0.291m)
2026-01-24 11:32:16,909 - DEBUG - integration_test -   Set spline state to 1.5200
2026-01-24 11:32:16,909 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:32:17,862 - DEBUG - integration_test - Step 8: Checking path alignment: vehicle=(1.322, 0.509), path_start=(0.000, 0.000), dist=1.417m
2026-01-24 11:32:17,863 - INFO - integration_test - === Calling planner.solve_mpc() at step 8 ===
2026-01-24 11:32:18,810 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:32:18,836 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 11:32:18,836 - INFO - integration_test - Warmstart k=0: x0=1.3224344907723322 , y0=0.5094244369574575 , psi0=0.6399999894484326 , v0=2.6000000141660684 , spline0=1.520000006408423 , a0=0.0 , w0=0.0
2026-01-24 11:32:18,836 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 11:32:18,837 - INFO - integration_test - Dyn residual k=0: pred=[1.5309793905968532, 0.664695250357195, 0.6399999894484326, 2.6000000141660684, 1.7800000078250298], ws=[1.5309793905968532, 0.664695250357195, 0.6399999894484325, 2.6000000141660684, 1.3696969712777838], res=[0.0, 0.0, 1.1102230246251565e-16, 0.0, 0.410303036547246], res_norm=4.103e-01
2026-01-24 11:32:18,837 - INFO - integration_test - Dyn residual k=1: pred=[1.7395242904213741, 0.8199660637569325, 0.6399999894484325, 2.6000000141660684, 1.6296969726943906], ws=[1.7395242904213741, 0.8199660637569325, 0.6399999894484325, 2.6000000141660684, 1.7066666689070635], res=[0.0, 0.0, 0.0, 0.0, -0.07696969621267291], res_norm=7.697e-02
2026-01-24 11:32:18,838 - INFO - integration_test - Dyn residual k=2: pred=[1.948069190245895, 0.97523687715667, 0.6399999894484325, 2.6000000141660684, 1.9666666703236704], ws=[1.948069190245895, 0.97523687715667, 0.6399999894484325, 2.6000000141660684, 2.0646464676609173], res=[0.0, 0.0, 0.0, 0.0, -0.09797979733724693], res_norm=9.798e-02
2026-01-24 11:32:18,856 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:19,810 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:19,831 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:19,876 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:19,897 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:19,941 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:19,962 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:20,007 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:20,028 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:20,073 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:20,094 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:20,141 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:20,163 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:20,222 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:20,244 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:20,290 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:20,311 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:20,354 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:20,375 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:20,420 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:20,440 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:20,486 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:21,150 - INFO - integration_test - Step 8: MPC solve successful
2026-01-24 11:32:21,156 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:32:21,156 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1847 scenarios available
2026-01-24 11:32:21,288 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1847 trajectory groups with 18470 total points
2026-01-24 11:32:21,289 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:32:21,443 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 11:32:21,458 - INFO - integration_test - Step 8: Computed 6 numeric contouring constraints for visualization (s=1.520)
2026-01-24 11:32:21,458 - DEBUG - integration_test - Step 8: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 11:32:21,458 - INFO - integration_test - === Applying control at step 8 ===
2026-01-24 11:32:21,458 - INFO - integration_test -   Control dict from planner: {'a': 2.000000019979806, 'w': 0.8000000095838036}
2026-01-24 11:32:21,458 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 11:32:21,458 - INFO - integration_test -   Planner output success: True
2026-01-24 11:32:21,460 - INFO - integration_test - Step 8 completed in 4.552s
2026-01-24 11:32:21,525 - INFO - integration_test - Step 9 (contouring until path end)
2026-01-24 11:32:21,526 - DEBUG - integration_test - Syncing planner state at step 9: vehicle_state=[1.53223933 0.67925693 0.71999999 2.80000002 1.80000001]
2026-01-24 11:32:21,527 - DEBUG - integration_test - Step 9: Using propagated spline 1.8000 (close to path, dist=0.602m, drift=0.161m)
2026-01-24 11:32:21,527 - DEBUG - integration_test -   Set spline state to 1.8000
2026-01-24 11:32:21,528 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:32:22,460 - DEBUG - integration_test - Step 9: Checking path alignment: vehicle=(1.532, 0.679), path_start=(0.000, 0.000), dist=1.676m
2026-01-24 11:32:22,460 - INFO - integration_test - === Calling planner.solve_mpc() at step 9 ===
2026-01-24 11:32:23,318 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:32:23,341 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 11:32:23,341 - INFO - integration_test - Warmstart k=0: x0=1.5322393332353745 , y0=0.6792569339397602 , psi0=0.719999990406813 , v0=2.800000016164049 , spline0=1.8000000080248277 , a0=0.0 , w0=0.0
2026-01-24 11:32:23,341 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 11:32:23,342 - INFO - integration_test - Dyn residual k=0: pred=[1.7427449403812156, 0.8638846411381856, 0.719999990406813, 2.800000016164049, 2.0800000096412328], ws=[1.7427449403812156, 0.8638846411381856, 0.7199999904068131, 2.800000016164049, 1.716363638700905], res=[0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.36363637094032786], res_norm=3.636e-01
2026-01-24 11:32:23,343 - INFO - integration_test - Dyn residual k=1: pred=[1.9532505475270567, 1.048512348336611, 0.7199999904068131, 2.800000016164049, 1.99636364031731], ws=[1.9532505475270567, 1.0485123483366112, 0.7199999904068131, 2.800000016164049, 2.08161616480014], res=[0.0, -2.220446049250313e-16, 0.0, 0.0, -0.08525252448283016], res_norm=8.525e-02
2026-01-24 11:32:23,343 - INFO - integration_test - Dyn residual k=2: pred=[2.163756154672898, 1.2331400555350367, 0.7199999904068131, 2.800000016164049, 2.361616166416545], ws=[2.163756154672898, 1.2331400555350367, 0.7199999904068131, 2.800000016164049, 1.9292929325439503], res=[0.0, 0.0, 0.0, 0.0, 0.43232323387259486], res_norm=4.323e-01
2026-01-24 11:32:23,359 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:24,405 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:24,426 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:24,472 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:24,494 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:24,540 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:24,560 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:24,604 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:24,626 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:24,667 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:24,687 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:24,730 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:24,751 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:24,791 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:24,813 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:24,855 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:24,875 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:24,916 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:24,936 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:24,978 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:24,999 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:25,043 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:25,663 - INFO - integration_test - Step 9: MPC solve successful
2026-01-24 11:32:25,669 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:32:25,669 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1861 scenarios available
2026-01-24 11:32:25,683 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1861 trajectory groups with 18610 total points
2026-01-24 11:32:25,684 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:32:25,863 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 11:32:25,877 - INFO - integration_test - Step 9: Computed 6 numeric contouring constraints for visualization (s=1.800)
2026-01-24 11:32:25,878 - DEBUG - integration_test - Step 9: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 11:32:25,878 - INFO - integration_test - === Applying control at step 9 ===
2026-01-24 11:32:25,878 - INFO - integration_test -   Control dict from planner: {'a': 2.0000000160316493, 'w': 0.7999999250044691}
2026-01-24 11:32:25,878 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 11:32:25,878 - INFO - integration_test -   Planner output success: True
2026-01-24 11:32:25,879 - INFO - integration_test - Step 9 completed in 4.353s
2026-01-24 11:32:25,946 - INFO - integration_test - Step 10 (contouring until path end)
2026-01-24 11:32:25,954 - DEBUG - integration_test - Syncing planner state at step 10: vehicle_state=[1.7422939  0.8790875  0.79999998 3.00000002 2.10000001]
2026-01-24 11:32:25,954 - DEBUG - integration_test - Step 10: Using propagated spline 2.1000 (close to path, dist=0.628m, drift=0.052m)
2026-01-24 11:32:25,954 - DEBUG - integration_test -   Set spline state to 2.1000
2026-01-24 11:32:25,955 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:32:26,918 - DEBUG - integration_test - Step 10: Checking path alignment: vehicle=(1.742, 0.879), path_start=(0.000, 0.000), dist=1.952m
2026-01-24 11:32:26,918 - INFO - integration_test - === Calling planner.solve_mpc() at step 10 ===
2026-01-24 11:32:27,990 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:32:28,015 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 11:32:28,015 - INFO - integration_test - Warmstart k=0: x0=1.742293902053325 , y0=0.8790875009322229 , psi0=0.7999999829072598 , v0=3.000000017767214 , spline0=2.100000009801549 , a0=0.0 , w0=0.0
2026-01-24 11:32:28,015 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 11:32:28,016 - INFO - integration_test - Dyn residual k=0: pred=[1.9513059197738027, 1.0942943259040334, 0.7999999829072598, 3.000000017767214, 2.4000000115782703], ws=[1.951305918535949, 1.0942943246294916, 0.7999999829072597, 3.0, 2.0929292957014485], res=[1.2378538194468547e-09, 1.2745418054294078e-09, 1.1102230246251565e-16, 1.7767213922326164e-08, 0.3070707158768218], res_norm=3.071e-01
2026-01-24 11:32:28,017 - INFO - integration_test - Dyn residual k=1: pred=[2.160317935018573, 1.3095011483267605, 0.7999999829072597, 3.0, 2.3929292957014487], ws=[2.160317935018573, 1.3095011483267605, 0.7999999829072597, 3.0, 2.488888892057066], res=[0.0, 0.0, 0.0, 0.0, -0.09595959635561746], res_norm=9.596e-02
2026-01-24 11:32:28,017 - INFO - integration_test - Dyn residual k=2: pred=[2.369329951501197, 1.5247079720240293, 0.7999999829072597, 3.0, 2.7888888920570665], ws=[2.369329951501197, 1.5247079720240293, 0.7999999829072597, 3.0, 2.3434343463055045], res=[0.0, 0.0, 0.0, 0.0, 0.44545454575156196], res_norm=4.455e-01
2026-01-24 11:32:28,034 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:28,986 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:29,011 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:29,060 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:29,084 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:29,134 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:29,157 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:29,207 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:29,230 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:29,279 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:29,302 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:29,351 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:29,374 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:29,423 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:29,445 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:29,497 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:29,520 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:29,583 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:29,611 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:29,658 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:29,679 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:29,723 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:30,378 - INFO - integration_test - Step 10: MPC solve successful
2026-01-24 11:32:30,389 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:32:30,389 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1838 scenarios available
2026-01-24 11:32:30,406 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1838 trajectory groups with 18380 total points
2026-01-24 11:32:30,407 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:32:30,581 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 11:32:30,594 - INFO - integration_test - Step 10: Computed 6 numeric contouring constraints for visualization (s=2.100)
2026-01-24 11:32:30,594 - DEBUG - integration_test - Step 10: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 11:32:30,594 - INFO - integration_test - === Applying control at step 10 ===
2026-01-24 11:32:30,594 - INFO - integration_test -   Control dict from planner: {'a': 1.2232597438277926e-07, 'w': 0.8000000095261843}
2026-01-24 11:32:30,594 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 11:32:30,594 - INFO - integration_test -   Planner output success: True
2026-01-24 11:32:30,595 - INFO - integration_test - Step 10 completed in 4.642s
2026-01-24 11:32:30,651 - INFO - integration_test - Step 11 (contouring until path end)
2026-01-24 11:32:30,652 - DEBUG - integration_test - Syncing planner state at step 11: vehicle_state=[1.94247937 1.10242087 0.87999998 3.00000003 2.40000001]
2026-01-24 11:32:30,652 - DEBUG - integration_test - Step 11: Using propagated spline 2.4000 (close to path, dist=0.588m, drift=0.352m)
2026-01-24 11:32:30,652 - DEBUG - integration_test -   Set spline state to 2.4000
2026-01-24 11:32:30,653 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:32:31,645 - DEBUG - integration_test - Step 11: Checking path alignment: vehicle=(1.942, 1.102), path_start=(0.000, 0.000), dist=2.234m
2026-01-24 11:32:31,645 - INFO - integration_test - === Calling planner.solve_mpc() at step 11 ===
2026-01-24 11:32:32,516 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:32:32,542 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 11:32:32,542 - INFO - integration_test - Warmstart k=0: x0=1.9424793651962458 , y0=1.1024208718719701 , psi0=0.8799999838598782 , v0=3.0000000299998115 , spline0=2.40000001280153 , a0=0.0 , w0=0.0
2026-01-24 11:32:32,542 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 11:32:32,543 - INFO - integration_test - Dyn residual k=0: pred=[2.133624714099207, 1.333642534768754, 0.8799999838598782, 3.0000000299998115, 2.7000000158015114], ws=[2.133624712187766, 1.3336425324565517, 0.8799999838598787, 3.0, 2.488888893026757], res=[1.911441227520072e-09, 2.3122022074772985e-09, -4.440892098500626e-16, 2.9999811523850894e-08, 0.2111111227747542], res_norm=2.111e-01
2026-01-24 11:32:32,544 - INFO - integration_test - Dyn residual k=1: pred=[2.3247700591792855, 1.5648641930411336, 0.8799999838598787, 3.0, 2.7888888930267575], ws=[2.3247700591792855, 1.5648641930411336, 0.8799999838598787, 3.0, 2.3434343471842864], res=[0.0, 0.0, 0.0, 0.0, 0.445454545842471], res_norm=4.455e-01
2026-01-24 11:32:32,545 - INFO - integration_test - Dyn residual k=2: pred=[2.515915406170805, 1.7960858536257154, 0.8799999838598787, 3.0, 2.6434343471842867], ws=[2.515915406170805, 1.7960858536257154, 0.8799999838598787, 3.0, 2.9343434388692278], res=[0.0, 0.0, 0.0, 0.0, -0.29090909168494106], res_norm=2.909e-01
2026-01-24 11:32:32,562 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:33,580 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:33,602 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:33,647 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:33,671 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:33,718 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:33,740 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:33,787 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:33,809 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:33,854 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:33,875 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:33,922 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:33,943 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:33,989 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:34,011 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:34,057 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:34,079 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:34,127 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:34,149 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:34,194 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:34,215 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:34,260 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:34,921 - INFO - integration_test - Step 11: MPC solve successful
2026-01-24 11:32:34,928 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:32:34,928 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1855 scenarios available
2026-01-24 11:32:34,942 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1855 trajectory groups with 18550 total points
2026-01-24 11:32:34,943 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:32:35,164 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 11:32:35,179 - INFO - integration_test - Step 11: Computed 6 numeric contouring constraints for visualization (s=2.400)
2026-01-24 11:32:35,179 - DEBUG - integration_test - Step 11: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 11:32:35,179 - INFO - integration_test - === Applying control at step 11 ===
2026-01-24 11:32:35,179 - INFO - integration_test -   Control dict from planner: {'a': -1.2254620497468114e-09, 'w': 0.05260428535246833}
2026-01-24 11:32:35,179 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 11:32:35,179 - INFO - integration_test -   Planner output success: True
2026-01-24 11:32:35,181 - INFO - integration_test - Step 11 completed in 4.529s
2026-01-24 11:32:35,245 - INFO - integration_test - Step 12 (contouring until path end)
2026-01-24 11:32:35,246 - DEBUG - integration_test - Syncing planner state at step 12: vehicle_state=[2.13301567 1.33414422 0.88526041 3.00000003 2.70000002]
2026-01-24 11:32:35,246 - DEBUG - integration_test - Step 12: Using propagated spline 2.7000 (close to path, dist=0.540m, drift=0.242m)
2026-01-24 11:32:35,246 - DEBUG - integration_test -   Set spline state to 2.7000
2026-01-24 11:32:35,247 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:32:36,292 - DEBUG - integration_test - Step 12: Checking path alignment: vehicle=(2.133, 1.334), path_start=(0.000, 0.000), dist=2.516m
2026-01-24 11:32:36,292 - INFO - integration_test - === Calling planner.solve_mpc() at step 12 ===
2026-01-24 11:32:37,176 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:32:37,201 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 11:32:37,202 - INFO - integration_test - Warmstart k=0: x0=2.1330156714164805 , y0=1.334144220431591 , psi0=0.8852604123951251 , v0=3.000000029877265 , spline0=2.7000000157892563 , a0=0.0 , w0=0.0
2026-01-24 11:32:37,202 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 11:32:37,203 - INFO - integration_test - Dyn residual k=0: pred=[2.322942056196613, 1.5663681859411502, 0.8852604123951251, 3.000000029877265, 3.0000000187769826], ws=[2.3229420543051194, 1.5663681836284113, 0.8852604123951249, 3.0, 2.343434348059479], res=[1.891493628392027e-09, 2.3127388892874023e-09, 2.220446049250313e-16, 2.987726510639277e-08, 0.6565656707175038], res_norm=6.566e-01
2026-01-24 11:32:37,203 - INFO - integration_test - Dyn residual k=1: pred=[2.512868437193758, 1.7985921468252317, 0.8852604123951249, 3.0, 2.643434348059479], ws=[2.512868437193758, 1.7985921468252317, 0.8852604123951249, 3.0, 2.934343439925494], res=[0.0, 0.0, 0.0, 0.0, -0.2909090918660149], res_norm=2.909e-01
2026-01-24 11:32:37,204 - INFO - integration_test - Dyn residual k=2: pred=[2.702794820082397, 2.030816110022052, 0.8852604123951249, 3.0, 3.2343434399254942], ws=[2.702794820082397, 2.030816110022052, 0.8852604123951249, 3.0, 3.3010101070706233], res=[0.0, 0.0, 0.0, 0.0, -0.06666666714512903], res_norm=6.667e-02
2026-01-24 11:32:37,219 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:38,251 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:38,273 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:38,321 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:38,344 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:38,389 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:38,411 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:38,458 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:38,480 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:38,528 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:38,549 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:38,594 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:38,617 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:38,662 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:38,684 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:38,731 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:38,755 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:38,803 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:38,825 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:38,872 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:38,892 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:38,939 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:39,598 - INFO - integration_test - Step 12: MPC solve successful
2026-01-24 11:32:39,606 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:32:39,606 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1871 scenarios available
2026-01-24 11:32:39,621 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1871 trajectory groups with 18710 total points
2026-01-24 11:32:39,622 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:32:39,817 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 11:32:39,834 - INFO - integration_test - Step 12: Computed 6 numeric contouring constraints for visualization (s=2.700)
2026-01-24 11:32:39,834 - DEBUG - integration_test - Step 12: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 11:32:39,834 - INFO - integration_test - === Applying control at step 12 ===
2026-01-24 11:32:39,834 - INFO - integration_test -   Control dict from planner: {'a': -9.999449298849446e-09, 'w': -0.22854995782137386}
2026-01-24 11:32:39,834 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 11:32:39,834 - INFO - integration_test -   Planner output success: True
2026-01-24 11:32:39,836 - INFO - integration_test - Step 12 completed in 4.590s
2026-01-24 11:32:39,898 - INFO - integration_test - Step 13 (contouring until path end)
2026-01-24 11:32:39,907 - DEBUG - integration_test - Syncing planner state at step 13: vehicle_state=[2.32557915 1.56417768 0.86240542 3.00000003 3.00000002]
2026-01-24 11:32:39,907 - DEBUG - integration_test - Step 13: Using propagated spline 3.0000 (close to path, dist=0.515m, drift=0.132m)
2026-01-24 11:32:39,907 - DEBUG - integration_test -   Set spline state to 3.0000
2026-01-24 11:32:39,908 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:32:41,009 - DEBUG - integration_test - Step 13: Checking path alignment: vehicle=(2.326, 1.564), path_start=(0.000, 0.000), dist=2.803m
2026-01-24 11:32:41,009 - INFO - integration_test - === Calling planner.solve_mpc() at step 13 ===
2026-01-24 11:32:41,931 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:32:41,957 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 11:32:41,957 - INFO - integration_test - Warmstart k=0: x0=2.3255791452765027 , y0=1.5641776805010874 , psi0=0.8624054166129878 , v0=3.00000002887732 , spline0=3.0000000186769884 , a0=0.0 , w0=0.0
2026-01-24 11:32:41,957 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 11:32:41,958 - INFO - integration_test - Dyn residual k=0: pred=[2.5207629437515915, 1.7920006085515254, 0.8624054166129878, 3.00000002887732, 3.3000000215647205], ws=[2.5207629418727966, 1.7920006063585536, 0.8624054166129875, 3.0, 2.9343434409464106], res=[1.8787948974363644e-09, 2.192971804149124e-09, 2.220446049250313e-16, 2.887732009071442e-08, 0.36565658061830986], res_norm=3.657e-01
2026-01-24 11:32:41,959 - INFO - integration_test - Dyn residual k=1: pred=[2.7159467384690905, 2.01982353221602, 0.8624054166129875, 3.0, 3.234343440946411], ws=[2.7159467384690905, 2.01982353221602, 0.8624054166129875, 3.0, 3.3010101081790464], res=[0.0, 0.0, 0.0, 0.0, -0.06666666723263548], res_norm=6.667e-02
2026-01-24 11:32:41,960 - INFO - integration_test - Dyn residual k=2: pred=[2.9111305350653844, 2.2476464580734863, 0.8624054166129875, 3.0, 3.6010101081790467], ws=[2.9111305350653844, 2.2476464580734863, 0.8624054166129875, 3.0, 3.6858585935934998], res=[0.0, 0.0, 0.0, 0.0, -0.08484848541445311], res_norm=8.485e-02
2026-01-24 11:32:41,976 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:42,937 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:42,958 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:43,001 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:43,021 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:43,068 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:43,094 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:43,158 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:43,181 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:43,228 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:43,250 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:43,294 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:43,317 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:43,361 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:43,382 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:43,428 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:43,449 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:43,492 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:43,515 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:43,559 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:43,581 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:43,626 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:44,387 - INFO - integration_test - Step 13: MPC solve successful
2026-01-24 11:32:44,395 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:32:44,395 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1852 scenarios available
2026-01-24 11:32:44,410 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1852 trajectory groups with 18520 total points
2026-01-24 11:32:44,411 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:32:44,775 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 11:32:44,787 - INFO - integration_test - Step 13: Computed 6 numeric contouring constraints for visualization (s=3.000)
2026-01-24 11:32:44,787 - DEBUG - integration_test - Step 13: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 11:32:44,787 - INFO - integration_test - === Applying control at step 13 ===
2026-01-24 11:32:44,787 - INFO - integration_test -   Control dict from planner: {'a': 1.1225679808616118e-08, 'w': -0.13396542913056378}
2026-01-24 11:32:44,787 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 11:32:44,787 - INFO - integration_test -   Planner output success: True
2026-01-24 11:32:44,789 - INFO - integration_test - Step 13 completed in 4.882s
2026-01-24 11:32:44,841 - INFO - integration_test - Step 14 (contouring until path end)
2026-01-24 11:32:44,843 - DEBUG - integration_test - Syncing planner state at step 14: vehicle_state=[2.5222831  1.79068642 0.84900887 3.00000003 3.30000002]
2026-01-24 11:32:44,843 - DEBUG - integration_test - Step 14: Using propagated spline 3.3000 (close to path, dist=0.510m, drift=0.432m)
2026-01-24 11:32:44,843 - DEBUG - integration_test -   Set spline state to 3.3000
2026-01-24 11:32:44,844 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:32:45,710 - DEBUG - integration_test - Step 14: Checking path alignment: vehicle=(2.522, 1.791), path_start=(0.000, 0.000), dist=3.093m
2026-01-24 11:32:45,710 - INFO - integration_test - === Calling planner.solve_mpc() at step 14 ===
2026-01-24 11:32:46,623 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:32:46,648 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 11:32:46,648 - INFO - integration_test - Warmstart k=0: x0=2.5222831026498493 , y0=1.790686419680847 , psi0=0.8490088736999314 , v0=3.000000029999888 , spline0=3.3000000216769774 , a0=0.0 , w0=0.0
2026-01-24 11:32:46,648 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 11:32:46,649 - INFO - integration_test - Dyn residual k=0: pred=[2.720501335243113, 2.0158741948099514, 0.8490088736999314, 3.000000029999888, 3.6000000246769663], ws=[2.720501333260938, 2.0158741925580825, 0.8490088736999315, 3.0, 3.3010101093305564], res=[1.9821748686865703e-09, 2.251868913560884e-09, -1.1102230246251565e-16, 2.999988790719499e-08, 0.29898991534640995], res_norm=2.990e-01
2026-01-24 11:32:46,650 - INFO - integration_test - Dyn residual k=1: pred=[2.9187195638720262, 2.2410619654353177, 0.8490088736999315, 3.0, 3.6010101093305567], ws=[2.9187195638720267, 2.241061965435318, 0.8490088736999315, 3.0, 3.6858585948359197], res=[-4.440892098500626e-16, -4.440892098500626e-16, 0.0, 0.0, -0.08484848550536306], res_norm=8.485e-02
2026-01-24 11:32:46,650 - INFO - integration_test - Dyn residual k=2: pred=[3.116937794483115, 2.4662497383125537, 0.8490088736999315, 3.0, 3.9858585948359195], ws=[3.116937794483115, 2.4662497383125537, 0.8490088736999315, 3.0, 3.810101019078344], res=[0.0, 0.0, 0.0, 0.0, 0.17575757575757534], res_norm=1.758e-01
2026-01-24 11:32:46,667 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:47,677 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:47,698 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:47,744 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:47,764 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:47,809 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:47,830 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:47,877 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:47,898 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:47,944 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:47,964 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:48,009 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:48,030 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:48,075 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:48,095 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:48,141 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:48,163 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:48,208 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:48,230 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:48,278 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:48,301 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:48,350 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:49,013 - INFO - integration_test - Step 14: MPC solve successful
2026-01-24 11:32:49,019 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:32:49,019 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1841 scenarios available
2026-01-24 11:32:49,032 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1841 trajectory groups with 18410 total points
2026-01-24 11:32:49,033 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:32:49,283 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 11:32:49,301 - INFO - integration_test - Step 14: Computed 6 numeric contouring constraints for visualization (s=3.300)
2026-01-24 11:32:49,302 - DEBUG - integration_test - Step 14: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 11:32:49,302 - INFO - integration_test - === Applying control at step 14 ===
2026-01-24 11:32:49,302 - INFO - integration_test -   Control dict from planner: {'a': -9.800778420548129e-06, 'w': -0.19600904511228076}
2026-01-24 11:32:49,302 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 11:32:49,302 - INFO - integration_test -   Planner output success: True
2026-01-24 11:32:49,304 - INFO - integration_test - Step 14 completed in 4.462s
2026-01-24 11:32:49,385 - INFO - integration_test - Step 15 (contouring until path end)
2026-01-24 11:32:49,387 - DEBUG - integration_test - Syncing planner state at step 15: vehicle_state=[2.72269548 2.01391717 0.82940797 2.99999905 3.59999993]
2026-01-24 11:32:49,388 - DEBUG - integration_test - Step 15: Using propagated spline 3.6000 (close to path, dist=0.452m, drift=0.322m)
2026-01-24 11:32:49,388 - DEBUG - integration_test -   Set spline state to 3.6000
2026-01-24 11:32:49,389 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:32:50,349 - DEBUG - integration_test - Step 15: Checking path alignment: vehicle=(2.723, 2.014), path_start=(0.000, 0.000), dist=3.387m
2026-01-24 11:32:50,349 - INFO - integration_test - === Calling planner.solve_mpc() at step 15 ===
2026-01-24 11:32:51,436 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:32:51,461 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 11:32:51,461 - INFO - integration_test - Warmstart k=0: x0=2.722695481598868 , y0=2.0139171732582444 , psi0=0.8294079691887033 , v0=2.999999049922046 , spline0=3.599999926669182 , a0=0.0 , w0=0.0
2026-01-24 11:32:51,461 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 11:32:51,462 - INFO - integration_test - Dyn residual k=0: pred=[2.925289173403493, 2.235176611557053, 0.8294079691887033, 2.999999049922046, 3.899999831661386], ws=[2.9252891734034936, 2.235176611557053, 0.8294079691887033, 2.999999049922046, 3.685858516142594], res=[-4.440892098500626e-16, 0.0, 0.0, 0.0, 0.21414131551879212], res_norm=2.141e-01
2026-01-24 11:32:51,463 - INFO - integration_test - Dyn residual k=1: pred=[3.1278828652081185, 2.4564360498558617, 0.8294079691887033, 2.999999049922046, 3.9858584211347985], ws=[3.127882865208119, 2.4564360498558617, 0.8294079691887033, 2.999999049922046, 3.8101009010383557], res=[-4.440892098500626e-16, 0.0, 0.0, 0.0, 0.17575752009644274], res_norm=1.758e-01
2026-01-24 11:32:51,464 - INFO - integration_test - Dyn residual k=2: pred=[3.330476557012744, 2.6776954881546704, 0.8294079691887033, 2.999999049922046, 4.110100806030561], ws=[3.3304765570127444, 2.6776954881546704, 0.8294079691887033, 2.999999049922046, 3.934343285934117], res=[-4.440892098500626e-16, 0.0, 0.0, 0.0, 0.17575752009644363], res_norm=1.758e-01
2026-01-24 11:32:51,480 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:52,385 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:52,404 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:52,460 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:52,492 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:52,544 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:52,566 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:52,610 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:52,628 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:52,672 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:52,691 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:52,735 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:52,754 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:52,795 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:52,815 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:52,855 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:52,875 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:52,919 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:52,938 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:52,980 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:52,999 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:53,040 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:53,616 - INFO - integration_test - Step 15: MPC solve successful
2026-01-24 11:32:53,631 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:32:53,631 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1856 scenarios available
2026-01-24 11:32:53,645 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1856 trajectory groups with 18560 total points
2026-01-24 11:32:53,646 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:32:53,878 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 11:32:53,900 - INFO - integration_test - Step 15: Computed 6 numeric contouring constraints for visualization (s=3.600)
2026-01-24 11:32:53,900 - DEBUG - integration_test - Step 15: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 11:32:53,900 - INFO - integration_test - === Applying control at step 15 ===
2026-01-24 11:32:53,900 - INFO - integration_test -   Control dict from planner: {'a': 9.79981188250444e-06, 'w': -0.0665469636920605}
2026-01-24 11:32:53,900 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 11:32:53,900 - INFO - integration_test -   Planner output success: True
2026-01-24 11:32:53,902 - INFO - integration_test - Step 15 completed in 4.515s
2026-01-24 11:32:53,965 - INFO - integration_test - Step 16 (contouring until path end)
2026-01-24 11:32:53,969 - DEBUG - integration_test - Syncing planner state at step 16: vehicle_state=[2.92602392 2.23450092 0.82275327 3.00000003 3.89999993]
2026-01-24 11:32:53,969 - DEBUG - integration_test - Step 16: Using propagated spline 3.9000 (close to path, dist=0.419m, drift=0.213m)
2026-01-24 11:32:53,969 - DEBUG - integration_test -   Set spline state to 3.9000
2026-01-24 11:32:53,970 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:32:54,928 - DEBUG - integration_test - Step 16: Checking path alignment: vehicle=(2.926, 2.235), path_start=(0.000, 0.000), dist=3.682m
2026-01-24 11:32:54,928 - INFO - integration_test - === Calling planner.solve_mpc() at step 16 ===
2026-01-24 11:32:55,921 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:32:55,945 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 11:32:55,946 - INFO - integration_test - Warmstart k=0: x0=2.9260239158202985 , y0=2.2345009172086057 , psi0=0.8227532728194973 , v0=3.000000029903234 , spline0=3.899999929659505 , a0=0.0 , w0=0.0
2026-01-24 11:32:55,946 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 11:32:55,947 - INFO - integration_test - Dyn residual k=0: pred=[3.130085591884252, 2.4544073385704297, 0.8227532728194973, 3.000000029903234, 4.1999999326498285], ws=[3.1300855898502173, 2.4544073363784586, 0.8227532728194973, 3.0, 3.810100980970098], res=[2.034034718434441e-09, 2.191971049114727e-09, 0.0, 2.990323411111717e-08, 0.38989895167973065], res_norm=3.899e-01
2026-01-24 11:32:55,947 - INFO - integration_test - Dyn residual k=1: pred=[3.334147263880136, 2.6743137555483116, 0.8227532728194973, 3.0, 4.110100980970098], ws=[3.334147263880136, 2.6743137555483116, 0.8227532728194973, 3.0, 3.9343434052125223], res=[0.0, 0.0, 0.0, 0.0, 0.17575757575757578], res_norm=1.758e-01
2026-01-24 11:32:55,948 - INFO - integration_test - Dyn residual k=2: pred=[3.538208937910055, 2.8942201747181646, 0.8227532728194973, 3.0, 4.234343405212522], ws=[3.538208937910055, 2.8942201747181646, 0.8227532728194973, 3.0, 4.058585829454946], res=[0.0, 0.0, 0.0, 0.0, 0.17575757575757578], res_norm=1.758e-01
2026-01-24 11:32:55,964 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:57,117 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:57,138 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:57,181 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:57,204 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:57,249 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:57,270 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:57,317 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:57,339 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:57,383 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:57,405 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:57,449 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:57,470 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:57,517 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:57,538 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:57,581 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:57,603 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:57,653 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:32:57,677 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:57,727 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:57,751 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:32:57,802 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:32:58,483 - INFO - integration_test - Step 16: MPC solve successful
2026-01-24 11:32:58,498 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:32:58,498 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1858 scenarios available
2026-01-24 11:32:58,519 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1858 trajectory groups with 18580 total points
2026-01-24 11:32:58,520 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:32:58,848 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 11:32:58,865 - INFO - integration_test - Step 16: Computed 6 numeric contouring constraints for visualization (s=3.900)
2026-01-24 11:32:58,866 - DEBUG - integration_test - Step 16: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 11:32:58,866 - INFO - integration_test - === Applying control at step 16 ===
2026-01-24 11:32:58,866 - INFO - integration_test -   Control dict from planner: {'a': 9.523820994156883e-10, 'w': -0.1364009980074196}
2026-01-24 11:32:58,866 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 11:32:58,866 - INFO - integration_test -   Planner output success: True
2026-01-24 11:32:58,867 - INFO - integration_test - Step 16 completed in 4.899s
2026-01-24 11:32:58,935 - INFO - integration_test - Step 17 (contouring until path end)
2026-01-24 11:32:58,937 - DEBUG - integration_test - Syncing planner state at step 17: vehicle_state=[3.13157901 2.45300883 0.80911317 3.00000003 4.19999993]
2026-01-24 11:32:58,938 - DEBUG - integration_test - Step 17: Using propagated spline 4.2000 (close to path, dist=0.416m, drift=0.103m)
2026-01-24 11:32:58,938 - DEBUG - integration_test -   Set spline state to 4.2000
2026-01-24 11:32:58,939 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:32:59,854 - DEBUG - integration_test - Step 17: Checking path alignment: vehicle=(3.132, 2.453), path_start=(0.000, 0.000), dist=3.978m
2026-01-24 11:32:59,854 - INFO - integration_test - === Calling planner.solve_mpc() at step 17 ===
2026-01-24 11:33:00,790 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:33:00,818 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 11:33:00,818 - INFO - integration_test - Warmstart k=0: x0=3.1315790137716206 , y0=2.4530088303871533 , psi0=0.8091131730187553 , v0=3.000000029998472 , spline0=4.1999999326593525 , a0=0.0 , w0=0.0
2026-01-24 11:33:00,818 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 11:33:00,819 - INFO - integration_test - Dyn residual k=0: pred=[3.338621159585071, 2.670111459705341, 0.8091131730187553, 3.000000029998472, 4.4999999356592], ws=[3.3386211575147553, 2.670111457534425, 0.8091131730187553, 3.0, 3.9343434064548837], res=[2.0703159187007714e-09, 2.170915891497316e-09, 0.0, 2.9998472150793987e-08, 0.5656565292043161], res_norm=5.657e-01
2026-01-24 11:33:00,820 - INFO - integration_test - Dyn residual k=1: pred=[3.54566330125789, 2.8872140846816965, 0.8091131730187553, 3.0, 4.234343406454884], ws=[3.54566330125789, 2.8872140846816965, 0.8091131730187553, 3.0, 4.058585830697307], res=[0.0, 0.0, 0.0, 0.0, 0.17575757575757667], res_norm=1.758e-01
2026-01-24 11:33:00,820 - INFO - integration_test - Dyn residual k=2: pred=[3.7527054450010247, 3.104316711828968, 0.8091131730187553, 3.0, 4.358585830697307], ws=[3.7527054450010247, 3.104316711828968, 0.8091131730187553, 3.0, 4.645454478113897], res=[0.0, 0.0, 0.0, 0.0, -0.2868686474165898], res_norm=2.869e-01
2026-01-24 11:33:00,835 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:01,818 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:33:01,840 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:01,888 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:01,910 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:01,959 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:01,980 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:02,027 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:02,047 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:02,106 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:02,138 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:02,197 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:02,221 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:02,268 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:02,291 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:02,340 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:02,361 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:02,409 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:02,431 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:02,480 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:33:02,504 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:02,553 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:33:03,179 - INFO - integration_test - Step 17: MPC solve successful
2026-01-24 11:33:03,190 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:33:03,190 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1856 scenarios available
2026-01-24 11:33:03,395 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1856 trajectory groups with 18560 total points
2026-01-24 11:33:03,397 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:33:03,744 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 11:33:03,765 - INFO - integration_test - Step 17: Computed 6 numeric contouring constraints for visualization (s=4.200)
2026-01-24 11:33:03,766 - DEBUG - integration_test - Step 17: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 11:33:03,766 - INFO - integration_test - === Applying control at step 17 ===
2026-01-24 11:33:03,766 - INFO - integration_test -   Control dict from planner: {'a': -1.8700661454854672e-07, 'w': -0.24170961502371013}
2026-01-24 11:33:03,766 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 11:33:03,766 - INFO - integration_test -   Planner output success: True
2026-01-24 11:33:03,767 - INFO - integration_test - Step 17 completed in 4.830s
2026-01-24 11:33:03,842 - INFO - integration_test - Step 18 (contouring until path end)
2026-01-24 11:33:03,843 - DEBUG - integration_test - Syncing planner state at step 18: vehicle_state=[3.34122466 2.66758824 0.78494221 3.00000001 4.49999993]
2026-01-24 11:33:03,844 - DEBUG - integration_test - Step 18: Using propagated spline 4.5000 (close to path, dist=0.411m, drift=0.403m)
2026-01-24 11:33:03,844 - DEBUG - integration_test -   Set spline state to 4.5000
2026-01-24 11:33:03,845 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:33:04,771 - DEBUG - integration_test - Step 18: Checking path alignment: vehicle=(3.341, 2.668), path_start=(0.000, 0.000), dist=4.275m
2026-01-24 11:33:04,771 - INFO - integration_test - === Calling planner.solve_mpc() at step 18 ===
2026-01-24 11:33:05,625 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:33:05,650 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 11:33:05,650 - INFO - integration_test - Warmstart k=0: x0=3.3412246612258416 , y0=2.667588237795328 , psi0=0.7849422115163843 , v0=3.0000000112978107 , spline0=4.499999933789134 , a0=0.0 , w0=0.0
2026-01-24 11:33:05,650 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 11:33:05,651 - INFO - integration_test - Dyn residual k=0: pred=[3.5534533963275043, 2.8796235289027683, 0.7849422115163843, 3.0000000112978107, 4.799999934918915], ws=[3.5534533955282646, 2.879623528104257, 0.7849422115163844, 3.0, 4.058585831165197], res=[7.992397854650335e-10, 7.985114791608794e-10, -1.1102230246251565e-16, 1.1297810686983212e-08, 0.7414141037537183], res_norm=7.414e-01
2026-01-24 11:33:05,652 - INFO - integration_test - Dyn residual k=1: pred=[3.7656821298306875, 3.091658818413185, 0.7849422115163844, 3.0, 4.358585831165197], ws=[3.7656821298306875, 3.0916588184131855, 0.7849422115163844, 3.0, 4.6454544792436785], res=[0.0, -4.440892098500626e-16, 0.0, 0.0, -0.28686864807848167], res_norm=2.869e-01
2026-01-24 11:33:05,653 - INFO - integration_test - Dyn residual k=2: pred=[3.9779108641331105, 3.303694108722114, 0.7849422115163844, 3.0, 4.945454479243678], ws=[3.9779108641331105, 3.303694108722114, 0.7849422115163844, 3.0, 5.0464645802537795], res=[0.0, 0.0, 0.0, 0.0, -0.10101010101010122], res_norm=1.010e-01
2026-01-24 11:33:05,667 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:06,673 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:33:06,697 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:06,744 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:06,766 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:06,812 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:06,833 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:06,880 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:06,903 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:06,951 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:06,972 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:07,018 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:07,040 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:07,088 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:07,110 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:07,156 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:07,177 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:07,222 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:07,244 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:07,292 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:33:07,317 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:07,367 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:33:08,068 - INFO - integration_test - Step 18: MPC solve successful
2026-01-24 11:33:08,079 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:33:08,079 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1865 scenarios available
2026-01-24 11:33:08,291 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1865 trajectory groups with 18650 total points
2026-01-24 11:33:08,293 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:33:08,665 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 11:33:08,684 - INFO - integration_test - Step 18: Computed 6 numeric contouring constraints for visualization (s=4.500)
2026-01-24 11:33:08,684 - DEBUG - integration_test - Step 18: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 11:33:08,684 - INFO - integration_test - === Applying control at step 18 ===
2026-01-24 11:33:08,685 - INFO - integration_test -   Control dict from planner: {'a': 1.8503554640889294e-07, 'w': 0.7999994881671046}
2026-01-24 11:33:08,685 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 11:33:08,685 - INFO - integration_test -   Planner output success: True
2026-01-24 11:33:08,686 - INFO - integration_test - Step 18 completed in 4.843s
2026-01-24 11:33:08,752 - INFO - integration_test - Step 19 (contouring until path end)
2026-01-24 11:33:08,753 - DEBUG - integration_test - Syncing planner state at step 19: vehicle_state=[3.54475021 2.88788205 0.86494216 3.00000003 4.79999994]
2026-01-24 11:33:08,754 - DEBUG - integration_test - Step 19: Using propagated spline 4.8000 (close to path, dist=0.351m, drift=0.293m)
2026-01-24 11:33:08,754 - DEBUG - integration_test -   Set spline state to 4.8000
2026-01-24 11:33:08,754 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:33:09,688 - DEBUG - integration_test - Step 19: Checking path alignment: vehicle=(3.545, 2.888), path_start=(0.000, 0.000), dist=4.572m
2026-01-24 11:33:09,688 - INFO - integration_test - === Calling planner.solve_mpc() at step 19 ===
2026-01-24 11:33:10,610 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:33:10,635 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 11:33:10,635 - INFO - integration_test - Warmstart k=0: x0=3.5447502114709915 , y0=2.8878820518007746 , psi0=0.8649421603330948 , v0=3.0000000298013654 , spline0=4.799999936769271 , a0=0.0 , w0=0.0
2026-01-24 11:33:10,635 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 11:33:10,636 - INFO - integration_test - Dyn residual k=0: pred=[3.7393554542335883, 3.1161993776378485, 0.8649421603330948, 3.0000000298013654, 5.099999939749408], ws=[3.739355452300421, 3.1161993753697925, 0.8649421603330945, 3.0, 4.6454544822238155], res=[1.9331674039335667e-09, 2.2680559652599186e-09, 3.3306690738754696e-16, 2.9801365375448086e-08, 0.45454545752559206], res_norm=4.545e-01
2026-01-24 11:33:10,636 - INFO - integration_test - Dyn residual k=1: pred=[3.9339606931298507, 3.3445166989388104, 0.8649421603330945, 3.0, 4.945454482223815], ws=[3.9339606931298507, 3.3445166989388104, 0.8649421603330945, 3.0, 5.046464583233917], res=[0.0, 0.0, 0.0, 0.0, -0.10101010101010122], res_norm=1.010e-01
2026-01-24 11:33:10,637 - INFO - integration_test - Dyn residual k=2: pred=[4.128565933959281, 3.5728340225078283, 0.8649421603330945, 3.0, 5.346464583233916], ws=[4.128565933959281, 3.5728340225078283, 0.8649421603330945, 3.0, 5.144444381213715], res=[0.0, 0.0, 0.0, 0.0, 0.20202020202020154], res_norm=2.020e-01
2026-01-24 11:33:10,653 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:11,671 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:33:11,706 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:11,781 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:11,803 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:11,849 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:11,869 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:11,914 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:11,936 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:11,981 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:12,000 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:12,046 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:12,067 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:12,110 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:12,132 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:12,175 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:12,194 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:12,243 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:12,266 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:12,313 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:33:12,333 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:12,381 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:33:16,500 - WARNING - integration_test - Step 19: MPC solve failed
2026-01-24 11:33:16,501 - WARNING - integration_test -   Consecutive MPC failures: 1/20
2026-01-24 11:33:16,512 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:33:16,512 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1849 scenarios available
2026-01-24 11:33:16,729 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1849 trajectory groups with 18490 total points
2026-01-24 11:33:16,730 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:33:17,092 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 11:33:17,117 - INFO - integration_test - Step 19: Computed 6 numeric contouring constraints for visualization (s=4.800)
2026-01-24 11:33:17,117 - DEBUG - integration_test - Step 19: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 11:33:17,117 - INFO - integration_test - === Applying control at step 19 ===
2026-01-24 11:33:17,117 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': 0.6802959251403475}
2026-01-24 11:33:17,117 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 11:33:17,117 - INFO - integration_test -   Planner output success: False
2026-01-24 11:33:17,117 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': 0.6802959251403475}
2026-01-24 11:33:17,118 - INFO - integration_test - Step 19 completed in 8.365s
2026-01-24 11:33:17,191 - INFO - integration_test - Step 20 (contouring until path end)
2026-01-24 11:33:17,194 - DEBUG - integration_test - Syncing planner state at step 20: vehicle_state=[3.72530787 3.11474438 0.93297175 2.80000003 5.07999994]
2026-01-24 11:33:17,194 - DEBUG - integration_test - Step 20: Using propagated spline 5.0800 (close to path, dist=0.302m, drift=0.164m)
2026-01-24 11:33:17,194 - DEBUG - integration_test -   Set spline state to 5.0800
2026-01-24 11:33:17,195 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:33:18,124 - DEBUG - integration_test - Step 20: Checking path alignment: vehicle=(3.725, 3.115), path_start=(0.000, 0.000), dist=4.856m
2026-01-24 11:33:18,124 - INFO - integration_test - === Calling planner.solve_mpc() at step 20 ===
2026-01-24 11:33:19,070 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:33:19,098 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 11:33:19,098 - INFO - integration_test - Warmstart k=0: x0=3.725307869811136 , y0=3.1147443847296548 , psi0=0.9329717528471295 , v0=2.800000029801365 , spline0=5.079999939749407 , a0=0.0 , w0=0.0
2026-01-24 11:33:19,098 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 11:33:19,100 - INFO - integration_test - Dyn residual k=0: pred=[3.8920336278803336, 3.3396944308846352, 0.9329717528471295, 2.800000029801365, 5.3599999427295435], ws=[3.8920336278803336, 3.3396944308846352, 0.9329717528471297, 2.800000029801365, 5.00646458919419], res=[0.0, 0.0, -2.220446049250313e-16, 0.0, 0.3535353535353538], res_norm=3.535e-01
2026-01-24 11:33:19,101 - INFO - integration_test - Dyn residual k=1: pred=[4.058759385949531, 3.5646444770396157, 0.9329717528471297, 2.800000029801365, 5.286464592174326], ws=[4.058759385949531, 3.5646444770396157, 0.9329717528471297, 2.800000029801365, 4.882424188133922], res=[0.0, 0.0, 0.0, 0.0, 0.404040404040404], res_norm=4.040e-01
2026-01-24 11:33:19,102 - INFO - integration_test - Dyn residual k=2: pred=[4.225485144018728, 3.789594523194596, 0.9329717528471297, 2.800000029801365, 5.1624241911140585], ws=[4.225485144018728, 3.789594523194596, 0.9329717528471297, 2.800000029801365, 5.465454494144361], res=[0.0, 0.0, 0.0, 0.0, -0.30303030303030276], res_norm=3.030e-01
2026-01-24 11:33:19,119 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:20,092 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:33:20,114 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:20,159 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:20,179 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:20,225 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:20,252 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:20,301 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:20,324 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:20,371 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:20,391 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:20,436 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:20,457 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:20,505 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:20,527 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:20,572 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:20,592 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:20,637 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:20,657 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:20,702 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:33:20,723 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:20,766 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:33:21,409 - INFO - integration_test - Step 20: MPC solve successful
2026-01-24 11:33:21,421 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:33:21,421 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1855 scenarios available
2026-01-24 11:33:21,434 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1855 trajectory groups with 18550 total points
2026-01-24 11:33:21,435 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:33:21,707 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 11:33:21,725 - INFO - integration_test - Step 20: Computed 6 numeric contouring constraints for visualization (s=5.080)
2026-01-24 11:33:21,725 - DEBUG - integration_test - Step 20: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 11:33:21,725 - INFO - integration_test - === Applying control at step 20 ===
2026-01-24 11:33:21,725 - INFO - integration_test -   Control dict from planner: {'a': 1.316921059721343, 'w': 0.8000000099997042}
2026-01-24 11:33:21,725 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 11:33:21,725 - INFO - integration_test -   Planner output success: True
2026-01-24 11:33:21,727 - INFO - integration_test - Step 20 completed in 4.533s
2026-01-24 11:33:21,780 - INFO - integration_test - Step 21 (contouring until path end)
2026-01-24 11:33:21,784 - DEBUG - integration_test - Syncing planner state at step 21: vehicle_state=[3.88649522 3.35161057 1.01297175 2.93169214 5.37316915]
2026-01-24 11:33:21,785 - DEBUG - integration_test - Step 21: Using propagated spline 5.3732 (close to path, dist=0.296m, drift=0.047m)
2026-01-24 11:33:21,785 - DEBUG - integration_test -   Set spline state to 5.3732
2026-01-24 11:33:21,785 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:33:22,705 - DEBUG - integration_test - Step 21: Checking path alignment: vehicle=(3.886, 3.352), path_start=(0.000, 0.000), dist=5.132m
2026-01-24 11:33:22,705 - INFO - integration_test - === Calling planner.solve_mpc() at step 21 ===
2026-01-24 11:33:23,915 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:33:23,942 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 11:33:23,942 - INFO - integration_test - Warmstart k=0: x0=3.886495222208531 , y0=3.3516105736443027 , psi0=1.0129717538471 , v0=2.9316921357734995 , spline0=5.373169153326757 , a0=0.0 , w0=0.0
2026-01-24 11:33:23,942 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 11:33:23,943 - INFO - integration_test - Dyn residual k=0: pred=[4.041681941654402, 3.600337873909453, 1.0129717538471, 2.9316921357734995, 5.666338366904108], ws=[4.041681941654402, 3.600337873909453, 1.0129717538470997, 2.9316921357734995, 5.110782811348552], res=[0.0, 0.0, 2.220446049250313e-16, 0.0, 0.5555555555555554], res_norm=5.556e-01
2026-01-24 11:33:23,944 - INFO - integration_test - Dyn residual k=1: pred=[4.1968686611002735, 3.849065174174603, 1.0129717538470997, 2.9316921357734995, 5.4039520249259025], ws=[4.1968686611002735, 3.849065174174603, 1.0129717538470997, 2.9316921357734995, 5.504962125936003], res=[0.0, 0.0, 0.0, 0.0, -0.10101010101010033], res_norm=1.010e-01
2026-01-24 11:33:23,944 - INFO - integration_test - Dyn residual k=2: pred=[4.352055380546145, 4.097792474439753, 1.0129717538470997, 2.9316921357734995, 5.798131339513353], ws=[4.352055380546145, 4.097792474439753, 1.0129717538470997, 2.9316921357734995, 5.596111137493152], res=[0.0, 0.0, 0.0, 0.0, 0.20202020202020154], res_norm=2.020e-01
2026-01-24 11:33:23,961 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:25,041 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:33:25,064 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:25,116 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:25,143 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:25,189 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:25,213 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:25,263 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:25,284 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:25,336 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:25,359 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:25,406 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:25,429 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:25,474 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:25,496 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:25,544 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:25,564 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:25,610 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:25,631 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:25,676 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:33:25,697 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:25,745 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:33:30,885 - WARNING - integration_test - Step 21: MPC solve failed
2026-01-24 11:33:30,885 - WARNING - integration_test -   Consecutive MPC failures: 1/20
2026-01-24 11:33:30,895 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:33:30,895 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1859 scenarios available
2026-01-24 11:33:30,912 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1859 trajectory groups with 18590 total points
2026-01-24 11:33:30,913 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:33:31,411 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 11:33:31,436 - INFO - integration_test - Step 21: Computed 6 numeric contouring constraints for visualization (s=5.373)
2026-01-24 11:33:31,437 - DEBUG - integration_test - Step 21: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 11:33:31,437 - INFO - integration_test - === Applying control at step 21 ===
2026-01-24 11:33:31,437 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': 0.6486296342063875}
2026-01-24 11:33:31,437 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 11:33:31,437 - INFO - integration_test -   Planner output success: False
2026-01-24 11:33:31,437 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': 0.6486296342063875}
2026-01-24 11:33:31,439 - INFO - integration_test - Step 21 completed in 9.655s
2026-01-24 11:33:31,513 - INFO - integration_test - Step 22 (contouring until path end)
2026-01-24 11:33:31,515 - DEBUG - integration_test - Syncing planner state at step 22: vehicle_state=[4.02858824 3.59649071 1.07783472 2.73169214 5.64633837]
2026-01-24 11:33:31,516 - DEBUG - integration_test - Step 22: Using propagated spline 5.6463 (close to path, dist=0.150m, drift=0.320m)
2026-01-24 11:33:31,516 - DEBUG - integration_test -   Set spline state to 5.6463
2026-01-24 11:33:31,516 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:33:32,530 - DEBUG - integration_test - Step 22: Checking path alignment: vehicle=(4.029, 3.596), path_start=(0.000, 0.000), dist=5.400m
2026-01-24 11:33:32,530 - INFO - integration_test - === Calling planner.solve_mpc() at step 22 ===
2026-01-24 11:33:33,459 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:33:33,485 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 11:33:33,485 - INFO - integration_test - Warmstart k=0: x0=4.028588237345703 , y0=3.596490712403016 , psi0=1.0778347172677387 , v0=2.7316921357734993 , spline0=5.646338366904107 , a0=0.0 , w0=0.0
2026-01-24 11:33:33,485 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 11:33:33,487 - INFO - integration_test - Dyn residual k=0: pred=[4.157862001663501, 3.837135083011543, 1.0778347172677387, 2.7316921357734993, 5.919507580481457], ws=[4.157862001663501, 3.837135083011543, 1.0778347172677387, 2.7316921357734993, 5.464962125936002], res=[0.0, 0.0, 0.0, 0.0, 0.45454545454545503], res_norm=4.545e-01
2026-01-24 11:33:33,487 - INFO - integration_test - Dyn residual k=1: pred=[4.287135765981299, 4.07777945362007, 1.0778347172677387, 2.7316921357734993, 5.738131339513352], ws=[4.287135765981299, 4.07777945362007, 1.0778347172677387, 2.7316921357734993, 5.53611113749315], res=[0.0, 0.0, 0.0, 0.0, 0.20202020202020154], res_norm=2.020e-01
2026-01-24 11:33:33,488 - INFO - integration_test - Dyn residual k=2: pred=[4.416409530299097, 4.3184238242285975, 1.0778347172677387, 2.7316921357734993, 5.8092803510705], ws=[4.416409530299097, 4.3184238242285975, 1.0778347172677387, 2.7316921357734993, 5.910290452080601], res=[0.0, 0.0, 0.0, 0.0, -0.10101010101010122], res_norm=1.010e-01
2026-01-24 11:33:33,505 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:34,674 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:33:34,694 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:34,743 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:34,765 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:34,812 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:34,834 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:34,881 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:34,905 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:34,957 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:34,980 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:35,030 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:35,054 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:35,103 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:35,127 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:35,177 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:35,200 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:35,249 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:35,272 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:35,323 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:33:35,355 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:35,423 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:33:40,710 - WARNING - integration_test - Step 22: MPC solve failed
2026-01-24 11:33:40,710 - WARNING - integration_test -   Consecutive MPC failures: 2/20
2026-01-24 11:33:40,723 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:33:40,723 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1867 scenarios available
2026-01-24 11:33:40,746 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1867 trajectory groups with 18670 total points
2026-01-24 11:33:40,747 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:33:41,193 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 11:33:41,217 - INFO - integration_test - Step 22: Computed 6 numeric contouring constraints for visualization (s=5.646)
2026-01-24 11:33:41,218 - DEBUG - integration_test - Step 22: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 11:33:41,218 - INFO - integration_test - === Applying control at step 22 ===
2026-01-24 11:33:41,218 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': -0.37570344815465706}
2026-01-24 11:33:41,218 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 11:33:41,218 - INFO - integration_test -   Planner output success: False
2026-01-24 11:33:41,218 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': -0.37570344815465706}
2026-01-24 11:33:41,219 - INFO - integration_test - Step 22 completed in 9.705s
2026-01-24 11:33:41,287 - INFO - integration_test - Step 23 (contouring until path end)
2026-01-24 11:33:41,290 - DEBUG - integration_test - Syncing planner state at step 23: vehicle_state=[4.15740029 3.8259626  1.04026437 2.53169214 5.89950758]
2026-01-24 11:33:41,291 - DEBUG - integration_test - Step 23: Using propagated spline 5.8995 (close to path, dist=0.098m, drift=0.164m)
2026-01-24 11:33:41,291 - DEBUG - integration_test -   Set spline state to 5.8995
2026-01-24 11:33:41,291 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:33:42,205 - DEBUG - integration_test - Step 23: Checking path alignment: vehicle=(4.157, 3.826), path_start=(0.000, 0.000), dist=5.650m
2026-01-24 11:33:42,205 - INFO - integration_test - === Calling planner.solve_mpc() at step 23 ===
2026-01-24 11:33:43,081 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:33:43,105 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 11:33:43,105 - INFO - integration_test - Warmstart k=0: x0=4.157400291743955 , y0=3.8259626003588556 , psi0=1.040264372452273 , v0=2.531692135773499 , spline0=5.899507580481457 , a0=0.0 , w0=0.0
2026-01-24 11:33:43,105 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 11:33:43,106 - INFO - integration_test - Dyn residual k=0: pred=[4.285501950138597, 4.044330674536186, 1.040264372452273, 2.531692135773499, 6.152676794058808], ws=[4.285501950138597, 4.044330674536186, 1.040264372452273, 2.531692135773499, 5.799141440523454], res=[0.0, 0.0, 0.0, 0.0, 0.3535353535353538], res_norm=3.535e-01
2026-01-24 11:33:43,107 - INFO - integration_test - Dyn residual k=1: pred=[4.413603608533239, 4.262698748713517, 1.040264372452273, 2.531692135773499, 6.052310654100804], ws=[4.413603608533239, 4.262698748713517, 1.040264372452273, 2.531692135773499, 5.6482702500604], res=[0.0, 0.0, 0.0, 0.0, 0.404040404040404], res_norm=4.040e-01
2026-01-24 11:33:43,108 - INFO - integration_test - Dyn residual k=2: pred=[4.541705266927881, 4.481066822890848, 1.040264372452273, 2.531692135773499, 5.90143946363775], ws=[4.541705266927881, 4.481066822890848, 1.040264372452273, 2.531692135773499, 6.0024495646478515], res=[0.0, 0.0, 0.0, 0.0, -0.10101010101010122], res_norm=1.010e-01
2026-01-24 11:33:43,125 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:44,112 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:33:44,136 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:44,188 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:44,213 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:44,261 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:44,284 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:44,334 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:44,356 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:44,410 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:44,434 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:44,488 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:44,512 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:44,562 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:44,585 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:44,633 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:44,656 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:44,715 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:44,749 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:44,810 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:33:44,833 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:44,882 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:33:45,552 - INFO - integration_test - Step 23: MPC solve successful
2026-01-24 11:33:45,563 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:33:45,563 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1853 scenarios available
2026-01-24 11:33:45,808 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1853 trajectory groups with 18530 total points
2026-01-24 11:33:45,809 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:33:46,206 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 11:33:46,231 - INFO - integration_test - Step 23: Computed 6 numeric contouring constraints for visualization (s=5.900)
2026-01-24 11:33:46,232 - DEBUG - integration_test - Step 23: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 11:33:46,232 - INFO - integration_test - === Applying control at step 23 ===
2026-01-24 11:33:46,232 - INFO - integration_test -   Control dict from planner: {'a': 1.9999980958740005, 'w': 0.7999995751952096}
2026-01-24 11:33:46,232 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 11:33:46,232 - INFO - integration_test -   Planner output success: True
2026-01-24 11:33:46,233 - INFO - integration_test - Step 23 completed in 4.944s
2026-01-24 11:33:46,302 - INFO - integration_test - Step 24 (contouring until path end)
2026-01-24 11:33:46,303 - DEBUG - integration_test - Syncing planner state at step 24: vehicle_state=[4.28122741 4.05810042 1.12026433 2.73169195 6.17267678]
2026-01-24 11:33:46,304 - DEBUG - integration_test - Step 24: Using propagated spline 6.1727 (close to path, dist=0.166m, drift=0.437m)
2026-01-24 11:33:46,304 - DEBUG - integration_test -   Set spline state to 6.1727
2026-01-24 11:33:46,305 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:33:47,268 - DEBUG - integration_test - Step 24: Checking path alignment: vehicle=(4.281, 4.058), path_start=(0.000, 0.000), dist=5.899m
2026-01-24 11:33:47,268 - INFO - integration_test - === Calling planner.solve_mpc() at step 24 ===
2026-01-24 11:33:48,224 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:33:48,253 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 11:33:48,253 - INFO - integration_test - Warmstart k=0: x0=4.281227405112113 , y0=4.058100417180424 , psi0=1.120264329971794 , v0=2.731691945360899 , spline0=6.172676775017547 , a0=0.0 , w0=0.0
2026-01-24 11:33:48,253 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 11:33:48,254 - INFO - integration_test - Dyn residual k=0: pred=[4.400177430500436, 4.304011580618796, 1.120264329971794, 2.731691945360899, 6.445845969553637], ws=[4.400177430500436, 4.304011580618796, 1.1202643299717945, 2.731691945360899, 5.890290413998081], res=[0.0, 0.0, -4.440892098500626e-16, 0.0, 0.5555555555555554], res_norm=5.556e-01
2026-01-24 11:33:48,255 - INFO - integration_test - Dyn residual k=1: pred=[4.51912745588876, 4.5499227440571675, 1.1202643299717945, 2.731691945360899, 6.163459608534171], ws=[4.51912745588876, 4.5499227440571675, 1.1202643299717945, 2.731691945360899, 6.264469709544271], res=[0.0, 0.0, 0.0, 0.0, -0.10101010101010033], res_norm=1.010e-01
2026-01-24 11:33:48,256 - INFO - integration_test - Dyn residual k=2: pred=[4.638077481277083, 4.795833907495539, 1.1202643299717945, 2.731691945360899, 6.537638904080361], ws=[4.638077481277083, 4.795833907495539, 1.1202643299717945, 2.731691945360899, 6.3356187020601595], res=[0.0, 0.0, 0.0, 0.0, 0.20202020202020154], res_norm=2.020e-01
2026-01-24 11:33:48,275 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:49,246 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:33:49,267 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:49,311 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:49,332 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:49,379 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:49,402 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:49,451 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:49,473 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:49,519 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:49,541 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:49,584 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:49,605 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:49,648 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:49,668 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:49,713 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:49,735 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:49,778 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:49,800 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:49,845 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:33:49,864 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:49,907 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:33:55,370 - WARNING - integration_test - Step 24: MPC solve failed
2026-01-24 11:33:55,370 - WARNING - integration_test -   Consecutive MPC failures: 1/20
2026-01-24 11:33:55,383 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:33:55,383 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1845 scenarios available
2026-01-24 11:33:55,649 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1845 trajectory groups with 18450 total points
2026-01-24 11:33:55,650 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:33:56,134 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 11:33:56,161 - INFO - integration_test - Step 24: Computed 6 numeric contouring constraints for visualization (s=6.173)
2026-01-24 11:33:56,161 - DEBUG - integration_test - Step 24: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 11:33:56,161 - INFO - integration_test - === Applying control at step 24 ===
2026-01-24 11:33:56,162 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': -0.8}
2026-01-24 11:33:56,162 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 11:33:56,162 - INFO - integration_test -   Planner output success: False
2026-01-24 11:33:56,162 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': -0.8}
2026-01-24 11:33:56,163 - INFO - integration_test - Step 24 completed in 9.860s
2026-01-24 11:33:56,241 - INFO - integration_test - Step 25 (contouring until path end)
2026-01-24 11:33:56,254 - DEBUG - integration_test - Syncing planner state at step 25: vehicle_state=[4.40505452 4.29023822 1.04026433 2.53169195 6.42584597]
2026-01-24 11:33:56,255 - DEBUG - integration_test - Step 25: Using propagated spline 6.4258 (close to path, dist=0.152m, drift=0.280m)
2026-01-24 11:33:56,255 - DEBUG - integration_test -   Set spline state to 6.4258
2026-01-24 11:33:56,256 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:33:57,185 - DEBUG - integration_test - Step 25: Checking path alignment: vehicle=(4.405, 4.290), path_start=(0.000, 0.000), dist=6.149m
2026-01-24 11:33:57,185 - INFO - integration_test - === Calling planner.solve_mpc() at step 25 ===
2026-01-24 11:33:58,094 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:33:58,119 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 11:33:58,119 - INFO - integration_test - Warmstart k=0: x0=4.40505451871756 , y0=4.290238223003523 , psi0=1.040264329971794 , v0=2.531691945360899 , spline0=6.425845969553637 , a0=0.0 , w0=0.0
2026-01-24 11:33:58,119 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 11:33:58,120 - INFO - integration_test - Dyn residual k=0: pred=[4.5331561767538515, 4.508606275315223, 1.040264329971794, 2.531691945360899, 6.679015164089727], ws=[4.5331561767538515, 4.508606275315223, 1.0402643299717944, 2.531691945360899, 6.224469709544272], res=[0.0, 0.0, -4.440892098500626e-16, 0.0, 0.45454545454545503], res_norm=4.545e-01
2026-01-24 11:33:58,121 - INFO - integration_test - Dyn residual k=1: pred=[4.661257834790143, 4.726974327626924, 1.0402643299717944, 2.531691945360899, 6.477638904080362], ws=[4.661257834790143, 4.726974327626924, 1.0402643299717944, 2.531691945360899, 6.578649005090464], res=[0.0, 0.0, 0.0, 0.0, -0.10101010101010122], res_norm=1.010e-01
2026-01-24 11:33:58,122 - INFO - integration_test - Dyn residual k=2: pred=[4.789359492826434, 4.945342379938625, 1.0402643299717944, 2.531691945360899, 6.831818199626554], ws=[4.789359492826434, 4.945342379938625, 1.0402643299717944, 2.531691945360899, 6.42777779558615], res=[0.0, 0.0, 0.0, 0.0, 0.404040404040404], res_norm=4.040e-01
2026-01-24 11:33:58,138 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:59,188 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:33:59,225 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:59,281 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:59,306 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:59,367 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:59,401 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:59,471 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:59,496 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:59,547 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:59,570 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:59,619 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:59,642 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:59,689 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:59,712 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:59,765 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:59,792 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:59,850 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:33:59,874 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:33:59,926 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:33:59,950 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:00,001 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:34:05,558 - WARNING - integration_test - Step 25: MPC solve failed
2026-01-24 11:34:05,558 - WARNING - integration_test -   Consecutive MPC failures: 2/20
2026-01-24 11:34:05,576 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:34:05,576 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1861 scenarios available
2026-01-24 11:34:05,592 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1861 trajectory groups with 18610 total points
2026-01-24 11:34:05,593 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:34:06,341 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 11:34:06,367 - INFO - integration_test - Step 25: Computed 6 numeric contouring constraints for visualization (s=6.426)
2026-01-24 11:34:06,367 - DEBUG - integration_test - Step 25: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 11:34:06,367 - INFO - integration_test - === Applying control at step 25 ===
2026-01-24 11:34:06,367 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': -0.8}
2026-01-24 11:34:06,367 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 11:34:06,367 - INFO - integration_test -   Planner output success: False
2026-01-24 11:34:06,367 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': -0.8}
2026-01-24 11:34:06,369 - INFO - integration_test - Step 25 completed in 10.115s
2026-01-24 11:34:06,437 - INFO - integration_test - Step 26 (contouring until path end)
2026-01-24 11:34:06,439 - DEBUG - integration_test - Syncing planner state at step 26: vehicle_state=[4.5362381  4.49491019 0.96026433 2.33169195 6.65901516]
2026-01-24 11:34:06,440 - DEBUG - integration_test - Step 26: Using propagated spline 6.6590 (close to path, dist=0.292m, drift=0.104m)
2026-01-24 11:34:06,440 - DEBUG - integration_test -   Set spline state to 6.6590
2026-01-24 11:34:06,441 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:34:07,452 - DEBUG - integration_test - Step 26: Checking path alignment: vehicle=(4.536, 4.495), path_start=(0.000, 0.000), dist=6.386m
2026-01-24 11:34:07,452 - INFO - integration_test - === Calling planner.solve_mpc() at step 26 ===
2026-01-24 11:34:08,410 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:34:08,438 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 11:34:08,438 - INFO - integration_test - Warmstart k=0: x0=4.536238101379045 , y0=4.4949101905947595 , psi0=0.960264329971794 , v0=2.3316919453608986 , spline0=6.659015164089727 , a0=0.0 , w0=0.0
2026-01-24 11:34:08,438 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 11:34:08,439 - INFO - integration_test - Dyn residual k=0: pred=[4.6699148001798525, 4.685955770178081, 0.960264329971794, 2.3316919453608986, 6.8921843586258165], ws=[4.6699148001798525, 4.685955770178081, 0.9602643299717943, 2.3316919453608986, 6.336628803070261], res=[0.0, 0.0, -3.3306690738754696e-16, 0.0, 0.5555555555555554], res_norm=5.556e-01
2026-01-24 11:34:08,440 - INFO - integration_test - Dyn residual k=1: pred=[4.803591498980659, 4.877001349761403, 0.9602643299717943, 2.3316919453608986, 6.569797997606351], ws=[4.803591498980659, 4.877001349761403, 0.9602643299717943, 2.3316919453608986, 6.670808098616451], res=[0.0, 0.0, 0.0, 0.0, -0.10101010101010033], res_norm=1.010e-01
2026-01-24 11:34:08,441 - INFO - integration_test - Dyn residual k=2: pred=[4.937268197781466, 5.068046929344725, 0.9602643299717943, 2.3316919453608986, 6.903977293152541], ws=[4.859893060718724, 4.923210082284221, 0.9602643299717943, 2.3316919453608986, 6.701957091132339], res=[0.07737513706274246, 0.14483684706050326, 0.0, 0.0, 0.20202020202020154], res_norm=2.603e-01
2026-01-24 11:34:08,458 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:09,496 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:34:09,520 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:09,569 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:34:09,591 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:09,641 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:34:09,664 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:09,711 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:34:09,734 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:09,783 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:34:09,804 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:09,853 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:34:09,875 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:09,922 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:34:09,944 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:09,991 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:34:10,014 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:10,061 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:34:10,084 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:10,145 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:34:10,182 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:10,237 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:34:15,748 - WARNING - integration_test - Step 26: MPC solve failed
2026-01-24 11:34:15,748 - WARNING - integration_test -   Consecutive MPC failures: 3/20
2026-01-24 11:34:15,766 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:34:15,766 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1860 scenarios available
2026-01-24 11:34:15,781 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1860 trajectory groups with 18600 total points
2026-01-24 11:34:15,782 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:34:16,392 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 11:34:16,425 - INFO - integration_test - Step 26: Computed 6 numeric contouring constraints for visualization (s=6.659)
2026-01-24 11:34:16,425 - DEBUG - integration_test - Step 26: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 11:34:16,425 - INFO - integration_test - === Applying control at step 26 ===
2026-01-24 11:34:16,425 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': -0.8}
2026-01-24 11:34:16,425 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 11:34:16,425 - INFO - integration_test -   Planner output success: False
2026-01-24 11:34:16,425 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': -0.8}
2026-01-24 11:34:16,427 - INFO - integration_test - Step 26 completed in 9.988s
2026-01-24 11:34:16,501 - INFO - integration_test - Step 27 (contouring until path end)
2026-01-24 11:34:16,505 - DEBUG - integration_test - Syncing planner state at step 27: vehicle_state=[4.67124945 4.67253307 0.88026433 2.13169195 6.87218436]
2026-01-24 11:34:16,506 - DEBUG - integration_test - Step 27: Using propagated spline 6.8722 (close to path, dist=0.276m, drift=0.317m)
2026-01-24 11:34:16,507 - DEBUG - integration_test -   Set spline state to 6.8722
2026-01-24 11:34:16,507 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:34:17,484 - DEBUG - integration_test - Step 27: Checking path alignment: vehicle=(4.671, 4.673), path_start=(0.000, 0.000), dist=6.607m
2026-01-24 11:34:17,485 - INFO - integration_test - === Calling planner.solve_mpc() at step 27 ===
2026-01-24 11:34:18,399 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:34:18,424 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 11:34:18,424 - INFO - integration_test - Warmstart k=0: x0=4.671249450874954 , y0=4.672533070183256 , psi0=0.880264329971794 , v0=2.1316919453608985 , spline0=6.872184358625817 , a0=0.0 , w0=0.0
2026-01-24 11:34:18,424 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 11:34:18,425 - INFO - integration_test - Dyn residual k=0: pred=[4.807027013507947, 4.836866752015706, 0.880264329971794, 2.1316919453608985, 7.085353553161907], ws=[4.673306506673696, 4.604206620761714, 0.8802643299717943, 2.1316919453608985, 6.327777795586149], res=[0.1337205068342513, 0.23266013125399265, -2.220446049250313e-16, 0.0, 0.7575757575757578], res_norm=8.037e-01
2026-01-24 11:34:18,426 - INFO - integration_test - Dyn residual k=1: pred=[4.80908406930669, 4.768540302594164, 0.8802643299717943, 2.1316919453608985, 6.540946990122239], ws=[4.942804576140941, 5.001200433848156, 0.8802643299717943, 2.1316919453608985, 6.742967192142442], res=[-0.1337205068342513, -0.23266013125399265, 0.0, 0.0, -0.20202020202020243], res_norm=3.359e-01
2026-01-24 11:34:18,426 - INFO - integration_test - Dyn residual k=2: pred=[5.0785821387739345, 5.1655341156806065, 0.8802643299717943, 2.1316919453608985, 6.956136386678532], ws=[5.063450155059048, 5.155492015697021, 0.8802643299717943, 2.1316919453608985, 7.057146487688632], res=[0.015131983714886665, 0.010042099983585295, 0.0, 0.0, -0.10101010101010033], res_norm=1.026e-01
2026-01-24 11:34:18,442 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:19,453 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:34:19,476 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:19,522 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:34:19,546 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:19,593 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:34:19,614 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:19,659 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:34:19,680 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:19,724 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:34:19,745 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:19,794 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:34:19,817 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:19,865 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:34:19,887 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:19,936 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:34:19,959 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:20,007 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:34:20,031 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:20,079 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:34:20,102 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:20,152 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:34:26,189 - WARNING - integration_test - Step 27: MPC solve failed
2026-01-24 11:34:26,189 - WARNING - integration_test -   Consecutive MPC failures: 4/20
2026-01-24 11:34:26,207 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:34:26,207 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1868 scenarios available
2026-01-24 11:34:26,221 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1868 trajectory groups with 18680 total points
2026-01-24 11:34:26,222 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:34:26,668 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 11:34:26,694 - INFO - integration_test - Step 27: Computed 6 numeric contouring constraints for visualization (s=6.872)
2026-01-24 11:34:26,694 - DEBUG - integration_test - Step 27: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 11:34:26,694 - INFO - integration_test - === Applying control at step 27 ===
2026-01-24 11:34:26,695 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': -0.8}
2026-01-24 11:34:26,695 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 11:34:26,695 - INFO - integration_test -   Planner output success: False
2026-01-24 11:34:26,695 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': -0.8}
2026-01-24 11:34:26,696 - INFO - integration_test - Step 27 completed in 10.191s
2026-01-24 11:34:26,760 - INFO - integration_test - Step 28 (contouring until path end)
2026-01-24 11:34:26,770 - DEBUG - integration_test - Syncing planner state at step 28: vehicle_state=[4.80668191 4.82390605 0.80026433 1.93169195 7.06535355]
2026-01-24 11:34:26,770 - DEBUG - integration_test - Step 28: Using propagated spline 7.0654 (close to path, dist=0.353m, drift=0.101m)
2026-01-24 11:34:26,770 - DEBUG - integration_test -   Set spline state to 7.0654
2026-01-24 11:34:26,771 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:34:27,760 - DEBUG - integration_test - Step 28: Checking path alignment: vehicle=(4.807, 4.824), path_start=(0.000, 0.000), dist=6.810m
2026-01-24 11:34:27,760 - INFO - integration_test - === Calling planner.solve_mpc() at step 28 ===
2026-01-24 11:34:28,828 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:34:28,856 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 11:34:28,856 - INFO - integration_test - Warmstart k=0: x0=4.806681911343689 , y0=4.823906050311609 , psi0=0.8002643299717941 , v0=1.9316919453608985 , spline0=7.0653535531619065 , a0=0.0 , w0=0.0
2026-01-24 11:34:28,856 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 11:34:28,857 - INFO - integration_test - Dyn residual k=0: pred=[4.941227552020444, 4.962512717873466, 0.8002643299717941, 1.9316919453608985, 7.258522747697996], ws=[4.941227552020444, 4.962512717873466, 0.8002643299717942, 1.9316919453608985, 6.500946990122238], res=[0.0, 0.0, -1.1102230246251565e-16, 0.0, 0.7575757575757578], res_norm=7.576e-01
2026-01-24 11:34:28,858 - INFO - integration_test - Dyn residual k=1: pred=[5.075773192697199, 5.1011193854353225, 0.8002643299717942, 1.9316919453608985, 6.694116184658328], ws=[5.075773192697199, 5.1011193854353225, 0.8002643299717942, 1.9316919453608985, 6.795126285668429], res=[0.0, 0.0, 0.0, 0.0, -0.10101010101010122], res_norm=1.010e-01
2026-01-24 11:34:28,859 - INFO - integration_test - Dyn residual k=2: pred=[5.210318833373955, 5.239726052997179, 0.8002643299717942, 1.9316919453608985, 6.988295480204519], ws=[5.100882009387172, 5.204595221507591, 0.8002643299717942, 1.9316919453608985, 7.08930558121462], res=[0.10943682398678245, 0.035130831489587955, 0.0, 0.0, -0.10101010101010122], res_norm=1.530e-01
2026-01-24 11:34:28,876 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:29,963 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:34:29,988 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:30,040 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:34:30,068 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:30,115 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:34:30,139 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:30,188 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:34:30,211 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:30,259 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:34:30,283 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:30,334 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:34:30,357 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:30,406 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:34:30,429 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:30,477 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:34:30,501 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:30,553 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:34:30,576 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:30,623 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:34:30,647 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:30,695 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:34:36,226 - WARNING - integration_test - Step 28: MPC solve failed
2026-01-24 11:34:36,226 - WARNING - integration_test -   Consecutive MPC failures: 5/20
2026-01-24 11:34:36,244 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:34:36,244 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1852 scenarios available
2026-01-24 11:34:36,526 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1852 trajectory groups with 18520 total points
2026-01-24 11:34:36,527 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:34:37,283 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 11:34:37,319 - INFO - integration_test - Step 28: Computed 6 numeric contouring constraints for visualization (s=7.065)
2026-01-24 11:34:37,320 - DEBUG - integration_test - Step 28: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 11:34:37,320 - INFO - integration_test - === Applying control at step 28 ===
2026-01-24 11:34:37,320 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': -0.8}
2026-01-24 11:34:37,320 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 11:34:37,320 - INFO - integration_test -   Planner output success: False
2026-01-24 11:34:37,320 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': -0.8}
2026-01-24 11:34:37,322 - INFO - integration_test - Step 28 completed in 10.552s
2026-01-24 11:34:37,404 - INFO - integration_test - Step 29 (contouring until path end)
2026-01-24 11:34:37,406 - DEBUG - integration_test - Syncing planner state at step 29: vehicle_state=[4.93928893 4.95019327 0.72026433 1.73169195 7.23852275]
2026-01-24 11:34:37,407 - DEBUG - integration_test - Step 29: Using propagated spline 7.2385 (close to path, dist=0.317m, drift=0.274m)
2026-01-24 11:34:37,407 - DEBUG - integration_test -   Set spline state to 7.2385
2026-01-24 11:34:37,408 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:34:38,398 - DEBUG - integration_test - Step 29: Checking path alignment: vehicle=(4.939, 4.950), path_start=(0.000, 0.000), dist=6.993m
2026-01-24 11:34:38,398 - INFO - integration_test - === Calling planner.solve_mpc() at step 29 ===
2026-01-24 11:34:39,339 - INFO - integration_test - ContouringObjective.update: reference_path=True, add_road_constraints=True
2026-01-24 11:34:39,365 - INFO - integration_test - Solver solve: module_manager has 6 modules: ['safe_horizon_constraint', 'contouring_constraints', 'control_effort_objective', 'control_jerk_objective', 'path_reference_velocity_objective', 'contouring_objective'], data=True
2026-01-24 11:34:39,365 - INFO - integration_test - Warmstart k=0: x0=4.939288931058579 , y0=4.950193266000767 , psi0=0.7202643299717941 , v0=1.7316919453608985 , spline0=7.2385227476979965 , a0=0.0 , w0=0.0
2026-01-24 11:34:39,365 - INFO - integration_test - Bounds: x∈[-2000.0,2000.0] , y∈[-2000.0,2000.0] , psi∈[-18.84955592153876,18.84955592153876] , v∈[-0.01,3.0] , spline∈[-1.0,10000.0] , a∈[-2.0,2.0] , w∈[-0.8,0.8]
2026-01-24 11:34:39,366 - INFO - integration_test - Dyn residual k=0: pred=[5.069448336526106, 5.064412787557364, 0.7202643299717941, 1.7316919453608985, 7.411691942234087], ws=[5.062841689258186, 5.0524430386670645, 0.7202643299717941, 1.7316919453608985, 7.058156588698733], res=[0.0066066472679198185, 0.01196974889029967, 0.0, 0.0, 0.3535353535353538], res_norm=3.538e-01
2026-01-24 11:34:39,367 - INFO - integration_test - Dyn residual k=1: pred=[5.193001094725713, 5.166662560223662, 0.7202643299717941, 1.7316919453608985, 7.231325783234823], ws=[4.990647213193588, 4.8821980081886, 0.7202643299717941, 1.7316919453608985, 6.726275278184318], res=[0.20235388153212508, 0.28446455203506193, 0.0, 0.0, 0.5050505050505052], res_norm=6.140e-01
2026-01-24 11:34:39,368 - INFO - integration_test - Dyn residual k=2: pred=[5.120806618661115, 4.996417529745197, 0.7202643299717941, 1.7316919453608985, 6.899444472720408], ws=[5.073253022113623, 5.160011710622216, 0.7202643299717941, 1.7316919453608985, 6.798434371710307], res=[0.04755359654749203, -0.16359418087701894, 0.0, 0.0, 0.10101010101010033], res_norm=1.981e-01
2026-01-24 11:34:39,385 - INFO - integration_test - Stage 0: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:40,409 - INFO - integration_test - Stage 0: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:34:40,431 - INFO - integration_test - Stage 1: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:40,475 - INFO - integration_test - Stage 1: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:34:40,500 - INFO - integration_test - Stage 2: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:40,546 - INFO - integration_test - Stage 2: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:34:40,567 - INFO - integration_test - Stage 3: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:40,618 - INFO - integration_test - Stage 3: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:34:40,641 - INFO - integration_test - Stage 4: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:40,687 - INFO - integration_test - Stage 4: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:34:40,708 - INFO - integration_test - Stage 5: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:40,753 - INFO - integration_test - Stage 5: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:34:40,774 - INFO - integration_test - Stage 6: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:40,821 - INFO - integration_test - Stage 6: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:34:40,844 - INFO - integration_test - Stage 7: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:40,889 - INFO - integration_test - Stage 7: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:34:40,910 - INFO - integration_test - Stage 8: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:40,956 - INFO - integration_test - Stage 8: constraints count=10 (linearized=0, contouring=6, other=4)
2026-01-24 11:34:40,977 - INFO - integration_test - Stage 9: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:41,024 - INFO - integration_test - Stage 9: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:34:41,044 - INFO - integration_test - Stage 10: 1 objective(s) with keys: ['contouring_lag_cost', 'contouring_contour_cost', 'contouring_velocity_cost', 'contouring_goal_cost', 'contouring_terminal_cost']
2026-01-24 11:34:41,088 - INFO - integration_test - Stage 10: constraints count=6 (linearized=0, contouring=6, other=0)
2026-01-24 11:34:47,363 - WARNING - integration_test - Step 29: MPC solve failed
2026-01-24 11:34:47,363 - WARNING - integration_test -   Consecutive MPC failures: 6/20
2026-01-24 11:34:47,380 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:34:47,380 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1854 scenarios available
2026-01-24 11:34:47,395 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1854 trajectory groups with 18540 total points
2026-01-24 11:34:47,396 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:34:47,890 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 11:34:47,919 - INFO - integration_test - Step 29: Computed 6 numeric contouring constraints for visualization (s=7.239)
2026-01-24 11:34:47,919 - DEBUG - integration_test - Step 29: Captured 6 contouring constraint halfspaces for visualization
2026-01-24 11:34:47,919 - INFO - integration_test - === Applying control at step 29 ===
2026-01-24 11:34:47,919 - INFO - integration_test -   Control dict from planner: {'a': -2.0, 'w': -0.8}
2026-01-24 11:34:47,919 - INFO - integration_test -   Expected input names: ['a', 'w']
2026-01-24 11:34:47,919 - INFO - integration_test -   Planner output success: False
2026-01-24 11:34:47,919 - WARNING - integration_test -   MPC solve failed - applying safe fallback control: {'a': -2.0, 'w': -0.8}
2026-01-24 11:34:47,921 - INFO - integration_test - Step 29 completed in 10.515s
2026-01-24 11:34:47,989 - WARNING - integration_test - Test timeout reached (180.0s) at step 30. Terminating test early.
2026-01-24 11:34:47,992 - INFO - integration_test - Saving test results...
2026-01-24 11:34:47,993 - INFO - integration_test - Saved 31 vehicle states to test_outputs/20260124_113140_contouring_safe_horizon_contouring_unicycle/vehicle_states.csv
2026-01-24 11:34:47,993 - INFO - integration_test - Saved obstacle summary to test_outputs/20260124_113140_contouring_safe_horizon_contouring_unicycle/obstacle_summary.csv
2026-01-24 11:34:47,993 - INFO - integration_test - Saved 41 states for obstacle 0 to test_outputs/20260124_113140_contouring_safe_horizon_contouring_unicycle/obstacle_0_detailed_states.csv
2026-01-24 11:34:47,993 - INFO - integration_test - Saved 41 states for obstacle 1 to test_outputs/20260124_113140_contouring_safe_horizon_contouring_unicycle/obstacle_1_detailed_states.csv
2026-01-24 11:34:47,993 - INFO - integration_test - Saved state history: 31 vehicle states, 2 obstacles
2026-01-24 11:34:47,993 - INFO - integration_test - Creating animation...
2026-01-24 11:34:48,037 - DEBUG - integration_test - Creating animation with 31 frames (range: 0 to 30)
2026-01-24 11:34:48,038 - DEBUG - integration_test - Frame 0: Drawing 6 contouring constraint halfspaces
2026-01-24 11:34:49,324 - INFO - integration_test - Frame 0: Safe Horizon module has 1857 scenarios after update
2026-01-24 11:34:49,324 - INFO - integration_test - Frame 0: Calling Safe Horizon visualizer
2026-01-24 11:34:49,324 - DEBUG - integration_test - Frame 0: Safe Horizon scenario_cache has 40 constraints across 10 keys: [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4)]
2026-01-24 11:34:49,327 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:34:49,327 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1857 scenarios available
2026-01-24 11:34:49,345 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1857 trajectory groups with 18570 total points
2026-01-24 11:34:49,347 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:34:49,410 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 11:34:49,417 - INFO - integration_test - Frame 0: Safe Horizon visualizer completed
2026-01-24 11:34:49,417 - DEBUG - integration_test - Frame 0: Drawing 6 contouring constraint halfspaces
2026-01-24 11:34:50,464 - INFO - integration_test - Frame 0: Safe Horizon module has 1864 scenarios after update
2026-01-24 11:34:50,464 - INFO - integration_test - Frame 0: Calling Safe Horizon visualizer
2026-01-24 11:34:50,464 - DEBUG - integration_test - Frame 0: Safe Horizon scenario_cache has 40 constraints across 10 keys: [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4)]
2026-01-24 11:34:50,467 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:34:50,467 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1864 scenarios available
2026-01-24 11:34:50,495 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1864 trajectory groups with 18640 total points
2026-01-24 11:34:50,498 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:34:50,579 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.125,0.11;0.775x0.77)
2026-01-24 11:34:50,589 - INFO - integration_test - Frame 0: Safe Horizon visualizer completed
2026-01-24 11:34:50,736 - DEBUG - integration_test - Frame 1: Drawing 6 contouring constraint halfspaces
2026-01-24 11:34:51,731 - INFO - integration_test - Frame 1: Safe Horizon module has 1857 scenarios after update
2026-01-24 11:34:51,731 - INFO - integration_test - Frame 1: Calling Safe Horizon visualizer
2026-01-24 11:34:51,731 - DEBUG - integration_test - Frame 1: Safe Horizon scenario_cache has 40 constraints across 10 keys: [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4)]
2026-01-24 11:34:51,732 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:34:51,732 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1857 scenarios available
2026-01-24 11:34:52,033 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1857 trajectory groups with 18570 total points
2026-01-24 11:34:52,034 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:34:52,086 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 11:34:52,093 - INFO - integration_test - Frame 1: Safe Horizon visualizer completed
2026-01-24 11:34:52,201 - DEBUG - integration_test - Frame 2: Drawing 6 contouring constraint halfspaces
2026-01-24 11:34:53,302 - INFO - integration_test - Frame 2: Safe Horizon module has 1845 scenarios after update
2026-01-24 11:34:53,302 - INFO - integration_test - Frame 2: Calling Safe Horizon visualizer
2026-01-24 11:34:53,302 - DEBUG - integration_test - Frame 2: Safe Horizon scenario_cache has 40 constraints across 10 keys: [(0, 0), (0, 1), (0, 2), (0, 3), (0, 4)]
2026-01-24 11:34:53,304 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:34:53,304 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1845 scenarios available
2026-01-24 11:34:53,322 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1845 trajectory groups with 18450 total points
2026-01-24 11:34:53,323 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:34:53,374 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 11:34:53,380 - INFO - integration_test - Frame 2: Safe Horizon visualizer completed
2026-01-24 11:34:54,462 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:34:54,462 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1854 scenarios available
2026-01-24 11:34:54,754 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1854 trajectory groups with 18540 total points
2026-01-24 11:34:54,756 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:34:54,804 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 11:34:55,877 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:34:55,877 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1864 scenarios available
2026-01-24 11:34:55,896 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1864 trajectory groups with 18640 total points
2026-01-24 11:34:55,897 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:34:55,951 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 11:34:57,135 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:34:57,135 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1856 scenarios available
2026-01-24 11:34:57,156 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1856 trajectory groups with 18560 total points
2026-01-24 11:34:57,158 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:34:57,521 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 11:34:58,732 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:34:58,732 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1863 scenarios available
2026-01-24 11:34:58,754 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1863 trajectory groups with 18630 total points
2026-01-24 11:34:58,755 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:34:58,809 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 11:34:59,942 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:34:59,943 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1861 scenarios available
2026-01-24 11:34:59,964 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1861 trajectory groups with 18610 total points
2026-01-24 11:34:59,965 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:35:00,025 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 11:35:01,248 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:35:01,249 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1852 scenarios available
2026-01-24 11:35:01,588 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1852 trajectory groups with 18520 total points
2026-01-24 11:35:01,589 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:35:01,647 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 11:35:02,800 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:35:02,800 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1872 scenarios available
2026-01-24 11:35:02,823 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1872 trajectory groups with 18720 total points
2026-01-24 11:35:02,825 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:35:02,894 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 11:35:04,052 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:35:04,052 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1859 scenarios available
2026-01-24 11:35:04,369 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1859 trajectory groups with 18590 total points
2026-01-24 11:35:04,371 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:35:04,424 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 11:35:05,578 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:35:05,578 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1867 scenarios available
2026-01-24 11:35:05,599 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1867 trajectory groups with 18670 total points
2026-01-24 11:35:05,601 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:35:05,656 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 11:35:06,797 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:35:06,797 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1846 scenarios available
2026-01-24 11:35:06,819 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1846 trajectory groups with 18460 total points
2026-01-24 11:35:06,820 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:35:06,878 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 11:35:08,277 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:35:08,277 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1852 scenarios available
2026-01-24 11:35:08,298 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1852 trajectory groups with 18520 total points
2026-01-24 11:35:08,299 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:35:08,346 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 11:35:09,370 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:35:09,370 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1838 scenarios available
2026-01-24 11:35:09,391 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1838 trajectory groups with 18380 total points
2026-01-24 11:35:09,392 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:35:09,446 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 11:35:10,572 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:35:10,572 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1839 scenarios available
2026-01-24 11:35:10,903 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1839 trajectory groups with 18390 total points
2026-01-24 11:35:10,905 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:35:10,961 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 11:35:12,107 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:35:12,107 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1860 scenarios available
2026-01-24 11:35:12,129 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1860 trajectory groups with 18600 total points
2026-01-24 11:35:12,131 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:35:12,186 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 11:35:13,389 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:35:13,389 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1865 scenarios available
2026-01-24 11:35:13,701 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1865 trajectory groups with 18650 total points
2026-01-24 11:35:13,702 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:35:13,755 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 11:35:14,877 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:35:14,877 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1864 scenarios available
2026-01-24 11:35:14,896 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1864 trajectory groups with 18640 total points
2026-01-24 11:35:14,897 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:35:14,950 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 11:35:16,047 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:35:16,047 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1861 scenarios available
2026-01-24 11:35:16,063 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1861 trajectory groups with 18610 total points
2026-01-24 11:35:16,064 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:35:16,388 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 11:35:17,453 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:35:17,453 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1870 scenarios available
2026-01-24 11:35:17,475 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1870 trajectory groups with 18700 total points
2026-01-24 11:35:17,477 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:35:17,532 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 11:35:18,806 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:35:18,806 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1854 scenarios available
2026-01-24 11:35:18,828 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1854 trajectory groups with 18540 total points
2026-01-24 11:35:18,829 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:35:18,886 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 11:35:20,061 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:35:20,061 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1859 scenarios available
2026-01-24 11:35:20,368 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1859 trajectory groups with 18590 total points
2026-01-24 11:35:20,369 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:35:20,422 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 11:35:21,626 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:35:21,626 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1856 scenarios available
2026-01-24 11:35:21,647 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1856 trajectory groups with 18560 total points
2026-01-24 11:35:21,648 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:35:21,707 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 11:35:22,828 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:35:22,828 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1852 scenarios available
2026-01-24 11:35:23,124 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1852 trajectory groups with 18520 total points
2026-01-24 11:35:23,125 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:35:23,173 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 11:35:24,276 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:35:24,276 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1857 scenarios available
2026-01-24 11:35:24,293 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1857 trajectory groups with 18570 total points
2026-01-24 11:35:24,295 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:35:24,343 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 11:35:25,554 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:35:25,554 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1863 scenarios available
2026-01-24 11:35:25,577 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1863 trajectory groups with 18630 total points
2026-01-24 11:35:25,578 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:35:25,643 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 11:35:26,864 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:35:26,864 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1849 scenarios available
2026-01-24 11:35:27,182 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1849 trajectory groups with 18490 total points
2026-01-24 11:35:27,183 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:35:27,242 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 11:35:28,377 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:35:28,377 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1849 scenarios available
2026-01-24 11:35:28,396 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1849 trajectory groups with 18490 total points
2026-01-24 11:35:28,397 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:35:28,454 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 11:35:29,496 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:35:29,496 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1865 scenarios available
2026-01-24 11:35:29,835 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1865 trajectory groups with 18650 total points
2026-01-24 11:35:29,837 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:35:29,906 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 11:35:31,114 - INFO - integration_test - SafeHorizonConstraintsVisualizer: scenario_module=True
2026-01-24 11:35:31,114 - INFO - integration_test - SafeHorizonConstraintsVisualizer: 1839 scenarios available
2026-01-24 11:35:31,135 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Extracted 1839 trajectory groups with 18390 total points
2026-01-24 11:35:31,136 - INFO - integration_test - SafeHorizonConstraintsVisualizer: About to draw 40 trajectories
2026-01-24 11:35:31,191 - INFO - integration_test - SafeHorizonConstraintsVisualizer: Drew 40 hypothetical trajectories to ax=Axes(0.22375,0.11;0.5775x0.77)
2026-01-24 11:35:33,299 - INFO - integration_test - Saved animation with 31 frames at 10.00 fps to test_outputs/20260124_113140_contouring_safe_horizon_contouring_unicycle/animation.gif (duration: 3.10s, size: 522153 bytes)
2026-01-24 11:35:33,322 - INFO - integration_test - Animation created successfully
2026-01-24 11:35:33,323 - INFO - integration_test - Test completed successfully
